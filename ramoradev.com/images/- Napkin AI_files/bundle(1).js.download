var tiptap;(()=>{"use strict";var t={34:(t,e,n)=>{var r=n(4901);t.exports=function(t){return"object"==typeof t?null!==t:r(t)}},237:(t,e,n)=>{n(6469)("flatMap")},259:(t,e,n)=>{var r=n(4376),o=n(6198),i=n(6837),s=n(6080),a=function(t,e,n,l,c,u,d,h){for(var p,f,g=c,m=0,y=!!d&&s(d,h);m<l;)m in n&&(p=y?y(n[m],m,e):n[m],u>0&&r(p)?(f=o(p),g=a(t,e,p,f,g,u-1)-1):(i(g+1),t[g]=p),g++),m++;return g};t.exports=a},283:(t,e,n)=>{var r=n(9504),o=n(9039),i=n(4901),s=n(9297),a=n(3724),l=n(350).CONFIGURABLE,c=n(3706),u=n(1181),d=u.enforce,h=u.get,p=String,f=Object.defineProperty,g=r("".slice),m=r("".replace),y=r([].join),b=a&&!o(function(){return 8!==f(function(){},"length",{value:8}).length}),v=String(String).split("String"),w=t.exports=function(t,e,n){"Symbol("===g(p(e),0,7)&&(e="["+m(p(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!s(t,"name")||l&&t.name!==e)&&(a?f(t,"name",{value:e,configurable:!0}):t.name=e),b&&n&&s(n,"arity")&&t.length!==n.arity&&f(t,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?a&&f(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=d(t);return s(r,"source")||(r.source=y(v,"string"==typeof e?e:"")),t};Function.prototype.toString=w(function(){return i(this)&&h(this).source||c(this)},"toString")},350:(t,e,n)=>{var r=n(3724),o=n(9297),i=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=o(i,"name"),l=a&&"something"===function(){}.name,c=a&&(!r||r&&s(i,"name").configurable);t.exports={EXISTS:a,PROPER:l,CONFIGURABLE:c}},373:(t,e,n)=>{var r=n(4576),o=n(7476),i=n(9039),s=n(9306),a=n(4488),l=n(4644),c=n(3709),u=n(3763),d=n(9519),h=n(3607),p=l.aTypedArray,f=l.exportTypedArrayMethod,g=r.Uint16Array,m=g&&o(g.prototype.sort),y=!(!m||i(function(){m(new g(2),null)})&&i(function(){m(new g(2),{})})),b=!!m&&!i(function(){if(d)return d<74;if(c)return c<67;if(u)return!0;if(h)return h<602;var t,e,n=new g(516),r=Array(516);for(t=0;t<516;t++)e=t%4,n[t]=515-t,r[t]=t-2*e+3;for(m(n,function(t,e){return(t/4|0)-(e/4|0)}),t=0;t<516;t++)if(n[t]!==r[t])return!0});f("sort",function(t){return void 0!==t&&s(t),b?m(this,t):a(p(this),function(t){return function(e,n){return void 0!==t?+t(e,n)||0:n!=n?-1:e!=e?1:0===e&&0===n?1/e>0&&1/n<0?1:-1:e>n}}(t))},!b||y)},397:(t,e,n)=>{var r=n(7751);t.exports=r("document","documentElement")},421:t=>{t.exports={}},443:(t,e,n)=>{t.exports=n.p+"b0b3fdd6eb66e1fc160a.svg"},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},616:(t,e,n)=>{var r=n(9039);t.exports=!r(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})},644:(t,e,n)=>{t.exports=n.p+"9f274cfaf4f7d8550cea.svg"},655:(t,e,n)=>{var r=n(6955),o=String;t.exports=function(t){if("Symbol"===r(t))throw new TypeError("Cannot convert a Symbol value to a string");return o(t)}},741:t=>{var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?n:e)(r)}},757:(t,e,n)=>{var r=n(7751),o=n(4901),i=n(1625),s=n(7040),a=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return o(e)&&i(e.prototype,a(t))}},788:(t,e,n)=>{var r=n(34),o=n(2195),i=n(8227)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[i])?!!e:"RegExp"===o(t))}},798:(t,e,n)=>{t.exports=n.p+"268b90ef8a4aa4c82dd5.svg"},838:(t,e,n)=>{var r=n(6518),o=n(3839).findLast,i=n(6469);r({target:"Array",proto:!0},{findLast:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i("findLast")},850:(t,e,n)=>{t.exports=n.p+"efdfa4de9ade8fcc8df0.svg"},1015:(t,e,n)=>{var r=n(5818);t.exports=r},1034:(t,e,n)=>{var r=n(9565),o=n(9297),i=n(1625),s=n(5213),a=n(7979),l=RegExp.prototype;t.exports=s.correct?function(t){return t.flags}:function(t){return s.correct||!i(l,t)||o(t,"flags")?t.flags:r(a,t)}},1072:(t,e,n)=>{var r=n(1828),o=n(8727);t.exports=Object.keys||function(t){return r(t,o)}},1113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},1181:(t,e,n)=>{var r,o,i,s=n(8622),a=n(4576),l=n(34),c=n(6699),u=n(9297),d=n(7629),h=n(6119),p=n(421),f="Object already initialized",g=a.TypeError,m=a.WeakMap;if(s||d.state){var y=d.state||(d.state=new m);y.get=y.get,y.has=y.has,y.set=y.set,r=function(t,e){if(y.has(t))throw new g(f);return e.facade=t,y.set(t,e),e},o=function(t){return y.get(t)||{}},i=function(t){return y.has(t)}}else{var b=h("state");p[b]=!0,r=function(t,e){if(u(t,b))throw new g(f);return e.facade=t,c(t,b,e),e},o=function(t){return u(t,b)?t[b]:{}},i=function(t){return u(t,b)}}t.exports={set:r,get:o,has:i,enforce:function(t){return i(t)?o(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!l(e)||(n=o(e)).type!==t)throw new g("Incompatible receiver, "+t+" required");return n}}}},1204:(t,e,n)=>{t.exports=n.p+"6dd943ba8b7cc44dc901.svg"},1261:(t,e,n)=>{t.exports=n.p+"f12af1a71710af9814c4.svg?v=2"},1291:(t,e,n)=>{var r=n(741);t.exports=function(t){var e=+t;return e!=e||0===e?0:r(e)}},1354:t=>{t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),i="/*# ".concat(o," */");return[e].concat([i]).join("\n")}return[e].join("\n")}},1436:(t,e,n)=>{var r=n(4295);t.exports=r},1443:(t,e,n)=>{t.exports=n.p+"204d4fc46f96fd2e8d5e.svg"},1469:(t,e,n)=>{var r=n(7433);t.exports=function(t,e){return new(r(t))(0===e?0:e)}},1478:(t,e,n)=>{n(5115);var r=n(4899);t.exports=r},1625:(t,e,n)=>{var r=n(9504);t.exports=r({}.isPrototypeOf)},1828:(t,e,n)=>{var r=n(9504),o=n(9297),i=n(5397),s=n(9617).indexOf,a=n(421),l=r([].push);t.exports=function(t,e){var n,r=i(t),c=0,u=[];for(n in r)!o(a,n)&&o(r,n)&&l(u,n);for(;e.length>c;)o(r,n=e[c++])&&(~s(u,n)||l(u,n));return u}},1890:(t,e,n)=>{t.exports=n.p+"c208b2dfd06ac336917f.svg"},1949:(t,e,n)=>{n(3451);var r=n(7015);t.exports=r("Array","findLastIndex")},2106:(t,e,n)=>{var r=n(283),o=n(4913);t.exports=function(t,e,n){return n.get&&r(n.get,e,{getter:!0}),n.set&&r(n.set,e,{setter:!0}),o.f(t,e,n)}},2140:(t,e,n)=>{var r={};r[n(8227)("toStringTag")]="z",t.exports="[object z]"===String(r)},2195:(t,e,n)=>{var r=n(9504),o=r({}.toString),i=r("".slice);t.exports=function(t){return i(o(t),8,-1)}},2211:(t,e,n)=>{var r=n(9039);t.exports=!r(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})},2274:(t,e,n)=>{t.exports=n.p+"81e9f14d41c4cf6eef89.svg"},2323:(t,e,n)=>{n(6449),n(3514);var r=n(7015);t.exports=r("Array","flat")},2360:(t,e,n)=>{var r,o=n(8551),i=n(6801),s=n(8727),a=n(421),l=n(397),c=n(4055),u=n(6119),d="prototype",h="script",p=u("IE_PROTO"),f=function(){},g=function(t){return"<"+h+">"+t+"</"+h+">"},m=function(t){t.write(g("")),t.close();var e=t.parentWindow.Object;return t=null,e},y=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}var t,e,n;y="undefined"!=typeof document?document.domain&&r?m(r):(e=c("iframe"),n="java"+h+":",e.style.display="none",l.appendChild(e),e.src=String(n),(t=e.contentWindow.document).open(),t.write(g("document.F=Object")),t.close(),t.F):m(r);for(var o=s.length;o--;)delete y[d][s[o]];return y()};a[p]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(f[d]=o(t),n=new f,f[d]=null,n[p]=t):n=y(),void 0===e?n:i.f(n,e)}},2404:(t,e,n)=>{t.exports=n.p+"37836eb665bd8a5adccb.svg"},2478:(t,e,n)=>{var r=n(9504),o=n(8981),i=Math.floor,s=r("".charAt),a=r("".replace),l=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,n,r,d,h){var p=n+t.length,f=r.length,g=u;return void 0!==d&&(d=o(d),g=c),a(h,g,function(o,a){var c;switch(s(a,0)){case"$":return"$";case"&":return t;case"`":return l(e,0,n);case"'":return l(e,p);case"<":c=d[l(a,1,-1)];break;default:var u=+a;if(0===u)return o;if(u>f){var h=i(u/10);return 0===h?o:h<=f?void 0===r[h-1]?s(a,1):r[h-1]+s(a,1):o}c=r[u-1]}return void 0===c?"":c})}},2777:(t,e,n)=>{var r=n(9565),o=n(34),i=n(757),s=n(5966),a=n(4270),l=n(8227),c=TypeError,u=l("toPrimitive");t.exports=function(t,e){if(!o(t)||i(t))return t;var n,l=s(t,u);if(l){if(void 0===e&&(e="default"),n=r(l,t,e),!o(n)||i(n))return n;throw new c("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},2787:(t,e,n)=>{var r=n(9297),o=n(4901),i=n(8981),s=n(6119),a=n(2211),l=s("IE_PROTO"),c=Object,u=c.prototype;t.exports=a?c.getPrototypeOf:function(t){var e=i(t);if(r(e,l))return e[l];var n=e.constructor;return o(n)&&e instanceof n?n.prototype:e instanceof c?u:null}},2796:(t,e,n)=>{var r=n(9039),o=n(4901),i=/#|\.prototype\./,s=function(t,e){var n=l[a(t)];return n===u||n!==c&&(o(e)?r(e):!!e)},a=s.normalize=function(t){return String(t).replace(i,".").toLowerCase()},l=s.data={},c=s.NATIVE="N",u=s.POLYFILL="P";t.exports=s},2839:(t,e,n)=>{var r=n(4576).navigator,o=r&&r.userAgent;t.exports=o?String(o):""},2967:(t,e,n)=>{var r=n(6706),o=n(34),i=n(7750),s=n(3506);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=r(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return i(n),s(r),o(n)?(e?t(n,r):n.__proto__=r,n):n}}():void 0)},3115:(t,e,n)=>{t.exports=n.p+"5b1fcc6bbb5be79f0e4e.svg"},3229:(t,e,n)=>{t.exports=n.p+"92cdc8ad5bde6a65254d.svg"},3392:(t,e,n)=>{var r=n(9504),o=0,i=Math.random(),s=r(1.1.toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++o+i,36)}},3451:(t,e,n)=>{var r=n(6518),o=n(3839).findLastIndex,i=n(6469);r({target:"Array",proto:!0},{findLastIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i("findLastIndex")},3506:(t,e,n)=>{var r=n(3925),o=String,i=TypeError;t.exports=function(t){if(r(t))return t;throw new i("Can't set "+o(t)+" as a prototype")}},3514:(t,e,n)=>{n(6469)("flat")},3517:(t,e,n)=>{var r=n(9504),o=n(9039),i=n(4901),s=n(6955),a=n(7751),l=n(3706),c=function(){},u=a("Reflect","construct"),d=/^\s*(?:class|function)\b/,h=r(d.exec),p=!d.test(c),f=function(t){if(!i(t))return!1;try{return u(c,[],t),!0}catch(t){return!1}},g=function(t){if(!i(t))return!1;switch(s(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p||!!h(d,l(t))}catch(t){return!0}};g.sham=!0,t.exports=!u||o(function(){var t;return f(f.call)||!f(Object)||!f(function(){t=!0})||t})?g:f},3523:(t,e,n)=>{t.exports=n.p+"414df491e025330a0518.svg"},3556:(t,e,n)=>{t.exports=n.p+"6d2563de53ef8e01d6ec.svg"},3607:(t,e,n)=>{var r=n(2839).match(/AppleWebKit\/(\d+)\./);t.exports=!!r&&+r[1]},3635:(t,e,n)=>{var r=n(9039),o=n(4576).RegExp;t.exports=r(function(){var t=o(".","s");return!(t.dotAll&&t.test("\n")&&"s"===t.flags)})},3706:(t,e,n)=>{var r=n(9504),o=n(4901),i=n(7629),s=r(Function.toString);o(i.inspectSource)||(i.inspectSource=function(t){return s(t)}),t.exports=i.inspectSource},3709:(t,e,n)=>{var r=n(2839).match(/firefox\/(\d+)/i);t.exports=!!r&&+r[1]},3717:(t,e)=>{e.f=Object.getOwnPropertySymbols},3724:(t,e,n)=>{var r=n(9039);t.exports=!r(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},3758:(t,e,n)=>{t.exports=n.p+"c0c74e099a5e96aa094e.svg"},3763:(t,e,n)=>{var r=n(2839);t.exports=/MSIE|Trident/.test(r)},3836:(t,e,n)=>{n(838);var r=n(7015);t.exports=r("Array","findLast")},3839:(t,e,n)=>{var r=n(6080),o=n(7055),i=n(8981),s=n(6198),a=function(t){var e=1===t;return function(n,a,l){for(var c,u=i(n),d=o(u),h=s(d),p=r(a,l);h-- >0;)if(p(c=d[h],h,u))switch(t){case 0:return c;case 1:return h}return e?-1:void 0}};t.exports={findLast:a(0),findLastIndex:a(1)}},3859:(t,e,n)=>{t.exports=n.p+"d67c1ea41b16dabd9d81.svg"},3925:(t,e,n)=>{var r=n(34);t.exports=function(t){return r(t)||null===t}},4029:(t,e,n)=>{t.exports=n.p+"272617badc36844781e7.svg"},4055:(t,e,n)=>{var r=n(4576),o=n(34),i=r.document,s=o(i)&&o(i.createElement);t.exports=function(t){return s?i.createElement(t):{}}},4117:t=>{t.exports=function(t){return null==t}},4170:(t,e,n)=>{var r=n(9951);t.exports=r},4212:(t,e,n)=>{var r=n(1015);t.exports=r},4270:(t,e,n)=>{var r=n(9565),o=n(4901),i=n(34),s=TypeError;t.exports=function(t,e){var n,a;if("string"===e&&o(n=t.toString)&&!i(a=r(n,t)))return a;if(o(n=t.valueOf)&&!i(a=r(n,t)))return a;if("string"!==e&&o(n=t.toString)&&!i(a=r(n,t)))return a;throw new s("Can't convert object to primitive value")}},4295:(t,e,n)=>{n(7357);var r=n(7015);t.exports=r("String","at")},4340:(t,e,n)=>{t.exports=n.p+"57f04f940ee61b2c2136.svg"},4373:(t,e,n)=>{var r=n(8981),o=n(5610),i=n(6198);t.exports=function(t){for(var e=r(this),n=i(e),s=arguments.length,a=o(s>1?arguments[1]:void 0,n),l=s>2?arguments[2]:void 0,c=void 0===l?n:o(l,n);c>a;)e[a++]=t;return e}},4376:(t,e,n)=>{var r=n(2195);t.exports=Array.isArray||function(t){return"Array"===r(t)}},4417:t=>{t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},4423:(t,e,n)=>{var r=n(6518),o=n(9617).includes,i=n(9039),s=n(6469);r({target:"Array",proto:!0,forced:i(function(){return!Array(1).includes()})},{includes:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),s("includes")},4488:(t,e,n)=>{var r=n(7680),o=Math.floor,i=function(t,e){var n=t.length;if(n<8)for(var s,a,l=1;l<n;){for(a=l,s=t[l];a&&e(t[a-1],s)>0;)t[a]=t[--a];a!==l++&&(t[a]=s)}else for(var c=o(n/2),u=i(r(t,0,c),e),d=i(r(t,c),e),h=u.length,p=d.length,f=0,g=0;f<h||g<p;)t[f+g]=f<h&&g<p?e(u[f],d[g])<=0?u[f++]:d[g++]:f<h?u[f++]:d[g++];return t};t.exports=i},4495:(t,e,n)=>{var r=n(9519),o=n(9039),i=n(4576).String;t.exports=!!Object.getOwnPropertySymbols&&!o(function(){var t=Symbol("symbol detection");return!i(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41})},4496:(t,e,n)=>{var r=n(9497);t.exports=r},4552:(t,e,n)=>{n(8350),n(237);var r=n(7015);t.exports=r("Array","flatMap")},4576:function(t,e,n){var r=function(t){return t&&t.Math===Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},4644:(t,e,n)=>{var r,o,i,s=n(7811),a=n(3724),l=n(4576),c=n(4901),u=n(34),d=n(9297),h=n(6955),p=n(6823),f=n(6699),g=n(6840),m=n(2106),y=n(1625),b=n(2787),v=n(2967),w=n(8227),A=n(3392),k=n(1181),x=k.enforce,C=k.get,S=l.Int8Array,E=S&&S.prototype,M=l.Uint8ClampedArray,_=M&&M.prototype,T=S&&b(S),D=E&&b(E),O=Object.prototype,N=l.TypeError,I=w("toStringTag"),L=A("TYPED_ARRAY_TAG"),R="TypedArrayConstructor",B=s&&!!v&&"Opera"!==h(l.opera),$=!1,P={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},F={BigInt64Array:8,BigUint64Array:8},z=function(t){var e=b(t);if(u(e)){var n=C(e);return n&&d(n,R)?n[R]:z(e)}},H=function(t){if(!u(t))return!1;var e=h(t);return d(P,e)||d(F,e)};for(r in P)(i=(o=l[r])&&o.prototype)?x(i)[R]=o:B=!1;for(r in F)(i=(o=l[r])&&o.prototype)&&(x(i)[R]=o);if((!B||!c(T)||T===Function.prototype)&&(T=function(){throw new N("Incorrect invocation")},B))for(r in P)l[r]&&v(l[r],T);if((!B||!D||D===O)&&(D=T.prototype,B))for(r in P)l[r]&&v(l[r].prototype,D);if(B&&b(_)!==D&&v(_,D),a&&!d(D,I))for(r in $=!0,m(D,I,{configurable:!0,get:function(){return u(this)?this[L]:void 0}}),P)l[r]&&f(l[r],L,r);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:B,TYPED_ARRAY_TAG:$&&L,aTypedArray:function(t){if(H(t))return t;throw new N("Target is not a typed array")},aTypedArrayConstructor:function(t){if(c(t)&&(!v||y(T,t)))return t;throw new N(p(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,n,r){if(a){if(n)for(var o in P){var i=l[o];if(i&&d(i.prototype,t))try{delete i.prototype[t]}catch(n){try{i.prototype[t]=e}catch(t){}}}D[t]&&!n||g(D,t,n?e:B&&E[t]||e,r)}},exportTypedArrayStaticMethod:function(t,e,n){var r,o;if(a){if(v){if(n)for(r in P)if((o=l[r])&&d(o,t))try{delete o[t]}catch(t){}if(T[t]&&!n)return;try{return g(T,t,n?e:B&&T[t]||e)}catch(t){}}for(r in P)!(o=l[r])||o[t]&&!n||g(o,t,e)}},getTypedArrayConstructor:z,isView:function(t){if(!u(t))return!1;var e=h(t);return"DataView"===e||d(P,e)||d(F,e)},isTypedArray:H,TypedArray:T,TypedArrayPrototype:D}},4654:(t,e,n)=>{t.exports=n.p+"730311866417c9366545.svg"},4671:(t,e,n)=>{n.r(e),n.d(e,{BubbleMenuOptions:()=>RE,ContentOptions:()=>LE,LineInViewport:()=>$E,PositionFromHook:()=>BE,PositionRange:()=>PE,TipTap:()=>FE,YArray:()=>jE,YDocument:()=>zE,YJSProvider:()=>lC,YMap:()=>HE,mergeYjsUpdates:()=>VE});var r={};n.r(r),n.d(r,{decode:()=>xg,encode:()=>Eg,format:()=>Mg,parse:()=>zg});var o={};n.r(o),n.d(o,{Any:()=>Vg,Cc:()=>qg,Cf:()=>Ug,P:()=>Hg,S:()=>jg,Z:()=>Wg});var i={};n.r(i),n.d(i,{arrayReplaceAt:()=>wm,assign:()=>vm,escapeHtml:()=>Nm,escapeRE:()=>Lm,fromCodePoint:()=>km,has:()=>bm,isMdAsciiPunct:()=>Pm,isPunctChar:()=>$m,isSpace:()=>Rm,isString:()=>mm,isValidEntityCode:()=>Am,isWhiteSpace:()=>Bm,lib:()=>zm,normalizeReference:()=>Fm,unescapeAll:()=>Mm,unescapeMd:()=>Em});var s={};function a(t){this.content=t}n.r(s),n.d(s,{parseLinkDestination:()=>jm,parseLinkLabel:()=>Hm,parseLinkTitle:()=>Vm}),n(4423),a.prototype={constructor:a,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return-1==e?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,o=r.find(t),i=r.content.slice();return-1==o?i.push(n||t,e):(i[o+1]=e,n&&(i[o]=n)),new a(i)},remove:function(t){var e=this.find(t);if(-1==e)return this;var n=this.content.slice();return n.splice(e,2),new a(n)},addToStart:function(t,e){return new a([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new a(n)},addBefore:function(t,e,n){var r=this.remove(e),o=r.content.slice(),i=r.find(t);return o.splice(-1==i?o.length:i,0,e,n),new a(o)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return(t=a.from(t)).size?new a(t.content.concat(this.subtract(t).content)):this},append:function(t){return(t=a.from(t)).size?new a(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=a.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}},a.from=function(t){if(t instanceof a)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new a(e)};const l=a;function c(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let o=t.child(r),i=e.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(let t=0;o.text[t]==i.text[t];t++)n++;return n}if(o.content.size||i.content.size){let t=c(o.content,i.content,n+1);if(null!=t)return t}n+=o.nodeSize}else n+=o.nodeSize}}function u(t,e,n,r){for(let o=t.childCount,i=e.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};let s=t.child(--o),a=e.child(--i),l=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){let t=0,e=Math.min(s.text.length,a.text.length);for(;t<e&&s.text[s.text.length-t-1]==a.text[a.text.length-t-1];)t++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){let t=u(s.content,a.content,n-1,r-1);if(t)return t}n-=l,r-=l}else n-=l,r-=l}}class d{constructor(t,e){if(this.content=t,this.size=e||0,null==e)for(let e=0;e<t.length;e++)this.size+=t[e].nodeSize}nodesBetween(t,e,n,r=0,o){for(let i=0,s=0;s<e;i++){let a=this.content[i],l=s+a.nodeSize;if(l>t&&!1!==n(a,r+s,o||null,i)&&a.content.size){let o=s+1;a.nodesBetween(Math.max(0,t-o),Math.min(a.content.size,e-o),n,r+o)}s=l}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,n,r){let o="",i=!0;return this.nodesBetween(t,e,(s,a)=>{let l=s.isText?s.text.slice(Math.max(t,a)-a,e-a):s.isLeaf?r?"function"==typeof r?r(s):r:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&l||s.isTextblock)&&n&&(i?i=!1:o+=n),o+=l},0),o}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new d(r,this.size+t.size)}cut(t,e=this.size){if(0==t&&e==this.size)return this;let n=[],r=0;if(e>t)for(let o=0,i=0;i<e;o++){let s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new d(n,r)}cutByIndex(t,e){return t==e?d.empty:0==t&&e==this.content.length?this:new d(this.content.slice(t,e))}replaceChild(t,e){let n=this.content[t];if(n==e)return this;let r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new d(r,o)}addToStart(t){return new d([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new d(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,n=0;e<this.content.length;e++){let r=this.content[e];t(r,n,e),n+=r.nodeSize}}findDiffStart(t,e=0){return c(this,t,e)}findDiffEnd(t,e=this.size,n=t.size){return u(this,t,e,n)}findIndex(t){if(0==t)return p(0,t);if(t==this.size)return p(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let e=0,n=0;;e++){let r=n+this.child(e).nodeSize;if(r>=t)return r==t?p(e+1,r):p(e,n);n=r}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return d.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new d(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return d.empty;let e,n=0;for(let r=0;r<t.length;r++){let o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new d(e||t,n)}static from(t){if(!t)return d.empty;if(t instanceof d)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new d([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}d.empty=new d([],0);const h={index:0,offset:0};function p(t,e){return h.index=t,h.offset=e,h}function f(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!f(t[n],e[n]))return!1}else{for(let n in t)if(!(n in e)||!f(t[n],e[n]))return!1;for(let n in e)if(!(n in t))return!1}return!0}class g{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,n=!1;for(let r=0;r<t.length;r++){let o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&f(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");let n=t.marks[e.type];if(!n)throw new RangeError(`There is no mark type ${e.type} in this schema`);let r=n.create(e.attrs);return n.checkAttrs(r.attrs),r}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&0==t.length)return g.none;if(t instanceof g)return[t];let e=t.slice();return e.sort((t,e)=>t.type.rank-e.type.rank),e}}g.none=[];class m extends Error{}class y{constructor(t,e,n){this.content=t,this.openStart=e,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let n=v(this.content,t+this.openStart,e);return n&&new y(n,this.openStart,this.openEnd)}removeBetween(t,e){return new y(b(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return y.empty;let n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new y(d.fromJSON(t,e.content),n,r)}static maxOpen(t,e=!0){let n=0,r=0;for(let r=t.firstChild;r&&!r.isLeaf&&(e||!r.type.spec.isolating);r=r.firstChild)n++;for(let n=t.lastChild;n&&!n.isLeaf&&(e||!n.type.spec.isolating);n=n.lastChild)r++;return new y(t,n,r)}}function b(t,e,n){let{index:r,offset:o}=t.findIndex(e),i=t.maybeChild(r),{index:s,offset:a}=t.findIndex(n);if(o==e||i.isText){if(a!=n&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(r,i.copy(b(i.content,e-o-1,n-o-1)))}function v(t,e,n,r){let{index:o,offset:i}=t.findIndex(e),s=t.maybeChild(o);if(i==e||s.isText)return r&&!r.canReplace(o,o,n)?null:t.cut(0,e).append(n).append(t.cut(e));let a=v(s.content,e-i-1,n,s);return a&&t.replaceChild(o,s.copy(a))}function w(t,e,n){if(n.openStart>t.depth)throw new m("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new m("Inconsistent open depths");return A(t,e,n,0)}function A(t,e,n,r){let o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){let s=A(t,e,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){let{start:o,end:s}=function(t,e){let n=e.depth-t.openStart,r=e.node(n).copy(t.content);for(let t=n-1;t>=0;t--)r=e.node(t).copy(d.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return E(i,M(t,o,s,e,r))}{let r=t.parent,o=r.content;return E(r,o.cut(0,t.parentOffset).append(n.content).append(o.cut(e.parentOffset)))}}return E(i,_(t,e,r))}function k(t,e){if(!e.type.compatibleContent(t.type))throw new m("Cannot join "+e.type.name+" onto "+t.type.name)}function x(t,e,n){let r=t.node(n);return k(r,e.node(n)),r}function C(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function S(t,e,n,r){let o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(C(t.nodeAfter,r),i++));for(let t=i;t<s;t++)C(o.child(t),r);e&&e.depth==n&&e.textOffset&&C(e.nodeBefore,r)}function E(t,e){return t.type.checkContent(e),t.copy(e)}function M(t,e,n,r,o){let i=t.depth>o&&x(t,e,o+1),s=r.depth>o&&x(n,r,o+1),a=[];return S(null,t,o,a),i&&s&&e.index(o)==n.index(o)?(k(i,s),C(E(i,M(t,e,n,r,o+1)),a)):(i&&C(E(i,_(t,e,o+1)),a),S(e,n,o,a),s&&C(E(s,_(n,r,o+1)),a)),S(r,null,o,a),new d(a)}function _(t,e,n){let r=[];return S(null,t,n,r),t.depth>n&&C(E(x(t,e,n+1),_(t,e,n+1)),r),S(e,null,n,r),new d(r)}y.empty=new y(d.empty,0,0);class T{constructor(t,e,n){this.pos=t,this.path=e,this.parentOffset=n,this.depth=e.length/3-1}resolveDepth(t){return null==t?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[3*this.resolveDepth(t)]}index(t){return this.path[3*this.resolveDepth(t)+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)}start(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]}after(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1;for(let e=0;e<t;e++)r+=n.child(e).nodeSize;return r}marks(){let t=this.parent,e=this.index();if(0==t.content.size)return g.none;if(this.textOffset)return t.child(e).marks;let n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){let t=n;n=r,r=t}let o=n.marks;for(var i=0;i<o.length;i++)!1!==o[i].type.spec.inclusive||r&&o[i].isInSet(r.marks)||(o=o[i--].removeFromSet(o));return o}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let n=e.marks,r=t.parent.maybeChild(t.index());for(var o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new I(this,t,n);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");let n=[],r=0,o=e;for(let e=t;;){let{index:t,offset:i}=e.content.findIndex(o),s=o-i;if(n.push(e,t,r+i),!s)break;if(e=e.child(t),e.isText)break;o=s-1,r+=i+1}return new T(e,n,o)}static resolveCached(t,e){let n=N.get(t);if(n)for(let t=0;t<n.elts.length;t++){let r=n.elts[t];if(r.pos==e)return r}else N.set(t,n=new D);let r=n.elts[n.i]=T.resolve(t,e);return n.i=(n.i+1)%O,r}}class D{constructor(){this.elts=[],this.i=0}}const O=12,N=new WeakMap;class I{constructor(t,e,n){this.$from=t,this.$to=e,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const L=Object.create(null);class R{constructor(t,e,n,r=g.none){this.type=t,this.attrs=e,this.marks=r,this.content=n||d.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,n,r=0){this.content.nodesBetween(t,e,n,r,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,n,r){return this.content.textBetween(t,e,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,n){return this.type==t&&f(this.attrs,e||t.defaultAttrs||L)&&g.sameSet(this.marks,n||g.none)}copy(t=null){return t==this.content?this:new R(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new R(this.type,this.attrs,this.content,t)}cut(t,e=this.content.size){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,n=!1){if(t==e)return y.empty;let r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new y(a,r.depth-i,o.depth-i)}replace(t,e,n){return w(this.resolve(t),this.resolve(e),n)}nodeAt(t){for(let e=this;;){let{index:n,offset:r}=e.content.findIndex(t);if(e=e.maybeChild(n),!e)return null;if(r==t||e.isText)return e;t-=r+1}}childAfter(t){let{index:e,offset:n}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:n}}childBefore(t){if(0==t)return{node:null,index:0,offset:0};let{index:e,offset:n}=this.content.findIndex(t);if(n<t)return{node:this.content.child(e),index:e,offset:n};let r=this.content.child(e-1);return{node:r,index:e-1,offset:n-r.nodeSize}}resolve(t){return T.resolveCached(this,t)}resolveNoCache(t){return T.resolve(this,t)}rangeHasMark(t,e,n){let r=!1;return e>t&&this.nodesBetween(t,e,t=>(n.isInSet(t.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),$(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,n=d.empty,r=0,o=n.childCount){let i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(let t=r;t<o;t++)if(!this.type.allowsMarks(n.child(t).marks))return!1;return!0}canReplaceWith(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;let o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=g.none;for(let e=0;e<this.marks.length;e++){let n=this.marks[e];n.type.checkAttrs(n.attrs),t=n.addToSet(t)}if(!g.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(t=>t.toJSON())),t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");let n;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}let r=d.fromJSON(t,e.content),o=t.nodeType(e.type).create(e.attrs,r,n);return o.type.checkAttrs(o.attrs),o}}R.prototype.text=void 0;class B extends R{constructor(t,e,n,r){if(super(t,e,null,r),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):$(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new B(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new B(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return 0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function $(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class P{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){let n=new F(t,e);if(null==n.next)return P.empty;let r=z(n);n.next&&n.err("Unexpected trailing text");let o=function(t){let e=Object.create(null);return function n(r){let o=[];r.forEach(e=>{t[e].forEach(({term:e,to:n})=>{if(!e)return;let r;for(let t=0;t<o.length;t++)o[t][0]==e&&(r=o[t][1]);W(t,n).forEach(t=>{r||o.push([e,r=[]]),-1==r.indexOf(t)&&r.push(t)})})});let i=e[r.join(",")]=new P(r.indexOf(t.length-1)>-1);for(let t=0;t<o.length;t++){let r=o[t][1].sort(U);i.next.push({type:o[t][0],next:e[r.join(",")]||n(r)})}return i}(W(t,0))}(function(t){let e=[[]];return o(function t(e,i){if("choice"==e.type)return e.exprs.reduce((e,n)=>e.concat(t(n,i)),[]);if("seq"!=e.type){if("star"==e.type){let s=n();return r(i,s),o(t(e.expr,s),s),[r(s)]}if("plus"==e.type){let s=n();return o(t(e.expr,i),s),o(t(e.expr,s),s),[r(s)]}if("opt"==e.type)return[r(i)].concat(t(e.expr,i));if("range"==e.type){let s=i;for(let r=0;r<e.min;r++){let r=n();o(t(e.expr,s),r),s=r}if(-1==e.max)o(t(e.expr,s),s);else for(let i=e.min;i<e.max;i++){let i=n();r(s,i),o(t(e.expr,s),i),s=i}return[r(s)]}if("name"==e.type)return[r(i,void 0,e.value)];throw new Error("Unknown expr type")}for(let r=0;;r++){let s=t(e.exprs[r],i);if(r==e.exprs.length-1)return s;o(s,i=n())}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){let o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach(t=>t.to=e)}}(r));return function(t,e){for(let n=0,r=[t];n<r.length;n++){let t=r[n],o=!t.validEnd,i=[];for(let e=0;e<t.next.length;e++){let{type:n,next:s}=t.next[e];i.push(n.name),!o||n.isText||n.hasRequiredAttrs()||(o=!1),-1==r.indexOf(s)&&r.push(s)}o&&e.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,n=t.childCount){let r=this;for(let o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let n=0;n<t.next.length;n++)if(this.next[e].type==t.next[n].type)return!0;return!1}fillBefore(t,e=!1,n=0){let r=[this];return function o(i,s){let a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return d.from(s.map(t=>t.createAndFill()));for(let t=0;t<i.next.length;t++){let{type:e,next:n}=i.next[t];if(!e.isText&&!e.hasRequiredAttrs()&&-1==r.indexOf(n)){r.push(n);let t=o(n,s.concat(e));if(t)return t}}return null}(this,[])}findWrapping(t){for(let e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),o=r.match;if(o.matchType(t)){let t=[];for(let e=r;e.type;e=e.via)t.push(e.type);return t.reverse()}for(let t=0;t<o.next.length;t++){let{type:i,next:s}=o.next[t];i.isLeaf||i.hasRequiredAttrs()||i.name in e||r.type&&!s.validEnd||(n.push({match:i.contentMatch,type:i,via:r}),e[i.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];return function e(n){t.push(n);for(let r=0;r<n.next.length;r++)-1==t.indexOf(n.next[r].next)&&e(n.next[r].next)}(this),t.map((e,n)=>{let r=n+(e.validEnd?"*":" ")+" ";for(let n=0;n<e.next.length;n++)r+=(n?", ":"")+e.next[n].type.name+"->"+t.indexOf(e.next[n].next);return r}).join("\n")}}P.empty=new P(!0);class F{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function z(t){let e=[];do{e.push(H(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function H(t){let e=[];do{e.push(j(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function j(t){let e=function(t){if(t.eat("(")){let e=z(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){let e=function(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let o=[];for(let t in n){let r=n[t];r.isInGroup(e)&&o.push(r)}return 0==o.length&&t.err("No node type or group '"+e+"' found"),o}(t,t.next).map(e=>(null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}));return t.pos++,1==e.length?e[0]:{type:"choice",exprs:e}}t.err("Unexpected token '"+t.next+"'")}(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=q(t,e)}return e}function V(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function q(t,e){let n=V(t),r=n;return t.eat(",")&&(r="}"!=t.next?V(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function U(t,e){return e-t}function W(t,e){let n=[];return function e(r){let o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(let t=0;t<o.length;t++){let{term:r,to:i}=o[t];r||-1!=n.indexOf(i)||e(i)}}(e),n.sort(U)}function J(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function K(t,e){let n=Object.create(null);for(let r in t){let o=e&&e[r];if(void 0===o){let e=t[r];if(!e.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=e.default}n[r]=o}return n}function G(t,e,n,r){for(let r in e)if(!(r in t))throw new RangeError(`Unsupported attribute ${r} for ${n} of type ${r}`);for(let n in t){let r=t[n];r.validate&&r.validate(e[n])}}function Y(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new Q(t,r,e[r]);return n}class Z{constructor(t,e,n){this.name=t,this.schema=e,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=Y(t,n.attrs),this.defaultAttrs=J(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==P.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:K(this.attrs,t)}create(t=null,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new R(this,this.computeAttrs(t),d.from(e),g.setFrom(n))}createChecked(t=null,e,n){return e=d.from(e),this.checkContent(e),new R(this,this.computeAttrs(t),e,g.setFrom(n))}createAndFill(t=null,e,n){if(t=this.computeAttrs(t),(e=d.from(e)).size){let t=this.contentMatch.fillBefore(e);if(!t)return null;e=t.append(e)}let r=this.contentMatch.matchFragment(e),o=r&&r.fillBefore(d.empty,!0);return o?new R(this,t,e.append(o),g.setFrom(n)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let e=0;e<t.childCount;e++)if(!this.allowsMarks(t.child(e).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){G(this.attrs,t,"node",this.name)}allowsMarkType(t){return null==this.markSet||this.markSet.indexOf(t)>-1}allowsMarks(t){if(null==this.markSet)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){if(null==this.markSet)return t;let e;for(let n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:g.none:t}static compile(t,e){let n=Object.create(null);t.forEach((t,r)=>n[t]=new Z(t,e,r));let r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let t in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}}class Q{constructor(t,e,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(t,e,n){let r=n.split("|");return n=>{let o=null===n?"null":typeof n;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${o}`)}}(t,e,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class X{constructor(t,e,n,r){this.name=t,this.rank=e,this.schema=n,this.spec=r,this.attrs=Y(t,r.attrs),this.excluded=null;let o=J(this.attrs);this.instance=o?new g(this,o):null}create(t=null){return!t&&this.instance?this.instance:new g(this,K(this.attrs,t))}static compile(t,e){let n=Object.create(null),r=0;return t.forEach((t,o)=>n[t]=new X(t,r++,e,o)),n}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}checkAttrs(t){G(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}}class tt{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let e=this.spec={};for(let n in t)e[n]=t[n];e.nodes=l.from(t.nodes),e.marks=l.from(t.marks||{}),this.nodes=Z.compile(this.spec.nodes,this),this.marks=X.compile(this.spec.marks,this);let n=Object.create(null);for(let t in this.nodes){if(t in this.marks)throw new RangeError(t+" can not be both a node and a mark");let e=this.nodes[t],r=e.spec.content||"",o=e.spec.marks;if(e.contentMatch=n[r]||(n[r]=P.parse(r,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!e.isInline||!e.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=e}e.markSet="_"==o?null:o?et(this,o.split(" ")):""!=o&&e.inlineContent?null:[]}for(let t in this.marks){let e=this.marks[t],n=e.spec.excludes;e.excluded=null==n?[e]:""==n?[]:et(this,n.split(" "))}this.nodeFromJSON=t=>R.fromJSON(this,t),this.markFromJSON=t=>g.fromJSON(this,t),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof Z))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)}text(t,e){let n=this.nodes.text;return new B(n,n.defaultAttrs,t,g.setFrom(e))}mark(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)}nodeType(t){let e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e}}function et(t,e){let n=[];for(let r=0;r<e.length;r++){let o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(let e in t.marks){let r=t.marks[e];("_"==o||r.spec.group&&r.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=r)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}class nt{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[];let n=this.matchedStyles=[];e.forEach(t=>{if(function(t){return null!=t.tag}(t))this.tags.push(t);else if(function(t){return null!=t.style}(t)){let e=/[^=]*/.exec(t.style)[0];n.indexOf(e)<0&&n.push(e),this.styles.push(t)}}),this.normalizeLists=!this.tags.some(e=>{if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;let n=t.nodes[e.node];return n.contentMatch.matchType(n)})}parse(t,e={}){let n=new lt(this,e,!1);return n.addAll(t,g.none,e.from,e.to),n.finish()}parseSlice(t,e={}){let n=new lt(this,e,!0);return n.addAll(t,g.none,e.from,e.to),y.maxOpen(n.finish())}matchTag(t,e,n){for(let r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){let n=this.tags[r];if(ct(t,n.tag)&&(void 0===n.namespace||t.namespaceURI==n.namespace)&&(!n.context||e.matchesContext(n.context))){if(n.getAttrs){let e=n.getAttrs(t);if(!1===e)continue;n.attrs=e||void 0}return n}}}matchStyle(t,e,n,r){for(let o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){let r=this.styles[o],i=r.style;if(!(0!=i.indexOf(t)||r.context&&!n.matchesContext(r.context)||i.length>t.length&&(61!=i.charCodeAt(t.length)||i.slice(t.length+1)!=e))){if(r.getAttrs){let t=r.getAttrs(e);if(!1===t)continue;r.attrs=t||void 0}return r}}}static schemaRules(t){let e=[];function n(t){let n=null==t.priority?50:t.priority,r=0;for(;r<e.length;r++){let t=e[r];if((null==t.priority?50:t.priority)<n)break}e.splice(r,0,t)}for(let e in t.marks){let r=t.marks[e].spec.parseDOM;r&&r.forEach(t=>{n(t=ut(t)),t.mark||t.ignore||t.clearMark||(t.mark=e)})}for(let e in t.nodes){let r=t.nodes[e].spec.parseDOM;r&&r.forEach(t=>{n(t=ut(t)),t.node||t.ignore||t.mark||(t.node=e)})}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new nt(t,nt.schemaRules(t)))}}const rt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ot={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},it={ol:!0,ul:!0};function st(t,e,n){return null!=e?(e?1:0)|("full"===e?2:0):t&&"pre"==t.whitespace?3:-5&n}class at{constructor(t,e,n,r,o,i){this.type=t,this.attrs=e,this.marks=n,this.solid=r,this.options=i,this.content=[],this.activeMarks=g.none,this.match=o||(4&i?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(d.from(t));if(!e){let e,n=this.type.contentMatch;return(e=n.findWrapping(t.type))?(this.match=n,e):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)}finish(t){if(!(1&this.options)){let t,e=this.content[this.content.length-1];if(e&&e.isText&&(t=/[ \t\r\n\u000c]+$/.exec(e.text))){let n=e;e.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-t[0].length))}}let e=d.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(d.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!rt.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class lt{constructor(t,e,n){this.parser=t,this.options=e,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r,o=e.topNode,i=st(null,e.preserveWhitespace,0)|(n?4:0);r=o?new at(o.type,o.attrs,g.none,!0,e.topMatch||o.type.contentMatch,i):new at(n?null:t.schema.topNodeType,null,g.none,!0,null,i),this.nodes=[r],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,e){3==t.nodeType?this.addTextNode(t,e):1==t.nodeType&&this.addElement(t,e)}addTextNode(t,e){let n=t.nodeValue,r=this.top,o=2&r.options?"full":this.localPreserveWS||(1&r.options)>0,{schema:i}=this.parser;if("full"===o||r.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(o)if("full"===o)n=n.replace(/\r\n?/g,"\n");else if(i.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(i.linebreakReplacement.create())){let t=n.split(/\r?\n|\r/);for(let n=0;n<t.length;n++)n&&this.insertNode(i.linebreakReplacement.create(),e,!0),t[n]&&this.insertNode(i.text(t[n]),e,!/\S/.test(t[n]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let e=r.content[r.content.length-1],o=t.previousSibling;(!e||o&&"BR"==o.nodeName||e.isText&&/[ \t\r\n\u000c]$/.test(e.text))&&(n=n.slice(1))}n&&this.insertNode(i.text(n),e,!/\S/.test(n)),this.findInText(t)}else this.findInside(t)}addElement(t,e,n){let r=this.localPreserveWS,o=this.top;("PRE"==t.tagName||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let i,s=t.nodeName.toLowerCase();it.hasOwnProperty(s)&&this.parser.normalizeLists&&function(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let t=1==e.nodeType?e.nodeName.toLowerCase():null;t&&it.hasOwnProperty(t)&&n?(n.appendChild(e),e=n):"li"==t?n=e:t&&(n=null)}}(t);let a=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(i=this.parser.matchTag(t,this,n));t:if(a?a.ignore:ot.hasOwnProperty(s))this.findInside(t),this.ignoreFallback(t,e);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(t=a.skip);let n,r=this.needsBlock;if(rt.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),n=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,e);break t}let i=a&&a.skip?e:this.readStyles(t,e);i&&this.addAll(t,i),n&&this.sync(o),this.needsBlock=r}else{let n=this.readStyles(t,e);n&&this.addElementByRule(t,a,n,!1===a.consuming?i:void 0)}this.localPreserveWS=r}leafFallback(t,e){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"),e)}ignoreFallback(t,e){"BR"!=t.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),e,!0)}readStyles(t,e){let n=t.style;if(n&&n.length)for(let t=0;t<this.parser.matchedStyles.length;t++){let r=this.parser.matchedStyles[t],o=n.getPropertyValue(r);if(o)for(let t;;){let n=this.parser.matchStyle(r,o,this,t);if(!n)break;if(n.ignore)return null;if(e=n.clearMark?e.filter(t=>!n.clearMark(t)):e.concat(this.parser.schema.marks[n.mark].create(n.attrs)),!1!==n.consuming)break;t=n}}return e}addElementByRule(t,e,n,r){let o,i;if(e.node)if(i=this.parser.schema.nodes[e.node],i.isLeaf)this.insertNode(i.create(e.attrs),n,"BR"==t.nodeName)||this.leafFallback(t,n);else{let t=this.enter(i,e.attrs||null,n,e.preserveWhitespace);t&&(o=!0,n=t)}else{let t=this.parser.schema.marks[e.mark];n=n.concat(t.create(e.attrs))}let s=this.top;if(i&&i.isLeaf)this.findInside(t);else if(r)this.addElement(t,n,r);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(t=>this.insertNode(t,n,!1));else{let r=t;"string"==typeof e.contentElement?r=t.querySelector(e.contentElement):"function"==typeof e.contentElement?r=e.contentElement(t):e.contentElement&&(r=e.contentElement),this.findAround(t,r,!0),this.addAll(r,n),this.findAround(t,r,!1)}o&&this.sync(s)&&this.open--}addAll(t,e,n,r){let o=n||0;for(let i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i,e);this.findAtPoint(t,o)}findPlace(t,e,n){let r,o;for(let e=this.open,i=0;e>=0;e--){let s=this.nodes[e],a=s.findWrapping(t);if(a&&(!r||r.length>a.length+i)&&(r=a,o=s,!a.length))break;if(s.solid){if(n)break;i+=2}}if(!r)return null;this.sync(o);for(let t=0;t<r.length;t++)e=this.enterInner(r[t],null,e,!1);return e}insertNode(t,e,n){if(t.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&(e=this.enterInner(t,null,e))}let r=this.findPlace(t,e,n);if(r){this.closeExtra();let e=this.top;e.match&&(e.match=e.match.matchType(t.type));let n=g.none;for(let o of r.concat(t.marks))(e.type?e.type.allowsMarkType(o.type):dt(o.type,t.type))&&(n=o.addToSet(n));return e.content.push(t.mark(n)),!0}return!1}enter(t,e,n,r){let o=this.findPlace(t.create(e),n,!1);return o&&(o=this.enterInner(t,e,n,!0,r)),o}enterInner(t,e,n,r=!1,o){this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(t);let s=st(t,o,i.options);4&i.options&&0==i.content.length&&(s|=4);let a=g.none;return n=n.filter(e=>!(i.type?i.type.allowsMarkType(e.type):dt(e.type,t))||(a=e.addToSet(a),!1)),this.nodes.push(new at(t,e,a,r,null,s)),this.open++,n}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!(!this.isOpen&&!this.options.topOpen))}sync(t){for(let e=this.open;e>=0;e--){if(this.nodes[e]==t)return this.open=e,!0;this.localPreserveWS&&(this.nodes[e].options|=1)}return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let n=this.nodes[e].content;for(let e=n.length-1;e>=0;e--)t+=n[e].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,n){if(t!=e&&this.find)for(let r=0;r<this.find.length;r++)null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node)&&e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),n=this.options.context,r=!(this.isOpen||n&&n.parent.type!=this.nodes[0].type),o=-(n?n.depth+1:0)+(r?0:1),i=(t,s)=>{for(;t>=0;t--){let a=e[t];if(""==a){if(t==e.length-1||0==t)continue;for(;s>=o;s--)if(i(t-1,s))return!0;return!1}{let t=s>0||0==s&&r?this.nodes[s].type:n&&s>=o?n.node(s-o).type:null;if(!t||t.name!=a&&!t.isInGroup(a))return!1;s--}}return!0};return i(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}}function ct(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function ut(t){let e={};for(let n in t)e[n]=t[n];return e}function dt(t,e){let n=e.schema.nodes;for(let r in n){let o=n[r];if(!o.allowsMarkType(t))continue;let i=[],s=t=>{i.push(t);for(let n=0;n<t.edgeCount;n++){let{type:r,next:o}=t.edge(n);if(r==e)return!0;if(i.indexOf(o)<0&&s(o))return!0}};if(s(o.contentMatch))return!0}}class ht{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},n){n||(n=ft(e).createDocumentFragment());let r=n,o=[];return t.forEach(t=>{if(o.length||t.marks.length){let n=0,i=0;for(;n<o.length&&i<t.marks.length;){let e=t.marks[i];if(this.marks[e.type.name]){if(!e.eq(o[n][0])||!1===e.type.spec.spanning)break;n++,i++}else i++}for(;n<o.length;)r=o.pop()[1];for(;i<t.marks.length;){let n=t.marks[i++],s=this.serializeMark(n,t.isInline,e);s&&(o.push([n,r]),r.appendChild(s.dom),r=s.contentDOM||s.dom)}}r.appendChild(this.serializeNodeInner(t,e))}),n}serializeNodeInner(t,e){let{dom:n,contentDOM:r}=mt(ft(e),this.nodes[t.type.name](t),null,t.attrs);if(r){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,r)}return n}serializeNode(t,e={}){let n=this.serializeNodeInner(t,e);for(let r=t.marks.length-1;r>=0;r--){let o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}serializeMark(t,e,n={}){let r=this.marks[t.type.name];return r&&mt(ft(n),r(t,e),null,t.attrs)}static renderSpec(t,e,n=null,r){return mt(t,e,n,r)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new ht(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=pt(t.nodes);return e.text||(e.text=t=>t.text),e}static marksFromSchema(t){return pt(t.marks)}}function pt(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function ft(t){return t.document||window.document}const gt=new WeakMap;function mt(t,e,n,r){if("string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;let o,i=e[0];if("string"!=typeof i)throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=function(t){let e=gt.get(t);return void 0===e&&gt.set(t,e=function(t){let e=null;return function t(n){if(n&&"object"==typeof n)if(Array.isArray(n))if("string"==typeof n[0])e||(e=[]),e.push(n);else for(let e=0;e<n.length;e++)t(n[e]);else for(let e in n)t(n[e])}(t),e}(t)),e}(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s,a=i.indexOf(" ");a>0&&(n=i.slice(0,a),i=i.slice(a+1));let l=n?t.createElementNS(n,i):t.createElement(i),c=e[1],u=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c)){u=2;for(let t in c)if(null!=c[t]){let e=t.indexOf(" ");e>0?l.setAttributeNS(t.slice(0,e),t.slice(e+1),c[t]):"style"==t&&l.style?l.style.cssText=c[t]:l.setAttribute(t,c[t])}}for(let o=u;o<e.length;o++){let i=e[o];if(0===i){if(o<e.length-1||o>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}{let{dom:e,contentDOM:o}=mt(t,i,n,r);if(l.appendChild(e),o){if(s)throw new RangeError("Multiple content holes");s=o}}}return{dom:l,contentDOM:s}}const yt=Math.pow(2,16);function bt(t,e){return t+e*yt}function vt(t){return 65535&t}class wt{constructor(t,e,n){this.pos=t,this.delInfo=e,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class At{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&At.empty)return At.empty}recover(t){let e=0,n=vt(t);if(!this.inverted)for(let t=0;t<n;t++)e+=this.ranges[3*t+2]-this.ranges[3*t+1];return this.ranges[3*n]+e+function(t){return(t-(65535&t))/yt}(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,n){let r=0,o=this.inverted?2:1,i=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let a=this.ranges[s]-(this.inverted?r:0);if(a>t)break;let l=this.ranges[s+o],c=this.ranges[s+i],u=a+l;if(t<=u){let o=a+r+((l?t==a?-1:t==u?1:e:e)<0?0:c);if(n)return o;let i=t==(e<0?a:u)?null:bt(s/3,t-a),d=t==a?2:t==u?1:4;return(e<0?t!=a:t!=u)&&(d|=8),new wt(o,d,i)}r+=c-l}return n?t+r:new wt(t+r,0,null)}touches(t,e){let n=0,r=vt(e),o=this.inverted?2:1,i=this.inverted?1:2;for(let e=0;e<this.ranges.length;e+=3){let s=this.ranges[e]-(this.inverted?n:0);if(s>t)break;let a=this.ranges[e+o];if(t<=s+a&&e==3*r)return!0;n+=this.ranges[e+i]-a}return!1}forEach(t){let e=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,o=0;r<this.ranges.length;r+=3){let i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),l=this.ranges[r+e],c=this.ranges[r+n];t(s,s+l,a,a+c),o+=c-l}}invert(){return new At(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return 0==t?At.empty:new At(t<0?[0,-t,0]:[0,0,t])}}At.empty=new At([]);class kt{constructor(t,e,n=0,r=(t?t.length:0)){this.mirror=e,this.from=n,this.to=r,this._maps=t||[],this.ownData=!(t||e)}get maps(){return this._maps}slice(t=0,e=this.maps.length){return new kt(this._maps,this.mirror,t,e)}appendMap(t,e){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),null!=e&&this.setMirror(this._maps.length-1,e)}appendMapping(t){for(let e=0,n=this._maps.length;e<t._maps.length;e++){let r=t.getMirror(e);this.appendMap(t._maps[e],null!=r&&r<e?n+r:void 0)}}getMirror(t){if(this.mirror)for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,n=this._maps.length+t._maps.length;e>=0;e--){let r=t.getMirror(e);this.appendMap(t._maps[e].invert(),null!=r&&r>e?n-r-1:void 0)}}invert(){let t=new kt;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let n=this.from;n<this.to;n++)t=this._maps[n].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,n){let r=0;for(let n=this.from;n<this.to;n++){let o=this._maps[n].mapResult(t,e);if(null!=o.recover){let e=this.getMirror(n);if(null!=e&&e>n&&e<this.to){n=e,t=this._maps[e].recover(o.recover);continue}}r|=o.delInfo,t=o.pos}return n?t:new wt(t,r,null)}}const xt=Object.create(null);class Ct{getMap(){return At.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=xt[e.stepType];if(!n)throw new RangeError(`No step type ${e.stepType} defined`);return n.fromJSON(t,e)}static jsonID(t,e){if(t in xt)throw new RangeError("Duplicate use of step JSON ID "+t);return xt[t]=e,e.prototype.jsonID=t,e}}class St{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new St(t,null)}static fail(t){return new St(null,t)}static fromReplace(t,e,n,r){try{return St.ok(t.replace(e,n,r))}catch(t){if(t instanceof m)return St.fail(t.message);throw t}}}function Et(t,e,n){let r=[];for(let o=0;o<t.childCount;o++){let i=t.child(o);i.content.size&&(i=i.copy(Et(i.content,e,i))),i.isInline&&(i=e(i,n,o)),r.push(i)}return d.fromArray(r)}class Mt extends Ct{constructor(t,e,n){super(),this.from=t,this.to=e,this.mark=n}apply(t){let e=t.slice(this.from,this.to),n=t.resolve(this.from),r=n.node(n.sharedDepth(this.to)),o=new y(Et(e.content,(t,e)=>t.isAtom&&e.type.allowsMarkType(this.mark.type)?t.mark(this.mark.addToSet(t.marks)):t,r),e.openStart,e.openEnd);return St.fromReplace(t,this.from,this.to,o)}invert(){return new _t(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return e.deleted&&n.deleted||e.pos>=n.pos?null:new Mt(e.pos,n.pos,this.mark)}merge(t){return t instanceof Mt&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Mt(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Mt(e.from,e.to,t.markFromJSON(e.mark))}}Ct.jsonID("addMark",Mt);class _t extends Ct{constructor(t,e,n){super(),this.from=t,this.to=e,this.mark=n}apply(t){let e=t.slice(this.from,this.to),n=new y(Et(e.content,t=>t.mark(this.mark.removeFromSet(t.marks)),t),e.openStart,e.openEnd);return St.fromReplace(t,this.from,this.to,n)}invert(){return new Mt(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return e.deleted&&n.deleted||e.pos>=n.pos?null:new _t(e.pos,n.pos,this.mark)}merge(t){return t instanceof _t&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new _t(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new _t(e.from,e.to,t.markFromJSON(e.mark))}}Ct.jsonID("removeMark",_t);class Tt extends Ct{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return St.fail("No node at mark step's position");let n=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return St.fromReplace(t,this.pos,this.pos+1,new y(d.from(n),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let t=this.mark.addToSet(e.marks);if(t.length==e.marks.length){for(let n=0;n<e.marks.length;n++)if(!e.marks[n].isInSet(t))return new Tt(this.pos,e.marks[n]);return new Tt(this.pos,this.mark)}}return new Dt(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Tt(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Tt(e.pos,t.markFromJSON(e.mark))}}Ct.jsonID("addNodeMark",Tt);class Dt extends Ct{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return St.fail("No node at mark step's position");let n=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return St.fromReplace(t,this.pos,this.pos+1,new y(d.from(n),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return e&&this.mark.isInSet(e.marks)?new Tt(this.pos,this.mark):this}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Dt(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Dt(e.pos,t.markFromJSON(e.mark))}}Ct.jsonID("removeNodeMark",Dt);class Ot extends Ct{constructor(t,e,n,r=!1){super(),this.from=t,this.to=e,this.slice=n,this.structure=r}apply(t){return this.structure&&It(t,this.from,this.to)?St.fail("Structure replace would overwrite content"):St.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new At([this.from,this.to-this.from,this.slice.size])}invert(t){return new Ot(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return e.deletedAcross&&n.deletedAcross?null:new Ot(e.pos,Math.max(e.pos,n.pos),this.slice,this.structure)}merge(t){if(!(t instanceof Ot)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;{let e=this.slice.size+t.slice.size==0?y.empty:new y(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new Ot(t.from,this.to,e,this.structure)}}{let e=this.slice.size+t.slice.size==0?y.empty:new y(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new Ot(this.from,this.to+(t.to-t.from),e,this.structure)}}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ot(e.from,e.to,y.fromJSON(t,e.slice),!!e.structure)}}Ct.jsonID("replace",Ot);class Nt extends Ct{constructor(t,e,n,r,o,i,s=!1){super(),this.from=t,this.to=e,this.gapFrom=n,this.gapTo=r,this.slice=o,this.insert=i,this.structure=s}apply(t){if(this.structure&&(It(t,this.from,this.gapFrom)||It(t,this.gapTo,this.to)))return St.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return St.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,e.content);return n?St.fromReplace(t,this.from,this.to,n):St.fail("Content does not fit in gap")}getMap(){return new At([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new Nt(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1),r=this.from==this.gapFrom?e.pos:t.map(this.gapFrom,-1),o=this.to==this.gapTo?n.pos:t.map(this.gapTo,1);return e.deletedAcross&&n.deletedAcross||r<e.pos||o>n.pos?null:new Nt(e.pos,n.pos,r,o,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to||"number"!=typeof e.gapFrom||"number"!=typeof e.gapTo||"number"!=typeof e.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Nt(e.from,e.to,e.gapFrom,e.gapTo,y.fromJSON(t,e.slice),e.insert,!!e.structure)}}function It(t,e,n){let r=t.resolve(e),o=n-e,i=r.depth;for(;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0){let t=r.node(i).maybeChild(r.indexAfter(i));for(;o>0;){if(!t||t.isLeaf)return!0;t=t.firstChild,o--}}return!1}function Lt(t,e,n,r=n.contentMatch,o=!0){let i=t.doc.nodeAt(e),s=[],a=e+1;for(let e=0;e<i.childCount;e++){let l=i.child(e),c=a+l.nodeSize,u=r.matchType(l.type);if(u){r=u;for(let e=0;e<l.marks.length;e++)n.allowsMarkType(l.marks[e].type)||t.step(new _t(a,c,l.marks[e]));if(o&&l.isText&&"pre"!=n.whitespace){let t,e,r=/\r?\n|\r/g;for(;t=r.exec(l.text);)e||(e=new y(d.from(n.schema.text(" ",n.allowedMarks(l.marks))),0,0)),s.push(new Ot(a+t.index,a+t.index+t[0].length,e))}}else s.push(new Ot(a,c,y.empty));a=c}if(!r.validEnd){let e=r.fillBefore(d.empty,!0);t.replace(a,a,new y(e,0,0))}for(let e=s.length-1;e>=0;e--)t.step(s[e])}function Rt(t,e,n){return(0==e||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Bt(t){let e=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let n=t.depth;;--n){let r=t.$from.node(n),o=t.$from.index(n),i=t.$to.indexAfter(n);if(n<t.depth&&r.canReplace(o,i,e))return n;if(0==n||r.type.spec.isolating||!Rt(r,o,i))break}return null}function $t(t,e,n=null,r=t){let o=function(t,e){let{parent:n,startIndex:r,endIndex:o}=t,i=n.contentMatchAt(r).findWrapping(e);if(!i)return null;let s=i.length?i[0]:e;return n.canReplaceWith(r,o,s)?i:null}(t,e),i=o&&function(t,e){let{parent:n,startIndex:r,endIndex:o}=t,i=n.child(r),s=e.contentMatch.findWrapping(i.type);if(!s)return null;let a=(s.length?s[s.length-1]:e).contentMatch;for(let t=r;a&&t<o;t++)a=a.matchType(n.child(t).type);return a&&a.validEnd?s:null}(r,e);return i?o.map(Pt).concat({type:e,attrs:n}).concat(i.map(Pt)):null}function Pt(t){return{type:t,attrs:null}}function Ft(t,e,n,r){e.forEach((o,i)=>{if(o.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(o.text);){let o=t.mapping.slice(r).map(n+1+i+s.index);t.replaceWith(o,o+1,e.type.schema.linebreakReplacement.create())}}})}function zt(t,e,n,r){e.forEach((o,i)=>{if(o.type==o.type.schema.linebreakReplacement){let o=t.mapping.slice(r).map(n+1+i);t.replaceWith(o,o+1,e.type.schema.text("\n"))}})}function Ht(t,e,n=1,r){let o=t.resolve(e),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let t=o.depth-1,e=n-2;t>i;t--,e--){let n=o.node(t),i=o.index(t);if(n.type.spec.isolating)return!1;let s=n.content.cutByIndex(i,n.childCount),a=r&&r[e+1];a&&(s=s.replaceChild(0,a.type.create(a.attrs)));let l=r&&r[e]||n;if(!n.canReplace(i+1,n.childCount)||!l.type.validContent(s))return!1}let a=o.indexAfter(i),l=r&&r[0];return o.node(i).canReplaceWith(a,a,l?l.type:o.node(i+1).type)}function jt(t,e){let n=t.resolve(e),r=n.index();return Vt(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function Vt(t,e){return!(!t||!e||t.isLeaf||!function(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let o=0;o<e.childCount;o++){let i=e.child(o),s=i.type==r?t.type.schema.nodes.text:i.type;if(n=n.matchType(s),!n)return!1;if(!t.type.allowsMarks(i.marks))return!1}return n.validEnd}(t,e))}function qt(t,e,n=-1){let r=t.resolve(e);for(let t=r.depth;;t--){let o,i,s=r.index(t);if(t==r.depth?(o=r.nodeBefore,i=r.nodeAfter):n>0?(o=r.node(t+1),s++,i=r.node(t).maybeChild(s)):(o=r.node(t).maybeChild(s-1),i=r.node(t+1)),o&&!o.isTextblock&&Vt(o,i)&&r.node(t).canReplace(s,s+1))return e;if(0==t)break;e=n<0?r.before(t):r.after(t)}}function Ut(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let o=n.content;for(let t=0;t<n.openStart;t++)o=o.firstChild.content;for(let t=1;t<=(0==n.openStart&&n.size?2:1);t++)for(let e=r.depth;e>=0;e--){let n=e==r.depth?0:r.pos<=(r.start(e+1)+r.end(e+1))/2?-1:1,i=r.index(e)+(n>0?1:0),s=r.node(e),a=!1;if(1==t)a=s.canReplace(i,i,o);else{let t=s.contentMatchAt(i).findWrapping(o.firstChild.type);a=t&&s.canReplaceWith(i,i,t[0])}if(a)return 0==n?r.pos:n<0?r.before(e+1):r.after(e+1)}return null}function Wt(t,e,n=e,r=y.empty){if(e==n&&!r.size)return null;let o=t.resolve(e),i=t.resolve(n);return Jt(o,i,r)?new Ot(e,n,r):new Kt(o,i,r).fit()}function Jt(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}Ct.jsonID("replaceAround",Nt);class Kt{constructor(t,e,n){this.$from=t,this.$to=e,this.unplaced=n,this.frontier=[],this.placed=d.empty;for(let e=0;e<=t.depth;e++){let n=t.node(e);this.frontier.push({type:n.type,match:n.contentMatchAt(t.indexAfter(e))})}for(let e=t.depth;e>0;e--)this.placed=d.from(t.node(e).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(t<0?this.$to:n.doc.resolve(t));if(!r)return null;let o=this.placed,i=n.depth,s=r.depth;for(;i&&s&&1==o.childCount;)o=o.firstChild.content,i--,s--;let a=new y(o,i,s);return t>-1?new Nt(n.pos,t,this.$to.pos,this.$to.end(),a,e):a.size||n.pos!=this.$to.pos?new Ot(n.pos,r.pos,a):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<t;n++){let o=e.firstChild;if(e.childCount>1&&(r=0),o.type.spec.isolating&&r<=n){t=n;break}e=o.content}for(let e=1;e<=2;e++)for(let n=1==e?t:this.unplaced.openStart;n>=0;n--){let t,r=null;n?(r=Zt(this.unplaced.content,n-1).firstChild,t=r.content):t=this.unplaced.content;let o=t.firstChild;for(let t=this.depth;t>=0;t--){let i,{type:s,match:a}=this.frontier[t],l=null;if(1==e&&(o?a.matchType(o.type)||(l=a.fillBefore(d.from(o),!1)):r&&s.compatibleContent(r.type)))return{sliceDepth:n,frontierDepth:t,parent:r,inject:l};if(2==e&&o&&(i=a.findWrapping(o.type)))return{sliceDepth:n,frontierDepth:t,parent:r,wrap:i};if(r&&a.matchType(r.type))break}}}openMore(){let{content:t,openStart:e,openEnd:n}=this.unplaced,r=Zt(t,e);return!(!r.childCount||r.firstChild.isLeaf||(this.unplaced=new y(t,e+1,Math.max(n,r.size+e>=t.size-n?e+1:0)),0))}dropNode(){let{content:t,openStart:e,openEnd:n}=this.unplaced,r=Zt(t,e);if(r.childCount<=1&&e>0){let o=t.size-e<=e+r.size;this.unplaced=new y(Gt(t,e-1,1),e-1,o?e-1:n)}else this.unplaced=new y(Gt(t,e,1),e,n)}placeNodes({sliceDepth:t,frontierDepth:e,parent:n,inject:r,wrap:o}){for(;this.depth>e;)this.closeFrontierNode();if(o)for(let t=0;t<o.length;t++)this.openFrontierNode(o[t]);let i=this.unplaced,s=n?n.content:i.content,a=i.openStart-t,l=0,c=[],{match:u,type:h}=this.frontier[e];if(r){for(let t=0;t<r.childCount;t++)c.push(r.child(t));u=u.matchFragment(r)}let p=s.size+t-(i.content.size-i.openEnd);for(;l<s.childCount;){let t=s.child(l),e=u.matchType(t.type);if(!e)break;l++,(l>1||0==a||t.content.size)&&(u=e,c.push(Qt(t.mark(h.allowedMarks(t.marks)),1==l?a:0,l==s.childCount?p:-1)))}let f=l==s.childCount;f||(p=-1),this.placed=Yt(this.placed,e,d.from(c)),this.frontier[e].match=u,f&&p<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let t=0,e=s;t<p;t++){let t=e.lastChild;this.frontier.push({type:t.type,match:t.contentMatchAt(t.childCount)}),e=t.content}this.unplaced=f?0==t?y.empty:new y(Gt(i.content,t-1,1),t-1,p<0?i.openEnd:t-1):new y(Gt(i.content,t,l),i.openStart,i.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t,e=this.frontier[this.depth];if(!e.type.isTextblock||!Xt(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:n,type:r}=this.frontier[e],o=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),i=Xt(t,e,r,n,o);if(i){for(let n=e-1;n>=0;n--){let{match:e,type:r}=this.frontier[n],o=Xt(t,n,r,e,!0);if(!o||o.childCount)continue t}return{depth:e,fit:i,move:o?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=Yt(this.placed,e.depth,e.fit)),t=e.move;for(let n=e.depth+1;n<=t.depth;n++){let e=t.node(n),r=e.type.contentMatch.fillBefore(e.content,!0,t.index(n));this.openFrontierNode(e.type,e.attrs,r)}return t}openFrontierNode(t,e=null,n){let r=this.frontier[this.depth];r.match=r.match.matchType(t),this.placed=Yt(this.placed,this.depth,d.from(t.create(e,n))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(d.empty,!0);t.childCount&&(this.placed=Yt(this.placed,this.frontier.length,t))}}function Gt(t,e,n){return 0==e?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Gt(t.firstChild.content,e-1,n)))}function Yt(t,e,n){return 0==e?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Yt(t.lastChild.content,e-1,n)))}function Zt(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function Qt(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,Qt(r.firstChild,e-1,1==r.childCount?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(d.empty,!0)))),t.copy(r)}function Xt(t,e,n,r,o){let i=t.node(e),s=o?t.indexAfter(e):t.index(e);if(s==i.childCount&&!n.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,s);return a&&!function(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}(n,i.content,s)?a:null}function te(t){return t.spec.defining||t.spec.definingForContent}function ee(t,e,n,r,o){if(e<n){let o=t.firstChild;t=t.replaceChild(0,o.copy(ee(o.content,e+1,n,r,o)))}if(e>r){let e=o.contentMatchAt(0),n=e.fillBefore(t).append(t);t=n.append(e.matchFragment(n).fillBefore(d.empty,!0))}return t}function ne(t,e){let n=[];for(let r=Math.min(t.depth,e.depth);r>=0;r--){let o=t.start(r);if(o<t.pos-(t.depth-r)||e.end(r)>e.pos+(e.depth-r)||t.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;(o==e.start(r)||r==t.depth&&r==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&r&&e.start(r-1)==o-1)&&n.push(r)}return n}class re extends Ct{constructor(t,e,n){super(),this.pos=t,this.attr=e,this.value=n}apply(t){let e=t.nodeAt(this.pos);if(!e)return St.fail("No node at attribute step's position");let n=Object.create(null);for(let t in e.attrs)n[t]=e.attrs[t];n[this.attr]=this.value;let r=e.type.create(n,null,e.marks);return St.fromReplace(t,this.pos,this.pos+1,new y(d.from(r),0,e.isLeaf?0:1))}getMap(){return At.empty}invert(t){return new re(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new re(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if("number"!=typeof e.pos||"string"!=typeof e.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new re(e.pos,e.attr,e.value)}}Ct.jsonID("attr",re);class oe extends Ct{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let n in t.attrs)e[n]=t.attrs[n];e[this.attr]=this.value;let n=t.type.create(e,t.content,t.marks);return St.ok(n)}getMap(){return At.empty}invert(t){return new oe(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if("string"!=typeof e.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new oe(e.attr,e.value)}}Ct.jsonID("docAttr",oe);let ie=class extends Error{};ie=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n},(ie.prototype=Object.create(Error.prototype)).constructor=ie,ie.prototype.name="TransformError";class se{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new kt}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new ie(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,n=y.empty){let r=Wt(this.doc,t,e,n);return r&&this.step(r),this}replaceWith(t,e,n){return this.replace(t,e,new y(d.from(n),0,0))}delete(t,e){return this.replace(t,e,y.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,n){return function(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let o=t.doc.resolve(e),i=t.doc.resolve(n);if(Jt(o,i,r))return t.step(new Ot(e,n,r));let s=ne(o,t.doc.resolve(n));0==s[s.length-1]&&s.pop();let a=-(o.depth+1);s.unshift(a);for(let t=o.depth,e=o.pos-1;t>0;t--,e--){let n=o.node(t).type.spec;if(n.defining||n.definingAsContext||n.isolating)break;s.indexOf(t)>-1?a=t:o.before(t)==e&&s.splice(1,0,-t)}let l=s.indexOf(a),c=[],u=r.openStart;for(let t=r.content,e=0;;e++){let n=t.firstChild;if(c.push(n),e==r.openStart)break;t=n.content}for(let t=u-1;t>=0;t--){let e=c[t],n=te(e.type);if(n&&!e.sameMarkup(o.node(Math.abs(a)-1)))u=t;else if(n||!e.type.isTextblock)break}for(let e=r.openStart;e>=0;e--){let a=(e+u+1)%(r.openStart+1),d=c[a];if(d)for(let e=0;e<s.length;e++){let c=s[(e+l)%s.length],u=!0;c<0&&(u=!1,c=-c);let h=o.node(c-1),p=o.index(c-1);if(h.canReplaceWith(p,p,d.type,d.marks))return t.replace(o.before(c),u?i.after(c):n,new y(ee(r.content,0,r.openStart,a),a,r.openEnd))}}let d=t.steps.length;for(let a=s.length-1;a>=0&&(t.replace(e,n,r),!(t.steps.length>d));a--){let t=s[a];t<0||(e=o.before(t),n=i.after(t))}}(this,t,e,n),this}replaceRangeWith(t,e,n){return function(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let o=function(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(0==r.parentOffset)for(let t=r.depth-1;t>=0;t--){let e=r.index(t);if(r.node(t).canReplaceWith(e,e,n))return r.before(t+1);if(e>0)return null}if(r.parentOffset==r.parent.content.size)for(let t=r.depth-1;t>=0;t--){let e=r.indexAfter(t);if(r.node(t).canReplaceWith(e,e,n))return r.after(t+1);if(e<r.node(t).childCount)return null}return null}(t.doc,e,r.type);null!=o&&(e=n=o)}t.replaceRange(e,n,new y(d.from(r),0,0))}(this,t,e,n),this}deleteRange(t,e){return function(t,e,n){let r=t.doc.resolve(e),o=t.doc.resolve(n),i=ne(r,o);for(let e=0;e<i.length;e++){let n=i[e],s=e==i.length-1;if(s&&0==n||r.node(n).type.contentMatch.validEnd)return t.delete(r.start(n),o.end(n));if(n>0&&(s||r.node(n-1).canReplace(r.index(n-1),o.indexAfter(n-1))))return t.delete(r.before(n),o.after(n))}for(let i=1;i<=r.depth&&i<=o.depth;i++)if(e-r.start(i)==r.depth-i&&n>r.end(i)&&o.end(i)-n!=o.depth-i&&r.start(i-1)==o.start(i-1)&&r.node(i-1).canReplace(r.index(i-1),o.index(i-1)))return t.delete(r.before(i),n);t.delete(e,n)}(this,t,e),this}lift(t,e){return function(t,e,n){let{$from:r,$to:o,depth:i}=e,s=r.before(i+1),a=o.after(i+1),l=s,c=a,u=d.empty,h=0;for(let t=i,e=!1;t>n;t--)e||r.index(t)>0?(e=!0,u=d.from(r.node(t).copy(u)),h++):l--;let p=d.empty,f=0;for(let t=i,e=!1;t>n;t--)e||o.after(t+1)<o.end(t)?(e=!0,p=d.from(o.node(t).copy(p)),f++):c++;t.step(new Nt(l,c,s,a,new y(u.append(p),h,f),u.size-h,!0))}(this,t,e),this}join(t,e=1){return function(t,e,n){let r=null,{linebreakReplacement:o}=t.doc.type.schema,i=t.doc.resolve(e-n),s=i.node().type;if(o&&s.inlineContent){let t="pre"==s.whitespace,e=!!s.contentMatch.matchType(o);t&&!e?r=!1:!t&&e&&(r=!0)}let a=t.steps.length;if(!1===r){let r=t.doc.resolve(e+n);zt(t,r.node(),r.before(),a)}s.inlineContent&&Lt(t,e+n-1,s,i.node().contentMatchAt(i.index()),null==r);let l=t.mapping.slice(a),c=l.map(e-n);if(t.step(new Ot(c,l.map(e+n,-1),y.empty,!0)),!0===r){let e=t.doc.resolve(c);Ft(t,e.node(),e.before(),t.steps.length)}}(this,t,e),this}wrap(t,e){return function(t,e,n){let r=d.empty;for(let t=n.length-1;t>=0;t--){if(r.size){let e=n[t].type.contentMatch.matchFragment(r);if(!e||!e.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=d.from(n[t].type.create(n[t].attrs,r))}let o=e.start,i=e.end;t.step(new Nt(o,i,o,i,new y(r,0,0),n.length,!0))}(this,t,e),this}setBlockType(t,e=t,n,r=null){return function(t,e,n,r,o){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=t.steps.length;t.doc.nodesBetween(e,n,(e,n)=>{let s="function"==typeof o?o(e):o;if(e.isTextblock&&!e.hasMarkup(r,s)&&function(t,e,n){let r=t.resolve(e),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(t.doc,t.mapping.slice(i).map(n),r)){let o=null;if(r.schema.linebreakReplacement){let t="pre"==r.whitespace,e=!!r.contentMatch.matchType(r.schema.linebreakReplacement);t&&!e?o=!1:!t&&e&&(o=!0)}!1===o&&zt(t,e,n,i),Lt(t,t.mapping.slice(i).map(n,1),r,void 0,null===o);let a=t.mapping.slice(i),l=a.map(n,1),c=a.map(n+e.nodeSize,1);return t.step(new Nt(l,c,l+1,c-1,new y(d.from(r.create(s,null,e.marks)),0,0),1,!0)),!0===o&&Ft(t,e,n,i),!1}})}(this,t,e,n,r),this}setNodeMarkup(t,e,n=null,r){return function(t,e,n,r,o){let i=t.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let s=n.create(r,null,o||i.marks);if(i.isLeaf)return t.replaceWith(e,e+i.nodeSize,s);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Nt(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new y(d.from(s),0,0),1,!0))}(this,t,e,n,r),this}setNodeAttribute(t,e,n){return this.step(new re(t,e,n)),this}setDocAttribute(t,e){return this.step(new oe(t,e)),this}addNodeMark(t,e){return this.step(new Tt(t,e)),this}removeNodeMark(t,e){let n=this.doc.nodeAt(t);if(!n)throw new RangeError("No node at position "+t);if(e instanceof g)e.isInSet(n.marks)&&this.step(new Dt(t,e));else{let r,o=n.marks,i=[];for(;r=e.isInSet(o);)i.push(new Dt(t,r)),o=r.removeFromSet(o);for(let t=i.length-1;t>=0;t--)this.step(i[t])}return this}split(t,e=1,n){return function(t,e,n=1,r){let o=t.doc.resolve(e),i=d.empty,s=d.empty;for(let t=o.depth,e=o.depth-n,a=n-1;t>e;t--,a--){i=d.from(o.node(t).copy(i));let e=r&&r[a];s=d.from(e?e.type.create(e.attrs,s):o.node(t).copy(s))}t.step(new Ot(e,e,new y(i.append(s),n,n),!0))}(this,t,e,n),this}addMark(t,e,n){return function(t,e,n,r){let o,i,s=[],a=[];t.doc.nodesBetween(e,n,(t,l,c)=>{if(!t.isInline)return;let u=t.marks;if(!r.isInSet(u)&&c.type.allowsMarkType(r.type)){let c=Math.max(l,e),d=Math.min(l+t.nodeSize,n),h=r.addToSet(u);for(let t=0;t<u.length;t++)u[t].isInSet(h)||(o&&o.to==c&&o.mark.eq(u[t])?o.to=d:s.push(o=new _t(c,d,u[t])));i&&i.to==c?i.to=d:a.push(i=new Mt(c,d,r))}}),s.forEach(e=>t.step(e)),a.forEach(e=>t.step(e))}(this,t,e,n),this}removeMark(t,e,n){return function(t,e,n,r){let o=[],i=0;t.doc.nodesBetween(e,n,(t,s)=>{if(!t.isInline)return;i++;let a=null;if(r instanceof X){let e,n=t.marks;for(;e=r.isInSet(n);)(a||(a=[])).push(e),n=e.removeFromSet(n)}else r?r.isInSet(t.marks)&&(a=[r]):a=t.marks;if(a&&a.length){let r=Math.min(s+t.nodeSize,n);for(let t=0;t<a.length;t++){let n,l=a[t];for(let t=0;t<o.length;t++){let e=o[t];e.step==i-1&&l.eq(o[t].style)&&(n=e)}n?(n.to=r,n.step=i):o.push({style:l,from:Math.max(s,e),to:r,step:i})}}}),o.forEach(e=>t.step(new _t(e.from,e.to,e.style)))}(this,t,e,n),this}clearIncompatible(t,e,n){return Lt(this,t,e,n),this}}const ae=Object.create(null);class le{constructor(t,e,n){this.$anchor=t,this.$head=e,this.ranges=n||[new ce(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=y.empty){let n=e.content.lastChild,r=null;for(let t=0;t<e.openEnd;t++)r=n,n=n.lastChild;let o=t.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:a,$to:l}=i[s],c=t.mapping.slice(o);t.replaceRange(c.map(a.pos),c.map(l.pos),s?y.empty:e),0==s&&ve(t,o,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(t,e){let n=t.steps.length,r=this.ranges;for(let o=0;o<r.length;o++){let{$from:i,$to:s}=r[o],a=t.mapping.slice(n),l=a.map(i.pos),c=a.map(s.pos);o?t.deleteRange(l,c):(t.replaceRangeWith(l,c,e),ve(t,n,e.isInline?-1:1))}}static findFrom(t,e,n=!1){let r=t.parent.inlineContent?new he(t):be(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(let r=t.depth-1;r>=0;r--){let o=e<0?be(t.node(0),t.node(r),t.before(r+1),t.index(r),e,n):be(t.node(0),t.node(r),t.after(r+1),t.index(r)+1,e,n);if(o)return o}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new me(t.node(0))}static atStart(t){return be(t,t,0,0,1)||new me(t)}static atEnd(t){return be(t,t,t.content.size,t.childCount,-1)||new me(t)}static fromJSON(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=ae[e.type];if(!n)throw new RangeError(`No selection type ${e.type} defined`);return n.fromJSON(t,e)}static jsonID(t,e){if(t in ae)throw new RangeError("Duplicate use of selection JSON ID "+t);return ae[t]=e,e.prototype.jsonID=t,e}getBookmark(){return he.between(this.$anchor,this.$head).getBookmark()}}le.prototype.visible=!0;class ce{constructor(t,e){this.$from=t,this.$to=e}}let ue=!1;function de(t){ue||t.parent.inlineContent||(ue=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class he extends le{constructor(t,e=t){de(t),de(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let n=t.resolve(e.map(this.head));if(!n.parent.inlineContent)return le.near(n);let r=t.resolve(e.map(this.anchor));return new he(r.parent.inlineContent?r:n,n)}replace(t,e=y.empty){if(super.replace(t,e),e==y.empty){let e=this.$from.marksAcross(this.$to);e&&t.ensureMarks(e)}}eq(t){return t instanceof he&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new pe(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if("number"!=typeof e.anchor||"number"!=typeof e.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new he(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,n=e){let r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))}static between(t,e,n){let r=t.pos-e.pos;if(n&&!r||(n=r>=0?1:-1),!e.parent.inlineContent){let t=le.findFrom(e,n,!0)||le.findFrom(e,-n,!0);if(!t)return le.near(e,n);e=t.$head}return t.parent.inlineContent||(0==r||(t=(le.findFrom(t,-n,!0)||le.findFrom(t,n,!0)).$anchor).pos<e.pos!=r<0)&&(t=e),new he(t,e)}}le.jsonID("text",he);class pe{constructor(t,e){this.anchor=t,this.head=e}map(t){return new pe(t.map(this.anchor),t.map(this.head))}resolve(t){return he.between(t.resolve(this.anchor),t.resolve(this.head))}}class fe extends le{constructor(t){let e=t.nodeAfter,n=t.node(0).resolve(t.pos+e.nodeSize);super(t,n),this.node=e}map(t,e){let{deleted:n,pos:r}=e.mapResult(this.anchor),o=t.resolve(r);return n?le.near(o):new fe(o)}content(){return new y(d.from(this.node),0,0)}eq(t){return t instanceof fe&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new ge(this.anchor)}static fromJSON(t,e){if("number"!=typeof e.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new fe(t.resolve(e.anchor))}static create(t,e){return new fe(t.resolve(e))}static isSelectable(t){return!t.isText&&!1!==t.type.spec.selectable}}fe.prototype.visible=!1,le.jsonID("node",fe);class ge{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:n}=t.mapResult(this.anchor);return e?new pe(n,n):new ge(n)}resolve(t){let e=t.resolve(this.anchor),n=e.nodeAfter;return n&&fe.isSelectable(n)?new fe(e):le.near(e)}}class me extends le{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=y.empty){if(e==y.empty){t.delete(0,t.doc.content.size);let e=le.atStart(t.doc);e.eq(t.selection)||t.setSelection(e)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new me(t)}map(t){return new me(t)}eq(t){return t instanceof me}getBookmark(){return ye}}le.jsonID("all",me);const ye={map(){return this},resolve:t=>new me(t)};function be(t,e,n,r,o,i=!1){if(e.inlineContent)return he.create(t,n);for(let s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){let r=e.child(s);if(r.isAtom){if(!i&&fe.isSelectable(r))return fe.create(t,n-(o<0?r.nodeSize:0))}else{let e=be(t,r,n+o,o<0?r.childCount:0,o,i);if(e)return e}n+=r.nodeSize*o}return null}function ve(t,e,n){let r=t.steps.length-1;if(r<e)return;let o,i=t.steps[r];(i instanceof Ot||i instanceof Nt)&&(t.mapping.maps[r].forEach((t,e,n,r)=>{null==o&&(o=r)}),t.setSelection(le.near(t.doc.resolve(o),n)))}class we extends se{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&this.updated|1,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=2,this}ensureMarks(t){return g.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(t,e){super.addStep(t,e),this.updated=-3&this.updated,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let n=this.selection;return e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||g.none))),n.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,n){let r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();{if(null==n&&(n=e),!t)return this.deleteRange(e,n);let o=this.storedMarks;if(!o){let t=this.doc.resolve(e);o=n==e?t.marks():t.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.selection.to!=e+t.length||this.setSelection(le.near(this.selection.$to)),this}}setMeta(t,e){return this.meta["string"==typeof t?t:t.key]=e,this}getMeta(t){return this.meta["string"==typeof t?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function Ae(t,e){return e&&t?t.bind(e):t}class ke{constructor(t,e,n){this.name=t,this.init=Ae(e.init,n),this.apply=Ae(e.apply,n)}}const xe=[new ke("doc",{init:t=>t.doc||t.schema.topNodeType.createAndFill(),apply:t=>t.doc}),new ke("selection",{init:(t,e)=>t.selection||le.atStart(e.doc),apply:t=>t.selection}),new ke("storedMarks",{init:t=>t.storedMarks||null,apply:(t,e,n,r)=>r.selection.$cursor?t.storedMarks:null}),new ke("scrollToSelection",{init:()=>0,apply:(t,e)=>t.scrolledIntoView?e+1:e})];class Ce{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=xe.slice(),e&&e.forEach(t=>{if(this.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");this.plugins.push(t),this.pluginsByKey[t.key]=t,t.spec.state&&this.fields.push(new ke(t.key,t.spec.state,t))})}}class Se{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=e){let e=this.config.plugins[n];if(e.spec.filterTransaction&&!e.spec.filterTransaction.call(e,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],n=this.applyInner(t),r=null;for(;;){let o=!1;for(let i=0;i<this.config.plugins.length;i++){let s=this.config.plugins[i];if(s.spec.appendTransaction){let a=r?r[i].n:0,l=r?r[i].state:this,c=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,l,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",t),!r){r=[];for(let t=0;t<this.config.plugins.length;t++)r.push(t<i?{state:n,n:e.length}:{state:this,n:0})}e.push(c),n=n.applyInner(c),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let e=new Se(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}return e}get tr(){return new we(this)}static create(t){let e=new Ce(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new Se(e);for(let r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n}reconfigure(t){let e=new Ce(this.schema,t.plugins),n=e.fields,r=new Se(e);for(let e=0;e<n.length;e++){let o=n[e].name;r[o]=this.hasOwnProperty(o)?this[o]:n[e].init(t,r)}return r}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(t=>t.toJSON())),t&&"object"==typeof t)for(let n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e}static fromJSON(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let r=new Ce(t.schema,t.plugins),o=new Se(r);return r.fields.forEach(r=>{if("doc"==r.name)o.doc=R.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=le.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(let i in n){let s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}}),o}}function Ee(t,e,n){for(let r in t){let o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=Ee(o,e,{})),n[r]=o}return n}class Me{constructor(t){this.spec=t,this.props={},t.props&&Ee(t.props,this,this.props),this.key=t.key?t.key.key:Te("plugin")}getState(t){return t[this.key]}}const _e=Object.create(null);function Te(t){return t in _e?t+"$"+ ++_e[t]:(_e[t]=0,t+"$")}class De{constructor(t="key"){this.key=Te(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const Oe=(t,e)=>!t.selection.empty&&(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function Ne(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const Ie=(t,e,n)=>{let r=Ne(t,n);if(!r)return!1;let o=$e(r);if(!o){let n=r.blockRange(),o=n&&Bt(n);return null!=o&&(e&&e(t.tr.lift(n,o).scrollIntoView()),!0)}let i=o.nodeBefore;if(Ke(t,o,e,-1))return!0;if(0==r.parent.content.size&&(Re(i,"end")||fe.isSelectable(i)))for(let n=r.depth;;n--){let s=Wt(t.doc,r.before(n),r.after(n),y.empty);if(s&&s.slice.size<s.to-s.from){if(e){let n=t.tr.step(s);n.setSelection(Re(i,"end")?le.findFrom(n.doc.resolve(n.mapping.map(o.pos,-1)),-1):fe.create(n.doc,o.pos-i.nodeSize)),e(n.scrollIntoView())}return!0}if(1==n||r.node(n-1).childCount>1)break}return!(!i.isAtom||o.depth!=r.depth-1||(e&&e(t.tr.delete(o.pos-i.nodeSize,o.pos).scrollIntoView()),0))};function Le(t,e,n){let r=e.nodeBefore,o=e.pos-1;for(;!r.isTextblock;o--){if(r.type.spec.isolating)return!1;let t=r.lastChild;if(!t)return!1;r=t}let i=e.nodeAfter,s=e.pos+1;for(;!i.isTextblock;s++){if(i.type.spec.isolating)return!1;let t=i.firstChild;if(!t)return!1;i=t}let a=Wt(t.doc,o,s,y.empty);if(!a||a.from!=o||a instanceof Ot&&a.slice.size>=s-o)return!1;if(n){let e=t.tr.step(a);e.setSelection(he.create(e.doc,o)),n(e.scrollIntoView())}return!0}function Re(t,e,n=!1){for(let r=t;r;r="start"==e?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)return!1}return!1}const Be=(t,e,n)=>{let{$head:r,empty:o}=t.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;i=$e(r)}let s=i&&i.nodeBefore;return!(!s||!fe.isSelectable(s)||(e&&e(t.tr.setSelection(fe.create(t.doc,i.pos-s.nodeSize)).scrollIntoView()),0))};function $e(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function Pe(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const Fe=(t,e,n)=>{let r=Pe(t,n);if(!r)return!1;let o=He(r);if(!o)return!1;let i=o.nodeAfter;if(Ke(t,o,e,1))return!0;if(0==r.parent.content.size&&(Re(i,"start")||fe.isSelectable(i))){let n=Wt(t.doc,r.before(),r.after(),y.empty);if(n&&n.slice.size<n.to-n.from){if(e){let r=t.tr.step(n);r.setSelection(Re(i,"start")?le.findFrom(r.doc.resolve(r.mapping.map(o.pos)),1):fe.create(r.doc,r.mapping.map(o.pos))),e(r.scrollIntoView())}return!0}}return!(!i.isAtom||o.depth!=r.depth-1||(e&&e(t.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),0))},ze=(t,e,n)=>{let{$head:r,empty:o}=t.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;i=He(r)}let s=i&&i.nodeAfter;return!(!s||!fe.isSelectable(s)||(e&&e(t.tr.setSelection(fe.create(t.doc,i.pos)).scrollIntoView()),0))};function He(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const je=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!(!n.parent.type.spec.code||!n.sameParent(r)||(e&&e(t.tr.insertText("\n").scrollIntoView()),0))};function Ve(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const qe=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let o=n.node(-1),i=n.indexAfter(-1),s=Ve(o.contentMatchAt(i));if(!s||!o.canReplaceWith(i,i,s))return!1;if(e){let r=n.after(),o=t.tr.replaceWith(r,r,s.createAndFill());o.setSelection(le.near(o.doc.resolve(r),1)),e(o.scrollIntoView())}return!0},Ue=(t,e)=>{let n=t.selection,{$from:r,$to:o}=n;if(n instanceof me||r.parent.inlineContent||o.parent.inlineContent)return!1;let i=Ve(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let n=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,s=t.tr.insert(n,i.createAndFill());s.setSelection(he.create(s.doc,n+1)),e(s.scrollIntoView())}return!0},We=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let r=n.before();if(Ht(t.doc,r))return e&&e(t.tr.split(r).scrollIntoView()),!0}let r=n.blockRange(),o=r&&Bt(r);return null!=o&&(e&&e(t.tr.lift(r,o).scrollIntoView()),!0)};var Je;function Ke(t,e,n,r){let o,i,s=e.nodeBefore,a=e.nodeAfter,l=s.type.spec.isolating||a.type.spec.isolating;if(!l&&function(t,e,n){let r=e.nodeBefore,o=e.nodeAfter,i=e.index();return!(!(r&&o&&r.type.compatibleContent(o.type))||(!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),0):!e.parent.canReplace(i,i+1)||!o.isTextblock&&!jt(t.doc,e.pos)||(n&&n(t.tr.join(e.pos).scrollIntoView()),0)))}(t,e,n))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(o=(i=s.contentMatchAt(s.childCount)).findWrapping(a.type))&&i.matchType(o[0]||a.type).validEnd){if(n){let r=e.pos+a.nodeSize,i=d.empty;for(let t=o.length-1;t>=0;t--)i=d.from(o[t].create(null,i));i=d.from(s.copy(i));let l=t.tr.step(new Nt(e.pos-1,r,e.pos,r,new y(i,1,0),o.length,!0)),c=l.doc.resolve(r+2*o.length);c.nodeAfter&&c.nodeAfter.type==s.type&&jt(l.doc,c.pos)&&l.join(c.pos),n(l.scrollIntoView())}return!0}let u=a.type.spec.isolating||r>0&&l?null:le.findFrom(e,1),h=u&&u.$from.blockRange(u.$to),p=h&&Bt(h);if(null!=p&&p>=e.depth)return n&&n(t.tr.lift(h,p).scrollIntoView()),!0;if(c&&Re(a,"start",!0)&&Re(s,"end")){let r=s,o=[];for(;o.push(r),!r.isTextblock;)r=r.lastChild;let i=a,l=1;for(;!i.isTextblock;i=i.firstChild)l++;if(r.canReplace(r.childCount,r.childCount,i.content)){if(n){let r=d.empty;for(let t=o.length-1;t>=0;t--)r=d.from(o[t].copy(r));n(t.tr.step(new Nt(e.pos-o.length,e.pos+a.nodeSize,e.pos+l,e.pos+a.nodeSize-l,new y(r,o.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function Ge(t){return function(e,n){let r=e.selection,o=t<0?r.$from:r.$to,i=o.depth;for(;o.node(i).isInline;){if(!i)return!1;i--}return!!o.node(i).isTextblock&&(n&&n(e.tr.setSelection(he.create(e.doc,t<0?o.start(i):o.end(i)))),!0)}}const Ye=Ge(-1),Ze=Ge(1);function Qe(t,e=null){return function(n,r){let o=!1;for(let r=0;r<n.selection.ranges.length&&!o;r++){let{$from:{pos:i},$to:{pos:s}}=n.selection.ranges[r];n.doc.nodesBetween(i,s,(r,i)=>{if(o)return!1;if(r.isTextblock&&!r.hasMarkup(t,e))if(r.type==t)o=!0;else{let e=n.doc.resolve(i),r=e.index();o=e.parent.canReplaceWith(r,r+1,t)}})}if(!o)return!1;if(r){let o=n.tr;for(let r=0;r<n.selection.ranges.length;r++){let{$from:{pos:i},$to:{pos:s}}=n.selection.ranges[r];o.setBlockType(i,s,t,e)}r(o.scrollIntoView())}return!0}}function Xe(...t){return function(e,n,r){for(let o=0;o<t.length;o++)if(t[o](e,n,r))return!0;return!1}}let tn=Xe(Oe,Ie,Be),en=Xe(Oe,Fe,ze);const nn={Enter:Xe(je,Ue,We,(t,e)=>{let{$from:n,$to:r}=t.selection;if(t.selection instanceof fe&&t.selection.node.isBlock)return!(!n.parentOffset||!Ht(t.doc,n.pos)||(e&&e(t.tr.split(n.pos).scrollIntoView()),0));if(!n.depth)return!1;let o,i,s=[],a=!1,l=!1;for(let t=n.depth;;t--){if(n.node(t).isBlock){a=n.end(t)==n.pos+(n.depth-t),l=n.start(t)==n.pos-(n.depth-t),i=Ve(n.node(t-1).contentMatchAt(n.indexAfter(t-1)));let e=Je;s.unshift(e||(a&&i?{type:i}:null)),o=t;break}if(1==t)return!1;s.unshift(null)}let c=t.tr;(t.selection instanceof he||t.selection instanceof me)&&c.deleteSelection();let u=c.mapping.map(n.pos),d=Ht(c.doc,u,s.length,s);if(d||(s[0]=i?{type:i}:null,d=Ht(c.doc,u,s.length,s)),!d)return!1;if(c.split(u,s.length,s),!a&&l&&n.node(o).type!=i){let t=c.mapping.map(n.before(o)),e=c.doc.resolve(t);i&&n.node(o-1).canReplaceWith(e.index(),e.index()+1,i)&&c.setNodeMarkup(c.mapping.map(n.before(o)),i)}return e&&e(c.scrollIntoView()),!0}),"Mod-Enter":qe,Backspace:tn,"Mod-Backspace":tn,"Shift-Backspace":tn,Delete:en,"Mod-Delete":en,"Mod-a":(t,e)=>(e&&e(t.tr.setSelection(new me(t.doc))),!0)},rn={"Ctrl-h":nn.Backspace,"Alt-Backspace":nn["Mod-Backspace"],"Ctrl-d":nn.Delete,"Ctrl-Alt-Backspace":nn["Mod-Delete"],"Alt-Delete":nn["Mod-Delete"],"Alt-d":nn["Mod-Delete"],"Ctrl-a":Ye,"Ctrl-e":Ze};for(let t in nn)rn[t]=nn[t];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();const on=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},sn=function(t){let e=t.assignedSlot||t.parentNode;return e&&11==e.nodeType?e.host:e};let an=null;const ln=function(t,e,n){let r=an||(an=document.createRange());return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},cn=function(t,e,n,r){return n&&(dn(t,e,n,r,-1)||dn(t,e,n,r,1))},un=/^(img|br|input|textarea|hr)$/i;function dn(t,e,n,r,o){for(var i;;){if(t==n&&e==r)return!0;if(e==(o<0?0:hn(t))){let n=t.parentNode;if(!n||1!=n.nodeType||pn(t)||un.test(t.nodeName)||"false"==t.contentEditable)return!1;e=on(t)+(o<0?0:1),t=n}else{if(1!=t.nodeType)return!1;{let n=t.childNodes[e+(o<0?-1:0)];if(1==n.nodeType&&"false"==n.contentEditable){if(!(null===(i=n.pmViewDesc)||void 0===i?void 0:i.ignoreForSelection))return!1;e+=o}else t=n,e=o<0?hn(t):0}}}}function hn(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function pn(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const fn=function(t){return t.focusNode&&cn(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function gn(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}const mn="undefined"!=typeof navigator?navigator:null,yn="undefined"!=typeof document?document:null,bn=mn&&mn.userAgent||"",vn=/Edge\/(\d+)/.exec(bn),wn=/MSIE \d/.exec(bn),An=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(bn),kn=!!(wn||An||vn),xn=wn?document.documentMode:An?+An[1]:vn?+vn[1]:0,Cn=!kn&&/gecko\/(\d+)/i.test(bn);Cn&&(/Firefox\/(\d+)/.exec(bn)||[0,0])[1];const Sn=!kn&&/Chrome\/(\d+)/.exec(bn),En=!!Sn,Mn=Sn?+Sn[1]:0,_n=!kn&&!!mn&&/Apple Computer/.test(mn.vendor),Tn=_n&&(/Mobile\/\w+/.test(bn)||!!mn&&mn.maxTouchPoints>2),Dn=Tn||!!mn&&/Mac/.test(mn.platform),On=!!mn&&/Win/.test(mn.platform),Nn=/Android \d/.test(bn),In=!!yn&&"webkitFontSmoothing"in yn.documentElement.style,Ln=In?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Rn(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Bn(t,e){return"number"==typeof t?t:t[e]}function $n(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function Pn(t,e,n){let r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument;for(let s=n||t.dom;s;){if(1!=s.nodeType){s=sn(s);continue}let t=s,n=t==i.body,a=n?Rn(i):$n(t),l=0,c=0;if(e.top<a.top+Bn(r,"top")?c=-(a.top-e.top+Bn(o,"top")):e.bottom>a.bottom-Bn(r,"bottom")&&(c=e.bottom-e.top>a.bottom-a.top?e.top+Bn(o,"top")-a.top:e.bottom-a.bottom+Bn(o,"bottom")),e.left<a.left+Bn(r,"left")?l=-(a.left-e.left+Bn(o,"left")):e.right>a.right-Bn(r,"right")&&(l=e.right-a.right+Bn(o,"right")),l||c)if(n)i.defaultView.scrollBy(l,c);else{let n=t.scrollLeft,r=t.scrollTop;c&&(t.scrollTop+=c),l&&(t.scrollLeft+=l);let o=t.scrollLeft-n,i=t.scrollTop-r;e={left:e.left-o,top:e.top-i,right:e.right-o,bottom:e.bottom-i}}let u=n?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(u))break;s="absolute"==u?s.offsetParent:sn(s)}}function Fn(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=sn(r));return e}function zn(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:o,left:i}=t[n];r.scrollTop!=o+e&&(r.scrollTop=o+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let Hn=null;function jn(t,e){let n,r,o,i,s=2e8,a=0,l=e.top,c=e.top;for(let u=t.firstChild,d=0;u;u=u.nextSibling,d++){let t;if(1==u.nodeType)t=u.getClientRects();else{if(3!=u.nodeType)continue;t=ln(u).getClientRects()}for(let h=0;h<t.length;h++){let p=t[h];if(p.top<=l&&p.bottom>=c){l=Math.max(p.bottom,l),c=Math.min(p.top,c);let t=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(t<s){n=u,s=t,r=t&&3==n.nodeType?{left:p.right<e.left?p.right:p.left,top:e.top}:e,1==u.nodeType&&t&&(a=d+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!o&&p.left<=e.left&&p.right>=e.left&&(o=u,i={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!n&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(a=d+1)}}return!n&&o&&(n=o,r=i,s=0),n&&3==n.nodeType?function(t,e){let n=t.nodeValue.length,r=document.createRange();for(let o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);let n=Jn(r,1);if(n.top!=n.bottom&&Vn(e,n))return{node:t,offset:o+(e.left>=(n.left+n.right)/2?1:0)}}return{node:t,offset:0}}(n,r):!n||s&&1==n.nodeType?{node:t,offset:a}:jn(n,r)}function Vn(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function qn(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=o;;){let n=t.childNodes[i];if(1==n.nodeType){let t=n.getClientRects();for(let r=0;r<t.length;r++){let o=t[r];if(Vn(e,o))return qn(n,e,o)}}if((i=(i+1)%r)==o)break}return t}function Un(t,e){let n,r=t.dom.ownerDocument,o=0,i=function(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(hn(r.offsetNode),r.offset)}}catch(t){}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(hn(r.startContainer),r.startOffset)}}}(r,e.left,e.top);i&&({node:n,offset:o}=i);let s,a=(t.root.elementFromPoint?t.root:r).elementFromPoint(e.left,e.top);if(!a||!t.dom.contains(1!=a.nodeType?a.parentNode:a)){let n=t.dom.getBoundingClientRect();if(!Vn(e,n))return null;if(a=qn(t.dom,e,n),!a)return null}if(_n)for(let t=a;n&&t;t=sn(t))t.draggable&&(n=void 0);if(a=function(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(a,e),n){if(Cn&&1==n.nodeType&&(o=Math.min(o,n.childNodes.length),o<n.childNodes.length)){let t,r=n.childNodes[o];"IMG"==r.nodeName&&(t=r.getBoundingClientRect()).right<=e.left&&t.bottom>e.top&&o++}let r;In&&o&&1==n.nodeType&&1==(r=n.childNodes[o-1]).nodeType&&"false"==r.contentEditable&&r.getBoundingClientRect().top>=e.top&&o--,n==t.dom&&o==n.childNodes.length-1&&1==n.lastChild.nodeType&&e.top>n.lastChild.getBoundingClientRect().bottom?s=t.state.doc.content.size:0!=o&&1==n.nodeType&&"BR"==n.childNodes[o-1].nodeName||(s=function(t,e,n,r){let o=-1;for(let n=e,i=!1;n!=t.dom;){let e,s=t.docView.nearestDesc(n,!0);if(!s)return null;if(1==s.dom.nodeType&&(s.node.isBlock&&s.parent||!s.contentDOM)&&((e=s.dom.getBoundingClientRect()).width||e.height)&&(s.node.isBlock&&s.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(s.dom.nodeName)&&(!i&&e.left>r.left||e.top>r.top?o=s.posBefore:(!i&&e.right<r.left||e.bottom<r.top)&&(o=s.posAfter),i=!0),!s.contentDOM&&o<0&&!s.node.isText))return(s.node.isBlock?r.top<(e.top+e.bottom)/2:r.left<(e.left+e.right)/2)?s.posBefore:s.posAfter;n=s.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n,-1)}(t,n,o,e))}null==s&&(s=function(t,e,n){let{node:r,offset:o}=jn(e,n),i=-1;if(1==r.nodeType&&!r.firstChild){let t=r.getBoundingClientRect();i=t.left!=t.right&&n.left>(t.left+t.right)/2?1:-1}return t.docView.posFromDOM(r,o,i)}(t,a,e));let l=t.docView.nearestDesc(a,!0);return{pos:s,inside:l?l.posAtStart-l.border:-1}}function Wn(t){return t.top<t.bottom||t.left<t.right}function Jn(t,e){let n=t.getClientRects();if(n.length){let t=n[e<0?0:n.length-1];if(Wn(t))return t}return Array.prototype.find.call(n,Wn)||t.getBoundingClientRect()}const Kn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Gn(t,e,n){let{node:r,offset:o,atom:i}=t.docView.domFromPos(e,n<0?-1:1),s=In||Cn;if(3==r.nodeType){if(!s||!Kn.test(r.nodeValue)&&(n<0?o:o!=r.nodeValue.length)){let t=o,e=o,i=n<0?1:-1;return n<0&&!o?(e++,i=-1):n>=0&&o==r.nodeValue.length?(t--,i=1):n<0?t--:e++,Yn(Jn(ln(r,t,e),i),i<0)}{let t=Jn(ln(r,o,o),n);if(Cn&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){let e=Jn(ln(r,o-1,o-1),-1);if(e.top==t.top){let n=Jn(ln(r,o,o+1),-1);if(n.top!=t.top)return Yn(n,n.left<e.left)}}return t}}if(!t.state.doc.resolve(e-(i||0)).parent.inlineContent){if(null==i&&o&&(n<0||o==hn(r))){let t=r.childNodes[o-1];if(1==t.nodeType)return Zn(t.getBoundingClientRect(),!1)}if(null==i&&o<hn(r)){let t=r.childNodes[o];if(1==t.nodeType)return Zn(t.getBoundingClientRect(),!0)}return Zn(r.getBoundingClientRect(),n>=0)}if(null==i&&o&&(n<0||o==hn(r))){let t=r.childNodes[o-1],e=3==t.nodeType?ln(t,hn(t)-(s?0:1)):1!=t.nodeType||"BR"==t.nodeName&&t.nextSibling?null:t;if(e)return Yn(Jn(e,1),!1)}if(null==i&&o<hn(r)){let t=r.childNodes[o];for(;t.pmViewDesc&&t.pmViewDesc.ignoreForCoords;)t=t.nextSibling;let e=t?3==t.nodeType?ln(t,0,s?0:1):1==t.nodeType?t:null:null;if(e)return Yn(Jn(e,-1),!0)}return Yn(Jn(3==r.nodeType?ln(r):r,-n),n>=0)}function Yn(t,e){if(0==t.width)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Zn(t,e){if(0==t.height)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function Qn(t,e,n){let r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o&&o.focus()}}const Xn=/[\u0590-\u08ac]/;let tr=null,er=null,nr=!1;class rr{constructor(t,e,n,r){this.parent=t,this.children=e,this.dom=n,this.contentDOM=r,this.dirty=0,n.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,n){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,n=this.posAtStart;;e++){let r=this.children[e];if(r==t)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){let n,r;if(t==this.contentDOM)n=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;n=t.previousSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.previousSibling;return n?this.posBeforeChild(r)+r.size:this.posAtStart}{let n,r;if(t==this.contentDOM)n=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;n=t.nextSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.nextSibling;return n?this.posBeforeChild(r):this.posAtEnd}}let r;if(t==this.dom&&this.contentDOM)r=e>on(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(let e=t;;e=e.parentNode){if(e==this.dom){r=!1;break}if(e.previousSibling)break}if(null==r&&e==t.childNodes.length)for(let e=t;;e=e.parentNode){if(e==this.dom){r=!0;break}if(e.nextSibling)break}}return(null==r?n>0:r)?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let n=!0,r=t;r;r=r.parentNode){let o,i=this.getDesc(r);if(i&&(!e||i.node)){if(!n||!(o=i.nodeDOM)||(1==o.nodeType?o.contains(1==t.nodeType?t:t.parentNode):o==t))return i;n=!1}}}getDesc(t){let e=t.pmViewDesc;for(let t=e;t;t=t.parent)if(t==this)return e}posFromDOM(t,e,n){for(let r=t;r;r=r.parentNode){let o=this.getDesc(r);if(o)return o.localPosFromDOM(t,e,n)}return-1}descAt(t){for(let e=0,n=0;e<this.children.length;e++){let r=this.children[e],o=n+r.size;if(n==t&&o!=n){for(;!r.border&&r.children.length;)for(let t=0;t<r.children.length;t++){let e=r.children[t];if(e.size){r=e;break}}return r}if(t<o)return r.descAt(t-n-r.border);n=o}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let n=0,r=0;for(let e=0;n<this.children.length;n++){let o=this.children[n],i=e+o.size;if(i>t||o instanceof ur){r=t-e;break}e=i}if(r)return this.children[n].domFromPos(r-this.children[n].border,e);for(let t;n&&!(t=this.children[n-1]).size&&t instanceof or&&t.side>=0;n--);if(e<=0){let t,r=!0;for(;t=n?this.children[n-1]:null,t&&t.dom.parentNode!=this.contentDOM;n--,r=!1);return t&&e&&r&&!t.border&&!t.domAtom?t.domFromPos(t.size,e):{node:this.contentDOM,offset:t?on(t.dom)+1:0}}{let t,r=!0;for(;t=n<this.children.length?this.children[n]:null,t&&t.dom.parentNode!=this.contentDOM;n++,r=!1);return t&&r&&!t.border&&!t.domAtom?t.domFromPos(0,e):{node:this.contentDOM,offset:t?on(t.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,n=0){if(0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,o=-1;for(let i=n,s=0;;s++){let n=this.children[s],a=i+n.size;if(-1==r&&t<=a){let o=i+n.border;if(t>=o&&e<=a-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(t,e,o);t=i;for(let e=s;e>0;e--){let n=this.children[e-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){r=on(n.dom)+1;break}t-=n.size}-1==r&&(r=0)}if(r>-1&&(a>e||s==this.children.length-1)){e=a;for(let t=s+1;t<this.children.length;t++){let n=this.children[t];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){o=on(n.dom);break}e+=n.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=a}return{node:this.contentDOM,from:t,to:e,fromOffset:r,toOffset:o}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:n}=this.domFromPos(t,0);if(1!=e.nodeType||n==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[n]}setSelection(t,e,n,r=!1){let o=Math.min(t,e),i=Math.max(t,e);for(let s=0,a=0;s<this.children.length;s++){let l=this.children[s],c=a+l.size;if(o>a&&i<c)return l.setSelection(t-a-l.border,e-a-l.border,n,r);a=c}let s=this.domFromPos(t,t?-1:1),a=e==t?s:this.domFromPos(e,e?-1:1),l=n.root.getSelection(),c=n.domSelectionRange(),u=!1;if((Cn||_n)&&t==e){let{node:t,offset:e}=s;if(3==t.nodeType){if(u=!(!e||"\n"!=t.nodeValue[e-1]),u&&e==t.nodeValue.length)for(let e,n=t;n;n=n.parentNode){if(e=n.nextSibling){"BR"==e.nodeName&&(s=a={node:e.parentNode,offset:on(e)+1});break}let t=n.pmViewDesc;if(t&&t.node&&t.node.isBlock)break}}else{let n=t.childNodes[e-1];u=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(Cn&&c.focusNode&&c.focusNode!=a.node&&1==c.focusNode.nodeType){let t=c.focusNode.childNodes[c.focusOffset];t&&"false"==t.contentEditable&&(r=!0)}if(!(r||u&&_n)&&cn(s.node,s.offset,c.anchorNode,c.anchorOffset)&&cn(a.node,a.offset,c.focusNode,c.focusOffset))return;let d=!1;if((l.extend||t==e)&&(!u||!Cn)){l.collapse(s.node,s.offset);try{t!=e&&l.extend(a.node,a.offset),d=!0}catch(t){}}if(!d){if(t>e){let t=s;s=a,a=t}let n=document.createRange();n.setEnd(a.node,a.offset),n.setStart(s.node,s.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(t){return!this.contentDOM&&"selection"!=t.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let n=0,r=0;r<this.children.length;r++){let o=this.children[r],i=n+o.size;if(n==i?t<=i&&e>=n:t<i&&e>n){let r=n+o.border,s=i-o.border;if(t>=r&&e<=s)return this.dirty=t==n||e==i?2:1,void(t!=r||e!=s||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(t-r,e-r):o.dirty=3);o.dirty=o.dom!=o.contentDOM||o.dom.parentNode!=this.contentDOM||o.children.length?3:2}n=i}this.dirty=2}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let n=1==t?2:1;e.dirty<n&&(e.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(t){return!1}}class or extends rr{constructor(t,e,n,r){let o,i=e.type.toDOM;if("function"==typeof i&&(i=i(n,()=>o?o.parent?o.parent.posBeforeChild(o):void 0:r)),!e.type.spec.raw){if(1!=i.nodeType){let t=document.createElement("span");t.appendChild(i),i=t}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(t,[],i,null),this.widget=e,this.widget=e,o=this}matchesWidget(t){return 0==this.dirty&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return!!e&&e(t)}ignoreMutation(t){return"selection"!=t.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class ir extends rr{constructor(t,e,n,r){super(t,[],e,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue}}class sr extends rr{constructor(t,e,n,r,o){super(t,[],n,r),this.mark=e,this.spec=o}static create(t,e,n,r){let o=r.nodeViews[e.type.name],i=o&&o(e,r,n);return i&&i.dom||(i=ht.renderSpec(document,e.type.spec.toDOM(e,n),null,e.attrs)),new sr(t,e,i.dom,i.contentDOM||i.dom,i)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return 3!=this.dirty&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),0!=this.dirty){let t=this.parent;for(;!t.node;)t=t.parent;t.dirty<this.dirty&&(t.dirty=this.dirty),this.dirty=0}}slice(t,e,n){let r=sr.create(this.parent,this.mark,!0,n),o=this.children,i=this.size;e<i&&(o=xr(o,e,i,n)),t>0&&(o=xr(o,0,t,n));for(let t=0;t<o.length;t++)o[t].parent=r;return r.children=o,r}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class ar extends rr{constructor(t,e,n,r,o,i,s,a,l){super(t,[],o,i),this.node=e,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=s}static create(t,e,n,r,o,i){let s,a=o.nodeViews[e.type.name],l=a&&a(e,o,()=>s?s.parent?s.parent.posBeforeChild(s):void 0:i,n,r),c=l&&l.dom,u=l&&l.contentDOM;if(e.isText)if(c){if(3!=c.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(e.text);else if(!c){let t=ht.renderSpec(document,e.type.spec.toDOM(e),null,e.attrs);({dom:c,contentDOM:u}=t)}u||e.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),e.type.spec.draggable&&(c.draggable=!0));let d=c;return c=br(c,n,e),l?s=new dr(t,e,n,r,c,u||null,d,l,o,i+1):e.isText?new cr(t,e,n,r,c,d,o):new ar(t,e,n,r,c,u||null,d,o,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(t.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let e=this.children.length-1;e>=0;e--){let n=this.children[e];if(this.dom.contains(n.dom.parentNode)){t.contentElement=n.dom.parentNode;break}}t.contentElement||(t.getContent=()=>d.empty)}else t.contentElement=this.contentDOM;else t.getContent=()=>this.node.content;return t}matchesNode(t,e,n){return 0==this.dirty&&t.eq(this.node)&&vr(e,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let n=this.node.inlineContent,r=e,o=t.composing?this.localCompositionInfo(t,e):null,i=o&&o.pos>-1?o:null,s=o&&o.pos<0,a=new Ar(this,i&&i.node,t);!function(t,e,n,r){let o=e.locals(t),i=0;if(0==o.length){for(let n=0;n<t.childCount;n++){let s=t.child(n);r(s,o,e.forChild(i,s),n),i+=s.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let u,d,h,p;for(;s<o.length&&o[s].to==i;){let t=o[s++];t.widget&&(u?(d||(d=[u])).push(t):u=t)}if(u)if(d){d.sort(kr);for(let t=0;t<d.length;t++)n(d[t],c,!!l)}else n(u,c,!!l);if(l)p=-1,h=l,l=null;else{if(!(c<t.childCount))break;p=c,h=t.child(c++)}for(let t=0;t<a.length;t++)a[t].to<=i&&a.splice(t--,1);for(;s<o.length&&o[s].from<=i&&o[s].to>i;)a.push(o[s++]);let f=i+h.nodeSize;if(h.isText){let t=f;s<o.length&&o[s].from<t&&(t=o[s].from);for(let e=0;e<a.length;e++)a[e].to<t&&(t=a[e].to);t<f&&(l=h.cut(t-i),h=h.cut(0,t-i),f=t,p=-1)}else for(;s<o.length&&o[s].to<f;)s++;r(h,h.isInline&&!h.isLeaf?a.filter(t=>!t.inline):a.slice(),e.forChild(i,h),p),i=f}}(this.node,this.innerDeco,(e,o,i)=>{e.spec.marks?a.syncToMarks(e.spec.marks,n,t):e.type.side>=0&&!i&&a.syncToMarks(o==this.node.childCount?g.none:this.node.child(o).marks,n,t),a.placeWidget(e,t,r)},(e,i,l,c)=>{let u;a.syncToMarks(e.marks,n,t),a.findNodeMatch(e,i,l,c)||s&&t.state.selection.from>r&&t.state.selection.to<r+e.nodeSize&&(u=a.findIndexWithChild(o.node))>-1&&a.updateNodeAt(e,i,l,u,t)||a.updateNextNode(e,i,l,t,c,r)||a.addNode(e,i,l,t,r),r+=e.nodeSize}),a.syncToMarks([],n,t),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(i&&this.protectLocalComposition(t,i),hr(this.contentDOM,this.children,t),Tn&&function(t){if("UL"==t.nodeName||"OL"==t.nodeName){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}(this.dom))}localCompositionInfo(t,e){let{from:n,to:r}=t.state.selection;if(!(t.state.selection instanceof he)||n<e||r>e+this.node.content.size)return null;let o=t.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let t=o.nodeValue,i=function(t,e,n,r){for(let o=0,i=0;o<t.childCount&&i<=r;){let s=t.child(o++),a=i;if(i+=s.nodeSize,!s.isText)continue;let l=s.text;for(;o<t.childCount;){let e=t.child(o++);if(i+=e.nodeSize,!e.isText)break;l+=e.text}if(i>=n){if(i>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let t=a<r?l.lastIndexOf(e,r-a-1):-1;if(t>=0&&t+e.length+a>=n)return a+t;if(n==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}(this.node.content,t,n-e,r-e);return i<0?null:{node:o,pos:i,text:t}}return{node:o,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:n,text:r}){if(this.getDesc(e))return;let o=e;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let i=new ir(this,o,e,r);t.input.compositionNodes.push(i),this.children=xr(this.children,n,n+r.length,t,i)}update(t,e,n,r){return!(3==this.dirty||!t.sameMarkup(this.node)||(this.updateInner(t,e,n,r),0))}updateInner(t,e,n,r){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0}updateOuterDeco(t){if(vr(t,this.outerDeco))return;let e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=mr(this.dom,this.nodeDOM,gr(this.outerDeco,this.node,e),gr(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.nodeDOM.draggable=!0))}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function lr(t,e,n,r,o){br(r,e,t);let i=new ar(void 0,t,e,n,r,r,r,o,0);return i.contentDOM&&i.updateChildren(o,0),i}class cr extends ar{constructor(t,e,n,r,o,i,s){super(t,e,n,r,o,null,i,s,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node)||(this.updateOuterDeco(e),0==this.dirty&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=t,this.dirty=0,0))}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,n){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,n)}ignoreMutation(t){return"characterData"!=t.type&&"selection"!=t.type}slice(t,e,n){let r=this.node.cut(t,e),o=document.createTextNode(r.text);return new cr(this.parent,r,this.outerDeco,this.innerDeco,o,o,n)}markDirty(t,e){super.markDirty(t,e),this.dom==this.nodeDOM||0!=t&&e!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}isText(t){return this.node.text==t}}class ur extends rr{parseRule(){return{ignore:!0}}matchesHack(t){return 0==this.dirty&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class dr extends ar{constructor(t,e,n,r,o,i,s,a,l,c){super(t,e,n,r,o,i,s,l,c),this.spec=a}update(t,e,n,r){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let o=this.spec.update(t,e,n);return o&&this.updateInner(t,e,n,r),o}return!(!this.contentDOM&&!t.isLeaf)&&super.update(t,e,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,n,r){this.spec.setSelection?this.spec.setSelection(t,e,n.root):super.setSelection(t,e,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function hr(t,e,n){let r=t.firstChild,o=!1;for(let i=0;i<e.length;i++){let s=e[i],a=s.dom;if(a.parentNode==t){for(;a!=r;)r=wr(r),o=!0;r=r.nextSibling}else o=!0,t.insertBefore(a,r);if(s instanceof sr){let e=r?r.previousSibling:t.lastChild;hr(s.contentDOM,s.children,n),r=e?e.nextSibling:t.firstChild}}for(;r;)r=wr(r),o=!0;o&&n.trackWrites==t&&(n.trackWrites=null)}const pr=function(t){t&&(this.nodeName=t)};pr.prototype=Object.create(null);const fr=[new pr];function gr(t,e,n){if(0==t.length)return fr;let r=n?fr[0]:new pr,o=[r];for(let i=0;i<t.length;i++){let s=t[i].type.attrs;if(s){s.nodeName&&o.push(r=new pr(s.nodeName));for(let t in s){let i=s[t];null!=i&&(n&&1==o.length&&o.push(r=new pr(e.isInline?"span":"div")),"class"==t?r.class=(r.class?r.class+" ":"")+i:"style"==t?r.style=(r.style?r.style+";":"")+i:"nodeName"!=t&&(r[t]=i))}}}return o}function mr(t,e,n,r){if(n==fr&&r==fr)return e;let o=e;for(let e=0;e<r.length;e++){let i=r[e],s=n[e];if(e){let e;s&&s.nodeName==i.nodeName&&o!=t&&(e=o.parentNode)&&e.nodeName.toLowerCase()==i.nodeName||(e=document.createElement(i.nodeName),e.pmIsDeco=!0,e.appendChild(o),s=fr[0]),o=e}yr(o,s||fr[0],i)}return o}function yr(t,e,n){for(let r in e)"class"==r||"style"==r||"nodeName"==r||r in n||t.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],o=n.class?n.class.split(" ").filter(Boolean):[];for(let e=0;e<r.length;e++)-1==o.indexOf(r[e])&&t.classList.remove(r[e]);for(let e=0;e<o.length;e++)-1==r.indexOf(o[e])&&t.classList.add(o[e]);0==t.classList.length&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let n,r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;n=r.exec(e.style);)t.style.removeProperty(n[1])}n.style&&(t.style.cssText+=n.style)}}function br(t,e,n){return mr(t,t,fr,gr(e,n,1!=t.nodeType))}function vr(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function wr(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class Ar{constructor(t,e,n){this.lock=e,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function(t,e){let n=e,r=n.children.length,o=t.childCount,i=new Map,s=[];t:for(;o>0;){let a;for(;;)if(r){let t=n.children[r-1];if(!(t instanceof sr)){a=t,r--;break}n=t,r=t.children.length}else{if(n==e)break t;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=t.child(o-1))break;--o,i.set(a,o),s.push(a)}}return{index:o,matched:i,matches:s.reverse()}}(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let n=t;n<e;n++)this.top.children[n].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,n){let r=0,o=this.stack.length>>1,i=Math.min(o,t.length);for(;r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(t[r])&&!1!==t[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);let r=-1;for(let e=this.index;e<Math.min(this.index+3,this.top.children.length);e++){let n=this.top.children[e];if(n.matchesMark(t[o])&&!this.isLocked(n.dom)){r=e;break}}if(r>-1)r>this.index&&(this.changed=!0,this.destroyBetween(this.index,r)),this.top=this.top.children[this.index];else{let r=sr.create(this.top,t[o],e,n);this.top.children.splice(this.index,0,r),this.top=r,this.changed=!0}this.index=0,o++}}findNodeMatch(t,e,n,r){let o,i=-1;if(r>=this.preMatch.index&&(o=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&o.matchesNode(t,e,n))i=this.top.children.indexOf(o,this.index);else for(let r=this.index,o=Math.min(this.top.children.length,r+5);r<o;r++){let o=this.top.children[r];if(o.matchesNode(t,e,n)&&!this.preMatch.matched.has(o)){i=r;break}}return!(i<0||(this.destroyBetween(this.index,i),this.index++,0))}updateNodeAt(t,e,n,r,o){let i=this.top.children[r];return 3==i.dirty&&i.dom==i.contentDOM&&(i.dirty=2),!!i.update(t,e,n,o)&&(this.destroyBetween(this.index,r),this.index++,!0)}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let e=t.pmViewDesc;if(e)for(let t=this.index;t<this.top.children.length;t++)if(this.top.children[t]==e)return t;return-1}t=e}}updateNextNode(t,e,n,r,o,i){for(let s=this.index;s<this.top.children.length;s++){let a=this.top.children[s];if(a instanceof ar){let l=this.preMatch.matched.get(a);if(null!=l&&l!=o)return!1;let c,u=a.dom,d=this.isLocked(u)&&!(t.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==t.text&&3!=a.dirty&&vr(e,a.outerDeco));if(!d&&a.update(t,e,n,r))return this.destroyBetween(this.index,s),a.dom!=u&&(this.changed=!0),this.index++,!0;if(!d&&(c=this.recreateWrapper(a,t,e,n,r,i)))return this.destroyBetween(this.index,s),this.top.children[this.index]=c,c.contentDOM&&(c.dirty=2,c.updateChildren(r,i+1),c.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,e,n,r,o,i){if(t.dirty||e.isAtom||!t.children.length||!t.node.content.eq(e.content)||!vr(n,t.outerDeco)||!r.eq(t.innerDeco))return null;let s=ar.create(this.top,e,n,r,o,i);if(s.contentDOM){s.children=t.children,t.children=[];for(let t of s.children)t.parent=s}return t.destroy(),s}addNode(t,e,n,r,o){let i=ar.create(this.top,t,e,n,r,o);i.contentDOM&&i.updateChildren(r,o+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(t,e,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(t)||t!=r.widget&&r.widget.type.toDOM.parentNode){let r=new or(this.top,t,e,n);this.top.children.splice(this.index++,0,r),this.changed=!0}else this.index++}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof sr;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof cr)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((_n||En)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let n=document.createElement(t);"IMG"==t&&(n.className="ProseMirror-separator",n.alt=""),"BR"==t&&(n.className="ProseMirror-trailingBreak");let r=new ur(this.top,[],n,null);e!=this.top?e.children.push(r):e.children.splice(this.index++,0,r),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||1==t.nodeType&&t.contains(this.lock.parentNode))}}function kr(t,e){return t.type.side-e.type.side}function xr(t,e,n,r,o){let i=[];for(let s=0,a=0;s<t.length;s++){let l=t[s],c=a,u=a+=l.size;c>=n||u<=e?i.push(l):(c<e&&i.push(l.slice(0,e-c,r)),o&&(i.push(o),o=void 0),u>n&&i.push(l.slice(n-c,l.size,r)))}return i}function Cr(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let o=t.docView.nearestDesc(n.focusNode),i=o&&0==o.size,s=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let a,l,c=r.resolve(s);if(fn(n)){for(a=s;o&&!o.node;)o=o.parent;let t=o.node;if(o&&t.isAtom&&fe.isSelectable(t)&&o.parent&&(!t.isInline||!function(t,e,n){for(let r=0==e,o=e==hn(t);r||o;){if(t==n)return!0;let e=on(t);if(!(t=t.parentNode))return!1;r=r&&0==e,o=o&&e==hn(t)}}(n.focusNode,n.focusOffset,o.dom))){let t=o.posBefore;l=new fe(s==t?c:r.resolve(t))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let e=s,o=s;for(let r=0;r<n.rangeCount;r++){let i=n.getRangeAt(r);e=Math.min(e,t.docView.posFromDOM(i.startContainer,i.startOffset,1)),o=Math.max(o,t.docView.posFromDOM(i.endContainer,i.endOffset,-1))}if(e<0)return null;[a,s]=o==t.state.selection.anchor?[o,e]:[e,o],c=r.resolve(s)}else a=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(a<0)return null}let u=r.resolve(a);return l||(l=Ir(t,u,c,"pointer"==e||t.state.selection.head<c.pos&&!i?1:-1)),l}function Sr(t){return t.editable?t.hasFocus():Rr(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Er(t,e=!1){let n=t.state.selection;if(Or(t,n),Sr(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&En){let e=t.domSelectionRange(),n=t.domObserver.currentSelection;if(e.anchorNode&&n.anchorNode&&cn(e.anchorNode,e.anchorOffset,n.anchorNode,n.anchorOffset))return t.input.mouseDown.delayedSelectionSync=!0,void t.domObserver.setCurSelection()}if(t.domObserver.disconnectSelection(),t.cursorWrapper)!function(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r="IMG"==n.nodeName;r?e.collapse(n.parentNode,on(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&kn&&xn<=11&&(n.disabled=!0,n.disabled=!1)}(t);else{let r,o,{anchor:i,head:s}=n;!Mr||n instanceof he||(n.$from.parent.inlineContent||(r=_r(t,n.from)),n.empty||n.$from.parent.inlineContent||(o=_r(t,n.to))),t.docView.setSelection(i,s,t,e),Mr&&(r&&Dr(r),o&&Dr(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{n.anchorNode==r&&n.anchorOffset==o||(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{Sr(t)&&!t.state.selection.visible||t.dom.classList.remove("ProseMirror-hideselection")},20))})}(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const Mr=_n||En&&Mn<63;function _r(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),o=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(_n&&o&&"false"==o.contentEditable)return Tr(o);if(!(o&&"false"!=o.contentEditable||i&&"false"!=i.contentEditable)){if(o)return Tr(o);if(i)return Tr(i)}}function Tr(t){return t.contentEditable="true",_n&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Dr(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Or(t,e){if(e instanceof fe){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Nr(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Nr(t)}function Nr(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Ir(t,e,n,r){return t.someProp("createSelectionBetween",r=>r(t,e,n))||he.between(e,n,r)}function Lr(t){return!(t.editable&&!t.hasFocus())&&Rr(t)}function Rr(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function Br(t,e){let{$anchor:n,$head:r}=t.selection,o=e>0?n.max(r):n.min(r),i=o.parent.inlineContent?o.depth?t.doc.resolve(e>0?o.after():o.before()):null:o;return i&&le.findFrom(i,e)}function $r(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Pr(t,e,n){let r=t.state.selection;if(!(r instanceof he)){if(r instanceof fe&&r.node.isInline)return $r(t,new he(e>0?r.$to:r.$from));{let n=Br(t.state,e);return!!n&&$r(t,n)}}if(n.indexOf("s")>-1){let{$head:n}=r,o=n.textOffset?null:e<0?n.nodeBefore:n.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let i=t.state.doc.resolve(n.pos+o.nodeSize*(e<0?-1:1));return $r(t,new he(r.$anchor,i))}if(!r.empty)return!1;if(t.endOfTextblock(e>0?"forward":"backward")){let n=Br(t.state,e);return!!(n&&n instanceof fe)&&$r(t,n)}if(!(Dn&&n.indexOf("m")>-1)){let n,o=r.$head,i=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter;if(!i||i.isText)return!1;let s=e<0?o.pos-i.nodeSize:o.pos;return!!(i.isAtom||(n=t.docView.descAt(s))&&!n.contentDOM)&&(fe.isSelectable(i)?$r(t,new fe(e<0?t.state.doc.resolve(o.pos-i.nodeSize):o)):!!In&&$r(t,new he(t.state.doc.resolve(e<0?s:s+i.nodeSize))))}}function Fr(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function zr(t,e){let n=t.pmViewDesc;return n&&0==n.size&&(e<0||t.nextSibling||"BR"!=t.nodeName)}function Hr(t,e){return e<0?function(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let o,i,s=!1;for(Cn&&1==n.nodeType&&r<Fr(n)&&zr(n.childNodes[r],-1)&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;{let t=n.childNodes[r-1];if(zr(t,-1))o=n,i=--r;else{if(3!=t.nodeType)break;n=t,r=n.nodeValue.length}}}else{if(jr(n))break;{let e=n.previousSibling;for(;e&&zr(e,-1);)o=n.parentNode,i=on(e),e=e.previousSibling;if(e)n=e,r=Fr(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}s?Vr(t,n,r):o&&Vr(t,o,i)}(t):function(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let o,i,s=Fr(n);for(;;)if(r<s){if(1!=n.nodeType)break;if(!zr(n.childNodes[r],1))break;o=n,i=++r}else{if(jr(n))break;{let e=n.nextSibling;for(;e&&zr(e,1);)o=e.parentNode,i=on(e)+1,e=e.nextSibling;if(e)n=e,r=0,s=Fr(n);else{if(n=n.parentNode,n==t.dom)break;r=s=0}}}o&&Vr(t,o,i)}(t)}function jr(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function Vr(t,e,n){if(3!=e.nodeType){let t,r;(r=function(t,e){for(;t&&e==t.childNodes.length&&!pn(t);)e=on(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=n,e=0}}(e,n))?(e=r,n=0):(t=function(t,e){for(;t&&!e&&!pn(t);)e=on(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=(t=n).childNodes.length}}(e,n))&&(e=t,n=t.nodeValue.length)}let r=t.domSelection();if(!r)return;if(fn(r)){let t=document.createRange();t.setEnd(e,n),t.setStart(e,n),r.removeAllRanges(),r.addRange(t)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:o}=t;setTimeout(()=>{t.state==o&&Er(t)},50)}function qr(t,e){let n=t.state.doc.resolve(e);if(!En&&!On&&n.parent.inlineContent){let r=t.coordsAtPos(e);if(e>n.start()){let n=t.coordsAtPos(e-1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left<r.left?"ltr":"rtl"}if(e<n.end()){let n=t.coordsAtPos(e+1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left>r.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(t.dom).direction?"rtl":"ltr"}function Ur(t,e,n){let r=t.state.selection;if(r instanceof he&&!r.empty||n.indexOf("s")>-1)return!1;if(Dn&&n.indexOf("m")>-1)return!1;let{$from:o,$to:i}=r;if(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let n=Br(t.state,e);if(n&&n instanceof fe)return $r(t,n)}if(!o.parent.inlineContent){let n=e<0?o:i,s=r instanceof me?le.near(n,e):le.findFrom(n,e);return!!s&&$r(t,s)}return!1}function Wr(t,e){if(!(t.state.selection instanceof he))return!0;let{$head:n,$anchor:r,empty:o}=t.state.selection;if(!n.sameParent(r))return!0;if(!o)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let r=t.state.tr;return e<0?r.delete(n.pos-i.nodeSize,n.pos):r.delete(n.pos,n.pos+i.nodeSize),t.dispatch(r),!0}return!1}function Jr(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function Kr(t,e){t.someProp("transformCopied",n=>{e=n(e,t)});let n=[],{content:r,openStart:o,openEnd:i}=e;for(;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;let t=r.firstChild;n.push(t.type.name,t.attrs!=t.type.defaultAttrs?t.attrs:null),r=t.content}let s=t.someProp("clipboardSerializer")||ht.fromSchema(t.state.schema),a=oo(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c,u=l.firstChild,d=0;for(;u&&1==u.nodeType&&(c=no[u.nodeName.toLowerCase()]);){for(let t=c.length-1;t>=0;t--){let e=a.createElement(c[t]);for(;l.firstChild;)e.appendChild(l.firstChild);l.appendChild(e),d++}u=l.firstChild}return u&&1==u.nodeType&&u.setAttribute("data-pm-slice",`${o} ${i}${d?` -${d}`:""} ${JSON.stringify(n)}`),{dom:l,text:t.someProp("clipboardTextSerializer",n=>n(e,t))||e.content.textBetween(0,e.content.size,"\n\n"),slice:e}}function Gr(t,e,n,r,o){let i,s,a=o.parent.type.spec.code;if(!n&&!e)return null;let l=!!e&&(r||a||!n);if(l){if(t.someProp("transformPastedText",n=>{e=n(e,a||r,t)}),a)return s=new y(d.from(t.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0),t.someProp("transformPasted",e=>{s=e(s,t,!0)}),s;let n=t.someProp("clipboardTextParser",n=>n(e,o,r,t));if(n)s=n;else{let n=o.marks(),{schema:r}=t.state,s=ht.fromSchema(r);i=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(t=>{let e=i.appendChild(document.createElement("p"));t&&e.appendChild(s.serializeNode(r.text(t,n)))})}}else t.someProp("transformPastedHTML",e=>{n=e(n,t)}),i=function(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n,r=oo().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(t);if((n=o&&no[o[1].toLowerCase()])&&(t=n.map(t=>"<"+t+">").join("")+t+n.map(t=>"</"+t+">").reverse().join("")),r.innerHTML=function(t){let e=window.trustedTypes;return e?(io||(io=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),io.createHTML(t)):t}(t),n)for(let t=0;t<n.length;t++)r=r.querySelector(n[t])||r;return r}(n),In&&function(t){let e=t.querySelectorAll(En?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];1==r.childNodes.length&&""==r.textContent&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}(i);let c=i&&i.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let t=+u[3];t>0;t--){let t=i.firstChild;for(;t&&1!=t.nodeType;)t=t.nextSibling;if(!t)break;i=t}if(!s){let e=t.someProp("clipboardParser")||t.someProp("domParser")||nt.fromSchema(t.state.schema);s=e.parseSlice(i,{preserveWhitespace:!(!l&&!u),context:o,ruleFromNode:t=>"BR"!=t.nodeName||t.nextSibling||!t.parentNode||Yr.test(t.parentNode.nodeName)?null:{ignore:!0}})}if(u)s=function(t,e){if(!t.size)return t;let n,r=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(e){return t}let{content:o,openStart:i,openEnd:s}=t;for(let t=n.length-2;t>=0;t-=2){let e=r.nodes[n[t]];if(!e||e.hasRequiredAttrs())break;o=d.from(e.create(n[t+1],o)),i++,s++}return new y(o,i,s)}(eo(s,+u[1],+u[2]),u[4]);else if(s=y.maxOpen(function(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let r,o=e.node(n).contentMatchAt(e.index(n)),i=[];if(t.forEach(t=>{if(!i)return;let e,n=o.findWrapping(t.type);if(!n)return i=null;if(e=i.length&&r.length&&Qr(n,r,t,i[i.length-1],0))i[i.length-1]=e;else{i.length&&(i[i.length-1]=Xr(i[i.length-1],r.length));let e=Zr(t,n);i.push(e),o=o.matchType(e.type),r=n}}),i)return d.from(i)}return t}(s.content,o),!0),s.openStart||s.openEnd){let t=0,e=0;for(let e=s.content.firstChild;t<s.openStart&&!e.type.spec.isolating;t++,e=e.firstChild);for(let t=s.content.lastChild;e<s.openEnd&&!t.type.spec.isolating;e++,t=t.lastChild);s=eo(s,t,e)}return t.someProp("transformPasted",e=>{s=e(s,t,l)}),s}const Yr=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Zr(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,d.from(t));return t}function Qr(t,e,n,r,o){if(o<t.length&&o<e.length&&t[o]==e[o]){let i=Qr(t,e,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==t.length-1?n.type:t[o+1]))return r.copy(r.content.append(d.from(Zr(n,t,o+1))))}}function Xr(t,e){if(0==e)return t;let n=t.content.replaceChild(t.childCount-1,Xr(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(d.empty,!0);return t.copy(n.append(r))}function to(t,e,n,r,o,i){let s=e<0?t.firstChild:t.lastChild,a=s.content;return t.childCount>1&&(i=0),o<r-1&&(a=to(a,e,n,r,o+1,i)),o>=n&&(a=e<0?s.contentMatchAt(0).fillBefore(a,i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(d.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(a))}function eo(t,e,n){return e<t.openStart&&(t=new y(to(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new y(to(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const no={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let ro=null;function oo(){return ro||(ro=document.implementation.createHTMLDocument("title"))}let io=null;const so={},ao={},lo={touchstart:!0,touchmove:!0};class co{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function uo(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function ho(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=e=>po(t,e))})}function po(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return!!r&&(r(t,e)||e.defaultPrevented)})}function fo(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function go(t){return{left:t.clientX,top:t.clientY}}function mo(t,e,n,r,o){if(-1==r)return!1;let i=t.state.doc.resolve(r);for(let r=i.depth+1;r>0;r--)if(t.someProp(e,e=>r>i.depth?e(t,n,i.nodeAfter,i.before(r),o,!0):e(t,n,i.node(r),i.before(r),o,!1)))return!0;return!1}function yo(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);"pointer"==n&&r.setMeta("pointer",!0),t.dispatch(r)}function bo(t,e,n,r){return mo(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",n=>n(t,e,r))}function vo(t,e,n,r){return mo(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",n=>n(t,e,r))||function(t,e,n){if(0!=n.button)return!1;let r=t.state.doc;if(-1==e)return!!r.inlineContent&&(yo(t,he.create(r,0,r.content.size),"pointer"),!0);let o=r.resolve(e);for(let e=o.depth+1;e>0;e--){let n=e>o.depth?o.nodeAfter:o.node(e),i=o.before(e);if(n.inlineContent)yo(t,he.create(r,i+1,i+1+n.content.size),"pointer");else{if(!fe.isSelectable(n))continue;yo(t,fe.create(r,i),"pointer")}return!0}}(t,n,r)}function wo(t){return Mo(t)}ao.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=16==n.keyCode||n.shiftKey,!xo(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!Nn||!En||13!=n.keyCode))if(229!=n.keyCode&&t.domObserver.forceFlush(),!Tn||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)t.someProp("handleKeyDown",e=>e(t,n))||function(t,e){let n=e.keyCode,r=function(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(e);if(8==n||Dn&&72==n&&"c"==r)return Wr(t,-1)||Hr(t,-1);if(46==n&&!e.shiftKey||Dn&&68==n&&"c"==r)return Wr(t,1)||Hr(t,1);if(13==n||27==n)return!0;if(37==n||Dn&&66==n&&"c"==r){let e=37==n?"ltr"==qr(t,t.state.selection.from)?-1:1:-1;return Pr(t,e,r)||Hr(t,e)}if(39==n||Dn&&70==n&&"c"==r){let e=39==n?"ltr"==qr(t,t.state.selection.from)?1:-1:1;return Pr(t,e,r)||Hr(t,e)}return 38==n||Dn&&80==n&&"c"==r?Ur(t,-1,r)||Hr(t,-1):40==n||Dn&&78==n&&"c"==r?function(t){if(!_n||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&1==e.nodeType&&0==n&&e.firstChild&&"false"==e.firstChild.contentEditable){let n=e.firstChild;Jr(t,n,"true"),setTimeout(()=>Jr(t,n,"false"),20)}return!1}(t)||Ur(t,1,r)||Hr(t,1):r==(Dn?"m":"c")&&(66==n||73==n||89==n||90==n)}(t,n)?n.preventDefault():uo(t,"key");else{let e=Date.now();t.input.lastIOSEnter=e,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==e&&(t.someProp("handleKeyDown",e=>e(t,gn(13,"Enter"))),t.input.lastIOSEnter=0)},200)}},ao.keyup=(t,e)=>{16==e.keyCode&&(t.input.shiftKey=!1)},ao.keypress=(t,e)=>{let n=e;if(xo(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Dn&&n.metaKey)return;if(t.someProp("handleKeyPress",e=>e(t,n)))return void n.preventDefault();let r=t.state.selection;if(!(r instanceof he&&r.$from.sameParent(r.$to))){let e=String.fromCharCode(n.charCode),o=()=>t.state.tr.insertText(e).scrollIntoView();/[\r\n]/.test(e)||t.someProp("handleTextInput",n=>n(t,r.$from.pos,r.$to.pos,e,o))||t.dispatch(o()),n.preventDefault()}};const Ao=Dn?"metaKey":"ctrlKey";so.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=wo(t),o=Date.now(),i="singleClick";o-t.input.lastClick.time<500&&function(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(n,t.input.lastClick)&&!n[Ao]&&t.input.lastClick.button==n.button&&("singleClick"==t.input.lastClick.type?i="doubleClick":"doubleClick"==t.input.lastClick.type&&(i="tripleClick")),t.input.lastClick={time:o,x:n.clientX,y:n.clientY,type:i,button:n.button};let s=t.posAtCoords(go(n));s&&("singleClick"==i?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new ko(t,s,n,!!r)):("doubleClick"==i?bo:vo)(t,s.pos,s.inside,n)?n.preventDefault():uo(t,"pointer"))};class ko{constructor(t,e,n,r){let o,i;if(this.view=t,this.pos=e,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!n[Ao],this.allowDefault=n.shiftKey,e.inside>-1)o=t.state.doc.nodeAt(e.inside),i=e.inside;else{let n=t.state.doc.resolve(e.pos);o=n.parent,i=n.depth?n.before():0}const s=r?null:n.target,a=s?t.docView.nearestDesc(s,!0):null;this.target=a&&1==a.nodeDOM.nodeType?a.nodeDOM:null;let{selection:l}=t.state;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||l instanceof fe&&l.from<=i&&l.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!Cn||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),uo(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Er(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(go(t))),this.updateAllowDefault(t),this.allowDefault||!e?uo(this.view,"pointer"):function(t,e,n,r,o){return mo(t,"handleClickOn",e,n,r)||t.someProp("handleClick",n=>n(t,e,r))||(o?function(t,e){if(-1==e)return!1;let n,r,o=t.state.selection;o instanceof fe&&(n=o.node);let i=t.state.doc.resolve(e);for(let t=i.depth+1;t>0;t--){let e=t>i.depth?i.nodeAfter:i.node(t);if(fe.isSelectable(e)){r=n&&o.$from.depth>0&&t>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(t);break}}return null!=r&&(yo(t,fe.create(t.state.doc,r),"pointer"),!0)}(t,n):function(t,e){if(-1==e)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return!!(r&&r.isAtom&&fe.isSelectable(r))&&(yo(t,new fe(n),"pointer"),!0)}(t,n))}(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||_n&&this.mightDrag&&!this.mightDrag.node.isAtom||En&&!this.view.state.selection.visible&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(yo(this.view,le.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):uo(this.view,"pointer")}move(t){this.updateAllowDefault(t),uo(this.view,"pointer"),0==t.buttons&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}function xo(t,e){return!!t.composing||!!(_n&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500)&&(t.input.compositionEndedAt=-2e8,!0)}so.touchstart=t=>{t.input.lastTouch=Date.now(),wo(t),uo(t,"pointer")},so.touchmove=t=>{t.input.lastTouch=Date.now(),uo(t,"pointer")},so.contextmenu=t=>wo(t);const Co=Nn?5e3:-1;function So(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Mo(t),e))}function Eo(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=function(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function Mo(t,e=!1){if(!(Nn&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),Eo(t),e||t.docView&&t.docView.dirty){let n=Cr(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):!t.markCursor&&!e||r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.updateState(t.state):t.dispatch(t.state.tr.deleteSelection()),!0}return!1}}ao.compositionstart=ao.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof he&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(t=>!1===t.type.spec.inclusive)))t.markCursor=t.state.storedMarks||n.marks(),Mo(t,!0),t.markCursor=null;else if(Mo(t,!e.selection.empty),Cn&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let e=t.domSelectionRange();for(let n=e.focusNode,r=e.focusOffset;n&&1==n.nodeType&&0!=r;){let e=r<0?n.lastChild:n.childNodes[r-1];if(!e)break;if(3==e.nodeType){let n=t.domSelection();n&&n.collapse(e,e.nodeValue.length);break}n=e,r=-1}}t.input.composing=!0}So(t,Co)},ao.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,So(t,20))};const _o=kn&&xn<15||Tn&&Ln<604;function To(t,e,n,r,o){let i=Gr(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",e=>e(t,o,i||y.empty)))return!0;if(!i)return!1;let s=function(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(i),a=s?t.state.tr.replaceSelectionWith(s,r):t.state.tr.replaceSelection(i);return t.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Do(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}so.copy=ao.cut=(t,e)=>{let n=e,r=t.state.selection,o="cut"==n.type;if(r.empty)return;let i=_o?null:n.clipboardData,s=r.content(),{dom:a,text:l}=Kr(t,s);i?(n.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):function(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),o=document.createRange();o.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}(t,a),o&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},ao.paste=(t,e)=>{let n=e;if(t.composing&&!Nn)return;let r=_o?null:n.clipboardData,o=t.input.shiftKey&&45!=t.input.lastKeyCode;r&&To(t,Do(r),r.getData("text/html"),o,n)?n.preventDefault():function(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let o=t.input.shiftKey&&45!=t.input.lastKeyCode;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?To(t,r.value,null,o,e):To(t,r.textContent,r.innerHTML,o,e)},50)}(t,n)};class Oo{constructor(t,e,n){this.slice=t,this.move=e,this.node=n}}const No=Dn?"altKey":"ctrlKey";function Io(t,e){let n=t.someProp("dragCopies",t=>!t(e));return null!=n?n:!e[No]}so.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let o,i=t.state.selection,s=i.empty?null:t.posAtCoords(go(n));if(s&&s.pos>=i.from&&s.pos<=(i instanceof fe?i.to-1:i.to));else if(r&&r.mightDrag)o=fe.create(t.state.doc,r.mightDrag.pos);else if(n.target&&1==n.target.nodeType){let e=t.docView.nearestDesc(n.target,!0);e&&e.node.type.spec.draggable&&e!=t.docView&&(o=fe.create(t.state.doc,e.posBefore))}let a=(o||t.state.selection).content(),{dom:l,text:c,slice:u}=Kr(t,a);(!n.dataTransfer.files.length||!En||Mn>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(_o?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",_o||n.dataTransfer.setData("text/plain",c),t.dragging=new Oo(u,Io(t,n),o)},so.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)},ao.dragover=ao.dragenter=(t,e)=>e.preventDefault(),ao.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let o=t.posAtCoords(go(n));if(!o)return;let i=t.state.doc.resolve(o.pos),s=r&&r.slice;s?t.someProp("transformPasted",e=>{s=e(s,t,!1)}):s=Gr(t,Do(n.dataTransfer),_o?null:n.dataTransfer.getData("text/html"),!1,i);let a=!(!r||!Io(t,n));if(t.someProp("handleDrop",e=>e(t,n,s||y.empty,a)))return void n.preventDefault();if(!s)return;n.preventDefault();let l=s?Ut(t.state.doc,i.pos,s):i.pos;null==l&&(l=i.pos);let c=t.state.tr;if(a){let{node:t}=r;t?t.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=0==s.openStart&&0==s.openEnd&&1==s.content.childCount,h=c.doc;if(d?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),c.doc.eq(h))return;let p=c.doc.resolve(u);if(d&&fe.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new fe(p));else{let e=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((t,n,r,o)=>e=o),c.setSelection(Ir(t,p,c.doc.resolve(e)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))},so.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Er(t)},20))},so.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)},so.beforeinput=(t,e)=>{if(En&&Nn&&"deleteContentBackward"==e.inputType){t.domObserver.flushSoon();let{domChangeCount:e}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=e)return;if(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",e=>e(t,gn(8,"Backspace"))))return;let{$cursor:n}=t.state.selection;n&&n.pos>0&&t.dispatch(t.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}};for(let t in ao)so[t]=ao[t];function Lo(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Ro{constructor(t,e){this.toDOM=t,this.spec=e||zo,this.side=this.spec.side||0}map(t,e,n,r){let{pos:o,deleted:i}=t.mapResult(e.from+r,this.side<0?-1:1);return i?null:new Po(o-n,o-n,this)}valid(){return!0}eq(t){return this==t||t instanceof Ro&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Lo(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class Bo{constructor(t,e){this.attrs=t,this.spec=e||zo}map(t,e,n,r){let o=t.map(e.from+r,this.spec.inclusiveStart?-1:1)-n,i=t.map(e.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new Po(o,i,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof Bo&&Lo(this.attrs,t.attrs)&&Lo(this.spec,t.spec)}static is(t){return t.type instanceof Bo}destroy(){}}class $o{constructor(t,e){this.attrs=t,this.spec=e||zo}map(t,e,n,r){let o=t.mapResult(e.from+r,1);if(o.deleted)return null;let i=t.mapResult(e.to+r,-1);return i.deleted||i.pos<=o.pos?null:new Po(o.pos-n,i.pos-n,this)}valid(t,e){let n,{index:r,offset:o}=t.content.findIndex(e.from);return o==e.from&&!(n=t.child(r)).isText&&o+n.nodeSize==e.to}eq(t){return this==t||t instanceof $o&&Lo(this.attrs,t.attrs)&&Lo(this.spec,t.spec)}destroy(){}}class Po{constructor(t,e,n){this.from=t,this.to=e,this.type=n}copy(t,e){return new Po(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,n){return this.type.map(t,this,e,n)}static widget(t,e,n){return new Po(t,t,new Ro(e,n))}static inline(t,e,n,r){return new Po(t,e,new Bo(n,r))}static node(t,e,n,r){return new Po(t,e,new $o(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof Bo}get widget(){return this.type instanceof Ro}}const Fo=[],zo={};class Ho{constructor(t,e){this.local=t.length?t:Fo,this.children=e.length?e:Fo}static create(t,e){return e.length?Jo(e,t,0,zo):jo}find(t,e,n){let r=[];return this.findInner(null==t?0:t,null==e?1e9:e,r,0,n),r}findInner(t,e,n,r,o){for(let i=0;i<this.local.length;i++){let s=this.local[i];s.from<=e&&s.to>=t&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<e&&this.children[i+1]>t){let s=this.children[i]+1;this.children[i+2].findInner(t-s,e-s,n,r+s,o)}}map(t,e,n){return this==jo||0==t.maps.length?this:this.mapInner(t,e,0,0,n||zo)}mapInner(t,e,n,r,o){let i;for(let s=0;s<this.local.length;s++){let a=this.local[s].map(t,n,r);a&&a.type.valid(e,a)?(i||(i=[])).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(t,e,n,r,o,i,s){let a=t.slice();for(let t=0,e=i;t<n.maps.length;t++){let r=0;n.maps[t].forEach((t,n,o,i)=>{let s=i-o-(n-t);for(let o=0;o<a.length;o+=3){let i=a[o+1];if(i<0||t>i+e-r)continue;let l=a[o]+e-r;n>=l?a[o+1]=t<=l?-2:-1:t>=e&&s&&(a[o]+=s,a[o+1]+=s)}r+=s}),e=n.maps[t].map(e,-1)}let l=!1;for(let e=0;e<a.length;e+=3)if(a[e+1]<0){if(-2==a[e+1]){l=!0,a[e+1]=-1;continue}let c=n.map(t[e]+i),u=c-o;if(u<0||u>=r.content.size){l=!0;continue}let d=n.map(t[e+1]+i,-1)-o,{index:h,offset:p}=r.content.findIndex(u),f=r.maybeChild(h);if(f&&p==u&&p+f.nodeSize==d){let r=a[e+2].mapInner(n,f,c+1,t[e]+i+1,s);r!=jo?(a[e]=u,a[e+1]=d,a[e+2]=r):(a[e+1]=-2,l=!0)}else l=!0}if(l){let l=function(t,e,n,r,o,i,s){function a(t,e){for(let i=0;i<t.local.length;i++){let a=t.local[i].map(r,o,e);a?n.push(a):s.onRemove&&s.onRemove(t.local[i].spec)}for(let n=0;n<t.children.length;n+=3)a(t.children[n+2],t.children[n]+e+1)}for(let n=0;n<t.length;n+=3)-1==t[n+1]&&a(t[n+2],e[n]+i+1);return n}(a,t,e,n,o,i,s),c=Jo(l,r,0,s);e=c.local;for(let t=0;t<a.length;t+=3)a[t+1]<0&&(a.splice(t,3),t-=3);for(let t=0,e=0;t<c.children.length;t+=3){let n=c.children[t];for(;e<a.length&&a[e]<n;)e+=3;a.splice(e,0,c.children[t],c.children[t+1],c.children[t+2])}}return new Ho(e.sort(Ko),a)}(this.children,i||[],t,e,n,r,o):i?new Ho(i.sort(Ko),Fo):jo}add(t,e){return e.length?this==jo?Ho.create(t,e):this.addInner(t,e,0):this}addInner(t,e,n){let r,o=0;t.forEach((t,i)=>{let s,a=i+n;if(s=Uo(e,t,a)){for(r||(r=this.children.slice());o<r.length&&r[o]<i;)o+=3;r[o]==i?r[o+2]=r[o+2].addInner(t,s,a+1):r.splice(o,0,i,i+t.nodeSize,Jo(s,t,a+1,zo)),o+=3}});let i=qo(o?Wo(e):e,-n);for(let e=0;e<i.length;e++)i[e].type.valid(t,i[e])||i.splice(e--,1);return new Ho(i.length?this.local.concat(i).sort(Ko):this.local,r||this.children)}remove(t){return 0==t.length||this==jo?this:this.removeInner(t,0)}removeInner(t,e){let n=this.children,r=this.local;for(let r=0;r<n.length;r+=3){let o,i=n[r]+e,s=n[r+1]+e;for(let e,n=0;n<t.length;n++)(e=t[n])&&e.from>i&&e.to<s&&(t[n]=null,(o||(o=[])).push(e));if(!o)continue;n==this.children&&(n=this.children.slice());let a=n[r+2].removeInner(o,i+1);a!=jo?n[r+2]=a:(n.splice(r,3),r-=3)}if(r.length)for(let n,o=0;o<t.length;o++)if(n=t[o])for(let t=0;t<r.length;t++)r[t].eq(n,e)&&(r==this.local&&(r=this.local.slice()),r.splice(t--,1));return n==this.children&&r==this.local?this:r.length||n.length?new Ho(r,n):jo}forChild(t,e){if(this==jo)return this;if(e.isLeaf)return Ho.empty;let n,r;for(let e=0;e<this.children.length;e+=3)if(this.children[e]>=t){this.children[e]==t&&(n=this.children[e+2]);break}let o=t+1,i=o+e.content.size;for(let t=0;t<this.local.length;t++){let e=this.local[t];if(e.from<i&&e.to>o&&e.type instanceof Bo){let t=Math.max(o,e.from)-o,n=Math.min(i,e.to)-o;t<n&&(r||(r=[])).push(e.copy(t,n))}}if(r){let t=new Ho(r.sort(Ko),Fo);return n?new Vo([t,n]):t}return n||jo}eq(t){if(this==t)return!0;if(!(t instanceof Ho)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return Go(this.localsInner(t))}localsInner(t){if(this==jo)return Fo;if(t.inlineContent||!this.local.some(Bo.is))return this.local;let e=[];for(let t=0;t<this.local.length;t++)this.local[t].type instanceof Bo||e.push(this.local[t]);return e}forEachSet(t){t(this)}}Ho.empty=new Ho([],[]),Ho.removeOverlap=Go;const jo=Ho.empty;class Vo{constructor(t){this.members=t}map(t,e){const n=this.members.map(n=>n.map(t,e,zo));return Vo.from(n)}forChild(t,e){if(e.isLeaf)return Ho.empty;let n=[];for(let r=0;r<this.members.length;r++){let o=this.members[r].forChild(t,e);o!=jo&&(o instanceof Vo?n=n.concat(o.members):n.push(o))}return Vo.from(n)}eq(t){if(!(t instanceof Vo)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,n=!0;for(let r=0;r<this.members.length;r++){let o=this.members[r].localsInner(t);if(o.length)if(e){n&&(e=e.slice(),n=!1);for(let t=0;t<o.length;t++)e.push(o[t])}else e=o}return e?Go(n?e:e.sort(Ko)):Fo}static from(t){switch(t.length){case 0:return jo;case 1:return t[0];default:return new Vo(t.every(t=>t instanceof Ho)?t:t.reduce((t,e)=>t.concat(e instanceof Ho?e:e.members),[]))}}forEachSet(t){for(let e=0;e<this.members.length;e++)this.members[e].forEachSet(t)}}function qo(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let o=t[r];n.push(new Po(o.from+e,o.to+e,o.type))}return n}function Uo(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,o=null;for(let e,i=0;i<t.length;i++)(e=t[i])&&e.from>n&&e.to<r&&((o||(o=[])).push(e),t[i]=null);return o}function Wo(t){let e=[];for(let n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function Jo(t,e,n,r){let o=[],i=!1;e.forEach((e,s)=>{let a=Uo(t,e,s+n);if(a){i=!0;let t=Jo(a,e,n+s+1,r);t!=jo&&o.push(s,s+e.nodeSize,t)}});let s=qo(i?Wo(t):t,-n).sort(Ko);for(let t=0;t<s.length;t++)s[t].type.valid(e,s[t])||(r.onRemove&&r.onRemove(s[t].spec),s.splice(t--,1));return s.length||o.length?new Ho(s,o):jo}function Ko(t,e){return t.from-e.from||t.to-e.to}function Go(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let o=n+1;o<e.length;o++){let i=e[o];if(i.from!=r.from){i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),Yo(e,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(e==t&&(e=t.slice()),e[o]=i.copy(i.from,r.to),Yo(e,o+1,i.copy(r.to,i.to)))}}return e}function Yo(t,e,n){for(;e<t.length&&Ko(n,t[e])>0;)e++;t.splice(e,0,n)}function Zo(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=jo&&e.push(r)}),t.cursorWrapper&&e.push(Ho.create(t.state.doc,[t.cursorWrapper.deco])),Vo.from(e)}const Qo={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Xo=kn&&xn<=11;class ti{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class ei{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new ti,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(t=>{for(let e=0;e<t.length;e++)this.queue.push(t[e]);kn&&xn<=11&&t.some(t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length)?this.flushSoon():this.flush()}),Xo&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Qo)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Lr(this.view)){if(this.suppressingSelectionUpdates)return Er(this.view);if(kn&&xn<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&cn(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let e,n=new Set;for(let e=t.focusNode;e;e=sn(e))n.add(e);for(let r=t.anchorNode;r;r=sn(r))if(n.has(r)){e=r;break}let r=e&&this.view.docView.nearestDesc(e);return r&&r.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let e=this.pendingRecords();e.length&&(this.queue=[]);let n=t.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&Lr(t)&&!this.ignoreSelectionChange(n),o=-1,i=-1,s=!1,a=[];if(t.editable)for(let t=0;t<e.length;t++){let n=this.registerMutation(e[t],a);n&&(o=o<0?n.from:Math.min(n.from,o),i=i<0?n.to:Math.max(n.to,i),n.typeOver&&(s=!0))}if(Cn&&a.length){let e=a.filter(t=>"BR"==t.nodeName);if(2==e.length){let[t,n]=e;t.parentNode&&t.parentNode.parentNode==n.parentNode?n.remove():t.remove()}else{let{focusNode:n}=this.currentSelection;for(let r of e){let e=r.parentNode;!e||"LI"!=e.nodeName||n&&ii(t,n)==e||r.remove()}}}let l=null;o<0&&r&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&fn(n)&&(l=Cr(t))&&l.eq(le.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,Er(t),this.currentSelection.set(n),t.scrollToSelection()):(o>-1||r)&&(o>-1&&(t.docView.markDirty(o,i),function(t){if(!ni.has(t)&&(ni.set(t,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace))){if(t.requiresGeckoHackNode=Cn,ri)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),ri=!0}}(t)),this.handleDOMChange(o,i,s,a),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(n)||Er(t),this.currentSelection.set(n))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let n=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(n==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(t))return null;if("childList"==t.type){for(let n=0;n<t.addedNodes.length;n++){let r=t.addedNodes[n];e.push(r),3==r.nodeType&&(this.lastChangedTextNode=r)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};let r=t.previousSibling,o=t.nextSibling;if(kn&&xn<=11&&t.addedNodes.length)for(let e=0;e<t.addedNodes.length;e++){let{previousSibling:n,nextSibling:i}=t.addedNodes[e];(!n||Array.prototype.indexOf.call(t.addedNodes,n)<0)&&(r=n),(!i||Array.prototype.indexOf.call(t.addedNodes,i)<0)&&(o=i)}let i=r&&r.parentNode==t.target?on(r)+1:0,s=n.localPosFromDOM(t.target,i,-1),a=o&&o.parentNode==t.target?on(o):t.target.childNodes.length;return{from:s,to:n.localPosFromDOM(t.target,a,1)}}return"attributes"==t.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=t.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}let ni=new WeakMap,ri=!1;function oi(t,e){let n=e.startContainer,r=e.startOffset,o=e.endContainer,i=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return cn(s.node,s.offset,o,i)&&([n,r,o,i]=[o,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:o,focusOffset:i}}function ii(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let e=t.docView.nearestDesc(n,!0);if(e&&e.node.isBlock)return n}return null}function si(t){let e=t.pmViewDesc;if(e)return e.parseRule();if("BR"==t.nodeName&&t.parentNode){if(_n&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}if(t.parentNode.lastChild==t||_n&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const ai=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function li(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Ir(t,e.resolve(n.anchor),e.resolve(n.head))}function ci(t,e,n){let r=t.depth,o=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n){let e=t.node(r).maybeChild(t.indexAfter(r));for(;e&&!e.isLeaf;)e=e.firstChild,o++}return o}function ui(t){if(2!=t.length)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class di{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new co,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(mi),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):"function"==typeof t?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=fi(this),pi(this),this.nodeViews=gi(this),this.docView=lr(this.state.doc,hi(this),Zo(this),this.dom,this),this.domObserver=new ei(this,(t,e,n,r)=>function(t,e,n,r,o){let i=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let e=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,n=Cr(t,e);if(n&&!t.state.selection.eq(n)){if(En&&Nn&&13===t.input.lastKeyCode&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",e=>e(t,gn(13,"Enter"))))return;let r=t.state.tr.setSelection(n);"pointer"==e?r.setMeta("pointer",!0):"key"==e&&r.scrollIntoView(),i&&r.setMeta("composition",i),t.dispatch(r)}return}let s=t.state.doc.resolve(e),a=s.sharedDepth(n);e=s.before(a+1),n=t.state.doc.resolve(n).after(a+1);let l,c,u=t.state.selection,h=function(t,e,n){let r,{node:o,fromOffset:i,toOffset:s,from:a,to:l}=t.docView.parseRange(e,n),c=t.domSelectionRange(),u=c.anchorNode;if(u&&t.dom.contains(1==u.nodeType?u:u.parentNode)&&(r=[{node:u,offset:c.anchorOffset}],fn(c)||r.push({node:c.focusNode,offset:c.focusOffset})),En&&8===t.input.lastKeyCode)for(let t=s;t>i;t--){let e=o.childNodes[t-1],n=e.pmViewDesc;if("BR"==e.nodeName&&!n){s=t;break}if(!n||n.size)break}let d=t.state.doc,h=t.someProp("domParser")||nt.fromSchema(t.state.schema),p=d.resolve(a),f=null,g=h.parse(o,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:s,preserveWhitespace:"pre"!=p.parent.type.whitespace||"full",findPositions:r,ruleFromNode:si,context:p});if(r&&null!=r[0].pos){let t=r[0].pos,e=r[1]&&r[1].pos;null==e&&(e=t),f={anchor:t+a,head:e+a}}return{doc:g,sel:f,from:a,to:l}}(t,e,n),p=t.state.doc,f=p.slice(h.from,h.to);8===t.input.lastKeyCode&&Date.now()-100<t.input.lastKeyCodeTime?(l=t.state.selection.to,c="end"):(l=t.state.selection.from,c="start"),t.input.lastKeyCode=null;let g=function(t,e,n,r,o){let i=t.findDiffStart(e,n);if(null==i)return null;let{a:s,b:a}=t.findDiffEnd(e,n+t.size,n+e.size);if("end"==o&&(r-=s+Math.max(0,i-Math.min(s,a))-i),s<i&&t.size<e.size){let t=r<=i&&r>=s?i-r:0;i-=t,i&&i<e.size&&ui(e.textBetween(i-1,i+1))&&(i+=t?1:-1),a=i+(a-s),s=i}else if(a<i){let e=r<=i&&r>=a?i-r:0;i-=e,i&&i<t.size&&ui(t.textBetween(i-1,i+1))&&(i+=e?1:-1),s=i+(s-a),a=i}return{start:i,endA:s,endB:a}}(f.content,h.doc.content,h.from,l,c);if(g&&t.input.domChangeCount++,(Tn&&t.input.lastIOSEnter>Date.now()-225||Nn)&&o.some(t=>1==t.nodeType&&!ai.test(t.nodeName))&&(!g||g.endA>=g.endB)&&t.someProp("handleKeyDown",e=>e(t,gn(13,"Enter"))))return void(t.input.lastIOSEnter=0);if(!g){if(!(r&&u instanceof he&&!u.empty&&u.$head.sameParent(u.$anchor))||t.composing||h.sel&&h.sel.anchor!=h.sel.head){if(h.sel){let e=li(t,t.state.doc,h.sel);if(e&&!e.eq(t.state.selection)){let n=t.state.tr.setSelection(e);i&&n.setMeta("composition",i),t.dispatch(n)}}return}g={start:u.from,endA:u.to,endB:u.to}}t.state.selection.from<t.state.selection.to&&g.start==g.endB&&t.state.selection instanceof he&&(g.start>t.state.selection.from&&g.start<=t.state.selection.from+2&&t.state.selection.from>=h.from?g.start=t.state.selection.from:g.endA<t.state.selection.to&&g.endA>=t.state.selection.to-2&&t.state.selection.to<=h.to&&(g.endB+=t.state.selection.to-g.endA,g.endA=t.state.selection.to)),kn&&xn<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>h.from&&" "==h.doc.textBetween(g.start-h.from-1,g.start-h.from+1)&&(g.start--,g.endA--,g.endB--);let m=h.doc.resolveNoCache(g.start-h.from),y=h.doc.resolveNoCache(g.endB-h.from),b=p.resolve(g.start),v=m.sameParent(y)&&m.parent.inlineContent&&b.end()>=g.endA;if((Tn&&t.input.lastIOSEnter>Date.now()-225&&(!v||o.some(t=>"DIV"==t.nodeName||"P"==t.nodeName))||!v&&m.pos<h.doc.content.size&&(!m.sameParent(y)||!m.parent.inlineContent)&&m.pos<y.pos&&!/\S/.test(h.doc.textBetween(m.pos,y.pos,"","")))&&t.someProp("handleKeyDown",e=>e(t,gn(13,"Enter"))))return void(t.input.lastIOSEnter=0);if(t.state.selection.anchor>g.start&&function(t,e,n,r,o){if(n-e<=o.pos-r.pos||ci(r,!0,!1)<o.pos)return!1;let i=t.resolve(e);if(!r.parent.isTextblock){let t=i.nodeAfter;return null!=t&&n==e+t.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let s=t.resolve(ci(i,!0,!0));return!(!s.parent.isTextblock||s.pos>n||ci(s,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(p,g.start,g.endA,m,y)&&t.someProp("handleKeyDown",e=>e(t,gn(8,"Backspace"))))return void(Nn&&En&&t.domObserver.suppressSelectionUpdates());En&&g.endB==g.start&&(t.input.lastChromeDelete=Date.now()),Nn&&!v&&m.start()!=y.start()&&0==y.parentOffset&&m.depth==y.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==g.endA&&(g.endB-=2,y=h.doc.resolveNoCache(g.endB-h.from),setTimeout(()=>{t.someProp("handleKeyDown",function(e){return e(t,gn(13,"Enter"))})},20));let w,A=g.start,k=g.endA,x=e=>{let n=e||t.state.tr.replace(A,k,h.doc.slice(g.start-h.from,g.endB-h.from));if(h.sel){let e=li(t,n.doc,h.sel);e&&!(En&&t.composing&&e.empty&&(g.start!=g.endB||t.input.lastChromeDelete<Date.now()-100)&&(e.head==A||e.head==n.mapping.map(k)-1)||kn&&e.empty&&e.head==A)&&n.setSelection(e)}return i&&n.setMeta("composition",i),n.scrollIntoView()};if(v)if(m.pos==y.pos){kn&&xn<=11&&0==m.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Er(t),20));let e=x(t.state.tr.delete(A,k)),n=p.resolve(g.start).marksAcross(p.resolve(g.endA));n&&e.ensureMarks(n),t.dispatch(e)}else if(g.endA==g.endB&&(w=function(t,e){let n,r,o,i=t.firstChild.marks,s=e.firstChild.marks,a=i,l=s;for(let t=0;t<s.length;t++)a=s[t].removeFromSet(a);for(let t=0;t<i.length;t++)l=i[t].removeFromSet(l);if(1==a.length&&0==l.length)r=a[0],n="add",o=t=>t.mark(r.addToSet(t.marks));else{if(0!=a.length||1!=l.length)return null;r=l[0],n="remove",o=t=>t.mark(r.removeFromSet(t.marks))}let c=[];for(let t=0;t<e.childCount;t++)c.push(o(e.child(t)));if(d.from(c).eq(t))return{mark:r,type:n}}(m.parent.content.cut(m.parentOffset,y.parentOffset),b.parent.content.cut(b.parentOffset,g.endA-b.start())))){let e=x(t.state.tr);"add"==w.type?e.addMark(A,k,w.mark):e.removeMark(A,k,w.mark),t.dispatch(e)}else if(m.parent.child(m.index()).isText&&m.index()==y.index()-(y.textOffset?0:1)){let e=m.parent.textBetween(m.parentOffset,y.parentOffset),n=()=>x(t.state.tr.insertText(e,A,k));t.someProp("handleTextInput",r=>r(t,A,k,e,n))||t.dispatch(n())}else t.dispatch(x());else t.dispatch(x())}(this,t,e,n,r)),this.domObserver.start(),function(t){for(let e in so){let n=so[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=e=>{!fo(t,e)||po(t,e)||!t.editable&&e.type in ao||n(t,e)},lo[e]?{passive:!0}:void 0)}_n&&t.dom.addEventListener("input",()=>null),ho(t)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&ho(this);let e=this._props;this._props=t,t.plugins&&(t.plugins.forEach(mi),this.directPlugins=t.plugins),this.updateStateInner(t.state,e)}setProps(t){let e={};for(let t in this._props)e[t]=this._props[t];e.state=this.state;for(let n in t)e[n]=t[n];this.update(e)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,e){var n;let r=this.state,o=!1,i=!1;t.storedMarks&&this.composing&&(Eo(this),i=!0),this.state=t;let s=r.plugins!=t.plugins||this._props.plugins!=e.plugins;if(s||this._props.plugins!=e.plugins||this._props.nodeViews!=e.nodeViews){let t=gi(this);(function(t,e){let n=0,r=0;for(let r in t){if(t[r]!=e[r])return!0;n++}for(let t in e)r++;return n!=r})(t,this.nodeViews)&&(this.nodeViews=t,o=!0)}(s||e.handleDOMEvents!=this._props.handleDOMEvents)&&ho(this),this.editable=fi(this),pi(this);let a=Zo(this),l=hi(this),c=r.plugins==t.plugins||r.doc.eq(t.doc)?t.scrollToSelection>r.scrollToSelection?"to selection":"preserve":"reset",u=o||!this.docView.matchesNode(t.doc,l,a);!u&&t.selection.eq(r.selection)||(i=!0);let d="preserve"==c&&i&&null==this.dom.style.overflowAnchor&&function(t){let e,n,r=t.dom.getBoundingClientRect(),o=Math.max(0,r.top);for(let i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){let r=t.root.elementFromPoint(i,s);if(!r||r==t.dom||!t.dom.contains(r))continue;let a=r.getBoundingClientRect();if(a.top>=o-20){e=r,n=a.top;break}}return{refDOM:e,refTop:n,stack:Fn(t.dom)}}(this);if(i){this.domObserver.stop();let e=u&&(kn||En)&&!this.composing&&!r.selection.empty&&!t.selection.empty&&function(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}(r.selection,t.selection);if(u){let n=En?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=function(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=function(t,e){for(;;){if(3==t.nodeType&&e)return t;if(1==t.nodeType&&e>0){if("false"==t.contentEditable)return null;e=hn(t=t.childNodes[e-1])}else{if(!t.parentNode||pn(t))return null;e=on(t),t=t.parentNode}}}(e.focusNode,e.focusOffset),r=function(t,e){for(;;){if(3==t.nodeType&&e<t.nodeValue.length)return t;if(1==t.nodeType&&e<t.childNodes.length){if("false"==t.contentEditable)return null;t=t.childNodes[e],e=0}else{if(!t.parentNode||pn(t))return null;e=on(t)+1,t=t.parentNode}}}(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let e=r.pmViewDesc,o=t.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!e||!e.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let t=n.pmViewDesc;if(t&&t.isText(n.nodeValue))return r}}return n||r}(this)),!o&&this.docView.update(t.doc,l,a,this)||(this.docView.updateOuterDeco(l),this.docView.destroy(),this.docView=lr(t.doc,l,a,this.dom,this)),n&&!this.trackWrites&&(e=!0)}e||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return cn(e.node,e.offset,n.anchorNode,n.anchorOffset)}(this))?Er(this,e):(Or(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),(null===(n=this.dragging)||void 0===n?void 0:n.node)&&!r.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,r),"reset"==c?this.dom.scrollTop=0:"to selection"==c?this.scrollToSelection():d&&function({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;zn(n,0==r?0:r-e)}(d)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(t&&this.dom.contains(1==t.nodeType?t:t.parentNode))if(this.someProp("handleScrollToSelection",t=>t(this)));else if(this.state.selection instanceof fe){let e=this.docView.domAfterPos(this.state.selection.from);1==e.nodeType&&Pn(this,e.getBoundingClientRect(),t)}else Pn(this,this.coordsAtPos(this.state.selection.head,1),t)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let e=0;e<this.pluginViews.length;e++){let n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let e=this.directPlugins[t];e.spec.view&&this.pluginViews.push(e.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let e=this.state.plugins[t];e.spec.view&&this.pluginViews.push(e.spec.view(this))}}}updateDraggedNode(t,e){let n=t.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let t=n.from+(this.state.doc.content.size-e.doc.content.size);(t>0&&this.state.doc.nodeAt(t))==n.node&&(r=t)}this.dragging=new Oo(t.slice,t.move,r<0?void 0:fe.create(this.state.doc,r))}someProp(t,e){let n,r=this._props&&this._props[t];if(null!=r&&(n=e?e(r):r))return n;for(let r=0;r<this.directPlugins.length;r++){let o=this.directPlugins[r].props[t];if(null!=o&&(n=e?e(o):o))return n}let o=this.state.plugins;if(o)for(let r=0;r<o.length;r++){let i=o[r].props[t];if(null!=i&&(n=e?e(i):i))return n}}hasFocus(){if(kn){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if("false"==t.contentEditable)return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(Hn)return t.focus(Hn);let e=Fn(t);t.focus(null==Hn?{get preventScroll(){return Hn={preventScroll:!0},!0}}:void 0),Hn||(Hn=!1,zn(e,0))}(this.dom),Er(this),this.domObserver.start()}get root(){let t=this._root;if(null==t)for(let t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t;return t||document}updateRoot(){this._root=null}posAtCoords(t){return Un(this,t)}coordsAtPos(t,e=1){return Gn(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,n=-1){let r=this.docView.posFromDOM(t,e,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r}endOfTextblock(t,e){return function(t,e,n){return tr==e&&er==n?nr:(tr=e,er=n,nr="up"==n||"down"==n?function(t,e,n){let r=e.selection,o="up"==n?r.$from:r.$to;return Qn(t,e,()=>{let{node:e}=t.docView.domFromPos(o.pos,"up"==n?-1:1);for(;;){let n=t.docView.nearestDesc(e,!0);if(!n)break;if(n.node.isBlock){e=n.contentDOM||n.dom;break}e=n.dom.parentNode}let r=Gn(t,o.pos,1);for(let t=e.firstChild;t;t=t.nextSibling){let e;if(1==t.nodeType)e=t.getClientRects();else{if(3!=t.nodeType)continue;e=ln(t,0,t.nodeValue.length).getClientRects()}for(let t=0;t<e.length;t++){let o=e[t];if(o.bottom>o.top+1&&("up"==n?r.top-o.top>2*(o.bottom-r.top):o.bottom-r.bottom>2*(r.bottom-o.top)))return!1}}return!0})}(t,e,n):function(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=t.domSelection();return a?Xn.test(r.parent.textContent)&&a.modify?Qn(t,e,()=>{let{focusNode:e,focusOffset:o,anchorNode:i,anchorOffset:s}=t.domSelectionRange(),l=a.caretBidiLevel;a.modify("move",n,"character");let c=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:u,focusOffset:d}=t.domSelectionRange(),h=u&&!c.contains(1==u.nodeType?u:u.parentNode)||e==u&&o==d;try{a.collapse(i,s),e&&(e!=i||o!=s)&&a.extend&&a.extend(e,o)}catch(t){}return null!=l&&(a.caretBidiLevel=l),h}):"left"==n||"backward"==n?i:s:r.pos==r.start()||r.pos==r.end()}(t,e,n))}(this,e||this.state,t)}pasteHTML(t,e){return To(this,"",t,!1,e||new ClipboardEvent("paste"))}pasteText(t,e){return To(this,t,null,!0,e||new ClipboardEvent("paste"))}serializeForClipboard(t){return Kr(this,t)}destroy(){this.docView&&(function(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Zo(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,an=null)}get isDestroyed(){return null==this.docView}dispatchEvent(t){return function(t,e){po(t,e)||!so[e.type]||!t.editable&&e.type in ao||so[e.type](t,e)}(this,t)}domSelectionRange(){let t=this.domSelection();return t?_n&&11===this.root.nodeType&&function(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}(this.dom.ownerDocument)==this.dom&&function(t,e){if(e.getComposedRanges){let n=e.getComposedRanges(t.root)[0];if(n)return oi(t,n)}let n;function r(t){t.preventDefault(),t.stopImmediatePropagation(),n=t.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?oi(t,n):null}(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function hi(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if("function"==typeof n&&(n=n(t.state)),n)for(let t in n)"class"==t?e.class+=" "+n[t]:"style"==t?e.style=(e.style?e.style+";":"")+n[t]:e[t]||"contenteditable"==t||"nodeName"==t||(e[t]=String(n[t]))}),e.translate||(e.translate="no"),[Po.node(0,t.state.doc.content.size,e)]}function pi(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Po.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function fi(t){return!t.someProp("editable",e=>!1===e(t.state))}function gi(t){let e=Object.create(null);function n(t){for(let n in t)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=t[n])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function mi(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}di.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};for(var yi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},bi={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},vi="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),wi="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Ai=0;Ai<10;Ai++)yi[48+Ai]=yi[96+Ai]=String(Ai);for(Ai=1;Ai<=24;Ai++)yi[Ai+111]="F"+Ai;for(Ai=65;Ai<=90;Ai++)yi[Ai]=String.fromCharCode(Ai+32),bi[Ai]=String.fromCharCode(Ai);for(var ki in yi)bi.hasOwnProperty(ki)||(bi[ki]=yi[ki]);const xi="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Ci="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function Si(t){let e,n,r,o,i=t.split(/-(?!$)/),s=i[i.length-1];"Space"==s&&(s=" ");for(let t=0;t<i.length-1;t++){let s=i[t];if(/^(cmd|meta|m)$/i.test(s))o=!0;else if(/^a(lt)?$/i.test(s))e=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else if(/^s(hift)?$/i.test(s))r=!0;else{if(!/^mod$/i.test(s))throw new Error("Unrecognized modifier name: "+s);xi?o=!0:n=!0}}return e&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),r&&(s="Shift-"+s),s}function Ei(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function Mi(t){let e=function(t){let e=Object.create(null);for(let n in t)e[Si(n)]=t[n];return e}(t);return function(t,n){let r,o=function(t){var e=!(vi&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||wi&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?bi:yi)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}(n),i=e[Ei(o,n)];if(i&&i(t.state,t.dispatch,t))return!0;if(1==o.length&&" "!=o){if(n.shiftKey){let r=e[Ei(o,n,!1)];if(r&&r(t.state,t.dispatch,t))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(Ci&&n.ctrlKey&&n.altKey)&&(r=yi[n.keyCode])&&r!=o){let o=e[Ei(r,n)];if(o&&o(t.state,t.dispatch,t))return!0}}return!1}}var _i=Object.defineProperty,Ti=(t,e)=>{for(var n in e)_i(t,n,{get:e[n],enumerable:!0})};function Di(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:o}=n,{storedMarks:i}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return o},get tr(){return r=n.selection,o=n.doc,i=n.storedMarks,n}}}var Oi=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){var t=this;const{rawCommands:e,editor:n,state:r}=this,{view:o}=n,{tr:i}=r,s=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(e=>{let[n,r]=e;return[n,function(){const e=r(...arguments)(s);return i.getMeta("preventDispatch")||t.hasCustomState||o.dispatch(i),e}]}))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t){var e=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{rawCommands:r,editor:o,state:i}=this,{view:s}=o,a=[],l=!!t,c=t||i.tr,u={...Object.fromEntries(Object.entries(r).map(t=>{let[r,o]=t;return[r,function(){const t=e.buildProps(c,n),r=o(...arguments)(t);return a.push(r),u}]})),run:()=>(l||!n||c.getMeta("preventDispatch")||this.hasCustomState||s.dispatch(c),a.every(t=>!0===t))};return u}createCan(t){const{rawCommands:e,state:n}=this,r=!1,o=t||n.tr,i=this.buildProps(o,r),s=Object.fromEntries(Object.entries(e).map(t=>{let[e,n]=t;return[e,function(){return n(...arguments)({...i,dispatch:void 0})}]}));return{...s,chain:()=>this.createChain(o,r)}}buildProps(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{rawCommands:n,editor:r,state:o}=this,{view:i}=r,s={tr:t,editor:r,view:i,state:Di({state:o,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(t=>{let[e,n]=t;return[e,function(){return n(...arguments)(s)}]}))}};return s}},Ni={};Ti(Ni,{blur:()=>Ii,clearContent:()=>Li,clearNodes:()=>Ri,command:()=>Bi,createParagraphNear:()=>$i,cut:()=>Pi,deleteCurrentNode:()=>Fi,deleteNode:()=>Hi,deleteRange:()=>ji,deleteSelection:()=>Vi,enter:()=>qi,exitCode:()=>Ui,extendMarkRange:()=>Qi,first:()=>Xi,focus:()=>is,forEach:()=>ss,insertContent:()=>as,insertContentAt:()=>ds,joinBackward:()=>fs,joinDown:()=>ps,joinForward:()=>gs,joinItemBackward:()=>ms,joinItemForward:()=>ys,joinTextblockBackward:()=>bs,joinTextblockForward:()=>vs,joinUp:()=>hs,keyboardShortcut:()=>As,lift:()=>xs,liftEmptyBlock:()=>Cs,liftListItem:()=>Ss,newlineInCode:()=>Es,resetAttributes:()=>Ts,scrollIntoView:()=>Ds,selectAll:()=>Os,selectNodeBackward:()=>Ns,selectNodeForward:()=>Is,selectParentNode:()=>Ls,selectTextblockEnd:()=>Rs,selectTextblockStart:()=>Bs,setContent:()=>Ps,setMark:()=>va,setMeta:()=>wa,setNode:()=>Aa,setNodeSelection:()=>ka,setTextSelection:()=>xa,sinkListItem:()=>Ca,splitBlock:()=>Ea,splitListItem:()=>Ma,toggleList:()=>Da,toggleMark:()=>Oa,toggleNode:()=>Na,toggleWrap:()=>Ia,undoInputRule:()=>La,unsetAllMarks:()=>Ra,unsetMark:()=>Ba,updateAttributes:()=>$a,wrapIn:()=>Pa,wrapInList:()=>Fa});var Ii=()=>t=>{let{editor:e,view:n}=t;return requestAnimationFrame(()=>{var t;e.isDestroyed||(n.dom.blur(),null==(t=null==window?void 0:window.getSelection())||t.removeAllRanges())}),!0},Li=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e=>{let{commands:n}=e;return n.setContent("",{emitUpdate:t})}},Ri=()=>t=>{let{state:e,tr:n,dispatch:r}=t;const{selection:o}=n,{ranges:i}=o;return!r||(i.forEach(t=>{let{$from:r,$to:o}=t;e.doc.nodesBetween(r.pos,o.pos,(t,e)=>{if(t.type.isText)return;const{doc:r,mapping:o}=n,i=r.resolve(o.map(e)),s=r.resolve(o.map(e+t.nodeSize)),a=i.blockRange(s);if(!a)return;const l=Bt(a);if(t.type.isTextblock){const{defaultType:t}=i.parent.contentMatchAt(i.index());n.setNodeMarkup(a.start,t)}(l||0===l)&&n.lift(a,l)})}),!0)},Bi=t=>e=>t(e),$i=()=>t=>{let{state:e,dispatch:n}=t;return Ue(e,n)},Pi=(t,e)=>n=>{let{editor:r,tr:o}=n;const{state:i}=r,s=i.doc.slice(t.from,t.to);o.deleteRange(t.from,t.to);const a=o.mapping.map(e);return o.insert(a,s.content),o.setSelection(new he(o.doc.resolve(Math.max(a-1,0)))),!0},Fi=()=>t=>{let{tr:e,dispatch:n}=t;const{selection:r}=e,o=r.$anchor.node();if(o.content.size>0)return!1;const i=e.selection.$anchor;for(let t=i.depth;t>0;t-=1)if(i.node(t).type===o.type){if(n){const n=i.before(t),r=i.after(t);e.delete(n,r).scrollIntoView()}return!0}return!1};function zi(t,e){if("string"==typeof t){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var Hi=t=>e=>{let{tr:n,state:r,dispatch:o}=e;const i=zi(t,r.schema),s=n.selection.$anchor;for(let t=s.depth;t>0;t-=1)if(s.node(t).type===i){if(o){const e=s.before(t),r=s.after(t);n.delete(e,r).scrollIntoView()}return!0}return!1},ji=t=>e=>{let{tr:n,dispatch:r}=e;const{from:o,to:i}=t;return r&&n.delete(o,i),!0},Vi=()=>t=>{let{state:e,dispatch:n}=t;return Oe(e,n)},qi=()=>t=>{let{commands:e}=t;return e.keyboardShortcut("Enter")},Ui=()=>t=>{let{state:e,dispatch:n}=t;return qe(e,n)};function Wi(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function Ji(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{strict:!0};const r=Object.keys(e);return!r.length||r.every(r=>n.strict?e[r]===t[r]:Wi(e[r])?e[r].test(t[r]):e[r]===t[r])}function Ki(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.find(t=>t.type===e&&Ji(Object.fromEntries(Object.keys(n).map(e=>[e,t.attrs[e]])),n))}function Gi(t,e){return!!Ki(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}function Yi(t,e,n){var r;if(!t||!e)return;let o=t.parent.childAfter(t.parentOffset);if(o.node&&o.node.marks.some(t=>t.type===e)||(o=t.parent.childBefore(t.parentOffset)),!o.node||!o.node.marks.some(t=>t.type===e))return;if(n=n||(null==(r=o.node.marks[0])?void 0:r.attrs),!Ki([...o.node.marks],e,n))return;let i=o.index,s=t.start()+o.offset,a=i+1,l=s+o.node.nodeSize;for(;i>0&&Gi([...t.parent.child(i-1).marks],e,n);)i-=1,s-=t.parent.child(i).nodeSize;for(;a<t.parent.childCount&&Gi([...t.parent.child(a).marks],e,n);)l+=t.parent.child(a).nodeSize,a+=1;return{from:s,to:l}}function Zi(t,e){if("string"==typeof t){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var Qi=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:o,dispatch:i}=n;const s=Zi(t,o.schema),{doc:a,selection:l}=r,{$from:c,from:u,to:d}=l;if(i){const t=Yi(c,s,e);if(t&&t.from<=u&&t.to>=d){const e=he.create(a,t.from,t.to);r.setSelection(e)}}return!0}},Xi=t=>e=>{const n="function"==typeof t?t(e):t;for(let t=0;t<n.length;t+=1)if(n[t](e))return!0;return!1};function ts(t){return t instanceof he}function es(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.min(Math.max(t,e),n)}function ns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return null;const n=le.atStart(t),r=le.atEnd(t);if("start"===e||!0===e)return n;if("end"===e)return r;const o=n.from,i=r.to;return"all"===e?he.create(t,es(0,o,i),es(t.content.size,o,i)):he.create(t,es(e,o,i),es(e,o,i))}function rs(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var is=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{editor:r,view:o,tr:i,dispatch:s}=n;e={scrollIntoView:!0,...e};const a=()=>{(rs()||"Android"===navigator.platform||/android/i.test(navigator.userAgent))&&o.dom.focus(),requestAnimationFrame(()=>{r.isDestroyed||(o.focus(),(null==e?void 0:e.scrollIntoView)&&r.commands.scrollIntoView())})};if(o.hasFocus()&&null===t||!1===t)return!0;if(s&&null===t&&!ts(r.state.selection))return a(),!0;const l=ns(i.doc,t)||r.state.selection,c=r.state.selection.eq(l);return s&&(c||i.setSelection(l),c&&i.storedMarks&&i.setStoredMarks(i.storedMarks),a()),!0}},ss=(t,e)=>n=>t.every((t,r)=>e(t,{...n,index:r})),as=(t,e)=>n=>{let{tr:r,commands:o}=n;return o.insertContentAt({from:r.selection.from,to:r.selection.to},t,e)},ls=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];3===r.nodeType&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):1===r.nodeType&&ls(r)}return t};function cs(t){if("undefined"==typeof window)throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=(new window.DOMParser).parseFromString(e,"text/html").body;return ls(n)}function us(t,e,n){if(t instanceof R||t instanceof d)return t;n={slice:!0,parseOptions:{},...n};const r="string"==typeof t;if("object"==typeof t&&null!==t)try{if(Array.isArray(t)&&t.length>0)return d.fromArray(t.map(t=>e.nodeFromJSON(t)));const r=e.nodeFromJSON(t);return n.errorOnInvalidContent&&r.check(),r}catch(r){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:r});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",r),us("",e,n)}if(r){if(n.errorOnInvalidContent){let r=!1,o="";const i=new tt({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:t=>(r=!0,o="string"==typeof t?t:t.outerHTML,null)}]}})});if(n.slice?nt.fromSchema(i).parseSlice(cs(t),n.parseOptions):nt.fromSchema(i).parse(cs(t),n.parseOptions),n.errorOnInvalidContent&&r)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}const r=nt.fromSchema(e);return n.slice?r.parseSlice(cs(t),n.parseOptions).content:r.parse(cs(t),n.parseOptions)}return us("",e,n)}var ds=(t,e,n)=>r=>{let{tr:o,dispatch:i,editor:s}=r;var a;if(i){let r;const i=t=>{s.emit("contentError",{editor:s,error:t,disableCollaboration:()=>{"collaboration"in s.storage&&"object"==typeof s.storage.collaboration&&s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},l={preserveWhitespace:"full",...(n={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n}).parseOptions};if(!n.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{us(e,s.schema,{parseOptions:l,errorOnInvalidContent:!0})}catch(t){i(t)}try{r=us(e,s.schema,{parseOptions:l,errorOnInvalidContent:null!=(a=n.errorOnInvalidContent)?a:s.options.enableContentCheck})}catch(t){return i(t),!1}let c,{from:u,to:h}="number"==typeof t?{from:t,to:t}:{from:t.from,to:t.to},p=!0,f=!0;if(("type"in r?[r]:r).forEach(t=>{t.check(),p=!!p&&t.isText&&0===t.marks.length,f=!!f&&t.isBlock}),u===h&&f){const{parent:t}=o.doc.resolve(u);t.isTextblock&&!t.type.spec.code&&!t.childCount&&(u-=1,h+=1)}if(p){if(Array.isArray(e))c=e.map(t=>t.text||"").join("");else if(e instanceof d){let t="";e.forEach(e=>{e.text&&(t+=e.text)}),c=t}else c="object"==typeof e&&e&&e.text?e.text:e;o.insertText(c,u,h)}else{c=r;const t=o.doc.resolve(u),e=t.node(),n=0===t.parentOffset,i=e.isText||e.isTextblock,s=e.content.size>0;n&&i&&s&&(u=Math.max(0,u-1)),o.replaceWith(u,h,c)}n.updateSelection&&function(t,e){const n=t.steps.length-1;if(n<e)return;const r=t.steps[n];if(!(r instanceof Ot||r instanceof Nt))return;const o=t.mapping.maps[n];let i=0;o.forEach((t,e,n,r)=>{0===i&&(i=r)}),t.setSelection(le.near(t.doc.resolve(i),-1))}(o,o.steps.length-1),n.applyInputRules&&o.setMeta("applyInputRules",{from:u,text:c}),n.applyPasteRules&&o.setMeta("applyPasteRules",{from:u,text:c})}return!0},hs=()=>t=>{let{state:e,dispatch:n}=t;return((t,e)=>{let n,r=t.selection,o=r instanceof fe;if(o){if(r.node.isTextblock||!jt(t.doc,r.from))return!1;n=r.from}else if(n=qt(t.doc,r.from,-1),null==n)return!1;if(e){let r=t.tr.join(n);o&&r.setSelection(fe.create(r.doc,n-t.doc.resolve(n).nodeBefore.nodeSize)),e(r.scrollIntoView())}return!0})(e,n)},ps=()=>t=>{let{state:e,dispatch:n}=t;return((t,e)=>{let n,r=t.selection;if(r instanceof fe){if(r.node.isTextblock||!jt(t.doc,r.to))return!1;n=r.to}else if(n=qt(t.doc,r.to,1),null==n)return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0})(e,n)},fs=()=>t=>{let{state:e,dispatch:n}=t;return Ie(e,n)},gs=()=>t=>{let{state:e,dispatch:n}=t;return Fe(e,n)},ms=()=>t=>{let{state:e,dispatch:n,tr:r}=t;try{const t=qt(e.doc,e.selection.$from.pos,-1);return null!=t&&(r.join(t,2),n&&n(r),!0)}catch{return!1}},ys=()=>t=>{let{state:e,dispatch:n,tr:r}=t;try{const t=qt(e.doc,e.selection.$from.pos,1);return null!=t&&(r.join(t,2),n&&n(r),!0)}catch{return!1}},bs=()=>t=>{let{state:e,dispatch:n}=t;return((t,e)=>{let n=Ne(t,void 0);if(!n)return!1;let r=$e(n);return!!r&&Le(t,r,e)})(e,n)},vs=()=>t=>{let{state:e,dispatch:n}=t;return((t,e)=>{let n=Pe(t,void 0);if(!n)return!1;let r=He(n);return!!r&&Le(t,r,e)})(e,n)};function ws(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}var As=t=>e=>{let{editor:n,view:r,tr:o,dispatch:i}=e;const s=function(t){const e=t.split(/-(?!$)/);let n,r,o,i,s=e[e.length-1];"Space"===s&&(s=" ");for(let t=0;t<e.length-1;t+=1){const s=e[t];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))n=!0;else if(/^(c|ctrl|control)$/i.test(s))r=!0;else if(/^s(hift)?$/i.test(s))o=!0;else{if(!/^mod$/i.test(s))throw new Error(`Unrecognized modifier name: ${s}`);rs()||ws()?i=!0:r=!0}}return n&&(s=`Alt-${s}`),r&&(s=`Ctrl-${s}`),i&&(s=`Meta-${s}`),o&&(s=`Shift-${s}`),s}(t).split(/-(?!$)/),a=s.find(t=>!["Alt","Ctrl","Meta","Shift"].includes(t)),l=new KeyboardEvent("keydown",{key:"Space"===a?" ":a,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),c=n.captureTransaction(()=>{r.someProp("handleKeyDown",t=>t(r,l))});return null==c||c.steps.forEach(t=>{const e=t.map(o.mapping);e&&i&&o.maybeStep(e)}),!0};function ks(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{from:r,to:o,empty:i}=t.selection,s=e?zi(e,t.schema):null,a=[];t.doc.nodesBetween(r,o,(t,e)=>{if(t.isText)return;const n=Math.max(r,e),i=Math.min(o,e+t.nodeSize);a.push({node:t,from:n,to:i})});const l=o-r,c=a.filter(t=>!s||s.name===t.node.type.name).filter(t=>Ji(t.node.attrs,n,{strict:!1}));return i?!!c.length:c.reduce((t,e)=>t+e.to-e.from,0)>=l}var xs=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,dispatch:o}=n;return!!ks(r,zi(t,r.schema),e)&&((t,e)=>{let{$from:n,$to:r}=t.selection,o=n.blockRange(r),i=o&&Bt(o);return null!=i&&(e&&e(t.tr.lift(o,i).scrollIntoView()),!0)})(r,o)}},Cs=()=>t=>{let{state:e,dispatch:n}=t;return We(e,n)},Ss=t=>e=>{let{state:n,dispatch:r}=e;return(o=zi(t,n.schema),function(t,e){let{$from:n,$to:r}=t.selection,i=n.blockRange(r,t=>t.childCount>0&&t.firstChild.type==o);return!!i&&(!e||(n.node(i.depth-1).type==o?function(t,e,n,r){let o=t.tr,i=r.end,s=r.$to.end(r.depth);i<s&&(o.step(new Nt(i-1,s,i,s,new y(d.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new I(o.doc.resolve(r.$from.pos),o.doc.resolve(s),r.depth));const a=Bt(r);if(null==a)return!1;o.lift(r,a);let l=o.doc.resolve(o.mapping.map(i,-1)-1);return jt(o.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&o.join(l.pos),e(o.scrollIntoView()),!0}(t,e,o,i):function(t,e,n){let r=t.tr,o=n.parent;for(let t=n.end,e=n.endIndex-1,i=n.startIndex;e>i;e--)t-=o.child(e).nodeSize,r.delete(t-1,t+1);let i=r.doc.resolve(n.start),s=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,l=n.endIndex==o.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(a?0:1),u+1,s.content.append(l?d.empty:d.from(o))))return!1;let h=i.pos,p=h+s.nodeSize;return r.step(new Nt(h-(a?1:0),p+(l?1:0),h+1,p-1,new y((a?d.empty:d.from(o.copy(d.empty))).append(l?d.empty:d.from(o.copy(d.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}(t,e,i)))})(n,r);var o},Es=()=>t=>{let{state:e,dispatch:n}=t;return je(e,n)};function Ms(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function _s(t,e){const n="string"==typeof e?[e]:e;return Object.keys(t).reduce((e,r)=>(n.includes(r)||(e[r]=t[r]),e),{})}var Ts=(t,e)=>n=>{let{tr:r,state:o,dispatch:i}=n,s=null,a=null;const l=Ms("string"==typeof t?t:t.name,o.schema);return!!l&&("node"===l&&(s=zi(t,o.schema)),"mark"===l&&(a=Zi(t,o.schema)),i&&r.selection.ranges.forEach(t=>{o.doc.nodesBetween(t.$from.pos,t.$to.pos,(t,n)=>{s&&s===t.type&&r.setNodeMarkup(n,void 0,_s(t.attrs,e)),a&&t.marks.length&&t.marks.forEach(o=>{a===o.type&&r.addMark(n,n+t.nodeSize,a.create(_s(o.attrs,e)))})})}),!0)},Ds=()=>t=>{let{tr:e,dispatch:n}=t;return n&&e.scrollIntoView(),!0},Os=()=>t=>{let{tr:e,dispatch:n}=t;if(n){const t=new me(e.doc);e.setSelection(t)}return!0},Ns=()=>t=>{let{state:e,dispatch:n}=t;return Be(e,n)},Is=()=>t=>{let{state:e,dispatch:n}=t;return ze(e,n)},Ls=()=>t=>{let{state:e,dispatch:n}=t;return((t,e)=>{let n,{$from:r,to:o}=t.selection,i=r.sharedDepth(o);return 0!=i&&(n=r.before(i),e&&e(t.tr.setSelection(fe.create(t.doc,n))),!0)})(e,n)},Rs=()=>t=>{let{state:e,dispatch:n}=t;return Ze(e,n)},Bs=()=>t=>{let{state:e,dispatch:n}=t;return Ye(e,n)};function $s(t,e){return us(t,e,{slice:!1,parseOptions:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},errorOnInvalidContent:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).errorOnInvalidContent})}var Ps=function(t){let{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:r={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o=>{let{editor:i,tr:s,dispatch:a,commands:l}=o;const{doc:c}=s;if("full"!==r.preserveWhitespace){const o=$s(t,i.schema,r,{errorOnInvalidContent:null!=e?e:i.options.enableContentCheck});return a&&s.replaceWith(0,c.content.size,o).setMeta("preventUpdate",!n),!0}return a&&s.setMeta("preventUpdate",!n),l.insertContentAt({from:0,to:c.content.size},t,{parseOptions:r,errorOnInvalidContent:null!=e?e:i.options.enableContentCheck})}};function Fs(t,e){const n=Zi(e,t.schema),{from:r,to:o,empty:i}=t.selection,s=[];i?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,o,t=>{s.push(...t.marks)});const a=s.find(t=>t.type.name===n.name);return a?{...a.attrs}:{}}function zs(t,e){const n=new se(t);return e.forEach(t=>{t.steps.forEach(t=>{n.step(t)})}),n}function Hs(t,e){const n=[];return t.descendants((t,r)=>{e(t)&&n.push({node:t,pos:r})}),n}function js(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(t,e)=>{n(t)&&r.push({node:t,pos:e})}),r}function Vs(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function qs(t){return e=>Vs(e.$from,t)}function Us(t,e,n){return void 0===t.config[e]&&t.parent?Us(t.parent,e,n):"function"==typeof t.config[e]?t.config[e].bind({...n,parent:t.parent?Us(t.parent,e,n):null}):t.config[e]}function Ws(t){return t.map(t=>{const e=Us(t,"addExtensions",{name:t.name,options:t.options,storage:t.storage});return e?[t,...Ws(e())]:t}).flat(10)}function Js(t,e){const n=ht.fromSchema(e).serializeFragment(t),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function Ks(t){return"function"==typeof t}function Gs(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(Ks(t)){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return e?t.bind(e)(...r):t(...r)}return t}function Ys(t){return{baseExtensions:t.filter(t=>"extension"===t.type),nodeExtensions:t.filter(t=>"node"===t.type),markExtensions:t.filter(t=>"mark"===t.type)}}function Zs(t){const e=[],{nodeExtensions:n,markExtensions:r}=Ys(t),o=[...n,...r],i={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(t=>{const n=Us(t,"addGlobalAttributes",{name:t.name,options:t.options,storage:t.storage,extensions:o});n&&n().forEach(t=>{t.types.forEach(n=>{Object.entries(t.attributes).forEach(t=>{let[r,o]=t;e.push({type:n,name:r,attribute:{...i,...o}})})})})}),o.forEach(t=>{const n={name:t.name,options:t.options,storage:t.storage},r=Us(t,"addAttributes",n);if(!r)return;const o=r();Object.entries(o).forEach(n=>{let[r,o]=n;const s={...i,...o};"function"==typeof(null==s?void 0:s.default)&&(s.default=s.default()),(null==s?void 0:s.isRequired)&&void 0===(null==s?void 0:s.default)&&delete s.default,e.push({type:t.name,name:r,attribute:s})})}),e}function Qs(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.filter(t=>!!t).reduce((t,e)=>{const n={...t};return Object.entries(e).forEach(t=>{let[e,r]=t;if(n[e])if("class"===e){const t=r?String(r).split(" "):[],o=n[e]?n[e].split(" "):[],i=t.filter(t=>!o.includes(t));n[e]=[...o,...i].join(" ")}else if("style"===e){const t=r?r.split(";").map(t=>t.trim()).filter(Boolean):[],o=n[e]?n[e].split(";").map(t=>t.trim()).filter(Boolean):[],i=new Map;o.forEach(t=>{const[e,n]=t.split(":").map(t=>t.trim());i.set(e,n)}),t.forEach(t=>{const[e,n]=t.split(":").map(t=>t.trim());i.set(e,n)}),n[e]=Array.from(i.entries()).map(t=>{let[e,n]=t;return`${e}: ${n}`}).join("; ")}else n[e]=r;else n[e]=r}),n},{})}function Xs(t,e){return e.filter(e=>e.type===t.type.name).filter(t=>t.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(t.attrs)||{}:{[e.name]:t.attrs[e.name]}).reduce((t,e)=>Qs(t,e),{})}function ta(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(!1===r)return!1;const o=e.reduce((t,e)=>{const r=e.attribute.parseHTML?e.attribute.parseHTML(n):function(t){return"string"!=typeof t?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):"true"===t||"false"!==t&&t}(n.getAttribute(e.name));return null==r?t:{...t,[e.name]:r}},{});return{...r,...o}}}}function ea(t){return Object.fromEntries(Object.entries(t).filter(t=>{let[e,n]=t;return("attrs"!==e||!function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===Object.keys(t).length&&t.constructor===Object}(n))&&null!=n}))}function na(t,e){var n;const r=Zs(t),{nodeExtensions:o,markExtensions:i}=Ys(t),s=null==(n=o.find(t=>Us(t,"topNode")))?void 0:n.name,a=Object.fromEntries(o.map(n=>{const o=r.filter(t=>t.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:e},s=ea({...t.reduce((t,e)=>{const r=Us(e,"extendNodeSchema",i);return{...t,...r?r(n):{}}},{}),content:Gs(Us(n,"content",i)),marks:Gs(Us(n,"marks",i)),group:Gs(Us(n,"group",i)),inline:Gs(Us(n,"inline",i)),atom:Gs(Us(n,"atom",i)),selectable:Gs(Us(n,"selectable",i)),draggable:Gs(Us(n,"draggable",i)),code:Gs(Us(n,"code",i)),whitespace:Gs(Us(n,"whitespace",i)),linebreakReplacement:Gs(Us(n,"linebreakReplacement",i)),defining:Gs(Us(n,"defining",i)),isolating:Gs(Us(n,"isolating",i)),attrs:Object.fromEntries(o.map(t=>{var e,n;return[t.name,{default:null==(e=null==t?void 0:t.attribute)?void 0:e.default,validate:null==(n=null==t?void 0:t.attribute)?void 0:n.validate}]}))}),a=Gs(Us(n,"parseHTML",i));a&&(s.parseDOM=a.map(t=>ta(t,o)));const l=Us(n,"renderHTML",i);l&&(s.toDOM=t=>l({node:t,HTMLAttributes:Xs(t,o)}));const c=Us(n,"renderText",i);return c&&(s.toText=c),[n.name,s]})),l=Object.fromEntries(i.map(n=>{const o=r.filter(t=>t.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:e},s=ea({...t.reduce((t,e)=>{const r=Us(e,"extendMarkSchema",i);return{...t,...r?r(n):{}}},{}),inclusive:Gs(Us(n,"inclusive",i)),excludes:Gs(Us(n,"excludes",i)),group:Gs(Us(n,"group",i)),spanning:Gs(Us(n,"spanning",i)),code:Gs(Us(n,"code",i)),attrs:Object.fromEntries(o.map(t=>{var e,n;return[t.name,{default:null==(e=null==t?void 0:t.attribute)?void 0:e.default,validate:null==(n=null==t?void 0:t.attribute)?void 0:n.validate}]}))}),a=Gs(Us(n,"parseHTML",i));a&&(s.parseDOM=a.map(t=>ta(t,o)));const l=Us(n,"renderHTML",i);return l&&(s.toDOM=t=>l({mark:t,HTMLAttributes:Xs(t,o)})),[n.name,s]}));return new tt({topNode:s,nodes:a,marks:l})}function ra(t){return t.sort((t,e)=>{const n=Us(t,"priority")||100,r=Us(e,"priority")||100;return n>r?-1:n<r?1:0})}function oa(t){const e=ra(Ws(t)),n=function(t){const e=t.filter((e,n)=>t.indexOf(e)!==n);return Array.from(new Set(e))}(e.map(t=>t.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(t=>`'${t}'`).join(", ")}]. This can lead to issues.`),e}function ia(t,e,n){const{from:r,to:o}=e,{blockSeparator:i="\n\n",textSerializers:s={}}=n||{};let a="";return t.nodesBetween(r,o,(t,n,l,c)=>{var u;t.isBlock&&n>r&&(a+=i);const d=null==s?void 0:s[t.type.name];if(d)return l&&(a+=d({node:t,pos:n,parent:l,index:c,range:e})),!1;t.isText&&(a+=null==(u=null==t?void 0:t.text)?void 0:u.slice(Math.max(r,n)-n,o-n))}),a}function sa(t,e){return ia(t,{from:0,to:t.content.size},e)}function aa(t){return Object.fromEntries(Object.entries(t.nodes).filter(t=>{let[,e]=t;return e.spec.toText}).map(t=>{let[e,n]=t;return[e,n.spec.toText]}))}function la(t,e){const n=Ms("string"==typeof e?e:e.name,t.schema);return"node"===n?function(t,e){const n=zi(e,t.schema),{from:r,to:o}=t.selection,i=[];t.doc.nodesBetween(r,o,t=>{i.push(t)});const s=i.reverse().find(t=>t.type.name===n.name);return s?{...s.attrs}:{}}(t,e):"mark"===n?Fs(t,e):{}}function ca(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((t,o)=>{const i=[];if(t.ranges.length)t.forEach((t,e)=>{i.push({from:t,to:e})});else{const{from:t,to:e}=n[o];if(void 0===t||void 0===e)return;i.push({from:t,to:e})}i.forEach(t=>{let{from:n,to:i}=t;const s=e.slice(o).map(n,-1),a=e.slice(o).map(i),l=e.invert().map(s,-1),c=e.invert().map(a);r.push({oldRange:{from:l,to:c},newRange:{from:s,to:a}})})}),function(t){const e=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.stringify;const n={};return t.filter(t=>{const r=e(t);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)})}(t);return 1===e.length?e:e.filter((t,n)=>{const r=e.filter((t,e)=>e!==n);return!r.some(e=>t.oldRange.from>=e.oldRange.from&&t.oldRange.to<=e.oldRange.to&&t.newRange.from>=e.newRange.from&&t.newRange.to<=e.newRange.to)})}(r)}function ua(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(e=>{const o=Yi(n.resolve(t),e.type);o&&r.push({mark:e,...o})}):n.nodesBetween(t,e,(t,e)=>{t&&void 0!==(null==t?void 0:t.nodeSize)&&r.push(...t.marks.map(n=>({from:e,to:e+t.nodeSize,mark:n})))}),r}function da(t,e){return e.nodes[t]||e.marks[t]||null}function ha(t,e,n){return Object.fromEntries(Object.entries(n).filter(n=>{let[r]=n;const o=t.find(t=>t.type===e&&t.name===r);return!!o&&o.attribute.keepOnSplit}))}function pa(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{empty:r,ranges:o}=t.selection,i=e?Zi(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(t=>!i||i.name===t.type.name).find(t=>Ji(t.attrs,n,{strict:!1}));let s=0;const a=[];if(o.forEach(e=>{let{$from:n,$to:r}=e;const o=n.pos,i=r.pos;t.doc.nodesBetween(o,i,(t,e)=>{if(!t.isText&&!t.marks.length)return;const n=Math.max(o,e),r=Math.min(i,e+t.nodeSize);s+=r-n,a.push(...t.marks.map(t=>({mark:t,from:n,to:r})))})}),0===s)return!1;const l=a.filter(t=>!i||i.name===t.mark.type.name).filter(t=>Ji(t.mark.attrs,n,{strict:!1})).reduce((t,e)=>t+e.to-e.from,0),c=a.filter(t=>!i||t.mark.type!==i&&t.mark.type.excludes(i)).reduce((t,e)=>t+e.to-e.from,0);return(l>0?l+c:l)>=s}function fa(t,e){return Array.isArray(e)?e.some(e=>("string"==typeof e?e:e.name)===t.name):e}function ga(t,e){const{nodeExtensions:n}=Ys(e),r=n.find(e=>e.name===t);if(!r)return!1;const o=Gs(Us(r,"group",{name:r.name,options:r.options,storage:r.storage}));return"string"==typeof o&&o.split(" ").includes("list")}function ma(t){let{checkChildren:e=!0,ignoreWhitespace:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;if(n){if("hardBreak"===t.type.name)return!0;if(t.isText)return/^\s*$/m.test(null!=(r=t.text)?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(0===t.content.childCount)return!0;if(e){let r=!0;return t.content.forEach(t=>{!1!==r&&(ma(t,{ignoreWhitespace:n,checkChildren:e})||(r=!1))}),r}return!1}function ya(t){return t instanceof fe}function ba(t,e,n){const r=t.state.doc.content.size,o=es(e,0,r),i=es(n,0,r),s=t.coordsAtPos(o),a=t.coordsAtPos(i,-1),l=Math.min(s.top,a.top),c=Math.max(s.bottom,a.bottom),u=Math.min(s.left,a.left),d=Math.max(s.right,a.right),h={top:l,bottom:c,left:u,right:d,width:d-u,height:c-l,x:u,y:l};return{...h,toJSON:()=>h}}var va=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:o,dispatch:i}=n;const{selection:s}=r,{empty:a,ranges:l}=s,c=Zi(t,o.schema);if(i)if(a){const t=Fs(o,c);r.addStoredMark(c.create({...t,...e}))}else l.forEach(t=>{const n=t.$from.pos,i=t.$to.pos;o.doc.nodesBetween(n,i,(t,o)=>{const s=Math.max(o,n),a=Math.min(o+t.nodeSize,i);t.marks.find(t=>t.type===c)?t.marks.forEach(t=>{c===t.type&&r.addMark(s,a,c.create({...t.attrs,...e}))}):r.addMark(s,a,c.create(e))})});return function(t,e,n){var r;const{selection:o}=e;let i=null;if(ts(o)&&(i=o.$cursor),i){const e=null!=(r=t.storedMarks)?r:i.marks();return i.parent.type.allowsMarkType(n)&&(!!n.isInSet(e)||!e.some(t=>t.type.excludes(n)))}const{ranges:s}=o;return s.some(e=>{let{$from:r,$to:o}=e,i=0===r.depth&&t.doc.inlineContent&&t.doc.type.allowsMarkType(n);return t.doc.nodesBetween(r.pos,o.pos,(t,e,r)=>{if(i)return!1;if(t.isInline){const e=!r||r.type.allowsMarkType(n),o=!!n.isInSet(t.marks)||!t.marks.some(t=>t.type.excludes(n));i=e&&o}return!i}),i})}(o,r,c)}},wa=(t,e)=>n=>{let{tr:r}=n;return r.setMeta(t,e),!0},Aa=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,dispatch:o,chain:i}=n;const s=zi(t,r.schema);let a;return r.selection.$anchor.sameParent(r.selection.$head)&&(a=r.selection.$anchor.parent.attrs),s.isTextblock?i().command(t=>{let{commands:n}=t;return!!Qe(s,{...a,...e})(r)||n.clearNodes()}).command(t=>{let{state:n}=t;return Qe(s,{...a,...e})(n,o)}).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)}},ka=t=>e=>{let{tr:n,dispatch:r}=e;if(r){const{doc:e}=n,r=es(t,0,e.content.size),o=fe.create(e,r);n.setSelection(o)}return!0},xa=t=>e=>{let{tr:n,dispatch:r}=e;if(r){const{doc:e}=n,{from:r,to:o}="number"==typeof t?{from:t,to:t}:t,i=he.atStart(e).from,s=he.atEnd(e).to,a=es(r,i,s),l=es(o,i,s),c=he.create(e,a,l);n.setSelection(c)}return!0},Ca=t=>e=>{let{state:n,dispatch:r}=e;const o=zi(t,n.schema);return(i=o,function(t,e){let{$from:n,$to:r}=t.selection,o=n.blockRange(r,t=>t.childCount>0&&t.firstChild.type==i);if(!o)return!1;let s=o.startIndex;if(0==s)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=i)return!1;if(e){let n=l.lastChild&&l.lastChild.type==a.type,r=d.from(n?i.create():null),s=new y(d.from(i.create(null,d.from(a.type.create(null,r)))),n?3:1,0),c=o.start,u=o.end;e(t.tr.step(new Nt(c-(n?3:1),u,c,u,s,1,!0)).scrollIntoView())}return!0})(n,r);var i};function Sa(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(t=>null==e?void 0:e.includes(t.type.name));t.tr.ensureMarks(r)}}var Ea=function(){let{keepMarks:t=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=>{let{tr:n,state:r,dispatch:o,editor:i}=e;const{selection:s,doc:a}=n,{$from:l,$to:c}=s,u=ha(i.extensionManager.attributes,l.node().type.name,l.node().attrs);if(s instanceof fe&&s.node.isBlock)return!(!l.parentOffset||!Ht(a,l.pos)||(o&&(t&&Sa(r,i.extensionManager.splittableMarks),n.split(l.pos).scrollIntoView()),0));if(!l.parent.isBlock)return!1;const d=c.parentOffset===c.parent.content.size,h=0===l.depth?void 0:function(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(l.node(-1).contentMatchAt(l.indexAfter(-1)));let p=d&&h?[{type:h,attrs:u}]:void 0,f=Ht(n.doc,n.mapping.map(l.pos),1,p);if(p||f||!Ht(n.doc,n.mapping.map(l.pos),1,h?[{type:h}]:void 0)||(f=!0,p=h?[{type:h,attrs:u}]:void 0),o){if(f&&(s instanceof he&&n.deleteSelection(),n.split(n.mapping.map(l.pos),1,p),h&&!d&&!l.parentOffset&&l.parent.type!==h)){const t=n.mapping.map(l.before()),e=n.doc.resolve(t);l.node(-1).canReplaceWith(e.index(),e.index()+1,h)&&n.setNodeMarkup(n.mapping.map(l.before()),h)}t&&Sa(r,i.extensionManager.splittableMarks),n.scrollIntoView()}return f}},Ma=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:o,dispatch:i,editor:s}=n;var a;const l=zi(t,o.schema),{$from:c,$to:u}=o.selection,h=o.selection.node;if(h&&h.isBlock||c.depth<2||!c.sameParent(u))return!1;const p=c.node(-1);if(p.type!==l)return!1;const f=s.extensionManager.attributes;if(0===c.parent.content.size&&c.node(-1).childCount===c.indexAfter(-1)){if(2===c.depth||c.node(-3).type!==l||c.index(-2)!==c.node(-2).childCount-1)return!1;if(i){let t=d.empty;const n=c.index(-1)?1:c.index(-2)?2:3;for(let e=c.depth-n;e>=c.depth-3;e-=1)t=d.from(c.node(e).copy(t));const o=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,i={...ha(f,c.node().type.name,c.node().attrs),...e},s=(null==(a=l.contentMatch.defaultType)?void 0:a.createAndFill(i))||void 0;t=t.append(d.from(l.createAndFill(null,s)||void 0));const u=c.before(c.depth-(n-1));r.replace(u,c.after(-o),new y(t,4-n,0));let h=-1;r.doc.nodesBetween(u,r.doc.content.size,(t,e)=>{if(h>-1)return!1;t.isTextblock&&0===t.content.size&&(h=e+1)}),h>-1&&r.setSelection(he.near(r.doc.resolve(h))),r.scrollIntoView()}return!0}const g=u.pos===c.end()?p.contentMatchAt(0).defaultType:null,m={...ha(f,p.type.name,p.attrs),...e},b={...ha(f,c.node().type.name,c.node().attrs),...e};r.delete(c.pos,u.pos);const v=g?[{type:l,attrs:m},{type:g,attrs:b}]:[{type:l,attrs:m}];if(!Ht(r.doc,c.pos,2))return!1;if(i){const{selection:t,storedMarks:e}=o,{splittableMarks:n}=s.extensionManager,a=e||t.$to.parentOffset&&t.$from.marks();if(r.split(c.pos,2,v).scrollIntoView(),!a||!i)return!0;const l=a.filter(t=>n.includes(t.type.name));r.ensureMarks(l)}return!0}},_a=(t,e)=>{const n=qs(t=>t.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;const o=t.doc.nodeAt(r);return n.node.type!==(null==o?void 0:o.type)||!jt(t.doc,n.pos)||(t.join(n.pos),!0)},Ta=(t,e)=>{const n=qs(t=>t.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;const o=t.doc.nodeAt(r);return n.node.type!==(null==o?void 0:o.type)||!jt(t.doc,r)||(t.join(r),!0)},Da=function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return o=>{let{editor:i,tr:s,state:a,dispatch:l,chain:c,commands:u,can:d}=o;const{extensions:h,splittableMarks:p}=i.extensionManager,f=zi(t,a.schema),g=zi(e,a.schema),{selection:m,storedMarks:y}=a,{$from:b,$to:v}=m,w=b.blockRange(v),A=y||m.$to.parentOffset&&m.$from.marks();if(!w)return!1;const k=qs(t=>ga(t.type.name,h))(m);if(w.depth>=1&&k&&w.depth-k.depth<=1){if(k.node.type===f)return u.liftListItem(g);if(ga(k.node.type.name,h)&&f.validContent(k.node.content)&&l)return c().command(()=>(s.setNodeMarkup(k.pos,f),!0)).command(()=>_a(s,f)).command(()=>Ta(s,f)).run()}return n&&A&&l?c().command(()=>{const t=d().wrapInList(f,r),e=A.filter(t=>p.includes(t.type.name));return s.ensureMarks(e),!!t||u.clearNodes()}).wrapInList(f,r).command(()=>_a(s,f)).command(()=>Ta(s,f)).run():c().command(()=>!!d().wrapInList(f,r)||u.clearNodes()).wrapInList(f,r).command(()=>_a(s,f)).command(()=>Ta(s,f)).run()}},Oa=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=>{let{state:o,commands:i}=r;const{extendEmptyMarkRange:s=!1}=n,a=Zi(t,o.schema);return pa(o,a,e)?i.unsetMark(a,{extendEmptyMarkRange:s}):i.setMark(a,e)}},Na=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=>{let{state:o,commands:i}=r;const s=zi(t,o.schema),a=zi(e,o.schema),l=ks(o,s,n);let c;return o.selection.$anchor.sameParent(o.selection.$head)&&(c=o.selection.$anchor.parent.attrs),l?i.setNode(a,c):i.setNode(s,{...c,...n})}},Ia=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,commands:o}=n;const i=zi(t,r.schema);return ks(r,i,e)?o.lift(i):o.wrapIn(i,e)}},La=()=>t=>{let{state:e,dispatch:n}=t;const r=e.plugins;for(let t=0;t<r.length;t+=1){const o=r[t];let i;if(o.spec.isInputRules&&(i=o.getState(e))){if(n){const t=e.tr,n=i.transform;for(let e=n.steps.length-1;e>=0;e-=1)t.step(n.steps[e].invert(n.docs[e]));if(i.text){const n=t.doc.resolve(i.from).marks();t.replaceWith(i.from,i.to,e.schema.text(i.text,n))}else t.delete(i.from,i.to)}return!0}}return!1},Ra=()=>t=>{let{tr:e,dispatch:n}=t;const{selection:r}=e,{empty:o,ranges:i}=r;return o||n&&i.forEach(t=>{e.removeMark(t.$from.pos,t.$to.pos)}),!0},Ba=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:o,dispatch:i}=n;var s;const{extendEmptyMarkRange:a=!1}=e,{selection:l}=r,c=Zi(t,o.schema),{$from:u,empty:d,ranges:h}=l;if(!i)return!0;if(d&&a){let{from:t,to:e}=l;const n=null==(s=u.marks().find(t=>t.type===c))?void 0:s.attrs,o=Yi(u,c,n);o&&(t=o.from,e=o.to),r.removeMark(t,e,c)}else h.forEach(t=>{r.removeMark(t.$from.pos,t.$to.pos,c)});return r.removeStoredMark(c),!0}},$a=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:o,dispatch:i}=n,s=null,a=null;const l=Ms("string"==typeof t?t:t.name,o.schema);return!!l&&("node"===l&&(s=zi(t,o.schema)),"mark"===l&&(a=Zi(t,o.schema)),i&&r.selection.ranges.forEach(t=>{const n=t.$from.pos,i=t.$to.pos;let l,c,u,d;r.selection.empty?o.doc.nodesBetween(n,i,(t,e)=>{s&&s===t.type&&(u=Math.max(e,n),d=Math.min(e+t.nodeSize,i),l=e,c=t)}):o.doc.nodesBetween(n,i,(t,o)=>{o<n&&s&&s===t.type&&(u=Math.max(o,n),d=Math.min(o+t.nodeSize,i),l=o,c=t),o>=n&&o<=i&&(s&&s===t.type&&r.setNodeMarkup(o,void 0,{...t.attrs,...e}),a&&t.marks.length&&t.marks.forEach(s=>{if(a===s.type){const l=Math.max(o,n),c=Math.min(o+t.nodeSize,i);r.addMark(l,c,a.create({...s.attrs,...e}))}}))}),c&&(void 0!==l&&r.setNodeMarkup(l,void 0,{...c.attrs,...e}),a&&c.marks.length&&c.marks.forEach(t=>{a===t.type&&r.addMark(u,d,a.create({...t.attrs,...e}))}))}),!0)}},Pa=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,dispatch:o}=n;return function(t,e=null){return function(n,r){let{$from:o,$to:i}=n.selection,s=o.blockRange(i),a=s&&$t(s,t,e);return!!a&&(r&&r(n.tr.wrap(s,a).scrollIntoView()),!0)}}(zi(t,r.schema),e)(r,o)}},Fa=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,dispatch:o}=n;return function(t,e=null){return function(n,r){let{$from:o,$to:i}=n.selection,s=o.blockRange(i);if(!s)return!1;let a=r?n.tr:null;return!!function(t,e,n,r=null){let o=!1,i=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&0==e.startIndex){if(0==e.$from.index(e.depth-1))return!1;let t=s.resolve(e.start-2);i=new I(t,t,e.depth),e.endIndex<e.parent.childCount&&(e=new I(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),o=!0}let a=$t(i,n,r,e);return!!a&&(t&&function(t,e,n,r,o){let i=d.empty;for(let t=n.length-1;t>=0;t--)i=d.from(n[t].type.create(n[t].attrs,i));t.step(new Nt(e.start-(r?2:0),e.end,e.start,e.end,new y(i,0,0),n.length,!0));let s=0;for(let t=0;t<n.length;t++)n[t].type==o&&(s=t+1);let a=n.length-s,l=e.start+n.length-(r?2:0),c=e.parent;for(let n=e.startIndex,r=e.endIndex,o=!0;n<r;n++,o=!1)!o&&Ht(t.doc,l,a)&&(t.split(l,a),l+=2*a),l+=c.child(n).nodeSize}(t,e,a,o,n),!0)}(a,s,t,e)&&(r&&r(a.scrollIntoView()),!0)}}(zi(t,r.schema),e)(r,o)}},za=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const o=this.callbacks[t];return o&&o.forEach(t=>t.apply(this,n)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(t=>t!==e):delete this.callbacks[t]),this}once(t,e){var n=this;const r=function(){n.off(t,r);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];e.apply(n,i)};return this.on(t,r)}removeAllListeners(){this.callbacks={}}},Ha=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=null==(e=t.undoable)||e}};function ja(t){var e;const{editor:n,from:r,to:o,text:i,rules:s,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(null==(e=c.nodeBefore||c.nodeAfter)?void 0:e.marks.find(t=>t.type.spec.code)))return!1;let u=!1;const d=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(t,e,o,i)=>{var s,a;const l=(null==(a=(s=t.type.spec).toText)?void 0:a.call(s,{node:t,pos:e,parent:o,index:i}))||t.textContent||"%leaf%";n+=t.isAtom&&!t.isText?l:l.slice(0,Math.max(0,r-e))}),n}(c)+i;return s.forEach(t=>{if(u)return;const e=((t,e)=>{if(Wi(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r})(d,t.find);if(!e)return;const s=l.state.tr,c=Di({state:l.state,transaction:s}),h={from:r-(e[0].length-i.length),to:o},{commands:p,chain:f,can:g}=new Oi({editor:n,state:c});null!==t.handler({state:c,range:h,match:e,commands:p,chain:f,can:g})&&s.steps.length&&(t.undoable&&s.setMeta(a,{transform:s,from:r,to:o,text:i}),l.dispatch(s),u=!0)}),u}function Va(t){return"Object"===function(t){return Object.prototype.toString.call(t).slice(8,-1)}(t)&&t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function qa(t,e){const n={...t};return Va(t)&&Va(e)&&Object.keys(e).forEach(r=>{Va(e[r])&&Va(t[r])?n[r]=qa(t[r],e[r]):n[r]=e[r]}),n}var Ua=class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...Gs(Us(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Gs(Us(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.extend({...this.config,addOptions:()=>qa(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},Wa=class t extends Ua{constructor(){super(...arguments),this.type="mark"}static create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n="function"==typeof e?e():e;return new t(n)}static handleExit(t){let{editor:e,mark:n}=t;const{tr:r}=e.state,o=e.state.selection.$from;if(o.pos===o.end()){const t=o.marks();if(!t.find(t=>(null==t?void 0:t.type.name)===n.name))return!1;const i=t.find(t=>(null==t?void 0:t.type.name)===n.name);return i&&r.removeStoredMark(i),r.insertText(" ",o.pos),e.view.dispatch(r),!0}return!1}configure(t){return super.configure(t)}extend(t){const e="function"==typeof t?t():t;return super.extend(e)}},Ja=class{constructor(t){this.find=t.find,this.handler=t.handler}};var Ka=null;function Ga(t){const{editor:e,rules:n}=t;let r,o=null,i=!1,s=!1,a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{r="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{r=null}const l=t=>{let{state:n,from:o,to:i,rule:s,pasteEvt:l}=t;const c=n.tr,u=Di({state:n,transaction:c});if(function(t){const{editor:e,state:n,from:r,to:o,rule:i,pasteEvent:s,dropEvent:a}=t,{commands:l,chain:c,can:u}=new Oi({editor:e,state:n}),d=[];return n.doc.nodesBetween(r,o,(t,e)=>{var h,p,f,g,m;if((null==(p=null==(h=t.type)?void 0:h.spec)?void 0:p.code)||!(t.isText||t.isTextblock||t.isInline))return;const y=null!=(m=null!=(g=null==(f=t.content)?void 0:f.size)?g:t.nodeSize)?m:0,b=Math.max(r,e),v=Math.min(o,e+y);b>=v||((t,e,n)=>{if(Wi(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(e=>{const n=[e.text];return n.index=e.index,n.input=t,n.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(e.replaceWith)),n}):[]})(t.isText?t.text||"":t.textBetween(b-e,v-e,void 0,""),i.find,s).forEach(t=>{if(void 0===t.index)return;const e=b+t.index+1,r=e+t[0].length,o={from:n.tr.mapping.map(e),to:n.tr.mapping.map(r)},h=i.handler({state:n,range:o,match:t,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:a});d.push(h)})}),d.every(t=>null!==t)}({editor:e,state:u,from:Math.max(o-1,0),to:i.b-1,rule:s,pasteEvent:l,dropEvent:r})&&c.steps.length){try{r="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{r=null}return a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,c}},c=n.map(t=>new Me({view(t){const n=n=>{var r;o=(null==(r=t.dom.parentElement)?void 0:r.contains(n.target))?t.dom.parentElement:null,o&&(Ka=e)},r=()=>{Ka&&(Ka=null)};return window.addEventListener("dragstart",n),window.addEventListener("dragend",r),{destroy(){window.removeEventListener("dragstart",n),window.removeEventListener("dragend",r)}}},props:{handleDOMEvents:{drop:(t,e)=>{if(s=o===t.dom.parentElement,r=e,!s){const t=Ka;(null==t?void 0:t.isEditable)&&setTimeout(()=>{const e=t.state.selection;e&&t.commands.deleteRange({from:e.from,to:e.to})},10)}return!1},paste:(t,e)=>{var n;const r=null==(n=e.clipboardData)?void 0:n.getData("text/html");return a=e,i=!!(null==r?void 0:r.includes("data-pm-slice")),!1}}},appendTransaction:(e,n,r)=>{const o=e[0],c="paste"===o.getMeta("uiEvent")&&!i,u="drop"===o.getMeta("uiEvent")&&!s,h=o.getMeta("applyPasteRules"),p=!!h;if(!c&&!u&&!p)return;if(p){let{text:e}=h;"string"==typeof e||(e=Js(d.from(e),r.schema));const{from:n}=h,o=n+e.length,i=(t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null==(e=n.clipboardData)||e.setData("text/html",t),n})(e);return l({rule:t,state:r,from:n,to:{b:o},pasteEvt:i})}const f=n.doc.content.findDiffStart(r.doc.content),g=n.doc.content.findDiffEnd(r.doc.content);return"number"==typeof f&&g&&f!==g.b?l({rule:t,state:r,from:f,to:g,pasteEvt:a}):void 0}}));return c}var Ya=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=oa(t),this.schema=na(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n=Us(e,"addCommands",{name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:da(e.name,this.schema)});return n?{...t,...n()}:t},{})}get plugins(){const{editor:t}=this,e=ra([...this.extensions].reverse()).flatMap(e=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:t,type:da(e.name,this.schema)},r=[],o=Us(e,"addKeyboardShortcuts",n);let i={};if("mark"===e.type&&Us(e,"exitable",n)&&(i.ArrowRight=()=>Wa.handleExit({editor:t,mark:e})),o){const e=Object.fromEntries(Object.entries(o()).map(e=>{let[n,r]=e;return[n,()=>r({editor:t})]}));i={...i,...e}}const s=new Me({props:{handleKeyDown:Mi(i)}});r.push(s);const a=Us(e,"addInputRules",n);if(fa(e,t.options.enableInputRules)&&a){const e=a();if(e&&e.length){const n=function(t){const{editor:e,rules:n}=t,r=new Me({state:{init:()=>null,apply(t,o,i){const s=t.getMeta(r);if(s)return s;const a=t.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:t}=a;"string"==typeof t||(t=Js(d.from(t),i.schema));const{from:o}=a,s=o+t.length;ja({editor:e,from:o,to:s,text:t,rules:n,plugin:r})}),t.selectionSet||t.docChanged?null:o}},props:{handleTextInput:(t,o,i,s)=>ja({editor:e,from:o,to:i,text:s,rules:n,plugin:r}),handleDOMEvents:{compositionend:t=>(setTimeout(()=>{const{$cursor:o}=t.state.selection;o&&ja({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(t,o){if("Enter"!==o.key)return!1;const{$cursor:i}=t.state.selection;return!!i&&ja({editor:e,from:i.pos,to:i.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}({editor:t,rules:e}),o=Array.isArray(n)?n:[n];r.push(...o)}}const l=Us(e,"addPasteRules",n);if(fa(e,t.options.enablePasteRules)&&l){const e=l();if(e&&e.length){const n=Ga({editor:t,rules:e});r.push(...n)}}const c=Us(e,"addProseMirrorPlugins",n);if(c){const t=c();r.push(...t)}return r});return e}get attributes(){return Zs(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=Ys(this.extensions);return Object.fromEntries(e.filter(t=>!!Us(t,"addNodeView")).map(e=>{const n=this.attributes.filter(t=>t.type===e.name),r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:t,type:zi(e.name,this.schema)},o=Us(e,"addNodeView",r);return o?[e.name,(r,i,s,a,l)=>{const c=Xs(r,n);return o()({node:r,view:i,getPos:s,decorations:a,innerDecorations:l,editor:t,extension:e,HTMLAttributes:c})}]:[]}))}get markViews(){const{editor:t}=this,{markExtensions:e}=Ys(this.extensions);return Object.fromEntries(e.filter(t=>!!Us(t,"addMarkView")).map(e=>{const n=this.attributes.filter(t=>t.type===e.name),r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:t,type:Zi(e.name,this.schema)},o=Us(e,"addMarkView",r);return o?[e.name,(r,i,s)=>{const a=Xs(r,n);return o()({mark:r,view:i,inline:s,editor:t,extension:e,HTMLAttributes:a,updateAttributes:e=>{!function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{state:r}=e,{doc:o,tr:i}=r,s=t;o.descendants((e,r)=>{const o=i.mapping.map(r),a=i.mapping.map(r)+e.nodeSize;let l=null;if(e.marks.forEach(t=>{if(t!==s)return!1;l=t}),!l)return;let c=!1;if(Object.keys(n).forEach(t=>{n[t]!==l.attrs[t]&&(c=!0)}),c){const e=t.type.create({...t.attrs,...n});i.removeMark(o,a,t.type),i.addMark(o,a,e)}}),i.docChanged&&e.view.dispatch(i)}(r,t,e)}})}]:[]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(t=>[t.name,t.storage])),t.forEach(t=>{var e;const n={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:da(t.name,this.schema)};"mark"===t.type&&(null==(e=Gs(Us(t,"keepOnSplit",n)))||e)&&this.splittableMarks.push(t.name);const r=Us(t,"onBeforeCreate",n),o=Us(t,"onCreate",n),i=Us(t,"onUpdate",n),s=Us(t,"onSelectionUpdate",n),a=Us(t,"onTransaction",n),l=Us(t,"onFocus",n),c=Us(t,"onBlur",n),u=Us(t,"onDestroy",n);r&&this.editor.on("beforeCreate",r),o&&this.editor.on("create",o),i&&this.editor.on("update",i),s&&this.editor.on("selectionUpdate",s),a&&this.editor.on("transaction",a),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),u&&this.editor.on("destroy",u)})}};Ya.resolve=oa,Ya.sort=ra,Ya.flatten=Ws,Ti({},{ClipboardTextSerializer:()=>Qa,Commands:()=>Xa,Delete:()=>tl,Drop:()=>el,Editable:()=>nl,FocusEvents:()=>ol,Keymap:()=>il,Paste:()=>sl,Tabindex:()=>al,focusEventsPluginKey:()=>rl});var Za=class t extends Ua{constructor(){super(...arguments),this.type="extension"}static create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n="function"==typeof e?e():e;return new t(n)}configure(t){return super.configure(t)}extend(t){const e="function"==typeof t?t():t;return super.extend(e)}},Qa=Za.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new Me({key:new De("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:o}=e,{ranges:i}=o,s=Math.min(...i.map(t=>t.$from.pos)),a=Math.max(...i.map(t=>t.$to.pos)),l=aa(n);return ia(r,{from:s,to:a},{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),Xa=Za.create({name:"commands",addCommands:()=>({...Ni})}),tl=Za.create({name:"delete",onUpdate(t){let{transaction:e,appendedTransactions:n}=t;var r,o,i;const s=()=>{var t,r,o,i;if(null!=(i=null==(o=null==(r=null==(t=this.editor.options.coreExtensionOptions)?void 0:t.delete)?void 0:r.filterTransaction)?void 0:o.call(r,e))?i:e.getMeta("y-sync$"))return;const s=zs(e.before,[e,...n]);ca(s).forEach(t=>{s.mapping.mapResult(t.oldRange.from).deletedAfter&&s.mapping.mapResult(t.oldRange.to).deletedBefore&&s.before.nodesBetween(t.oldRange.from,t.oldRange.to,(n,r)=>{const o=r+n.nodeSize-2,i=t.oldRange.from<=r&&o<=t.oldRange.to;this.editor.emit("delete",{type:"node",node:n,from:r,to:o,newFrom:s.mapping.map(r),newTo:s.mapping.map(o),deletedRange:t.oldRange,newRange:t.newRange,partial:!i,editor:this.editor,transaction:e,combinedTransform:s})})});const a=s.mapping;s.steps.forEach((t,n)=>{var r,o;if(t instanceof _t){const i=a.slice(n).map(t.from,-1),l=a.slice(n).map(t.to),c=a.invert().map(i,-1),u=a.invert().map(l),d=null==(r=s.doc.nodeAt(i-1))?void 0:r.marks.some(e=>e.eq(t.mark)),h=null==(o=s.doc.nodeAt(l))?void 0:o.marks.some(e=>e.eq(t.mark));this.editor.emit("delete",{type:"mark",mark:t.mark,from:t.from,to:t.to,deletedRange:{from:c,to:u},newRange:{from:i,to:l},partial:Boolean(h||d),editor:this.editor,transaction:e,combinedTransform:s})}})};null==(i=null==(o=null==(r=this.editor.options.coreExtensionOptions)?void 0:r.delete)?void 0:o.async)||i?setTimeout(s,0):s()}}),el=Za.create({name:"drop",addProseMirrorPlugins(){return[new Me({key:new De("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),nl=Za.create({name:"editable",addProseMirrorPlugins(){return[new Me({key:new De("editable"),props:{editable:()=>this.editor.options.editable}})]}}),rl=new De("focusEvents"),ol=Za.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Me({key:rl,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),il=Za.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(t=>{let{commands:e}=t;return[()=>e.undoInputRule(),()=>e.command(t=>{let{tr:n}=t;const{selection:r,doc:o}=n,{empty:i,$anchor:s}=r,{pos:a,parent:l}=s,c=s.parent.isTextblock&&a>0?n.doc.resolve(a-1):s,u=c.parent.type.spec.isolating,d=s.pos-s.parentOffset,h=u&&1===c.parent.childCount?d===s.pos:le.atStart(o).from===a;return!(!i||!l.type.isTextblock||l.textContent.length||!h||h&&"paragraph"===s.parent.type.name)&&e.clearNodes()}),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()]}),e=()=>this.editor.commands.first(t=>{let{commands:e}=t;return[()=>e.deleteSelection(),()=>e.deleteCurrentNode(),()=>e.joinForward(),()=>e.selectNodeForward()]}),n={Enter:()=>this.editor.commands.first(t=>{let{commands:e}=t;return[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()]}),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},r={...n},o={...n,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return rs()||ws()?o:r},addProseMirrorPlugins(){return[new Me({key:new De("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(t=>t.getMeta("composition")))return;const r=t.some(t=>t.docChanged)&&!e.doc.eq(n.doc),o=t.some(t=>t.getMeta("preventClearDocument"));if(!r||o)return;const{empty:i,from:s,to:a}=e.selection,l=le.atStart(e.doc).from,c=le.atEnd(e.doc).to;if(i||s!==l||a!==c)return;if(!ma(n.doc))return;const u=n.tr,d=Di({state:n,transaction:u}),{commands:h}=new Oi({editor:this.editor,state:d});return h.clearNodes(),u.steps.length?u:void 0}})]}}),sl=Za.create({name:"paste",addProseMirrorPlugins(){return[new Me({key:new De("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),al=Za.create({name:"tabindex",addProseMirrorPlugins(){return[new Me({key:new De("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),ll=class t{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=e,this.currentNode=r}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return null!=(t=this.actualDepth)?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let e=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);e=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:e,to:n},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new t(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new t(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new t(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const o=n.isBlock&&!n.isTextblock,i=n.isAtom&&!n.isText,s=this.pos+r+(i?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(s);if(!o&&a.depth<=this.depth)return;const l=new t(a,this.editor,o,o?n:null);o&&(l.actualDepth=this.depth+1),e.push(new t(a,this.editor,o,o?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=this.parent;for(;r&&!n;){if(r.node.type.name===t)if(Object.keys(e).length>0){const t=r.node.attrs,n=Object.keys(e);for(let r=0;r<n.length;r+=1){const o=n[r];if(t[o]!==e[o])break}}else n=r;r=r.parent}return n}querySelector(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.querySelectorAll(t,e,!0)[0]||null}querySelectorAll(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];if(!this.children||0===this.children.length)return r;const o=Object.keys(e);return this.children.forEach(i=>{n&&r.length>0||(i.node.type.name===t&&o.every(t=>e[t]===i.node.attrs[t])&&r.push(i),n&&r.length>0||(r=r.concat(i.querySelectorAll(t,e,n))))}),r}setAttribute(t){const{tr:e}=this.editor.state;e.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(e)}},cl=class extends za{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.css=null,this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:"undefined"!=typeof document?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:t=>{let{error:e}=t;throw e},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",t=>{let{event:e,slice:n,moved:r}=t;return this.options.onDrop(e,n,r)}),this.on("paste",t=>{let{event:e,slice:n}=t;return this.options.onPaste(e,n)}),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=ns(e,this.options.autofocus);this.editorState=Se.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if("undefined"==typeof document)throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;(null==t?void 0:t.editor)&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css)try{"function"==typeof this.css.remove?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&"undefined"!=typeof document&&(this.css=function(t,e){const n=document.querySelector("style[data-tiptap-style]");if(null!==n)return n;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style",""),r.innerHTML='.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 0 !important;\n  height: 0 !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}',document.getElementsByTagName("head")[0].appendChild(r),r}(0,this.options.injectNonce))}setOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options={...this.options,...t},this.editorView&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if("state"===e)return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=Ks(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(t=>{const e="string"==typeof t?`${t}$`:t.key;n=n.filter(t=>!t.key.startsWith(e))}),e.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var t,e;const n=[...this.options.enableCoreExtensions?[nl,Qa.configure({blockSeparator:null==(e=null==(t=this.options.coreExtensionOptions)?void 0:t.clipboardTextSerializer)?void 0:e.blockSeparator}),Xa,ol,il,al,el,sl,tl].filter(t=>"object"!=typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[t.name]):[],...this.options.extensions].filter(t=>["extension","node","mark"].includes(null==t?void 0:t.type));this.extensionManager=new Ya(n,this)}createCommandManager(){this.commandManager=new Oi({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=$s(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error&&["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message)))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&"object"==typeof this.storage.collaboration&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(t=>"collaboration"!==t.name),this.createExtensionManager()}}),t=$s(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){var e;this.editorView=new di(t,{...this.options.editorProps,attributes:{role:"textbox",...null==(e=this.options.editorProps)?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.prependClass(),this.injectCSS(),this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach(t=>{var e;return null==(e=this.capturedTransaction)?void 0:e.step(t)}):void(this.capturedTransaction=t);const{state:e,transactions:n}=this.state.applyTransaction(t),r=!this.state.selection.eq(e.selection),o=n.includes(t),i=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!o)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const s=n.findLast(t=>t.getMeta("focus")||t.getMeta("blur")),a=null==s?void 0:s.getMeta("focus"),l=null==s?void 0:s.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),t.getMeta("preventUpdate")||!n.some(t=>t.docChanged)||i.doc.eq(e.doc)||this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return la(this.state,t)}isActive(t,e){const n="string"==typeof t?t:null,r="string"==typeof t?e:t;return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return ks(t,null,n)||pa(t,null,n);const r=Ms(e,t.schema);return"node"===r?ks(t,e,n):"mark"===r&&pa(t,e,n)}(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Js(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e="\n\n",textSerializers:n={}}=t||{};return sa(this.state.doc,{blockSeparator:e,textSerializers:{...aa(this.schema),...n}})}get isEmpty(){return ma(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return null==(e=null==(t=this.editorView)?void 0:t.isDestroyed)||e}$node(t,e){var n;return(null==(n=this.$doc)?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return(null==(n=this.$doc)?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new ll(e,this)}get $doc(){return this.$pos(0)}};function ul(t){return new Ha({find:t.find,handler:e=>{let{state:n,range:r,match:o}=e;const i=Gs(t.getAttributes,void 0,o);if(!1===i||null===i)return null;const{tr:s}=n,a=o[o.length-1],l=o[0];if(a){const e=l.search(/\S/),o=r.from+l.indexOf(a),c=o+a.length;if(ua(r.from,r.to,n.doc).filter(e=>e.mark.type.excluded.find(n=>n===t.type&&n!==e.mark.type)).filter(t=>t.to>o).length)return null;c<r.to&&s.delete(c,r.to),o>r.from&&s.delete(r.from+e,o);const u=r.from+e+a.length;s.addMark(r.from+e,u,t.type.create(i||{})),s.removeStoredMark(t.type)}},undoable:t.undoable})}function dl(t){return new Ha({find:t.find,handler:e=>{let{state:n,range:r,match:o}=e;const i=Gs(t.getAttributes,void 0,o)||{},{tr:s}=n,a=r.from;let l=r.to;const c=t.type.create(i);if(o[1]){let t=a+o[0].lastIndexOf(o[1]);t>l?t=l:l=t+o[1].length;const e=o[0][o[0].length-1];s.insertText(e,a+o[0].length-1),s.replaceWith(t,l,c)}else if(o[0]){const e=t.type.isInline?a:a-1;s.insert(e,t.type.create(i)).delete(s.mapping.map(a),s.mapping.map(l))}s.scrollIntoView()},undoable:t.undoable})}function hl(t){return new Ha({find:t.find,handler:e=>{let{state:n,range:r,match:o}=e;const i=n.doc.resolve(r.from),s=Gs(t.getAttributes,void 0,o)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;n.tr.delete(r.from,r.to).setBlockType(r.from,r.from,t.type,s)},undoable:t.undoable})}function pl(t){return new Ha({find:t.find,handler:e=>{let{state:n,range:r,match:o}=e,i=t.replace,s=r.from;const a=r.to;if(o[1]){const t=o[0].lastIndexOf(o[1]);i+=o[0].slice(t+o[1].length),s+=t;const e=s-a;e>0&&(i=o[0].slice(t-e,t)+i,s=a)}n.tr.insertText(i,s,a)},undoable:t.undoable})}function fl(t){return new Ha({find:t.find,handler:e=>{let{state:n,range:r,match:o,chain:i}=e;const s=Gs(t.getAttributes,void 0,o)||{},a=n.tr.delete(r.from,r.to),l=a.doc.resolve(r.from).blockRange(),c=l&&$t(l,t.type,s);if(!c)return null;if(a.wrap(l,c),t.keepMarks&&t.editor){const{selection:e,storedMarks:r}=n,{splittableMarks:o}=t.editor.extensionManager,i=r||e.$to.parentOffset&&e.$from.marks();if(i){const t=i.filter(t=>o.includes(t.type.name));a.ensureMarks(t)}}if(t.keepAttributes){const e="bulletList"===t.type.name||"orderedList"===t.type.name?"listItem":"taskList";i().updateAttributes(e,s).run()}const u=a.doc.resolve(r.from-1).nodeBefore;u&&u.type===t.type&&jt(a.doc,r.from-1)&&(!t.joinPredicate||t.joinPredicate(o,u))&&a.join(r.from-1)},undoable:t.undoable})}function gl(t){if(!(null==t?void 0:t.trim()))return{};const e={},n=[],r=t.replace(/["']([^"']*)["']/g,t=>(n.push(t),`__QUOTED_${n.length-1}__`)),o=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(o){const t=o.map(t=>t.trim().slice(1));e.class=t.join(" ")}const i=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);i&&(e.id=i[1]),Array.from(r.matchAll(/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g)).forEach(t=>{let[,r,o]=t;var i;const s=parseInt((null==(i=o.match(/__QUOTED_(\d+)__/))?void 0:i[1])||"0",10),a=n[s];a&&(e[r]=a.slice(1,-1))});const s=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return s&&s.split(/\s+/).filter(Boolean).forEach(t=>{t.match(/^[a-zA-Z][\w-]*$/)&&(e[t]=!0)}),e}function ml(t){if(!t||0===Object.keys(t).length)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(t=>e.push(`.${t}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(t=>{let[n,r]=t;"class"!==n&&"id"!==n&&(!0===r?e.push(n):!1!==r&&null!=r&&e.push(`${n}="${String(r)}"`))}),e.join(" ")}function yl(t){const{nodeName:e,name:n,parseAttributes:r=gl,serializeAttributes:o=ml,defaultAttributes:i={},requiredAttributes:s=[],allowedAttributes:a}=t,l=n||e;return{parseMarkdown:(t,n)=>{const r={...i,...t.attributes};return n.createNode(e,r,[])},markdownTokenizer:{name:e,level:"block",start(t){var e;const n=new RegExp(`^:::${l}(?:\\s|$)`,"m"),r=null==(e=t.match(n))?void 0:e.index;return void 0!==r?r:-1},tokenize(t,n,o){const i=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),a=t.match(i);if(!a)return;const c=a[1]||"",u=r(c);return s.find(t=>!(t in u))?void 0:{type:e,raw:a[0],attributes:u}}},renderMarkdown:t=>{const e=(t=>{if(!a)return t;const e={};return a.forEach(n=>{n in t&&(e[n]=t[n])}),e})(t.attrs||{}),n=o(e);return`:::${l}${n?` {${n}}`:""} :::`}}}function bl(t){const{nodeName:e,name:n,getContent:r,parseAttributes:o=gl,serializeAttributes:i=ml,defaultAttributes:s={},content:a="block",allowedAttributes:l}=t,c=n||e;return{parseMarkdown:(t,n)=>{let o;if(r){const e=r(t);o="string"==typeof e?[{type:"text",text:e}]:e}else o="block"===a?n.parseChildren(t.tokens||[]):n.parseInline(t.tokens||[]);const i={...s,...t.attributes};return n.createNode(e,i,o)},markdownTokenizer:{name:e,level:"block",start(t){var e;const n=new RegExp(`^:::${c}`,"m"),r=null==(e=t.match(n))?void 0:e.index;return void 0!==r?r:-1},tokenize(t,n,r){var i;const s=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),l=t.match(s);if(!l)return;const[u,d=""]=l,h=o(d);let p=1;const f=u.length;let g="";const m=/^:::([\w-]*)(\s.*)?/gm,y=t.slice(f);for(m.lastIndex=0;;){const n=m.exec(y);if(null===n)break;const o=n.index,s=n[1];if(!(null==(i=n[2])?void 0:i.endsWith(":::")))if(s)p+=1;else if(p-=1,0===p){const i=y.slice(0,o);g=i.trim();const s=t.slice(0,f+o+n[0].length);let l=[];if(g)if("block"===a)for(l=r.blockTokens(i),l.forEach(t=>{!t.text||t.tokens&&0!==t.tokens.length||(t.tokens=r.inlineTokens(t.text))});l.length>0;){const t=l[l.length-1];if("paragraph"!==t.type||t.text&&""!==t.text.trim())break;l.pop()}else l=r.inlineTokens(g);return{type:e,raw:s,attributes:h,content:g,tokens:l}}}}},renderMarkdown:(t,e)=>{const n=(t=>{if(!l)return t;const e={};return l.forEach(n=>{n in t&&(e[n]=t[n])}),e})(t.attrs||{}),r=i(n),o=r?` {${r}}`:"",s=e.renderChildren(t.content||[],"\n\n");return`:::${c}${o}\n\n${s}\n\n:::`}}}function vl(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(t);for(;null!==r;){const[,o,i,s]=r;e[o]=i||s,r=n.exec(t)}return e}function wl(t){return Object.entries(t).filter(t=>{let[,e]=t;return null!=e}).map(t=>{let[e,n]=t;return`${e}="${n}"`}).join(" ")}function Al(t){const{nodeName:e,name:n,getContent:r,parseAttributes:o=vl,serializeAttributes:i=wl,defaultAttributes:s={},selfClosing:a=!1,allowedAttributes:l}=t,c=n||e,u=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(t,n)=>{const o={...s,...t.attributes};if(a)return n.createNode(e,o);const i=r?r(t):t.content||"";return i?n.createNode(e,o,[n.createTextNode(i)]):n.createNode(e,o,[])},markdownTokenizer:{name:e,level:"inline",start(t){const e=a?new RegExp(`\\[${u}\\s*[^\\]]*\\]`):new RegExp(`\\[${u}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${u}\\]`),n=t.match(e),r=null==n?void 0:n.index;return void 0!==r?r:-1},tokenize(t,n,r){const i=a?new RegExp(`^\\[${u}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${u}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${u}\\]`),s=t.match(i);if(!s)return;let l="",c="";if(a){const[,t]=s;c=t}else{const[,t,e]=s;c=t,l=e||""}const d=o(c.trim());return{type:e,raw:s[0],content:l.trim(),attributes:d}}},renderMarkdown:t=>{let e="";r?e=r(t):t.content&&t.content.length>0&&(e=t.content.filter(t=>"text"===t.type).map(t=>t.text).join(""));const n=(t=>{if(!l)return t;const e={};return l.forEach(n=>{n in t&&(e[n]=t[n])}),e})(t.attrs||{}),o=i(n),s=o?` ${o}`:"";return a?`[${c}${s}]`:`[${c}${s}]${e}[/${c}]`}}}function kl(t,e,n){var r,o,i,s;const a=t.split("\n"),l=[];let c="",u=0;const d=e.baseIndentSize||2;for(;u<a.length;){const t=a[u],h=t.match(e.itemPattern);if(!h){if(l.length>0)break;if(""===t.trim()){u+=1;continue}return}const p=e.extractItemData(h),{indentLevel:f,mainContent:g}=p;c=`${c}${t}\n`;const m=[g];for(u+=1;u<a.length;){const t=a[u];if(""===t.trim()){const e=a.slice(u+1).findIndex(t=>""!==t.trim());if(-1===e)break;if(((null==(o=null==(r=a[u+1+e].match(/^(\s*)/))?void 0:r[1])?void 0:o.length)||0)>f){m.push(t),c=`${c}${t}\n`,u+=1;continue}break}if(!(((null==(s=null==(i=t.match(/^(\s*)/))?void 0:i[1])?void 0:s.length)||0)>f))break;m.push(t),c=`${c}${t}\n`,u+=1}let y;const b=m.slice(1);if(b.length>0){const t=b.map(t=>t.slice(f+d)).join("\n");t.trim()&&(y=e.customNestedParser?e.customNestedParser(t):n.blockTokens(t))}const v=e.createToken(p,y);l.push(v)}if(0!==l.length)return{items:l,raw:c.trim()}}function xl(t,e,n,r){if(!t||!Array.isArray(t.content))return"";const o="function"==typeof n?n(r):n,[i,...s]=t.content,a=[`${o}${e.renderChildren([i])}`];return s&&s.length>0&&s.forEach(t=>{const n=e.renderChildren([t]);if(n){const t=n.split("\n").map(t=>t?e.indent(t):"").join("\n");a.push(t)}}),a.join("\n")}Ti({},{createAtomBlockMarkdownSpec:()=>yl,createBlockMarkdownSpec:()=>bl,createInlineMarkdownSpec:()=>Al,parseAttributes:()=>gl,parseIndentedBlocks:()=>kl,renderNestedMarkdownContent:()=>xl,serializeAttributes:()=>ml});var Cl=class t extends Ua{constructor(){super(...arguments),this.type="node"}static create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n="function"==typeof e?e():e;return new t(n)}configure(t){return super.configure(t)}extend(t){const e="function"==typeof t?t():t;return super.extend(e)}};function Sl(t){return new Ja({find:t.find,handler:e=>{let{state:n,range:r,match:o,pasteEvent:i}=e;const s=Gs(t.getAttributes,void 0,o,i);if(!1===s||null===s)return null;const{tr:a}=n,l=o[o.length-1],c=o[0];let u=r.to;if(l){const e=c.search(/\S/),o=r.from+c.indexOf(l),i=o+l.length;if(ua(r.from,r.to,n.doc).filter(e=>e.mark.type.excluded.find(n=>n===t.type&&n!==e.mark.type)).filter(t=>t.to>o).length)return null;i<r.to&&a.delete(i,r.to),o>r.from&&a.delete(r.from+e,o),u=r.from+e+l.length,a.addMark(r.from+e,u,t.type.create(s||{})),a.removeStoredMark(t.type)}}})}function El(t={}){return new Me({view:e=>new Ml(e,t)})}class Ml{constructor(t,e){var n;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=e.width)&&void 0!==n?n:1,this.color=!1===e.color?void 0:e.color||"black",this.class=e.class,this.handlers=["dragover","dragend","drop","dragleave"].map(e=>{let n=t=>{this[e](t)};return t.dom.addEventListener(e,n),{name:e,handler:n}})}destroy(){this.handlers.forEach(({name:t,handler:e})=>this.editorView.dom.removeEventListener(t,e))}update(t,e){null!=this.cursorPos&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,null==t?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t,e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r=this.editorView.dom,o=r.getBoundingClientRect(),i=o.width/r.offsetWidth,s=o.height/r.offsetHeight;if(n){let n=e.nodeBefore,r=e.nodeAfter;if(n||r){let e=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0));if(e){let o=e.getBoundingClientRect(),i=n?o.bottom:o.top;n&&r&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let a=this.width/2*s;t={left:o.left,right:o.right,top:i-a,bottom:i+a}}}}if(!t){let e=this.editorView.coordsAtPos(this.cursorPos),n=this.width/2*i;t={left:e.left-n,right:e.left+n,top:e.top,bottom:e.bottom}}let a,l,c=this.editorView.dom.offsetParent;if(this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n),!c||c==document.body&&"static"==getComputedStyle(c).position)a=-pageXOffset,l=-pageYOffset;else{let t=c.getBoundingClientRect(),e=t.width/c.offsetWidth,n=t.height/c.offsetHeight;a=t.left-c.scrollLeft*e,l=t.top-c.scrollTop*n}this.element.style.left=(t.left-a)/i+"px",this.element.style.top=(t.top-l)/s+"px",this.element.style.width=(t.right-t.left)/i+"px",this.element.style.height=(t.bottom-t.top)/s+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),n=e&&e.inside>=0&&this.editorView.state.doc.nodeAt(e.inside),r=n&&n.type.spec.disableDropCursor,o="function"==typeof r?r(this.editorView,e,t):r;if(e&&!o){let t=e.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let e=Ut(this.editorView.state.doc,t,this.editorView.dragging.slice);null!=e&&(t=e)}this.setCursor(t),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}class _l extends le{constructor(t){super(t,t)}map(t,e){let n=t.resolve(e.map(this.head));return _l.valid(n)?new _l(n):le.near(n)}content(){return y.empty}eq(t){return t instanceof _l&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new _l(t.resolve(e.pos))}getBookmark(){return new Tl(this.anchor)}static valid(t){let e=t.parent;if(e.isTextblock||!function(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(0!=n)for(let t=r.child(n-1);;t=t.lastChild){if(0==t.childCount&&!t.inlineContent||Dl(t.type))return!0;if(t.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(t)||!function(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n!=r.childCount)for(let t=r.child(n);;t=t.firstChild){if(0==t.childCount&&!t.inlineContent||Dl(t.type))return!0;if(t.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(t))return!1;let n=e.type.spec.allowGapCursor;if(null!=n)return n;let r=e.contentMatchAt(t.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(t,e,n=!1){t:for(;;){if(!n&&_l.valid(t))return t;let r=t.pos,o=null;for(let n=t.depth;;n--){let i=t.node(n);if(e>0?t.indexAfter(n)<i.childCount:t.index(n)>0){o=i.child(e>0?t.indexAfter(n):t.index(n)-1);break}if(0==n)return null;r+=e;let s=t.doc.resolve(r);if(_l.valid(s))return s}for(;;){let i=e>0?o.firstChild:o.lastChild;if(!i){if(o.isAtom&&!o.isText&&!fe.isSelectable(o)){t=t.doc.resolve(r+o.nodeSize*e),n=!1;continue t}break}o=i,r+=e;let s=t.doc.resolve(r);if(_l.valid(s))return s}return null}}}_l.prototype.visible=!1,_l.findFrom=_l.findGapCursorFrom,le.jsonID("gapcursor",_l);class Tl{constructor(t){this.pos=t}map(t){return new Tl(t.map(this.pos))}resolve(t){let e=t.resolve(this.pos);return _l.valid(e)?new _l(e):le.near(e)}}function Dl(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}const Ol=Mi({ArrowLeft:Nl("horiz",-1),ArrowRight:Nl("horiz",1),ArrowUp:Nl("vert",-1),ArrowDown:Nl("vert",1)});function Nl(t,e){const n="vert"==t?e>0?"down":"up":e>0?"right":"left";return function(t,r,o){let i=t.selection,s=e>0?i.$to:i.$from,a=i.empty;if(i instanceof he){if(!o.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=t.doc.resolve(e>0?s.after():s.before())}let l=_l.findGapCursorFrom(s,e,a);return!!l&&(r&&r(t.tr.setSelection(new _l(l))),!0)}}function Il(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!_l.valid(r))return!1;let o=t.posAtCoords({left:n.clientX,top:n.clientY});return!(o&&o.inside>-1&&fe.isSelectable(t.state.doc.nodeAt(o.inside))||(t.dispatch(t.state.tr.setSelection(new _l(r))),0))}function Ll(t,e){if("insertCompositionText"!=e.inputType||!(t.state.selection instanceof _l))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let o=d.empty;for(let t=r.length-1;t>=0;t--)o=d.from(r[t].createAndFill(null,o));let i=t.state.tr.replace(n.pos,n.pos,new y(o,0,0));return i.setSelection(he.near(i.doc.resolve(n.pos+1))),t.dispatch(i),!1}function Rl(t){if(!(t.selection instanceof _l))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Ho.create(t.doc,[Po.widget(t.selection.head,e,{key:"gapcursor"})])}var Bl=200,$l=function(){};$l.prototype.append=function(t){return t.length?(t=$l.from(t),!this.length&&t||t.length<Bl&&this.leafAppend(t)||this.length<Bl&&t.leafPrepend(this)||this.appendInner(t)):this},$l.prototype.prepend=function(t){return t.length?$l.from(t).append(this):this},$l.prototype.appendInner=function(t){return new Fl(this,t)},$l.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.length),t>=e?$l.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))},$l.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)},$l.prototype.forEach=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length),e<=n?this.forEachInner(t,e,n,0):this.forEachInvertedInner(t,e,n,0)},$l.prototype.map=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(e,n){return r.push(t(e,n))},e,n),r},$l.from=function(t){return t instanceof $l?t:t&&t.length?new Pl(t):$l.empty};var Pl=function(t){function e(e){t.call(this),this.values=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(t,n){return 0==t&&n==this.length?this:new e(this.values.slice(t,n))},e.prototype.getInner=function(t){return this.values[t]},e.prototype.forEachInner=function(t,e,n,r){for(var o=e;o<n;o++)if(!1===t(this.values[o],r+o))return!1},e.prototype.forEachInvertedInner=function(t,e,n,r){for(var o=e-1;o>=n;o--)if(!1===t(this.values[o],r+o))return!1},e.prototype.leafAppend=function(t){if(this.length+t.length<=Bl)return new e(this.values.concat(t.flatten()))},e.prototype.leafPrepend=function(t){if(this.length+t.length<=Bl)return new e(t.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}($l);$l.empty=new Pl([]);var Fl=function(t){function e(e,n){t.call(this),this.left=e,this.right=n,this.length=e.length+n.length,this.depth=Math.max(e.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(t){return t<this.left.length?this.left.get(t):this.right.get(t-this.left.length)},e.prototype.forEachInner=function(t,e,n,r){var o=this.left.length;return!(e<o&&!1===this.left.forEachInner(t,e,Math.min(n,o),r))&&!(n>o&&!1===this.right.forEachInner(t,Math.max(e-o,0),Math.min(this.length,n)-o,r+o))&&void 0},e.prototype.forEachInvertedInner=function(t,e,n,r){var o=this.left.length;return!(e>o&&!1===this.right.forEachInvertedInner(t,e-o,Math.max(n,o)-o,r+o))&&!(n<o&&!1===this.left.forEachInvertedInner(t,Math.min(e,o),n,r))&&void 0},e.prototype.sliceInner=function(t,e){if(0==t&&e==this.length)return this;var n=this.left.length;return e<=n?this.left.slice(t,e):t>=n?this.right.slice(t-n,e-n):this.left.slice(t,n).append(this.right.slice(0,e-n))},e.prototype.leafAppend=function(t){var n=this.right.leafAppend(t);if(n)return new e(this.left,n)},e.prototype.leafPrepend=function(t){var n=this.left.leafPrepend(t);if(n)return new e(n,this.right)},e.prototype.appendInner=function(t){return this.left.depth>=Math.max(this.right.depth,t.depth)+1?new e(this.left,new e(this.right,t)):new e(this,t)},e}($l);const zl=$l;class Hl{constructor(t,e){this.items=t,this.eventCount=e}popEvent(t,e){if(0==this.eventCount)return null;let n,r,o=this.items.length;for(;;o--)if(this.items.get(o-1).selection){--o;break}e&&(n=this.remapping(o,this.items.length),r=n.maps.length);let i,s,a=t.tr,l=[],c=[];return this.items.forEach((t,e)=>{if(!t.step)return n||(n=this.remapping(o,e+1),r=n.maps.length),r--,void c.push(t);if(n){c.push(new jl(t.map));let e,o=t.step.map(n.slice(r));o&&a.maybeStep(o).doc&&(e=a.mapping.maps[a.mapping.maps.length-1],l.push(new jl(e,void 0,void 0,l.length+c.length))),r--,e&&n.appendMap(e,r)}else a.maybeStep(t.step);return t.selection?(i=n?t.selection.map(n.slice(r)):t.selection,s=new Hl(this.items.slice(0,o).append(c.reverse().concat(l)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:s,transform:a,selection:i}}addTransform(t,e,n,r){let o=[],i=this.eventCount,s=this.items,a=!r&&s.length?s.get(s.length-1):null;for(let n=0;n<t.steps.length;n++){let l,c=t.steps[n].invert(t.docs[n]),u=new jl(t.mapping.maps[n],c,e);(l=a&&a.merge(u))&&(u=l,n?o.pop():s=s.slice(0,s.length-1)),o.push(u),e&&(i++,e=void 0),r||(a=u)}let l=i-n.depth;return l>ql&&(s=function(t,e){let n;return t.forEach((t,r)=>{if(t.selection&&0==e--)return n=r,!1}),t.slice(n)}(s,l),i-=l),new Hl(s.append(o),i)}remapping(t,e){let n=new kt;return this.items.forEach((e,r)=>{let o=null!=e.mirrorOffset&&r-e.mirrorOffset>=t?n.maps.length-e.mirrorOffset:void 0;n.appendMap(e.map,o)},t,e),n}addMaps(t){return 0==this.eventCount?this:new Hl(this.items.append(t.map(t=>new jl(t))),this.eventCount)}rebased(t,e){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-e),o=t.mapping,i=t.steps.length,s=this.eventCount;this.items.forEach(t=>{t.selection&&s--},r);let a=e;this.items.forEach(e=>{let r=o.getMirror(--a);if(null==r)return;i=Math.min(i,r);let l=o.maps[r];if(e.step){let i=t.steps[r].invert(t.docs[r]),c=e.selection&&e.selection.map(o.slice(a+1,r));c&&s++,n.push(new jl(l,i,c))}else n.push(new jl(l))},r);let l=[];for(let t=e;t<i;t++)l.push(new jl(o.maps[t]));let c=this.items.slice(0,r).append(l).append(n),u=new Hl(c,s);return u.emptyItemCount()>500&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let t=0;return this.items.forEach(e=>{e.step||t++}),t}compress(t=this.items.length){let e=this.remapping(0,t),n=e.maps.length,r=[],o=0;return this.items.forEach((i,s)=>{if(s>=t)r.push(i),i.selection&&o++;else if(i.step){let t=i.step.map(e.slice(n)),s=t&&t.getMap();if(n--,s&&e.appendMap(s,n),t){let a=i.selection&&i.selection.map(e.slice(n));a&&o++;let l,c=new jl(s.invert(),t,a),u=r.length-1;(l=r.length&&r[u].merge(c))?r[u]=l:r.push(c)}}else i.map&&n--},this.items.length,0),new Hl(zl.from(r.reverse()),o)}}Hl.empty=new Hl(zl.empty,0);class jl{constructor(t,e,n,r){this.map=t,this.step=e,this.selection=n,this.mirrorOffset=r}merge(t){if(this.step&&t.step&&!t.selection){let e=t.step.merge(this.step);if(e)return new jl(e.getMap().invert(),e,this.selection)}}}class Vl{constructor(t,e,n,r,o){this.done=t,this.undone=e,this.prevRanges=n,this.prevTime=r,this.prevComposition=o}}const ql=20;function Ul(t){let e=[];for(let n=t.length-1;n>=0&&0==e.length;n--)t[n].forEach((t,n,r,o)=>e.push(r,o));return e}function Wl(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let o=e.map(t[r],1),i=e.map(t[r+1],-1);o<=i&&n.push(o,i)}return n}let Jl=!1,Kl=null;function Gl(t){let e=t.plugins;if(Kl!=e){Jl=!1,Kl=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Jl=!0;break}}return Jl}const Yl=new De("history"),Zl=new De("closeHistory");function Ql(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Me({key:Yl,state:{init:()=>new Vl(Hl.empty,Hl.empty,null,0,-1),apply:(e,n,r)=>function(t,e,n,r){let o,i=n.getMeta(Yl);if(i)return i.historyState;n.getMeta(Zl)&&(t=new Vl(t.done,t.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(0==n.steps.length)return t;if(s&&s.getMeta(Yl))return s.getMeta(Yl).redo?new Vl(t.done.addTransform(n,void 0,r,Gl(e)),t.undone,Ul(n.mapping.maps),t.prevTime,t.prevComposition):new Vl(t.done,t.undone.addTransform(n,void 0,r,Gl(e)),null,t.prevTime,t.prevComposition);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new Vl(t.done.rebased(n,o),t.undone.rebased(n,o),Wl(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Vl(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Wl(t.prevRanges,n.mapping),t.prevTime,t.prevComposition);{let o=n.getMeta("composition"),i=0==t.prevTime||!s&&t.prevComposition!=o&&(t.prevTime<(n.time||0)-r.newGroupDelay||!function(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((t,r)=>{for(let o=0;o<e.length;o+=2)t<=e[o+1]&&r>=e[o]&&(n=!0)}),n}(n,t.prevRanges)),a=s?Wl(t.prevRanges,n.mapping):Ul(n.mapping.maps);return new Vl(t.done.addTransform(n,i?e.selection.getBookmark():void 0,r,Gl(e)),Hl.empty,a,n.time,null==o?t.prevComposition:o)}}(n,r,e,t)},config:t,props:{handleDOMEvents:{beforeinput(t,e){let n=e.inputType,r="historyUndo"==n?tc:"historyRedo"==n?ec:null;return!!r&&(e.preventDefault(),r(t.state,t.dispatch))}}}})}function Xl(t,e){return(n,r)=>{let o=Yl.getState(n);if(!o||0==(t?o.undone:o.done).eventCount)return!1;if(r){let i=function(t,e,n){let r=Gl(e),o=Yl.get(e).spec.config,i=(n?t.undone:t.done).popEvent(e,r);if(!i)return null;let s=i.selection.resolve(i.transform.doc),a=(n?t.done:t.undone).addTransform(i.transform,e.selection.getBookmark(),o,r),l=new Vl(n?a:i.remaining,n?i.remaining:a,null,0,-1);return i.transform.setSelection(s).setMeta(Yl,{redo:n,historyState:l})}(o,n,t);i&&r(e?i.scrollIntoView():i)}return!0}}const tc=Xl(!1,!0),ec=Xl(!0,!0);Xl(!1,!1),Xl(!0,!1),Za.create({name:"characterCount",addOptions:()=>({limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(t=>""!==t).length}),addStorage:()=>({characters:()=>0,words:()=>0}),onBeforeCreate(){this.storage.characters=t=>{const e=(null==t?void 0:t.node)||this.editor.state.doc;if("textSize"===((null==t?void 0:t.mode)||this.options.mode)){const t=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(t)}return e.nodeSize},this.storage.words=t=>{const e=(null==t?void 0:t.node)||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let t=!1;return[new Me({key:new De("characterCount"),appendTransaction:(e,n,r)=>{if(t)return;const o=this.options.limit;if(null==o||0===o)return void(t=!0);const i=this.storage.characters({node:r.doc});if(i>o){const e=0,n=i-o;console.warn(`[CharacterCount] Initial content exceeded limit of ${o} characters. Content was automatically trimmed.`);const s=r.tr.deleteRange(e,n);return t=!0,s}t=!0},filterTransaction:(t,e)=>{const n=this.options.limit;if(!t.docChanged||0===n||null==n)return!0;const r=this.storage.characters({node:e.doc}),o=this.storage.characters({node:t.doc});if(o<=n)return!0;if(r>n&&o>n&&o<=r)return!0;if(r>n&&o>n&&o>r)return!1;if(!t.getMeta("paste"))return!1;const i=t.selection.$head.pos,s=i-(o-n),a=i;return t.deleteRange(s,a),!(this.storage.characters({node:t.doc})>n)}})]}}),Za.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[El(this.options)]}});var nc=Za.create({name:"focus",addOptions:()=>({className:"has-focus",mode:"all"}),addProseMirrorPlugins(){return[new Me({key:new De("focus"),props:{decorations:t=>{let{doc:e,selection:n}=t;const{isEditable:r,isFocused:o}=this.editor,{anchor:i}=n,s=[];if(!r||!o)return Ho.create(e,[]);let a=0;"deepest"===this.options.mode&&e.descendants((t,e)=>{if(!t.isText)return i>=e&&i<=e+t.nodeSize-1&&void(a+=1)});let l=0;return e.descendants((t,e)=>!t.isText&&(i>=e&&i<=e+t.nodeSize-1&&(l+=1,"deepest"===this.options.mode&&a-l>0||"shallowest"===this.options.mode&&l>1?"deepest"===this.options.mode:void s.push(Po.node(e,e+t.nodeSize,{class:this.options.className}))))),Ho.create(e,s)}}})]}}),rc=Za.create({name:"gapCursor",addProseMirrorPlugins:()=>[new Me({props:{decorations:Rl,createSelectionBetween:(t,e,n)=>e.pos==n.pos&&_l.valid(n)?new _l(n):null,handleClick:Il,handleKeyDown:Ol,handleDOMEvents:{beforeinput:Ll}}})],extendNodeSchema(t){var e;return{allowGapCursor:null!=(e=Gs(Us(t,"allowGapCursor",{name:t.name,options:t.options,storage:t.storage})))?e:null}}});function oc(t){let{types:e,node:n}=t;return n&&Array.isArray(e)&&e.includes(n.type)||(null==n?void 0:n.type)===e}Za.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new Me({key:new De("placeholder"),props:{decorations:t=>{let{doc:e,selection:n}=t;const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:o}=n,i=[];if(!r)return null;const s=this.editor.isEmpty;return e.descendants((t,e)=>{const n=o>=e&&o<=e+t.nodeSize,r=!t.isLeaf&&ma(t);if((n||!this.options.showOnlyCurrent)&&r){const r=[this.options.emptyNodeClass];s&&r.push(this.options.emptyEditorClass);const o=Po.node(e,e+t.nodeSize,{class:r.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:t,pos:e,hasAnchor:n}):this.options.placeholder});i.push(o)}return this.options.includeChildren}),Ho.create(e,i)}}})]}}),Za.create({name:"selection",addOptions:()=>({className:"selection"}),addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new Me({key:new De("selection"),props:{decorations:n=>n.selection.empty||t.isFocused||!t.isEditable||ya(n.selection)||t.view.dragging?null:Ho.create(n.doc,[Po.inline(n.selection.from,n.selection.to,{class:e.className})])}})]}}),Za.create({name:"trailingNode",addOptions:()=>({node:void 0,notAfter:[]}),addProseMirrorPlugins(){var t;const e=new De(this.name),n=(null==(t=this.editor.schema.topNodeType.contentMatch.defaultType)?void 0:t.name)||this.options.node||"paragraph",r=Object.entries(this.editor.schema.nodes).map(t=>{let[,e]=t;return e}).filter(t=>(this.options.notAfter||[]).concat(n).includes(t.name));return[new Me({key:e,appendTransaction:(t,r,o)=>{const{doc:i,tr:s,schema:a}=o,l=e.getState(o),c=i.content.size,u=a.nodes[n];if(l)return s.insert(c,u.create())},state:{init:(t,e)=>!oc({node:e.tr.doc.lastChild,types:r}),apply:(t,e)=>t.docChanged?!oc({node:t.doc.lastChild,types:r}):e}})]}}),Za.create({name:"undoRedo",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>t=>{let{state:e,dispatch:n}=t;return tc(e,n)},redo:()=>t=>{let{state:e,dispatch:n}=t;return ec(e,n)}}),addProseMirrorPlugins(){return[Ql(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}});const ic=new De("y-sync"),sc=new De("y-undo");new De("yjs-cursor"),n(5044),n(8845),n(373);const ac=Math.floor,lc=(Math.ceil,Math.abs),cc=(Math.imul,Math.round,Math.log10,Math.log2,Math.log,Math.sqrt,(t,e)=>t<e?t:e),uc=(t,e)=>t>e?t:e,dc=(Number.isNaN,Math.pow,Math.sign,t=>0!==t?t<0:1/t<0),hc=Object.assign,pc=Object.keys,fc=(Object.values,t=>pc(t).length),gc=(t,e)=>{for(const n in t)if(!e(t[n],n))return!1;return!0},mc=Object.freeze,yc=t=>{for(const e in t){const n=t[e];"object"!=typeof n&&"function"!=typeof n||yc(t[e])}return mc(t)},bc=()=>new Set,vc=/[\uD800-\uDBFF]/,wc=/[\uDC00-\uDFFF]/,Ac=t=>new Error(t),kc=()=>{throw Ac("Method unimplemented")},xc=()=>{throw Ac("Unexpected case")},Cc=()=>new Map,Sc=t=>{const e=Cc();return t.forEach((t,n)=>{e.set(n,t)}),e},Ec=(t,e,n)=>{let r=t.get(e);return void 0===r&&t.set(e,r=n()),r},Mc=t=>t[t.length-1],_c=(t,e)=>{for(let n=0;n<e.length;n++)t.push(e[n])},Tc=Array.from,Dc=Array.isArray;class Oc{constructor(){this._observers=Cc()}on(t,e){return Ec(this._observers,t,bc).add(e),e}once(t,e){var n=this;const r=function(){n.off(t,r),e(...arguments)};this.on(t,r)}off(t,e){const n=this._observers.get(t);void 0!==n&&(n.delete(e),0===n.size&&this._observers.delete(t))}emit(t,e){return Tc((this._observers.get(t)||Cc()).values()).forEach(t=>t(...e))}destroy(){this._observers=Cc()}}class Nc{constructor(){this._observers=Cc()}on(t,e){Ec(this._observers,t,bc).add(e)}once(t,e){var n=this;const r=function(){n.off(t,r),e(...arguments)};this.on(t,r)}off(t,e){const n=this._observers.get(t);void 0!==n&&(n.delete(e),0===n.size&&this._observers.delete(t))}emit(t,e){return Tc((this._observers.get(t)||Cc()).values()).forEach(t=>t(...e))}destroy(){this._observers=Cc()}}const Ic=64,Lc=128,Rc=127,Bc=Number.MAX_SAFE_INTEGER,$c=(Number.MIN_SAFE_INTEGER,Number.isInteger||(t=>"number"==typeof t&&isFinite(t)&&ac(t)===t)),Pc=(Number.isNaN,Number.parseInt,String.fromCharCode),Fc=(String.fromCodePoint,Pc(65535),/^\s*/g),zc=/([A-Z])/g,Hc=(t,e)=>(t=>t.replace(Fc,""))(t.replace(zc,t=>`${e}${(t=>t.toLowerCase())(t)}`)),jc="undefined"!=typeof TextEncoder?new TextEncoder:null,Vc=jc?t=>jc.encode(t):t=>{const e=unescape(encodeURIComponent(t)),n=e.length,r=new Uint8Array(n);for(let t=0;t<n;t++)r[t]=e.codePointAt(t);return r};let qc="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});qc&&1===qc.decode(new Uint8Array).length&&(qc=null);class Uc{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const Wc=()=>new Uc,Jc=t=>{const e=new Uint8Array((t=>{let e=t.cpos;for(let n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e})(t));let n=0;for(let r=0;r<t.bufs.length;r++){const o=t.bufs[r];e.set(o,n),n+=o.length}return e.set(new Uint8Array(t.cbuf.buffer,0,t.cpos),n),e},Kc=(t,e)=>{const n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(2*n),t.cpos=0),t.cbuf[t.cpos++]=e},Gc=Kc,Yc=(t,e)=>{for(;e>Rc;)Kc(t,Lc|Rc&e),e=ac(e/128);Kc(t,Rc&e)},Zc=(t,e)=>{const n=dc(e);for(n&&(e=-e),Kc(t,(e>63?Lc:0)|(n?Ic:0)|63&e),e=ac(e/64);e>0;)Kc(t,(e>Rc?Lc:0)|Rc&e),e=ac(e/128)},Qc=new Uint8Array(3e4),Xc=Qc.length/3,tu=jc&&jc.encodeInto?(t,e)=>{if(e.length<Xc){const n=jc.encodeInto(e,Qc).written||0;Yc(t,n);for(let e=0;e<n;e++)Kc(t,Qc[e])}else nu(t,Vc(e))}:(t,e)=>{const n=unescape(encodeURIComponent(e)),r=n.length;Yc(t,r);for(let e=0;e<r;e++)Kc(t,n.codePointAt(e))},eu=(t,e)=>{const n=t.cbuf.length,r=t.cpos,o=cc(n-r,e.length),i=e.length-o;t.cbuf.set(e.subarray(0,o),r),t.cpos+=o,i>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(uc(2*n,i)),t.cbuf.set(e.subarray(o)),t.cpos=i)},nu=(t,e)=>{Yc(t,e.byteLength),eu(t,e)},ru=(t,e)=>{((t,e)=>{const n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(new Uint8Array(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(2*uc(n,e)),t.cpos=0)})(t,e);const n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},ou=new DataView(new ArrayBuffer(4)),iu=(t,e)=>{switch(typeof e){case"string":Kc(t,119),tu(t,e);break;case"number":$c(e)&&lc(e)<=2147483647?(Kc(t,125),Zc(t,e)):(n=e,ou.setFloat32(0,n),ou.getFloat32(0)===n?(Kc(t,124),((t,e)=>{ru(t,4).setFloat32(0,e,!1)})(t,e)):(Kc(t,123),((t,e)=>{ru(t,8).setFloat64(0,e,!1)})(t,e)));break;case"bigint":Kc(t,122),((t,e)=>{ru(t,8).setBigInt64(0,e,!1)})(t,e);break;case"object":if(null===e)Kc(t,126);else if(Dc(e)){Kc(t,117),Yc(t,e.length);for(let n=0;n<e.length;n++)iu(t,e[n])}else if(e instanceof Uint8Array)Kc(t,116),nu(t,e);else{Kc(t,118);const n=Object.keys(e);Yc(t,n.length);for(let r=0;r<n.length;r++){const o=n[r];tu(t,o),iu(t,e[o])}}break;case"boolean":Kc(t,e?120:121);break;default:Kc(t,127)}var n};class su extends Uc{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&Yc(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}const au=t=>{t.count>0&&(Zc(t.encoder,1===t.count?t.s:-t.s),t.count>1&&Yc(t.encoder,t.count-2))};class lu{constructor(){this.encoder=new Uc,this.s=0,this.count=0}write(t){this.s===t?this.count++:(au(this),this.count=1,this.s=t)}toUint8Array(){return au(this),Jc(this.encoder)}}const cu=t=>{if(t.count>0){const e=2*t.diff+(1===t.count?0:1);Zc(t.encoder,e),t.count>1&&Yc(t.encoder,t.count-2)}};class uu{constructor(){this.encoder=new Uc,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(cu(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return cu(this),Jc(this.encoder)}}class du{constructor(){this.sarr=[],this.s="",this.lensE=new lu}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){const t=new Uc;return this.sarr.push(this.s),this.s="",tu(t,this.sarr.join("")),eu(t,this.lensE.toUint8Array()),Jc(t)}}const hu=Ac("Unexpected end of array"),pu=Ac("Integer out of Range");class fu{constructor(t){this.arr=t,this.pos=0}}const gu=t=>new fu(t),mu=t=>((t,e)=>{const n=new Uint8Array(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n})(t,bu(t)),yu=t=>t.arr[t.pos++],bu=t=>{let e=0,n=1;const r=t.arr.length;for(;t.pos<r;){const r=t.arr[t.pos++];if(e+=(r&Rc)*n,n*=128,r<Lc)return e;if(e>Bc)throw pu}throw hu},vu=t=>{let e=t.arr[t.pos++],n=63&e,r=64;const o=(e&Ic)>0?-1:1;if(0===(e&Lc))return o*n;const i=t.arr.length;for(;t.pos<i;){if(e=t.arr[t.pos++],n+=(e&Rc)*r,r*=128,e<Lc)return o*n;if(n>Bc)throw pu}throw hu},wu=qc?t=>qc.decode(mu(t)):t=>{let e=bu(t);if(0===e)return"";{let n=String.fromCodePoint(yu(t));if(--e<100)for(;e--;)n+=String.fromCodePoint(yu(t));else for(;e>0;){const r=e<1e4?e:1e4,o=t.arr.subarray(t.pos,t.pos+r);t.pos+=r,n+=String.fromCodePoint.apply(null,o),e-=r}return decodeURIComponent(escape(n))}},Au=(t,e)=>{const n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},ku=[t=>{},t=>null,vu,t=>Au(t,4).getFloat32(0,!1),t=>Au(t,8).getFloat64(0,!1),t=>Au(t,8).getBigInt64(0,!1),t=>!1,t=>!0,wu,t=>{const e=bu(t),n={};for(let r=0;r<e;r++)n[wu(t)]=xu(t);return n},t=>{const e=bu(t),n=[];for(let r=0;r<e;r++)n.push(xu(t));return n},mu],xu=t=>ku[127-yu(t)](t);class Cu extends fu{constructor(t,e){super(t),this.reader=e,this.s=null,this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),(t=this).pos!==t.arr.length?this.count=bu(this)+1:this.count=-1),this.count--,this.s;var t}}class Su extends fu{constructor(t){super(t),this.s=0,this.count=0}read(){if(0===this.count){this.s=vu(this);const t=dc(this.s);this.count=1,t&&(this.s=-this.s,this.count=bu(this)+2)}return this.count--,this.s}}class Eu extends fu{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(0===this.count){const t=vu(this),e=1&t;this.diff=ac(t/2),this.count=1,e&&(this.count=bu(this)+2)}return this.s+=this.diff,this.count--,this.s}}class Mu{constructor(t){this.decoder=new Su(t),this.str=wu(this.decoder),this.spos=0}read(){const t=this.spos+this.decoder.read(),e=this.str.slice(this.spos,t);return this.spos=t,e}}crypto.subtle;const _u=crypto.getRandomValues.bind(crypto),Tu=Math.random,Du=()=>_u(new Uint32Array(1))[0],Ou=[1e7]+-1e3+-4e3+-8e3+-1e11,Nu=()=>Ou.replace(/[018]/g,t=>(t^Du()&15>>t/4).toString(16)),Iu=t=>new Promise(t),Lu=(Promise.all.bind(Promise),t=>void 0===t?null:t);let Ru=new class{constructor(){this.map=new Map}setItem(t,e){this.map.set(t,e)}getItem(t){return this.map.get(t)}},Bu=!0;try{"undefined"!=typeof localStorage&&localStorage&&(Ru=localStorage,Bu=!1)}catch(t){}const $u=Ru,Pu=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;try{for(;n<t.length;n++)t[n](...e)}finally{n<t.length&&Pu(t,e,n+1)}},Fu=t=>t,zu="undefined"!=typeof process&&process.release&&/node|io\.js/.test(process.release.name)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0),Hu="undefined"!=typeof window&&"undefined"!=typeof document&&!zu;let ju;"undefined"!=typeof navigator&&/Mac/.test(navigator.platform);const Vu=[],qu=t=>(()=>{if(void 0===ju)if(zu){ju=Cc();const t=process.argv;let e=null;for(let n=0;n<t.length;n++){const r=t[n];"-"===r[0]?(null!==e&&ju.set(e,""),e=r):null!==e?(ju.set(e,r),e=null):Vu.push(r)}null!==e&&ju.set(e,"")}else"object"==typeof location?(ju=Cc(),(location.search||"?").slice(1).split("&").forEach(t=>{if(0!==t.length){const[e,n]=t.split("=");ju.set(`--${Hc(e,"-")}`,n),ju.set(`-${Hc(e,"-")}`,n)}})):ju=Cc();return ju})().has(t),Uu=t=>Lu(zu?process.env[t.toUpperCase().replaceAll("-","_")]:$u.getItem(t)),Wu=t=>qu("--"+t)||null!==Uu(t),Ju=(Wu("production"),zu&&(Yu=process.env.FORCE_COLOR,["true","1","2"].includes(Yu)))||!qu("--no-colors")&&!Wu("no-color")&&(!zu||process.stdout.isTTY)&&(!zu||qu("--color")||null!==Uu("COLORTERM")||(Uu("TERM")||"").includes("color")),Ku=Hu?t=>{let e="";for(let n=0;n<t.byteLength;n++)e+=Pc(t[n]);return btoa(e)}:t=>Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("base64"),Gu=t=>(()=>{const e=Wc();return(e=>{iu(e,t)})(e),Jc(e)})();var Yu;class Zu{constructor(t,e){this.left=t,this.right=e}}const Qu=(t,e)=>new Zu(t,e),Xu="undefined"!=typeof document?document:{},td=("undefined"!=typeof DOMParser&&new DOMParser,t=>((t,e)=>{const n=[];for(const[r,o]of t)n.push(e(o,r));return n})(t,(t,e)=>`${e}:${t};`).join("")),ed=(Xu.ELEMENT_NODE,Xu.TEXT_NODE,Xu.CDATA_SECTION_NODE,Xu.COMMENT_NODE,Xu.DOCUMENT_NODE,Xu.DOCUMENT_TYPE_NODE,Xu.DOCUMENT_FRAGMENT_NODE,Symbol),nd=Date.now,rd=ed(),od=ed(),id=ed(),sd=ed(),ad=ed(),ld=ed(),cd=ed(),ud=ed(),dd=ed();nd();const hd={[rd]:Qu("font-weight","bold"),[od]:Qu("font-weight","normal"),[id]:Qu("color","blue"),[ad]:Qu("color","green"),[sd]:Qu("color","grey"),[ld]:Qu("color","red"),[cd]:Qu("color","purple"),[ud]:Qu("color","orange"),[dd]:Qu("color","black")},pd=Ju?t=>{var e;1===t.length&&(null===(e=t[0])||void 0===e?void 0:e.constructor)===Function&&(t=t[0]());const n=[],r=[],o=Cc();let i=[],s=0;for(;s<t.length;s++){const e=t[s],i=hd[e];if(void 0!==i)o.set(i.left,i.right);else{if(void 0===e)break;if(e.constructor!==String&&e.constructor!==Number)break;{const t=td(o);s>0||t.length>0?(n.push("%c"+e),r.push(t)):n.push(e)}}}for(s>0&&(i=r,i.unshift(n.join("")));s<t.length;s++){const e=t[s];e instanceof Symbol||i.push(e)}return i}:t=>{var e;1===t.length&&(null===(e=t[0])||void 0===e?void 0:e.constructor)===Function&&(t=t[0]());const n=[],r=[];let o=0;for(;o<t.length;o++){const e=t[o];if(void 0===e)break;if(e.constructor===String||e.constructor===Number)n.push(e);else if(e.constructor===Object)break}for(o>0&&r.push(n.join(""));o<t.length;o++){const e=t[o];e instanceof Symbol||r.push(e)}return r},fd=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];console.log(...pd(e)),md.forEach(t=>t.print(e))},gd=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];console.warn(...pd(e)),e.unshift(ud),md.forEach(t=>t.print(e))},md=bc(),yd=t=>({[Symbol.iterator](){return this},next:t}),bd=(t,e)=>yd(()=>{const{done:n,value:r}=t.next();return{done:n,value:n?void 0:e(r)}});class vd{constructor(t,e){this.clock=t,this.len=e}}class wd{constructor(){this.clients=new Map}}const Ad=(t,e,n)=>e.clients.forEach((e,r)=>{const o=t.doc.store.clients.get(r);if(null!=o){const r=o[o.length-1],i=r.id.clock+r.length;for(let r=0,s=e[r];r<e.length&&s.clock<i;s=e[++r])vh(t,o,s.clock,s.len,n)}}),kd=(t,e)=>{const n=t.clients.get(e.client);return void 0!==n&&null!==((t,e)=>{let n=0,r=t.length-1;for(;n<=r;){const o=ac((n+r)/2),i=t[o],s=i.clock;if(s<=e){if(e<s+i.len)return o;n=o+1}else r=o-1}return null})(n,e.clock)},xd=t=>{t.clients.forEach(t=>{let e,n;for(t.sort((t,e)=>t.clock-e.clock),e=1,n=1;e<t.length;e++){const r=t[n-1],o=t[e];r.clock+r.len>=o.clock?r.len=uc(r.len,o.clock+o.len-r.clock):(n<e&&(t[n]=o),n++)}t.length=n})},Cd=t=>{const e=new wd;for(let n=0;n<t.length;n++)t[n].clients.forEach((r,o)=>{if(!e.clients.has(o)){const i=r.slice();for(let e=n+1;e<t.length;e++)_c(i,t[e].clients.get(o)||[]);e.clients.set(o,i)}});return xd(e),e},Sd=(t,e,n,r)=>{Ec(t.clients,e,()=>[]).push(new vd(n,r))},Ed=()=>new wd,Md=t=>{const e=Ed();return t.clients.forEach((t,n)=>{const r=[];for(let e=0;e<t.length;e++){const n=t[e];if(n.deleted){const o=n.id.clock;let i=n.length;if(e+1<t.length)for(let n=t[e+1];e+1<t.length&&n.deleted;n=t[1+ ++e])i+=n.length;r.push(new vd(o,i))}}r.length>0&&e.clients.set(n,r)}),e},_d=(t,e)=>{Yc(t.restEncoder,e.clients.size),Tc(e.clients.entries()).sort((t,e)=>e[0]-t[0]).forEach(([e,n])=>{t.resetDsCurVal(),Yc(t.restEncoder,e);const r=n.length;Yc(t.restEncoder,r);for(let e=0;e<r;e++){const r=n[e];t.writeDsClock(r.clock),t.writeDsLen(r.len)}})},Td=t=>{const e=new wd,n=bu(t.restDecoder);for(let r=0;r<n;r++){t.resetDsCurVal();const n=bu(t.restDecoder),r=bu(t.restDecoder);if(r>0){const o=Ec(e.clients,n,()=>[]);for(let e=0;e<r;e++)o.push(new vd(t.readDsClock(),t.readDsLen()))}}return e},Dd=(t,e,n)=>{const r=new wd,o=bu(t.restDecoder);for(let i=0;i<o;i++){t.resetDsCurVal();const o=bu(t.restDecoder),i=bu(t.restDecoder),s=n.clients.get(o)||[],a=hh(n,o);for(let n=0;n<i;n++){const n=t.readDsClock(),i=n+t.readDsLen();if(n<a){a<i&&Sd(r,o,a,i-a);let t=fh(s,n),l=s[t];for(!l.deleted&&l.id.clock<n&&(s.splice(t+1,0,hf(e,l,n-l.id.clock)),t++);t<s.length&&(l=s[t++],l.id.clock<i);)l.deleted||(i<l.id.clock+l.length&&s.splice(t,0,hf(e,l,i-l.id.clock)),l.delete(e))}else Sd(r,o,n,i-n)}}if(r.clients.size>0){const t=new zd;return Yc(t.restEncoder,0),_d(t,r),t.toUint8Array()}return null},Od=Du;class Nd extends Oc{constructor({guid:t=Nu(),collectionid:e=null,gc:n=!0,gcFilter:r=()=>!0,meta:o=null,autoLoad:i=!1,shouldLoad:s=!0}={}){super(),this.gc=n,this.gcFilter=r,this.clientID=Od(),this.guid=t,this.collectionid=e,this.share=new Map,this.store=new uh,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=s,this.autoLoad=i,this.meta=o,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=Iu(t=>{this.on("load",()=>{this.isLoaded=!0,t(this)})});const a=()=>Iu(t=>{const e=n=>{void 0!==n&&!0!==n||(this.off("sync",e),t())};this.on("sync",e)});this.on("sync",t=>{!1===t&&this.isSynced&&(this.whenSynced=a()),this.isSynced=void 0===t||!0===t,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=a()}load(){const t=this._item;null===t||this.shouldLoad||Sh(t.parent.doc,t=>{t.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Tc(this.subdocs).map(t=>t.guid))}transact(t,e=null){return Sh(this,t,e)}get(t,e=Qh){const n=Ec(this.share,t,()=>{const t=new e;return t._integrate(this,null),t}),r=n.constructor;if(e!==Qh&&r!==e){if(r===Qh){const r=new e;r._map=n._map,n._map.forEach(t=>{for(;null!==t;t=t.left)t.parent=r}),r._start=n._start;for(let t=r._start;null!==t;t=t.right)t.parent=r;return r._length=n._length,this.share.set(t,r),r._integrate(this,null),r}throw new Error(`Type with the name ${t} has already been defined with a different constructor`)}return n}getArray(t=""){return this.get(t,yp)}getText(t=""){return this.get(t,Rp)}getMap(t=""){return this.get(t,vp)}getXmlElement(t=""){return this.get(t,Pp)}getXmlFragment(t=""){return this.get(t,$p)}toJSON(){const t={};return this.share.forEach((e,n)=>{t[n]=e.toJSON()}),t}destroy(){this.isDestroyed=!0,Tc(this.subdocs).forEach(t=>t.destroy());const t=this._item;if(null!==t){this._item=null;const e=t.content;e.doc=new Nd({guid:this.guid,...e.opts,shouldLoad:!1}),e.doc._item=t,Sh(t.parent.doc,n=>{const r=e.doc;t.deleted||n.subdocsAdded.add(r),n.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class Id{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return bu(this.restDecoder)}readDsLen(){return bu(this.restDecoder)}}class Ld extends Id{readLeftID(){return Qd(bu(this.restDecoder),bu(this.restDecoder))}readRightID(){return Qd(bu(this.restDecoder),bu(this.restDecoder))}readClient(){return bu(this.restDecoder)}readInfo(){return yu(this.restDecoder)}readString(){return wu(this.restDecoder)}readParentInfo(){return 1===bu(this.restDecoder)}readTypeRef(){return bu(this.restDecoder)}readLen(){return bu(this.restDecoder)}readAny(){return xu(this.restDecoder)}readBuf(){return(t=>{const e=(n=t.byteLength,new Uint8Array(n));var n;return e.set(t),e})(mu(this.restDecoder))}readJSON(){return JSON.parse(wu(this.restDecoder))}readKey(){return wu(this.restDecoder)}}class Rd{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=bu(this.restDecoder),this.dsCurrVal}readDsLen(){const t=bu(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class Bd extends Rd{constructor(t){super(t),this.keys=[],bu(t),this.keyClockDecoder=new Eu(mu(t)),this.clientDecoder=new Su(mu(t)),this.leftClockDecoder=new Eu(mu(t)),this.rightClockDecoder=new Eu(mu(t)),this.infoDecoder=new Cu(mu(t),yu),this.stringDecoder=new Mu(mu(t)),this.parentInfoDecoder=new Cu(mu(t),yu),this.typeRefDecoder=new Su(mu(t)),this.lenDecoder=new Su(mu(t))}readLeftID(){return new Yd(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Yd(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return xu(this.restDecoder)}readBuf(){return mu(this.restDecoder)}readJSON(){return xu(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const t=this.stringDecoder.read();return this.keys.push(t),t}}}class $d{constructor(){this.restEncoder=Wc()}toUint8Array(){return Jc(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){Yc(this.restEncoder,t)}writeDsLen(t){Yc(this.restEncoder,t)}}class Pd extends $d{writeLeftID(t){Yc(this.restEncoder,t.client),Yc(this.restEncoder,t.clock)}writeRightID(t){Yc(this.restEncoder,t.client),Yc(this.restEncoder,t.clock)}writeClient(t){Yc(this.restEncoder,t)}writeInfo(t){Gc(this.restEncoder,t)}writeString(t){tu(this.restEncoder,t)}writeParentInfo(t){Yc(this.restEncoder,t?1:0)}writeTypeRef(t){Yc(this.restEncoder,t)}writeLen(t){Yc(this.restEncoder,t)}writeAny(t){iu(this.restEncoder,t)}writeBuf(t){nu(this.restEncoder,t)}writeJSON(t){tu(this.restEncoder,JSON.stringify(t))}writeKey(t){tu(this.restEncoder,t)}}class Fd{constructor(){this.restEncoder=Wc(),this.dsCurrVal=0}toUint8Array(){return Jc(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const e=t-this.dsCurrVal;this.dsCurrVal=t,Yc(this.restEncoder,e)}writeDsLen(t){0===t&&xc(),Yc(this.restEncoder,t-1),this.dsCurrVal+=t}}class zd extends Fd{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new uu,this.clientEncoder=new lu,this.leftClockEncoder=new uu,this.rightClockEncoder=new uu,this.infoEncoder=new su(Gc),this.stringEncoder=new du,this.parentInfoEncoder=new su(Gc),this.typeRefEncoder=new lu,this.lenEncoder=new lu}toUint8Array(){const t=Wc();return Yc(t,0),nu(t,this.keyClockEncoder.toUint8Array()),nu(t,this.clientEncoder.toUint8Array()),nu(t,this.leftClockEncoder.toUint8Array()),nu(t,this.rightClockEncoder.toUint8Array()),nu(t,Jc(this.infoEncoder)),nu(t,this.stringEncoder.toUint8Array()),nu(t,Jc(this.parentInfoEncoder)),nu(t,this.typeRefEncoder.toUint8Array()),nu(t,this.lenEncoder.toUint8Array()),eu(t,Jc(this.restEncoder)),Jc(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){iu(this.restEncoder,t)}writeBuf(t){nu(this.restEncoder,t)}writeJSON(t){iu(this.restEncoder,t)}writeKey(t){const e=this.keyMap.get(t);void 0===e?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(e)}}const Hd=(t,e,n)=>{const r=new Map;n.forEach((t,n)=>{hh(e,n)>t&&r.set(n,t)}),dh(e).forEach((t,e)=>{n.has(e)||r.set(e,0)}),Yc(t.restEncoder,r.size),Tc(r.entries()).sort((t,e)=>e[0]-t[0]).forEach(([n,r])=>{((t,e,n,r)=>{r=uc(r,e[0].id.clock);const o=fh(e,r);Yc(t.restEncoder,e.length-o),t.writeClient(n),Yc(t.restEncoder,r);const i=e[o];i.write(t,r-i.id.clock);for(let n=o+1;n<e.length;n++)e[n].write(t,0)})(t,e.clients.get(n),n,r)})},jd=(t,e,n,r=Bd)=>{const o=gu(e);((t,e,n,r=new Bd(t))=>{Sh(e,t=>{t.local=!1;let e=!1;const n=t.doc,o=n.store,i=((t,e)=>{const n=Cc(),r=bu(t.restDecoder);for(let o=0;o<r;o++){const r=bu(t.restDecoder),o=new Array(r),i=t.readClient();let s=bu(t.restDecoder);n.set(i,{i:0,refs:o});for(let n=0;n<r;n++){const r=t.readInfo();switch(31&r){case 0:{const e=t.readLen();o[n]=new Vp(Qd(i,s),e),s+=e;break}case 10:{const e=bu(t.restDecoder);o[n]=new bf(Qd(i,s),e),s+=e;break}default:{const a=!(192&r),l=new gf(Qd(i,s),null,(r&Lc)===Lc?t.readLeftID():null,null,(r&Ic)===Ic?t.readRightID():null,a?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,!a||32&~r?null:t.readString(),mf(t,r));o[n]=l,s+=l.length}}}}return n})(r,n),s=((t,e,n)=>{const r=[];let o=Tc(n.keys()).sort((t,e)=>t-e);if(0===o.length)return null;const i=()=>{if(0===o.length)return null;let t=n.get(o[o.length-1]);for(;t.refs.length===t.i;){if(o.pop(),!(o.length>0))return null;t=n.get(o[o.length-1])}return t};let s=i();if(null===s)return null;const a=new uh,l=new Map,c=(t,e)=>{const n=l.get(t);(null==n||n>e)&&l.set(t,e)};let u=s.refs[s.i++];const d=new Map,h=()=>{for(const t of r){const e=t.id.client,r=n.get(e);r?(r.i--,a.clients.set(e,r.refs.slice(r.i)),n.delete(e),r.i=0,r.refs=[]):a.clients.set(e,[t]),o=o.filter(t=>t!==e)}r.length=0};for(;;){if(u.constructor!==bf){const o=Ec(d,u.id.client,()=>hh(e,u.id.client))-u.id.clock;if(o<0)r.push(u),c(u.id.client,u.id.clock-1),h();else{const i=u.getMissing(t,e);if(null!==i){r.push(u);const t=n.get(i)||{refs:[],i:0};if(t.refs.length!==t.i){u=t.refs[t.i++];continue}c(i,hh(e,i)),h()}else(0===o||o<u.length)&&(u.integrate(t,o),d.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(null!==s&&s.i<s.refs.length)u=s.refs[s.i++];else{if(s=i(),null===s)break;u=s.refs[s.i++]}}if(a.clients.size>0){const t=new zd;return Hd(t,a,new Map),Yc(t.restEncoder,0),{missing:l,update:t.toUint8Array()}}return null})(t,o,i),a=o.pendingStructs;if(a){for(const[t,n]of a.missing)if(n<hh(o,t)){e=!0;break}if(s){for(const[t,e]of s.missing){const n=a.missing.get(t);(null==n||n>e)&&a.missing.set(t,e)}a.update=Bh([a.update,s.update])}}else o.pendingStructs=s;const l=Dd(r,t,o);if(o.pendingDs){const e=new Bd(gu(o.pendingDs));bu(e.restDecoder);const n=Dd(e,t,o);o.pendingDs=l&&n?Bh([l,n]):l||n}else o.pendingDs=l;if(e){const e=o.pendingStructs.update;o.pendingStructs=null,jd(t.doc,e)}},n,!1)})(o,t,n,new r(o))},Vd=(t,e,n)=>jd(t,e,n,Ld),qd=t=>(t=>{const e=new Map,n=bu(t.restDecoder);for(let r=0;r<n;r++){const n=bu(t.restDecoder),r=bu(t.restDecoder);e.set(n,r)}return e})(new Id(gu(t)));class Ud{constructor(){this.l=[]}}const Wd=()=>new Ud,Jd=(t,e)=>t.l.push(e),Kd=(t,e)=>{const n=t.l,r=n.length;t.l=n.filter(t=>e!==t),r===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Gd=(t,e,n)=>Pu(t.l,[e,n]);class Yd{constructor(t,e){this.client=t,this.clock=e}}const Zd=(t,e)=>t===e||null!==t&&null!==e&&t.client===e.client&&t.clock===e.clock,Qd=(t,e)=>new Yd(t,e),Xd=t=>{for(const[e,n]of t.doc.share.entries())if(n===t)return e;throw xc()},th=(t,e)=>{for(;null!==e;){if(e.parent===t)return!0;e=e.parent._item}return!1};class eh{constructor(t,e,n,r=0){this.type=t,this.tname=e,this.item=n,this.assoc=r}}class nh{constructor(t,e,n=0){this.type=t,this.index=e,this.assoc=n}}const rh=(t,e,n)=>{let r=null,o=null;return null===t._item?o=Xd(t):r=Qd(t._item.id.client,t._item.id.clock),new eh(r,o,e,n)},oh=(t,e,n=0)=>{let r=t._start;if(n<0){if(0===e)return rh(t,null,n);e--}for(;null!==r;){if(!r.deleted&&r.countable){if(r.length>e)return rh(t,Qd(r.id.client,r.id.clock+e),n);e-=r.length}if(null===r.right&&n<0)return rh(t,r.lastId,n);r=r.right}return rh(t,null,n)};class ih{constructor(t,e){this.ds=t,this.sv=e}}const sh=(t,e)=>new ih(t,e),ah=(sh(Ed(),new Map),t=>sh(Md(t.store),dh(t.store))),lh=(t,e)=>void 0===e?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!kd(e.ds,t.id),ch=(t,e)=>{const n=Ec(t.meta,ch,bc),r=t.doc.store;n.has(e)||(e.sv.forEach((e,n)=>{e<hh(r,n)&&yh(t,Qd(n,e))}),Ad(t,e.ds,t=>{}),n.add(e))};class uh{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const dh=t=>{const e=new Map;return t.clients.forEach((t,n)=>{const r=t[t.length-1];e.set(n,r.id.clock+r.length)}),e},hh=(t,e)=>{const n=t.clients.get(e);if(void 0===n)return 0;const r=n[n.length-1];return r.id.clock+r.length},ph=(t,e)=>{let n=t.clients.get(e.id.client);if(void 0===n)n=[],t.clients.set(e.id.client,n);else{const t=n[n.length-1];if(t.id.clock+t.length!==e.id.clock)throw xc()}n.push(e)},fh=(t,e)=>{let n=0,r=t.length-1,o=t[r],i=o.id.clock;if(i===e)return r;let s=ac(e/(i+o.length-1)*r);for(;n<=r;){if(o=t[s],i=o.id.clock,i<=e){if(e<i+o.length)return s;n=s+1}else r=s-1;s=ac((n+r)/2)}throw xc()},gh=(t,e)=>{const n=t.clients.get(e.client);return n[fh(n,e.clock)]},mh=(t,e,n)=>{const r=fh(e,n),o=e[r];return o.id.clock<n&&o instanceof gf?(e.splice(r+1,0,hf(t,o,n-o.id.clock)),r+1):r},yh=(t,e)=>{const n=t.doc.store.clients.get(e.client);return n[mh(t,n,e.clock)]},bh=(t,e,n)=>{const r=e.clients.get(n.client),o=fh(r,n.clock),i=r[o];return n.clock!==i.id.clock+i.length-1&&i.constructor!==Vp&&r.splice(o+1,0,hf(t,i,n.clock-i.id.clock+1)),i},vh=(t,e,n,r,o)=>{if(0===r)return;const i=n+r;let s,a=mh(t,e,n);do{s=e[a++],i<s.id.clock+s.length&&mh(t,e,i),o(s)}while(a<e.length&&e[a].id.clock<i)};class wh{constructor(t,e,n){this.doc=t,this.deleteSet=new wd,this.beforeState=dh(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=e,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const Ah=(t,e)=>!(0===e.deleteSet.clients.size&&!((t,e)=>{for(const[n,r]of t)if(e(r,n))return!0;return!1})(e.afterState,(t,n)=>e.beforeState.get(n)!==t)||(xd(e.deleteSet),((t,e)=>{Hd(t,e.doc.store,e.beforeState)})(t,e),_d(t,e.deleteSet),0)),kh=(t,e,n)=>{const r=e._item;(null===r||r.id.clock<(t.beforeState.get(r.id.client)||0)&&!r.deleted)&&Ec(t.changed,e,bc).add(n)},xh=(t,e)=>{let n=t[e],r=t[e-1],o=e;for(;o>0&&r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n);n=r,r=t[--o-1])n instanceof gf&&null!==n.parentSub&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);const i=e-o;return i&&t.splice(e+1-i,i),i},Ch=(t,e)=>{if(e<t.length){const n=t[e],r=n.doc,o=r.store,i=n.deleteSet,s=n._mergeStructs;try{xd(i),n.afterState=dh(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const t=[];n.changed.forEach((e,r)=>t.push(()=>{null!==r._item&&r._item.deleted||r._callObserver(n,e)})),t.push(()=>{n.changedParentTypes.forEach((t,e)=>{e._dEH.l.length>0&&(null===e._item||!e._item.deleted)&&((t=t.filter(t=>null===t.target._item||!t.target._item.deleted)).forEach(t=>{t.currentTarget=e,t._path=null}),t.sort((t,e)=>t.path.length-e.path.length),Gd(e._dEH,t,n))})}),t.push(()=>r.emit("afterTransaction",[n,r])),Pu(t,[]),n._needFormattingCleanup&&Np(n)}finally{r.gc&&((t,e,n)=>{for(const[r,o]of t.clients.entries()){const t=e.clients.get(r);for(let r=o.length-1;r>=0;r--){const i=o[r],s=i.clock+i.len;for(let r=fh(t,i.clock),o=t[r];r<t.length&&o.id.clock<s;o=t[++r]){const o=t[r];if(i.clock+i.len<=o.id.clock)break;o instanceof gf&&o.deleted&&!o.keep&&n(o)&&o.gc(e,!1)}}}})(i,o,r.gcFilter),((t,e)=>{t.clients.forEach((t,n)=>{const r=e.clients.get(n);for(let e=t.length-1;e>=0;e--){const n=t[e];for(let t=cc(r.length-1,1+fh(r,n.clock+n.len-1)),e=r[t];t>0&&e.id.clock>=n.clock;e=r[t])t-=1+xh(r,t)}})})(i,o),n.afterState.forEach((t,e)=>{const r=n.beforeState.get(e)||0;if(r!==t){const t=o.clients.get(e),n=uc(fh(t,r),1);for(let e=t.length-1;e>=n;)e-=1+xh(t,e)}});for(let t=s.length-1;t>=0;t--){const{client:e,clock:n}=s[t].id,r=o.clients.get(e),i=fh(r,n);i+1<r.length&&xh(r,i+1)>1||i>0&&xh(r,i)}if(n.local||n.afterState.get(r.clientID)===n.beforeState.get(r.clientID)||(fd(ud,rd,"[yjs] ",od,ld,"Changed the client-id because another client seems to be using it."),r.clientID=Od()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const t=new Pd;Ah(t,n)&&r.emit("update",[t.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const t=new zd;Ah(t,n)&&r.emit("updateV2",[t.toUint8Array(),n.origin,r,n])}const{subdocsAdded:a,subdocsLoaded:l,subdocsRemoved:c}=n;(a.size>0||c.size>0||l.size>0)&&(a.forEach(t=>{t.clientID=r.clientID,null==t.collectionid&&(t.collectionid=r.collectionid),r.subdocs.add(t)}),c.forEach(t=>r.subdocs.delete(t)),r.emit("subdocs",[{loaded:l,added:a,removed:c},r,n]),c.forEach(t=>t.destroy())),t.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,t])):Ch(t,e+1)}}},Sh=(t,e,n=null,r=!0)=>{const o=t._transactionCleanups;let i=!1,s=null;null===t._transaction&&(i=!0,t._transaction=new wh(t,n,r),o.push(t._transaction),1===o.length&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{s=e(t._transaction)}finally{if(i){const e=t._transaction===o[0];t._transaction=null,e&&Ch(o,0)}}return s};class Eh{constructor(t,e){this.insertions=e,this.deletions=t,this.meta=new Map}}const Mh=(t,e,n)=>{Ad(t,n.deletions,n=>{n instanceof gf&&e.scope.some(e=>e===t.doc||th(e,n))&&df(n,!1)})},_h=(t,e,n)=>{let r=null;const o=t.doc,i=t.scope;Sh(o,n=>{for(;e.length>0&&null===t.currStackItem;){const r=o.store,s=e.pop(),a=new Set,l=[];let c=!1;Ad(n,s.insertions,t=>{if(t instanceof gf){if(null!==t.redone){let{item:e,diff:o}=uf(r,t.id);o>0&&(e=yh(n,Qd(e.id.client,e.id.clock+o))),t=e}!t.deleted&&i.some(e=>e===n.doc||th(e,t))&&l.push(t)}}),Ad(n,s.deletions,t=>{t instanceof gf&&i.some(e=>e===n.doc||th(e,t))&&!kd(s.insertions,t.id)&&a.add(t)}),a.forEach(e=>{c=null!==ff(n,e,a,s.insertions,t.ignoreRemoteMapChanges,t)||c});for(let e=l.length-1;e>=0;e--){const r=l[e];t.deleteFilter(r)&&(r.delete(n),c=!0)}t.currStackItem=c?s:null}n.changed.forEach((t,e)=>{t.has(null)&&e._searchMarker&&(e._searchMarker.length=0)}),r=n},t);const s=t.currStackItem;if(null!=s){const e=r.changedParentTypes;t.emit("stack-item-popped",[{stackItem:s,type:n,changedParentTypes:e,origin:t},t]),t.currStackItem=null}return s};class Th extends Oc{constructor(t,{captureTimeout:e=500,captureTransaction:n=t=>!0,deleteFilter:r=()=>!0,trackedOrigins:o=new Set([null]),ignoreRemoteMapChanges:i=!1,doc:s=(Dc(t)?t[0].doc:t instanceof Nd?t:t.doc)}={}){super(),this.scope=[],this.doc=s,this.addToScope(t),this.deleteFilter=r,o.add(this),this.trackedOrigins=o,this.captureTransaction=n,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=i,this.captureTimeout=e,this.afterTransactionHandler=t=>{if(!(this.captureTransaction(t)&&this.scope.some(e=>t.changedParentTypes.has(e)||e===this.doc)&&(this.trackedOrigins.has(t.origin)||t.origin&&this.trackedOrigins.has(t.origin.constructor))))return;const e=this.undoing,n=this.redoing,r=e?this.redoStack:this.undoStack;e?this.stopCapturing():n||this.clear(!1,!0);const o=new wd;t.afterState.forEach((e,n)=>{const r=t.beforeState.get(n)||0,i=e-r;i>0&&Sd(o,n,r,i)});const i=nd();let s=!1;if(this.lastChange>0&&i-this.lastChange<this.captureTimeout&&r.length>0&&!e&&!n){const e=r[r.length-1];e.deletions=Cd([e.deletions,t.deleteSet]),e.insertions=Cd([e.insertions,o])}else r.push(new Eh(t.deleteSet,o)),s=!0;e||n||(this.lastChange=i),Ad(t,t.deleteSet,e=>{e instanceof gf&&this.scope.some(n=>n===t.doc||th(n,e))&&df(e,!0)});const a=[{stackItem:r[r.length-1],origin:t.origin,type:e?"redo":"undo",changedParentTypes:t.changedParentTypes},this];s?this.emit("stack-item-added",a):this.emit("stack-item-updated",a)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(t){const e=new Set(this.scope);(t=Dc(t)?t:[t]).forEach(t=>{e.has(t)||(e.add(t),(t instanceof Qh?t.doc!==this.doc:t!==this.doc)&&gd("[yjs#509] Not same Y.Doc"),this.scope.push(t))})}addTrackedOrigin(t){this.trackedOrigins.add(t)}removeTrackedOrigin(t){this.trackedOrigins.delete(t)}clear(t=!0,e=!0){(t&&this.canUndo()||e&&this.canRedo())&&this.doc.transact(n=>{t&&(this.undoStack.forEach(t=>Mh(n,this,t)),this.undoStack=[]),e&&(this.redoStack.forEach(t=>Mh(n,this,t)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:e}])})}stopCapturing(){this.lastChange=0}undo(){let t;this.undoing=!0;try{t=_h(this,this.undoStack,"undo")}finally{this.undoing=!1}return t}redo(){let t;this.redoing=!0;try{t=_h(this,this.redoStack,"redo")}finally{this.redoing=!1}return t}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}class Dh{constructor(t,e){this.gen=function*(t){const e=bu(t.restDecoder);for(let n=0;n<e;n++){const e=bu(t.restDecoder),n=t.readClient();let r=bu(t.restDecoder);for(let o=0;o<e;o++){const e=t.readInfo();if(10===e){const e=bu(t.restDecoder);yield new bf(Qd(n,r),e),r+=e}else if(31&e){const o=!(192&e),i=new gf(Qd(n,r),null,(e&Lc)===Lc?t.readLeftID():null,null,(e&Ic)===Ic?t.readRightID():null,o?t.readParentInfo()?t.readString():t.readLeftID():null,!o||32&~e?null:t.readString(),mf(t,e));yield i,r+=i.length}else{const e=t.readLen();yield new Vp(Qd(n,r),e),r+=e}}}}(t),this.curr=null,this.done=!1,this.filterSkips=e,this.next()}next(){do{this.curr=this.gen.next().value||null}while(this.filterSkips&&null!==this.curr&&this.curr.constructor===bf);return this.curr}}const Oh=t=>Nh(t,Ld),Nh=(t,e=Bd)=>{const n=[],r=new e(gu(t)),o=new Dh(r,!1);for(let t=o.curr;null!==t;t=o.next())n.push(t);return{structs:n,ds:Td(r)}};class Ih{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const Lh=t=>Bh(t,Ld,Pd),Rh=(t,e)=>{if(t.constructor===Vp){const{client:n,clock:r}=t.id;return new Vp(Qd(n,r+e),t.length-e)}if(t.constructor===bf){const{client:n,clock:r}=t.id;return new bf(Qd(n,r+e),t.length-e)}{const n=t,{client:r,clock:o}=n.id;return new gf(Qd(r,o+e),null,Qd(r,o+e-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(e))}},Bh=(t,e=Bd,n=zd)=>{if(1===t.length)return t[0];const r=t.map(t=>new e(gu(t)));let o=r.map(t=>new Dh(t,!0)),i=null;const s=new n,a=new Ih(s);for(;o=o.filter(t=>null!==t.curr),o.sort((t,e)=>{if(t.curr.id.client===e.curr.id.client){const n=t.curr.id.clock-e.curr.id.clock;return 0===n?t.curr.constructor===e.curr.constructor?0:t.curr.constructor===bf?1:-1:n}return e.curr.id.client-t.curr.id.client}),0!==o.length;){const t=o[0],e=t.curr.id.client;if(null!==i){let n=t.curr,r=!1;for(;null!==n&&n.id.clock+n.length<=i.struct.id.clock+i.struct.length&&n.id.client>=i.struct.id.client;)n=t.next(),r=!0;if(null===n||n.id.client!==e||r&&n.id.clock>i.struct.id.clock+i.struct.length)continue;if(e!==i.struct.id.client)Fh(a,i.struct,i.offset),i={struct:n,offset:0},t.next();else if(i.struct.id.clock+i.struct.length<n.id.clock)if(i.struct.constructor===bf)i.struct.length=n.id.clock+n.length-i.struct.id.clock;else{Fh(a,i.struct,i.offset);const t=n.id.clock-i.struct.id.clock-i.struct.length;i={struct:new bf(Qd(e,i.struct.id.clock+i.struct.length),t),offset:0}}else{const e=i.struct.id.clock+i.struct.length-n.id.clock;e>0&&(i.struct.constructor===bf?i.struct.length-=e:n=Rh(n,e)),i.struct.mergeWith(n)||(Fh(a,i.struct,i.offset),i={struct:n,offset:0},t.next())}}else i={struct:t.curr,offset:0},t.next();for(let n=t.curr;null!==n&&n.id.client===e&&n.id.clock===i.struct.id.clock+i.struct.length&&n.constructor!==bf;n=t.next())Fh(a,i.struct,i.offset),i={struct:n,offset:0}}null!==i&&(Fh(a,i.struct,i.offset),i=null),zh(a);const l=r.map(t=>Td(t)),c=Cd(l);return _d(s,c),s.toUint8Array()},$h=(t,e,n=Bd,r=zd)=>{const o=qd(e),i=new r,s=new Ih(i),a=new n(gu(t)),l=new Dh(a,!1);for(;l.curr;){const t=l.curr,e=t.id.client,n=o.get(e)||0;if(l.curr.constructor!==bf)if(t.id.clock+t.length>n)for(Fh(s,t,uc(n-t.id.clock,0)),l.next();l.curr&&l.curr.id.client===e;)Fh(s,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===e&&l.curr.id.clock+l.curr.length<=n;)l.next();else l.next()}zh(s);const c=Td(a);return _d(i,c),i.toUint8Array()},Ph=t=>{t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:Jc(t.encoder.restEncoder)}),t.encoder.restEncoder=Wc(),t.written=0)},Fh=(t,e,n)=>{t.written>0&&t.currClient!==e.id.client&&Ph(t),0===t.written&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),Yc(t.encoder.restEncoder,e.id.clock+n)),e.write(t.encoder,n),t.written++},zh=t=>{Ph(t);const e=t.encoder.restEncoder;Yc(e,t.clientStructs.length);for(let n=0;n<t.clientStructs.length;n++){const r=t.clientStructs[n];Yc(e,r.written),eu(e,r.restEncoder)}},Hh=t=>((t,e,n,r)=>{const o=new n(gu(t)),i=new Dh(o,!1),s=new r,a=new Ih(s);for(let t=i.curr;null!==t;t=i.next())Fh(a,e(t),0);zh(a);const l=Td(o);return _d(s,l),s.toUint8Array()})(t,Fu,Bd,Pd),jh="You must not compute changes after the event-handler fired.";class Vh{constructor(t,e){this.target=t,this.currentTarget=t,this.transaction=e,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=qh(this.currentTarget,this.target))}deletes(t){return kd(this.transaction.deleteSet,t.id)}get keys(){if(null===this._keys){if(0===this.transaction.doc._transactionCleanups.length)throw Ac(jh);const t=new Map,e=this.target;this.transaction.changed.get(e).forEach(n=>{if(null!==n){const r=e._map.get(n);let o,i;if(this.adds(r)){let t=r.left;for(;null!==t&&this.adds(t);)t=t.left;if(this.deletes(r)){if(null===t||!this.deletes(t))return;o="delete",i=Mc(t.content.getContent())}else null!==t&&this.deletes(t)?(o="update",i=Mc(t.content.getContent())):(o="add",i=void 0)}else{if(!this.deletes(r))return;o="delete",i=Mc(r.content.getContent())}t.set(n,{action:o,oldValue:i})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(null===t){if(0===this.transaction.doc._transactionCleanups.length)throw Ac(jh);const e=this.target,n=bc(),r=bc(),o=[];if(t={added:n,deleted:r,delta:o,keys:this.keys},this.transaction.changed.get(e).has(null)){let t=null;const i=()=>{t&&o.push(t)};for(let o=e._start;null!==o;o=o.right)o.deleted?this.deletes(o)&&!this.adds(o)&&(null!==t&&void 0!==t.delete||(i(),t={delete:0}),t.delete+=o.length,r.add(o)):this.adds(o)?(null!==t&&void 0!==t.insert||(i(),t={insert:[]}),t.insert=t.insert.concat(o.content.getContent()),n.add(o)):(null!==t&&void 0!==t.retain||(i(),t={retain:0}),t.retain+=o.length);null!==t&&void 0===t.retain&&i()}this._changes=t}return t}}const qh=(t,e)=>{const n=[];for(;null!==e._item&&e!==t;){if(null!==e._item.parentSub)n.unshift(e._item.parentSub);else{let t=0,r=e._item.parent._start;for(;r!==e._item&&null!==r;)!r.deleted&&r.countable&&(t+=r.length),r=r.right;n.unshift(t)}e=e._item.parent}return n},Uh=()=>{gd("Invalid access: Add Yjs type to a document before reading data.")};let Wh=0;class Jh{constructor(t,e){t.marker=!0,this.p=t,this.index=e,this.timestamp=Wh++}}const Kh=(t,e,n)=>{t.p.marker=!1,t.p=e,e.marker=!0,t.index=n,t.timestamp=Wh++},Gh=(t,e)=>{if(null===t._start||0===e||null===t._searchMarker)return null;const n=0===t._searchMarker.length?null:t._searchMarker.reduce((t,n)=>lc(e-t.index)<lc(e-n.index)?t:n);let r=t._start,o=0;for(null!==n&&(r=n.p,o=n.index,(t=>{t.timestamp=Wh++})(n));null!==r.right&&o<e;){if(!r.deleted&&r.countable){if(e<o+r.length)break;o+=r.length}r=r.right}for(;null!==r.left&&o>e;)r=r.left,!r.deleted&&r.countable&&(o-=r.length);for(;null!==r.left&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(o-=r.length);return null!==n&&lc(n.index-o)<r.parent.length/80?(Kh(n,r,o),n):((t,e,n)=>{if(t.length>=80){const r=t.reduce((t,e)=>t.timestamp<e.timestamp?t:e);return Kh(r,e,n),r}{const r=new Jh(e,n);return t.push(r),r}})(t._searchMarker,r,o)},Yh=(t,e,n)=>{for(let r=t.length-1;r>=0;r--){const o=t[r];if(n>0){let e=o.p;for(e.marker=!1;e&&(e.deleted||!e.countable);)e=e.left,e&&!e.deleted&&e.countable&&(o.index-=e.length);if(null===e||!0===e.marker){t.splice(r,1);continue}o.p=e,e.marker=!0}(e<o.index||n>0&&e===o.index)&&(o.index=uc(e,o.index+n))}},Zh=(t,e,n)=>{const r=t,o=e.changedParentTypes;for(;Ec(o,t,()=>[]).push(n),null!==t._item;)t=t._item.parent;Gd(r._eH,n,e)};class Qh{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Wd(),this._dEH=Wd(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,e){this.doc=t,this._item=e}_copy(){throw kc()}clone(){throw kc()}_write(t){}get _first(){let t=this._start;for(;null!==t&&t.deleted;)t=t.right;return t}_callObserver(t,e){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){Jd(this._eH,t)}observeDeep(t){Jd(this._dEH,t)}unobserve(t){Kd(this._eH,t)}unobserveDeep(t){Kd(this._dEH,t)}toJSON(){}}const Xh=(t,e,n)=>{t.doc??Uh(),e<0&&(e=t._length+e),n<0&&(n=t._length+n);let r=n-e;const o=[];let i=t._start;for(;null!==i&&r>0;){if(i.countable&&!i.deleted){const t=i.content.getContent();if(t.length<=e)e-=t.length;else{for(let n=e;n<t.length&&r>0;n++)o.push(t[n]),r--;e=0}}i=i.right}return o},tp=t=>{t.doc??Uh();const e=[];let n=t._start;for(;null!==n;){if(n.countable&&!n.deleted){const t=n.content.getContent();for(let n=0;n<t.length;n++)e.push(t[n])}n=n.right}return e},ep=(t,e)=>{const n=[];let r=t._start;for(;null!==r;){if(r.countable&&lh(r,e)){const t=r.content.getContent();for(let e=0;e<t.length;e++)n.push(t[e])}r=r.right}return n},np=(t,e)=>{let n=0,r=t._start;for(t.doc??Uh();null!==r;){if(r.countable&&!r.deleted){const o=r.content.getContent();for(let r=0;r<o.length;r++)e(o[r],n++,t)}r=r.right}},rp=(t,e)=>{const n=[];return np(t,(r,o)=>{n.push(e(r,o,t))}),n},op=t=>{let e=t._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(null===n){for(;null!==e&&e.deleted;)e=e.right;if(null===e)return{done:!0,value:void 0};n=e.content.getContent(),r=0,e=e.right}const t=n[r++];return n.length<=r&&(n=null),{done:!1,value:t}}}},ip=(t,e)=>{t.doc??Uh();const n=Gh(t,e);let r=t._start;for(null!==n&&(r=n.p,e-=n.index);null!==r;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},sp=(t,e,n,r)=>{let o=n;const i=t.doc,s=i.clientID,a=i.store,l=null===n?e._start:n.right;let c=[];const u=()=>{c.length>0&&(o=new gf(Qd(s,hh(a,s)),o,o&&o.lastId,l,l&&l.id,e,null,new Qp(c)),o.integrate(t,0),c=[])};r.forEach(n=>{if(null===n)c.push(n);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(n);break;default:switch(u(),n.constructor){case Uint8Array:case ArrayBuffer:o=new gf(Qd(s,hh(a,s)),o,o&&o.lastId,l,l&&l.id,e,null,new qp(new Uint8Array(n))),o.integrate(t,0);break;case Nd:o=new gf(Qd(s,hh(a,s)),o,o&&o.lastId,l,l&&l.id,e,null,new Jp(n)),o.integrate(t,0);break;default:if(!(n instanceof Qh))throw new Error("Unexpected content type in insert operation");o=new gf(Qd(s,hh(a,s)),o,o&&o.lastId,l,l&&l.id,e,null,new cf(n)),o.integrate(t,0)}}}),u()},ap=()=>Ac("Length exceeded!"),lp=(t,e,n,r)=>{if(n>e._length)throw ap();if(0===n)return e._searchMarker&&Yh(e._searchMarker,n,r.length),sp(t,e,null,r);const o=n,i=Gh(e,n);let s=e._start;for(null!==i&&(s=i.p,0===(n-=i.index)&&(s=s.prev,n+=s&&s.countable&&!s.deleted?s.length:0));null!==s;s=s.right)if(!s.deleted&&s.countable){if(n<=s.length){n<s.length&&yh(t,Qd(s.id.client,s.id.clock+n));break}n-=s.length}return e._searchMarker&&Yh(e._searchMarker,o,r.length),sp(t,e,s,r)},cp=(t,e,n,r)=>{if(0===r)return;const o=n,i=r,s=Gh(e,n);let a=e._start;for(null!==s&&(a=s.p,n-=s.index);null!==a&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&yh(t,Qd(a.id.client,a.id.clock+n)),n-=a.length);for(;r>0&&null!==a;)a.deleted||(r<a.length&&yh(t,Qd(a.id.client,a.id.clock+r)),a.delete(t),r-=a.length),a=a.right;if(r>0)throw ap();e._searchMarker&&Yh(e._searchMarker,o,-i+r)},up=(t,e,n)=>{const r=e._map.get(n);void 0!==r&&r.delete(t)},dp=(t,e,n,r)=>{const o=e._map.get(n)||null,i=t.doc,s=i.clientID;let a;if(null==r)a=new Qp([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:a=new Qp([r]);break;case Uint8Array:a=new qp(r);break;case Nd:a=new Jp(r);break;default:if(!(r instanceof Qh))throw new Error("Unexpected content type");a=new cf(r)}new gf(Qd(s,hh(i.store,s)),o,o&&o.lastId,null,null,e,n,a).integrate(t,0)},hp=(t,e)=>{t.doc??Uh();const n=t._map.get(e);return void 0===n||n.deleted?void 0:n.content.getContent()[n.length-1]},pp=t=>{const e={};return t.doc??Uh(),t._map.forEach((t,n)=>{t.deleted||(e[n]=t.content.getContent()[t.length-1])}),e},fp=(t,e)=>{t.doc??Uh();const n=t._map.get(e);return void 0!==n&&!n.deleted},gp=t=>{return t.doc??Uh(),e=t._map.entries(),n=t=>!t[1].deleted,yd(()=>{let t;do{t=e.next()}while(!t.done&&!n(t.value));return t});var e,n};class mp extends Vh{}class yp extends Qh{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const e=new yp;return e.push(t),e}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new yp}clone(){const t=new yp;return t.insert(0,this.toArray().map(t=>t instanceof Qh?t.clone():t)),t}get length(){return this.doc??Uh(),this._length}_callObserver(t,e){super._callObserver(t,e),Zh(this,t,new mp(this,t))}insert(t,e){null!==this.doc?Sh(this.doc,n=>{lp(n,this,t,e)}):this._prelimContent.splice(t,0,...e)}push(t){null!==this.doc?Sh(this.doc,e=>{((t,e,n)=>{let r=(e._searchMarker||[]).reduce((t,e)=>e.index>t.index?e:t,{index:0,p:e._start}).p;if(r)for(;r.right;)r=r.right;sp(t,e,r,n)})(e,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,e=1){null!==this.doc?Sh(this.doc,n=>{cp(n,this,t,e)}):this._prelimContent.splice(t,e)}get(t){return ip(this,t)}toArray(){return tp(this)}slice(t=0,e=this.length){return Xh(this,t,e)}toJSON(){return this.map(t=>t instanceof Qh?t.toJSON():t)}map(t){return rp(this,t)}forEach(t){np(this,t)}[Symbol.iterator](){return op(this)}_write(t){t.writeTypeRef(ef)}}class bp extends Vh{constructor(t,e,n){super(t,e),this.keysChanged=n}}class vp extends Qh{constructor(t){super(),this._prelimContent=null,this._prelimContent=void 0===t?new Map:new Map(t)}_integrate(t,e){super._integrate(t,e),this._prelimContent.forEach((t,e)=>{this.set(e,t)}),this._prelimContent=null}_copy(){return new vp}clone(){const t=new vp;return this.forEach((e,n)=>{t.set(n,e instanceof Qh?e.clone():e)}),t}_callObserver(t,e){Zh(this,t,new bp(this,t,e))}toJSON(){this.doc??Uh();const t={};return this._map.forEach((e,n)=>{if(!e.deleted){const r=e.content.getContent()[e.length-1];t[n]=r instanceof Qh?r.toJSON():r}}),t}get size(){return[...gp(this)].length}keys(){return bd(gp(this),t=>t[0])}values(){return bd(gp(this),t=>t[1].content.getContent()[t[1].length-1])}entries(){return bd(gp(this),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this.doc??Uh(),this._map.forEach((e,n)=>{e.deleted||t(e.content.getContent()[e.length-1],n,this)})}[Symbol.iterator](){return this.entries()}delete(t){null!==this.doc?Sh(this.doc,e=>{up(e,this,t)}):this._prelimContent.delete(t)}set(t,e){return null!==this.doc?Sh(this.doc,n=>{dp(n,this,t,e)}):this._prelimContent.set(t,e),e}get(t){return hp(this,t)}has(t){return fp(this,t)}clear(){null!==this.doc?Sh(this.doc,t=>{this.forEach(function(e,n,r){up(t,r,n)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(nf)}}const wp=(t,e)=>t===e||"object"==typeof t&&"object"==typeof e&&t&&e&&((t,e)=>t===e||fc(t)===fc(e)&&gc(t,(t,n)=>(void 0!==t||((t,e)=>Object.prototype.hasOwnProperty.call(t,e))(e,n))&&e[n]===t))(t,e);class Ap{constructor(t,e,n,r){this.left=t,this.right=e,this.index=n,this.currentAttributes=r}forward(){null===this.right&&xc(),this.right.content.constructor===Gp?this.right.deleted||Sp(this.currentAttributes,this.right.content):this.right.deleted||(this.index+=this.right.length),this.left=this.right,this.right=this.right.right}}const kp=(t,e,n)=>{for(;null!==e.right&&n>0;)e.right.content.constructor===Gp?e.right.deleted||Sp(e.currentAttributes,e.right.content):e.right.deleted||(n<e.right.length&&yh(t,Qd(e.right.id.client,e.right.id.clock+n)),e.index+=e.right.length,n-=e.right.length),e.left=e.right,e.right=e.right.right;return e},xp=(t,e,n,r)=>{const o=new Map,i=r?Gh(e,n):null;if(i){const e=new Ap(i.p.left,i.p,i.index,o);return kp(t,e,n-i.index)}{const r=new Ap(null,e._start,0,o);return kp(t,r,n)}},Cp=(t,e,n,r)=>{for(;null!==n.right&&(!0===n.right.deleted||n.right.content.constructor===Gp&&wp(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const o=t.doc,i=o.clientID;r.forEach((r,s)=>{const a=n.left,l=n.right,c=new gf(Qd(i,hh(o.store,i)),a,a&&a.lastId,l,l&&l.id,e,null,new Gp(s,r));c.integrate(t,0),n.right=c,n.forward()})},Sp=(t,e)=>{const{key:n,value:r}=e;null===r?t.delete(n):t.set(n,r)},Ep=(t,e)=>{for(;null!==t.right&&(t.right.deleted||t.right.content.constructor===Gp&&wp(e[t.right.content.key]??null,t.right.content.value));)t.forward()},Mp=(t,e,n,r)=>{const o=t.doc,i=o.clientID,s=new Map;for(const a in r){const l=r[a],c=n.currentAttributes.get(a)??null;if(!wp(c,l)){s.set(a,c);const{left:r,right:u}=n;n.right=new gf(Qd(i,hh(o.store,i)),r,r&&r.lastId,u,u&&u.id,e,null,new Gp(a,l)),n.right.integrate(t,0),n.forward()}}return s},_p=(t,e,n,r,o)=>{n.currentAttributes.forEach((t,e)=>{void 0===o[e]&&(o[e]=null)});const i=t.doc,s=i.clientID;Ep(n,o);const a=Mp(t,e,n,o),l=r.constructor===String?new Xp(r):r instanceof Qh?new cf(r):new Kp(r);let{left:c,right:u,index:d}=n;e._searchMarker&&Yh(e._searchMarker,n.index,l.getLength()),u=new gf(Qd(s,hh(i.store,s)),c,c&&c.lastId,u,u&&u.id,e,null,l),u.integrate(t,0),n.right=u,n.index=d,n.forward(),Cp(t,e,n,a)},Tp=(t,e,n,r,o)=>{const i=t.doc,s=i.clientID;Ep(n,o);const a=Mp(t,e,n,o);t:for(;null!==n.right&&(r>0||a.size>0&&(n.right.deleted||n.right.content.constructor===Gp));){if(!n.right.deleted)switch(n.right.content.constructor){case Gp:{const{key:e,value:i}=n.right.content,s=o[e];if(void 0!==s){if(wp(s,i))a.delete(e);else{if(0===r)break t;a.set(e,i)}n.right.delete(t)}else n.currentAttributes.set(e,i);break}default:r<n.right.length&&yh(t,Qd(n.right.id.client,n.right.id.clock+r)),r-=n.right.length}n.forward()}if(r>0){let o="";for(;r>0;r--)o+="\n";n.right=new gf(Qd(s,hh(i.store,s)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,e,null,new Xp(o)),n.right.integrate(t,0),n.forward()}Cp(t,e,n,a)},Dp=(t,e,n,r,o)=>{let i=e;const s=Cc();for(;i&&(!i.countable||i.deleted);){if(!i.deleted&&i.content.constructor===Gp){const t=i.content;s.set(t.key,t)}i=i.right}let a=0,l=!1;for(;e!==i;){if(n===e&&(l=!0),!e.deleted){const n=e.content;switch(n.constructor){case Gp:{const{key:i,value:c}=n,u=r.get(i)??null;s.get(i)===n&&u!==c||(e.delete(t),a++,l||(o.get(i)??null)!==c||u===c||(null===u?o.delete(i):o.set(i,u))),l||e.deleted||Sp(o,n);break}}}e=e.right}return a},Op=t=>{let e=0;return Sh(t.doc,n=>{let r=t._start,o=t._start,i=Cc();const s=Sc(i);for(;o;)!1===o.deleted&&(o.content.constructor===Gp?Sp(s,o.content):(e+=Dp(n,r,o,i,s),i=Sc(s),r=o)),o=o.right}),e},Np=t=>{const e=new Set,n=t.doc;for(const[r,o]of t.afterState.entries()){const i=t.beforeState.get(r)||0;o!==i&&vh(t,n.store.clients.get(r),i,o,t=>{t.deleted||t.content.constructor!==Gp||t.constructor===Vp||e.add(t.parent)})}Sh(n,n=>{Ad(t,t.deleteSet,t=>{if(t instanceof Vp||!t.parent._hasFormatting||e.has(t.parent))return;const r=t.parent;t.content.constructor===Gp?e.add(r):((t,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const n=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Gp){const r=e.content.key;n.has(r)?e.delete(t):n.add(r)}e=e.left}})(n,t)});for(const t of e)Op(t)})},Ip=(t,e,n)=>{const r=n,o=Sc(e.currentAttributes),i=e.right;for(;n>0&&null!==e.right;){if(!1===e.right.deleted)switch(e.right.content.constructor){case cf:case Kp:case Xp:n<e.right.length&&yh(t,Qd(e.right.id.client,e.right.id.clock+n)),n-=e.right.length,e.right.delete(t)}e.forward()}i&&Dp(t,i,e.right,o,e.currentAttributes);const s=(e.left||e.right).parent;return s._searchMarker&&Yh(s._searchMarker,e.index,-r+n),e};class Lp extends Vh{constructor(t,e,n){super(t,e),this.childListChanged=!1,this.keysChanged=new Set,n.forEach(t=>{null===t?this.childListChanged=!0:this.keysChanged.add(t)})}get changes(){if(null===this._changes){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(null===this._delta){const t=this.target.doc,e=[];Sh(t,t=>{const n=new Map,r=new Map;let o=this.target._start,i=null;const s={};let a="",l=0,c=0;const u=()=>{if(null!==i){let t=null;switch(i){case"delete":c>0&&(t={delete:c}),c=0;break;case"insert":("object"==typeof a||a.length>0)&&(t={insert:a},n.size>0&&(t.attributes={},n.forEach((e,n)=>{null!==e&&(t.attributes[n]=e)}))),a="";break;case"retain":l>0&&(t={retain:l},(t=>{for(const e in t)return!1;return!0})(s)||(t.attributes=hc({},s))),l=0}t&&e.push(t),i=null}};for(;null!==o;){switch(o.content.constructor){case cf:case Kp:this.adds(o)?this.deletes(o)||(u(),i="insert",a=o.content.getContent()[0],u()):this.deletes(o)?("delete"!==i&&(u(),i="delete"),c+=1):o.deleted||("retain"!==i&&(u(),i="retain"),l+=1);break;case Xp:this.adds(o)?this.deletes(o)||("insert"!==i&&(u(),i="insert"),a+=o.content.str):this.deletes(o)?("delete"!==i&&(u(),i="delete"),c+=o.length):o.deleted||("retain"!==i&&(u(),i="retain"),l+=o.length);break;case Gp:{const{key:e,value:a}=o.content;if(this.adds(o)){if(!this.deletes(o)){const l=n.get(e)??null;wp(l,a)?null!==a&&o.delete(t):("retain"===i&&u(),wp(a,r.get(e)??null)?delete s[e]:s[e]=a)}}else if(this.deletes(o)){r.set(e,a);const t=n.get(e)??null;wp(t,a)||("retain"===i&&u(),s[e]=t)}else if(!o.deleted){r.set(e,a);const n=s[e];void 0!==n&&(wp(n,a)?null!==n&&o.delete(t):("retain"===i&&u(),null===a?delete s[e]:s[e]=a))}o.deleted||("insert"===i&&u(),Sp(n,o.content));break}}o=o.right}for(u();e.length>0;){const t=e[e.length-1];if(void 0===t.retain||void 0!==t.attributes)break;e.pop()}}),this._delta=e}return this._delta}}class Rp extends Qh{constructor(t){super(),this._pending=void 0!==t?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??Uh(),this._length}_integrate(t,e){super._integrate(t,e);try{this._pending.forEach(t=>t())}catch(t){console.error(t)}this._pending=null}_copy(){return new Rp}clone(){const t=new Rp;return t.applyDelta(this.toDelta()),t}_callObserver(t,e){super._callObserver(t,e);const n=new Lp(this,t,e);Zh(this,t,n),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){this.doc??Uh();let t="",e=this._start;for(;null!==e;)!e.deleted&&e.countable&&e.content.constructor===Xp&&(t+=e.content.str),e=e.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:e=!0}={}){null!==this.doc?Sh(this.doc,n=>{const r=new Ap(null,this._start,0,new Map);for(let o=0;o<t.length;o++){const i=t[o];if(void 0!==i.insert){const s=e||"string"!=typeof i.insert||o!==t.length-1||null!==r.right||"\n"!==i.insert.slice(-1)?i.insert:i.insert.slice(0,-1);("string"!=typeof s||s.length>0)&&_p(n,this,r,s,i.attributes||{})}else void 0!==i.retain?Tp(n,this,r,i.retain,i.attributes||{}):void 0!==i.delete&&Ip(n,r,i.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,e,n){this.doc??Uh();const r=[],o=new Map,i=this.doc;let s="",a=this._start;function l(){if(s.length>0){const t={};let e=!1;o.forEach((n,r)=>{e=!0,t[r]=n});const n={insert:s};e&&(n.attributes=t),r.push(n),s=""}}const c=()=>{for(;null!==a;){if(lh(a,t)||void 0!==e&&lh(a,e))switch(a.content.constructor){case Xp:{const r=o.get("ychange");void 0===t||lh(a,t)?void 0===e||lh(a,e)?void 0!==r&&(l(),o.delete("ychange")):void 0!==r&&r.user===a.id.client&&"added"===r.type||(l(),o.set("ychange",n?n("added",a.id):{type:"added"})):void 0!==r&&r.user===a.id.client&&"removed"===r.type||(l(),o.set("ychange",n?n("removed",a.id):{type:"removed"})),s+=a.content.str;break}case cf:case Kp:{l();const t={insert:a.content.getContent()[0]};if(o.size>0){const e={};t.attributes=e,o.forEach((t,n)=>{e[n]=t})}r.push(t);break}case Gp:lh(a,t)&&(l(),Sp(o,a.content))}a=a.right}l()};return t||e?Sh(i,n=>{t&&ch(n,t),e&&ch(n,e),c()},"cleanup"):c(),r}insert(t,e,n){if(e.length<=0)return;const r=this.doc;null!==r?Sh(r,r=>{const o=xp(r,this,t,!n);n||(n={},o.currentAttributes.forEach((t,e)=>{n[e]=t})),_p(r,this,o,e,n)}):this._pending.push(()=>this.insert(t,e,n))}insertEmbed(t,e,n){const r=this.doc;null!==r?Sh(r,r=>{const o=xp(r,this,t,!n);_p(r,this,o,e,n||{})}):this._pending.push(()=>this.insertEmbed(t,e,n||{}))}delete(t,e){if(0===e)return;const n=this.doc;null!==n?Sh(n,n=>{Ip(n,xp(n,this,t,!0),e)}):this._pending.push(()=>this.delete(t,e))}format(t,e,n){if(0===e)return;const r=this.doc;null!==r?Sh(r,r=>{const o=xp(r,this,t,!1);null!==o.right&&Tp(r,this,o,e,n)}):this._pending.push(()=>this.format(t,e,n))}removeAttribute(t){null!==this.doc?Sh(this.doc,e=>{up(e,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,e){null!==this.doc?Sh(this.doc,n=>{dp(n,this,t,e)}):this._pending.push(()=>this.setAttribute(t,e))}getAttribute(t){return hp(this,t)}getAttributes(){return pp(this)}_write(t){t.writeTypeRef(rf)}}class Bp{constructor(t,e=()=>!0){this._filter=e,this._root=t,this._currentNode=t._start,this._firstCall=!0,t.doc??Uh()}[Symbol.iterator](){return this}next(){let t=this._currentNode,e=t&&t.content&&t.content.type;if(null!==t&&(!this._firstCall||t.deleted||!this._filter(e)))do{if(e=t.content.type,t.deleted||e.constructor!==Pp&&e.constructor!==$p||null===e._start)for(;null!==t;){const e=t.next;if(null!==e){t=e;break}t=t.parent===this._root?null:t.parent._item}else t=e._start}while(null!==t&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,null===t?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class $p extends Qh{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new $p}clone(){const t=new $p;return t.insert(0,this.toArray().map(t=>t instanceof Qh?t.clone():t)),t}get length(){return this.doc??Uh(),null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(t){return new Bp(this,t)}querySelector(t){t=t.toUpperCase();const e=new Bp(this,e=>e.nodeName&&e.nodeName.toUpperCase()===t).next();return e.done?null:e.value}querySelectorAll(t){return t=t.toUpperCase(),Tc(new Bp(this,e=>e.nodeName&&e.nodeName.toUpperCase()===t))}_callObserver(t,e){Zh(this,t,new Fp(this,e,t))}toString(){return rp(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,e={},n){const r=t.createDocumentFragment();return void 0!==n&&n._createAssociation(r,this),np(this,o=>{r.insertBefore(o.toDOM(t,e,n),null)}),r}insert(t,e){null!==this.doc?Sh(this.doc,n=>{lp(n,this,t,e)}):this._prelimContent.splice(t,0,...e)}insertAfter(t,e){if(null!==this.doc)Sh(this.doc,n=>{const r=t&&t instanceof Qh?t._item:t;sp(n,this,r,e)});else{const n=this._prelimContent,r=null===t?0:n.findIndex(e=>e===t)+1;if(0===r&&null!==t)throw Ac("Reference item not found");n.splice(r,0,...e)}}delete(t,e=1){null!==this.doc?Sh(this.doc,n=>{cp(n,this,t,e)}):this._prelimContent.splice(t,e)}toArray(){return tp(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return ip(this,t)}slice(t=0,e=this.length){return Xh(this,t,e)}forEach(t){np(this,t)}_write(t){t.writeTypeRef(sf)}}class Pp extends $p{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,e){super._integrate(t,e),this._prelimAttrs.forEach((t,e)=>{this.setAttribute(e,t)}),this._prelimAttrs=null}_copy(){return new Pp(this.nodeName)}clone(){const t=new Pp(this.nodeName);return((t,e)=>{for(const n in t)e(t[n],n)})(this.getAttributes(),(e,n)=>{"string"==typeof e&&t.setAttribute(n,e)}),t.insert(0,this.toArray().map(t=>t instanceof Qh?t.clone():t)),t}toString(){const t=this.getAttributes(),e=[],n=[];for(const e in t)n.push(e);n.sort();const r=n.length;for(let o=0;o<r;o++){const r=n[o];e.push(r+'="'+t[r]+'"')}const o=this.nodeName.toLocaleLowerCase();return`<${o}${e.length>0?" "+e.join(" "):""}>${super.toString()}</${o}>`}removeAttribute(t){null!==this.doc?Sh(this.doc,e=>{up(e,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,e){null!==this.doc?Sh(this.doc,n=>{dp(n,this,t,e)}):this._prelimAttrs.set(t,e)}getAttribute(t){return hp(this,t)}hasAttribute(t){return fp(this,t)}getAttributes(t){return t?((t,e)=>{const n={};return this._map.forEach((t,r)=>{let o=t;for(;null!==o&&(!e.sv.has(o.id.client)||o.id.clock>=(e.sv.get(o.id.client)||0));)o=o.left;null!==o&&lh(o,e)&&(n[r]=o.content.getContent()[o.length-1])}),n})(0,t):pp(this)}toDOM(t=document,e={},n){const r=t.createElement(this.nodeName),o=this.getAttributes();for(const t in o){const e=o[t];"string"==typeof e&&r.setAttribute(t,e)}return np(this,o=>{r.appendChild(o.toDOM(t,e,n))}),void 0!==n&&n._createAssociation(r,this),r}_write(t){t.writeTypeRef(of),t.writeKey(this.nodeName)}}class Fp extends Vh{constructor(t,e,n){super(t,n),this.childListChanged=!1,this.attributesChanged=new Set,e.forEach(t=>{null===t?this.childListChanged=!0:this.attributesChanged.add(t)})}}class zp extends vp{constructor(t){super(),this.hookName=t}_copy(){return new zp(this.hookName)}clone(){const t=new zp(this.hookName);return this.forEach((e,n)=>{t.set(n,e)}),t}toDOM(t=document,e={},n){const r=e[this.hookName];let o;return o=void 0!==r?r.createDom(this):document.createElement(this.hookName),o.setAttribute("data-yjs-hook",this.hookName),void 0!==n&&n._createAssociation(o,this),o}_write(t){t.writeTypeRef(af),t.writeKey(this.hookName)}}class Hp extends Rp{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new Hp}clone(){const t=new Hp;return t.applyDelta(this.toDelta()),t}toDOM(t=document,e,n){const r=t.createTextNode(this.toString());return void 0!==n&&n._createAssociation(r,this),r}toString(){return this.toDelta().map(t=>{const e=[];for(const n in t.attributes){const r=[];for(const e in t.attributes[n])r.push({key:e,value:t.attributes[n][e]});r.sort((t,e)=>t.key<e.key?-1:1),e.push({nodeName:n,attrs:r})}e.sort((t,e)=>t.nodeName<e.nodeName?-1:1);let n="";for(let t=0;t<e.length;t++){const r=e[t];n+=`<${r.nodeName}`;for(let t=0;t<r.attrs.length;t++){const e=r.attrs[t];n+=` ${e.key}="${e.value}"`}n+=">"}n+=t.insert;for(let t=e.length-1;t>=0;t--)n+=`</${e[t].nodeName}>`;return n}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(lf)}}class jp{constructor(t,e){this.id=t,this.length=e}get deleted(){throw kc()}mergeWith(t){return!1}write(t,e,n){throw kc()}integrate(t,e){throw kc()}}class Vp extends jp{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor===t.constructor&&(this.length+=t.length,!0)}integrate(t,e){e>0&&(this.id.clock+=e,this.length-=e),ph(t.doc.store,this)}write(t,e){t.writeInfo(0),t.writeLen(this.length-e)}getMissing(t,e){return null}}class qp{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new qp(this.content)}splice(t){throw kc()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeBuf(this.content)}getRef(){return 3}}class Up{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Up(this.len)}splice(t){const e=new Up(this.len-t);return this.len=t,e}mergeWith(t){return this.len+=t.len,!0}integrate(t,e){Sd(t.deleteSet,e.id.client,e.id.clock,this.len),e.markDeleted()}delete(t){}gc(t){}write(t,e){t.writeLen(this.len-e)}getRef(){return 1}}const Wp=(t,e)=>new Nd({guid:t,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class Jp{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const e={};this.opts=e,t.gc||(e.gc=!1),t.autoLoad&&(e.autoLoad=!0),null!==t.meta&&(e.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Jp(Wp(this.doc.guid,this.opts))}splice(t){throw kc()}mergeWith(t){return!1}integrate(t,e){this.doc._item=e,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,e){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}class Kp{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Kp(this.embed)}splice(t){throw kc()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeJSON(this.embed)}getRef(){return 5}}class Gp{constructor(t,e){this.key=t,this.value=e}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Gp(this.key,this.value)}splice(t){throw kc()}mergeWith(t){return!1}integrate(t,e){const n=e.parent;n._searchMarker=null,n._hasFormatting=!0}delete(t){}gc(t){}write(t,e){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}class Yp{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Yp(this.arr)}splice(t){const e=new Yp(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const n=this.arr.length;t.writeLen(n-e);for(let r=e;r<n;r++){const e=this.arr[r];t.writeString(void 0===e?"undefined":JSON.stringify(e))}}getRef(){return 2}}const Zp="development"===Uu("node_env");class Qp{constructor(t){this.arr=t,Zp&&yc(t)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Qp(this.arr)}splice(t){const e=new Qp(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const n=this.arr.length;t.writeLen(n-e);for(let r=e;r<n;r++){const e=this.arr[r];t.writeAny(e)}}getRef(){return 8}}class Xp{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Xp(this.str)}splice(t){const e=new Xp(this.str.slice(t));this.str=this.str.slice(0,t);const n=this.str.charCodeAt(t-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,t-1)+"",e.str=""+e.str.slice(1)),e}mergeWith(t){return this.str+=t.str,!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeString(0===e?this.str:this.str.slice(e))}getRef(){return 4}}const tf=[t=>new yp,t=>new vp,t=>new Rp,t=>new Pp(t.readKey()),t=>new $p,t=>new zp(t.readKey()),t=>new Hp],ef=0,nf=1,rf=2,of=3,sf=4,af=5,lf=6;class cf{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new cf(this.type._copy())}splice(t){throw kc()}mergeWith(t){return!1}integrate(t,e){this.type._integrate(t.doc,e)}delete(t){let e=this.type._start;for(;null!==e;)e.deleted?e.id.clock<(t.beforeState.get(e.id.client)||0)&&t._mergeStructs.push(e):e.delete(t),e=e.right;this.type._map.forEach(e=>{e.deleted?e.id.clock<(t.beforeState.get(e.id.client)||0)&&t._mergeStructs.push(e):e.delete(t)}),t.changed.delete(this.type)}gc(t){let e=this.type._start;for(;null!==e;)e.gc(t,!0),e=e.right;this.type._start=null,this.type._map.forEach(e=>{for(;null!==e;)e.gc(t,!0),e=e.left}),this.type._map=new Map}write(t,e){this.type._write(t)}getRef(){return 7}}const uf=(t,e)=>{let n,r=e,o=0;do{o>0&&(r=Qd(r.client,r.clock+o)),n=gh(t,r),o=r.clock-n.id.clock,r=n.redone}while(null!==r&&n instanceof gf);return{item:n,diff:o}},df=(t,e)=>{for(;null!==t&&t.keep!==e;)t.keep=e,t=t.parent._item},hf=(t,e,n)=>{const{client:r,clock:o}=e.id,i=new gf(Qd(r,o+n),e,Qd(r,o+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&i.markDeleted(),e.keep&&(i.keep=!0),null!==e.redone&&(i.redone=Qd(e.redone.client,e.redone.clock+n)),e.right=i,null!==i.right&&(i.right.left=i),t._mergeStructs.push(i),null!==i.parentSub&&null===i.right&&i.parent._map.set(i.parentSub,i),e.length=n,i},pf=(t,e)=>((t,e)=>{for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1})(t,t=>kd(t.deletions,e)),ff=(t,e,n,r,o,i)=>{const s=t.doc,a=s.store,l=s.clientID,c=e.redone;if(null!==c)return yh(t,c);let u,d=e.parent._item,h=null;if(null!==d&&!0===d.deleted){if(null===d.redone&&(!n.has(d)||null===ff(t,d,n,r,o,i)))return null;for(;null!==d.redone;)d=yh(t,d.redone)}const p=null===d?e.parent:d.content.type;if(null===e.parentSub){for(h=e.left,u=e;null!==h;){let e=h;for(;null!==e&&e.parent._item!==d;)e=null===e.redone?null:yh(t,e.redone);if(null!==e&&e.parent._item===d){h=e;break}h=h.left}for(;null!==u;){let e=u;for(;null!==e&&e.parent._item!==d;)e=null===e.redone?null:yh(t,e.redone);if(null!==e&&e.parent._item===d){u=e;break}u=u.right}}else if(u=null,e.right&&!o){for(h=e;null!==h&&null!==h.right&&(h.right.redone||kd(r,h.right.id)||pf(i.undoStack,h.right.id)||pf(i.redoStack,h.right.id));)for(h=h.right;h.redone;)h=yh(t,h.redone);if(h&&null!==h.right)return null}else h=p._map.get(e.parentSub)||null;const f=hh(a,l),g=Qd(l,f),m=new gf(g,h,h&&h.lastId,u,u&&u.id,p,e.parentSub,e.content.copy());return e.redone=g,df(m,!0),m.integrate(t,0),m};class gf extends jp{constructor(t,e,n,r,o,i,s,a){super(t,a.getLength()),this.origin=n,this.left=e,this.right=r,this.rightOrigin=o,this.parent=i,this.parentSub=s,this.redone=null,this.content=a,this.info=this.content.isCountable()?2:0}set marker(t){(8&this.info)>0!==t&&(this.info^=8)}get marker(){return(8&this.info)>0}get keep(){return(1&this.info)>0}set keep(t){this.keep!==t&&(this.info^=1)}get countable(){return(2&this.info)>0}get deleted(){return(4&this.info)>0}set deleted(t){this.deleted!==t&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(t,e){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=hh(e,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=hh(e,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Yd&&this.id.client!==this.parent.client&&this.parent.clock>=hh(e,this.parent.client))return this.parent.client;if(this.origin&&(this.left=bh(t,e,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=yh(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Vp||this.right&&this.right.constructor===Vp)this.parent=null;else if(this.parent){if(this.parent.constructor===Yd){const t=gh(e,this.parent);t.constructor===Vp?this.parent=null:this.parent=t.content.type}}else this.left&&this.left.constructor===gf?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===gf&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}integrate(t,e){if(e>0&&(this.id.clock+=e,this.left=bh(t,t.doc.store,Qd(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(e),this.length-=e),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){let e,n=this.left;if(null!==n)e=n.right;else if(null!==this.parentSub)for(e=this.parent._map.get(this.parentSub)||null;null!==e&&null!==e.left;)e=e.left;else e=this.parent._start;const r=new Set,o=new Set;for(;null!==e&&e!==this.right;){if(o.add(e),r.add(e),Zd(this.origin,e.origin)){if(e.id.client<this.id.client)n=e,r.clear();else if(Zd(this.rightOrigin,e.rightOrigin))break}else{if(null===e.origin||!o.has(gh(t.doc.store,e.origin)))break;r.has(gh(t.doc.store,e.origin))||(n=e,r.clear())}e=e.right}this.left=n}if(null!==this.left){const t=this.left.right;this.right=t,this.left.right=this}else{let t;if(null!==this.parentSub)for(t=this.parent._map.get(this.parentSub)||null;null!==t&&null!==t.left;)t=t.left;else t=this.parent._start,this.parent._start=this;this.right=t}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(t)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),ph(t.doc.store,this),this.content.integrate(t,this),kh(t,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(t)}else new Vp(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;null!==t&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;null!==t&&t.deleted;)t=t.left;return t}get lastId(){return 1===this.length?this.id:Qd(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&Zd(t.origin,this.lastId)&&this.right===t&&Zd(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&null===this.redone&&null===t.redone&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const e=this.parent._searchMarker;return e&&e.forEach(e=>{e.p===t&&(e.p=this,!this.deleted&&this.countable&&(e.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,null!==this.right&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const e=this.parent;this.countable&&null===this.parentSub&&(e._length-=this.length),this.markDeleted(),Sd(t.deleteSet,this.id.client,this.id.clock,this.length),kh(t,e,this.parentSub),this.content.delete(t)}}gc(t,e){if(!this.deleted)throw xc();this.content.gc(t),e?((t,e,n)=>{const r=t.clients.get(e.id.client);r[fh(r,e.id.clock)]=n})(t,this,new Vp(this.id,this.length)):this.content=new Up(this.length)}write(t,e){const n=e>0?Qd(this.id.client,this.id.clock+e-1):this.origin,r=this.rightOrigin,o=this.parentSub,i=31&this.content.getRef()|(null===n?0:Lc)|(null===r?0:Ic)|(null===o?0:32);if(t.writeInfo(i),null!==n&&t.writeLeftID(n),null!==r&&t.writeRightID(r),null===n&&null===r){const e=this.parent;if(void 0!==e._item){const n=e._item;if(null===n){const n=Xd(e);t.writeParentInfo(!0),t.writeString(n)}else t.writeParentInfo(!1),t.writeLeftID(n.id)}else e.constructor===String?(t.writeParentInfo(!0),t.writeString(e)):e.constructor===Yd?(t.writeParentInfo(!1),t.writeLeftID(e)):xc();null!==o&&t.writeString(o)}this.content.write(t,e)}}const mf=(t,e)=>yf[31&e](t),yf=[()=>{xc()},t=>new Up(t.readLen()),t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++){const e=t.readString();"undefined"===e?n.push(void 0):n.push(JSON.parse(e))}return new Yp(n)},t=>new qp(t.readBuf()),t=>new Xp(t.readString()),t=>new Kp(t.readJSON()),t=>new Gp(t.readKey(),t.readJSON()),t=>new cf(tf[t.readTypeRef()](t)),t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++)n.push(t.readAny());return new Qp(n)},t=>new Jp(Wp(t.readString(),t.readAny())),()=>{xc()}];class bf extends jp{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor===t.constructor&&(this.length+=t.length,!0)}integrate(t,e){xc()}write(t,e){t.writeInfo(10),Yc(t.restEncoder,this.length-e)}getMissing(t,e){return null}}const vf="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},wf="__ $YJS$ __";!0===vf[wf]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),vf[wf]=!0;const Af=(t,e,n)=>{if(0===t)return oh(e,0,0===e.length?-1:0);let r=null===e._first?null:e._first.content.type;for(;null!==r&&e!==r;){if(r instanceof Hp){if(r._length>=t)return oh(r,t,0===e.length?-1:0);if(t-=r._length,null!==r._item&&null!==r._item.next)r=r._item.next.content.type;else{do{r=null===r._item?null:r._item.parent,t--}while(r!==e&&null!==r&&null!==r._item&&null===r._item.next);null!==r&&r!==e&&(r=null===r._item?null:r._item.next.content.type)}}else{const o=(n.get(r)||{nodeSize:0}).nodeSize;if(null!==r._first&&t<o)r=r._first.content.type,t--;else{if(1===t&&0===r._length&&o>1)return new eh(null===r._item?null:r._item.id,null===r._item?Xd(r):null,null);if(t-=o,null!==r._item&&null!==r._item.next)r=r._item.next.content.type;else{if(0===t)return r=null===r._item?r:r._item.parent,new eh(null===r._item?null:r._item.id,null===r._item?Xd(r):null,null);do{r=r._item.parent,t--}while(r!==e&&null===r._item.next);r!==e&&(r=r._item.next.content.type)}}}if(null===r)throw xc();if(0===t&&r.constructor!==Hp&&r!==e)return kf(r._item.parent,r._item)}return oh(e,e._length,0===e.length?-1:0)},kf=(t,e)=>{let n=null,r=null;return null===t._item?r=Xd(t):n=Qd(t._item.id.client,t._item.id.clock),new eh(n,r,e.id)},xf=(t,e,n,r)=>{const o=((t,e,n=!0)=>{const r=e.store,o=t.item,i=t.type,s=t.tname,a=t.assoc;let l=null,c=0;if(null!==o){if(hh(r,o.client)<=o.clock)return null;const t=n?uf(r,o):((t,e)=>{const n=gh(t,e);return{item:n,diff:e.clock-n.id.clock}})(r,o),e=t.item;if(!(e instanceof gf))return null;if(l=e.parent,null===l._item||!l._item.deleted){c=e.deleted||!e.countable?0:t.diff+(a>=0?0:1);let n=e.left;for(;null!==n;)!n.deleted&&n.countable&&(c+=n.length),n=n.left}}else{if(null!==s)l=e.get(s);else{if(null===i)throw xc();{if(hh(r,i.client)<=i.clock)return null;const{item:t}=n?uf(r,i):{item:gh(r,i)};if(!(t instanceof gf&&t.content instanceof cf))return null;l=t.content.type}}c=a>=0?l._length:0}return((t,e,n=0)=>new nh(t,e,n))(l,c,t.assoc)})(n,t);if(null===o||o.type!==e&&!th(e,o.type._item))return null;let i=o.type,s=0;if(i.constructor===Hp)s=o.index;else if(null===i._item||!i._item.deleted){let t=i._first,e=0;for(;e<i._length&&e<o.index&&null!==t;){if(!t.deleted){const n=t.content.type;e++,s+=n instanceof Hp?n._length:r.get(n).nodeSize}t=t.right}s+=1}for(;i!==e&&null!==i._item;){const t=i._item.parent;if(null===t._item||!t._item.deleted){s+=1;let e=t._first;for(;null!==e;){const t=e.content.type;if(t===i)break;e.deleted||(s+=t instanceof Hp?t._length:r.get(t).nodeSize),e=e.right}}i=t}return s-1},Cf=t=>class{constructor(t){this._=t}destroy(){t(this._)}},Sf=Cf(clearTimeout),Ef=(t,e)=>new Sf(setTimeout(e,t)),Mf=(Cf(clearInterval),Cf(t=>"undefined"!=typeof requestAnimationFrame&&cancelAnimationFrame(t)),Cf(t=>"undefined"!=typeof cancelIdleCallback&&cancelIdleCallback(t)),(t,e)=>t>>>e|t<<32-e),_f=t=>Mf(t,2)^Mf(t,13)^Mf(t,22),Tf=t=>Mf(t,6)^Mf(t,11)^Mf(t,25),Df=t=>Mf(t,7)^Mf(t,18)^t>>>3,Of=t=>Mf(t,17)^Mf(t,19)^t>>>10,Nf=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),If=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);class Lf{constructor(){const t=new ArrayBuffer(320);this._H=new Uint32Array(t,0,8),this._H.set(If),this._W=new Uint32Array(t,64,64)}_updateHash(){const t=this._H,e=this._W;for(let t=16;t<64;t++)e[t]=Of(e[t-2])+e[t-7]+Df(e[t-15])+e[t-16];let n=t[0],r=t[1],o=t[2],i=t[3],s=t[4],a=t[5],l=t[6],c=t[7];for(let t,u,d=0;d<64;d++)t=c+Tf(s)+(s&a^~s&l)+Nf[d]+e[d]>>>0,u=_f(n)+(n&r^n&o^r&o)>>>0,c=l,l=a,a=s,s=i+t>>>0,i=o,o=r,r=n,n=t+u>>>0;t[0]+=n,t[1]+=r,t[2]+=o,t[3]+=i,t[4]+=s,t[5]+=a,t[6]+=l,t[7]+=c}digest(t){let e=0;for(;e+56<=t.length;){let n=0;for(;n<16&&e+3<t.length;n++)this._W[n]=t[e++]<<24|t[e++]<<16|t[e++]<<8|t[e++];if(e%64!=0){for(this._W.fill(0,n,16);e<t.length;)this._W[n]|=t[e]<<8*(3-e%4),e++;this._W[n]|=Lc<<8*(3-e%4)}this._updateHash()}const n=e%64!=0;this._W.fill(0,0,16);let r=0;for(;e<t.length;r++)for(let n=3;n>=0&&e<t.length;n--)this._W[r]|=t[e++]<<8*n;n||(this._W[r-(e%4==0?0:1)]|=Lc<<8*(3-e%4)),this._W[14]=t.byteLength/536870912,this._W[15]=8*t.byteLength,this._updateHash();const o=new Uint8Array(32);for(let t=0;t<this._H.length;t++)for(let e=0;e<4;e++)o[4*t+e]=this._H[t]>>>8*(3-e);return o}}const Rf=(t,e)=>void 0===e?!t.deleted:e.sv.has(t.id.client)&&e.sv.get(t.id.client)>t.id.clock&&!kd(e.ds,t.id),Bf=[{light:"#ecd44433",dark:"#ecd444"}],$f=(t,e,n)=>{if(!t.has(n)){if(t.size<e.length){const n=bc();t.forEach(t=>n.add(t)),e=e.filter(t=>!n.has(t))}t.set(n,(r=e)[ac(Tu()*r.length)])}var r;return t.get(n)},Pf=(t,e)=>({type:e.selection.jsonID,anchor:Af(e.selection.anchor,t.type,t.mapping),head:Af(e.selection.head,t.type,t.mapping)});class Ff{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;this.type=t,this.prosemirrorView=null,this.mux=(()=>{let t=!0;return(e,n)=>{if(t){t=!1;try{e()}finally{t=!0}}else void 0!==n&&n()}})(),this.mapping=e,this.isOMark=new Map,this._observeFunction=this._typeChanged.bind(this),this.doc=t.doc,this.beforeTransactionSelection=null,this.beforeAllTransactions=()=>{null===this.beforeTransactionSelection&&null!=this.prosemirrorView&&(this.beforeTransactionSelection=Pf(this,this.prosemirrorView.state))},this.afterAllTransactions=()=>{this.beforeTransactionSelection=null},this._domSelectionInView=null}get _tr(){return this.prosemirrorView.state.tr.setMeta("addToHistory",!1)}_isLocalCursorInView(){return!!this.prosemirrorView.hasFocus()&&(Hu&&null===this._domSelectionInView&&(Ef(0,()=>{this._domSelectionInView=null}),this._domSelectionInView=this._isDomSelectionInView()),this._domSelectionInView)}_isDomSelectionInView(){const t=this.prosemirrorView._root.getSelection();if(null==t||null==t.anchorNode)return!1;const e=this.prosemirrorView._root.createRange();e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset),0===e.getClientRects().length&&e.startContainer&&e.collapsed&&e.selectNodeContents(e.startContainer);const n=e.getBoundingClientRect(),r=Xu.documentElement;return n.bottom>=0&&n.right>=0&&n.left<=(window.innerWidth||r.clientWidth||0)&&n.top<=(window.innerHeight||r.clientHeight||0)}renderSnapshot(t,e){e||(e=sh(Ed(),new Map)),this.prosemirrorView.dispatch(this._tr.setMeta(ic,{snapshot:t,prevSnapshot:e}))}unrenderSnapshot(){this.mapping.clear(),this.mux(()=>{const t=this.type.toArray().map(t=>Hf(t,this.prosemirrorView.state.schema,this)).filter(t=>null!==t),e=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new y(d.from(t),0,0));e.setMeta(ic,{snapshot:null,prevSnapshot:null}),this.prosemirrorView.dispatch(e)})}_forceRerender(){this.mapping.clear(),this.mux(()=>{const t=null!==this.beforeTransactionSelection?null:this.prosemirrorView.state.selection,e=this.type.toArray().map(t=>Hf(t,this.prosemirrorView.state.schema,this)).filter(t=>null!==t),n=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new y(d.from(e),0,0));if(t){const e=cc(uc(t.anchor,0),n.doc.content.size),r=cc(uc(t.head,0),n.doc.content.size);n.setSelection(he.create(n.doc,e,r))}this.prosemirrorView.dispatch(n.setMeta(ic,{isChangeOrigin:!0,binding:this}))})}_renderSnapshot(t,e,n){let r=this.doc,o=this.type;if(t||(t=ah(this.doc)),t instanceof Uint8Array||e instanceof Uint8Array)if(t instanceof Uint8Array&&e instanceof Uint8Array||xc(),r=new Nd({gc:!1}),jd(r,e),e=ah(r),jd(r,t),t=ah(r),null===o._item){const t=Array.from(this.doc.share.keys()).find(t=>this.doc.share.get(t)===this.type);o=r.getXmlFragment(t)}else{const t=r.store.clients.get(o._item.id.client)??[],e=t[fh(t,o._item.id.clock)].content;o=e.type}this.mapping.clear(),this.mux(()=>{r.transact(r=>{const i=n.permanentUserData;i&&i.dss.forEach(t=>{Ad(r,t,t=>{})});const s=(t,e)=>{const r="added"===t?i.getUserByClientId(e.client):i.getUserByDeletedId(e);return{user:r,type:t,color:$f(n.colorMapping,n.colors,r)}},a=ep(o,new ih(e.ds,t.sv)).map(n=>!n._item.deleted||Rf(n._item,t)||Rf(n._item,e)?Hf(n,this.prosemirrorView.state.schema,{mapping:new Map,isOMark:new Map},t,e,s):null).filter(t=>null!==t),l=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new y(d.from(a),0,0));this.prosemirrorView.dispatch(l.setMeta(ic,{isChangeOrigin:!0}))},ic)})}_typeChanged(t,e){if(null==this.prosemirrorView)return;const n=ic.getState(this.prosemirrorView.state);0!==t.length&&null==n.snapshot&&null==n.prevSnapshot?this.mux(()=>{const t=(t,e)=>this.mapping.delete(e);Ad(e,e.deleteSet,t=>{if(t.constructor===gf){const e=t.content.type;e&&this.mapping.delete(e)}}),e.changed.forEach(t),e.changedParentTypes.forEach(t);const n=this.type.toArray().map(t=>zf(t,this.prosemirrorView.state.schema,this)).filter(t=>null!==t);let r=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new y(d.from(n),0,0));try{((t,e,n)=>{if(null!==e&&null!==e.anchor&&null!==e.head&&null!==e.anchor.item&&null!==e.head.item)if("all"===e.type)t.setSelection(new me(t.doc));else if("node"===e.type){const r=xf(n.doc,n.type,e.anchor,n.mapping);t.setSelection(fe.create(t.doc,r))}else{const r=xf(n.doc,n.type,e.anchor,n.mapping),o=xf(n.doc,n.type,e.head,n.mapping);if(null!==r&&null!==o){const e=he.between(t.doc.resolve(r),t.doc.resolve(o));t.setSelection(e)}}else console.debug("[y-prosemirror] restoreRelativeSelection: skip",{relSel:e})})(r,this.beforeTransactionSelection,this),r=r.setMeta(ic,{isChangeOrigin:!0,isUndoRedoOperation:e.origin instanceof Th}),this._isLocalCursorInView()&&null!==this.beforeTransactionSelection&&null!==this.beforeTransactionSelection.anchor&&null!==this.beforeTransactionSelection.anchor.item&&null!==this.beforeTransactionSelection.head&&null!==this.beforeTransactionSelection.head.item&&(console.debug("[y-prosemirror] _typeChanged: scrollIntoView"),r.scrollIntoView()),this.prosemirrorView.dispatch(r)}catch(t){console.error(t)}}):this.renderSnapshot(n.snapshot,n.prevSnapshot)}_prosemirrorChanged(t){this.doc.isSynced&&this.doc.transact(()=>{ng(this.doc,this.type,t,this),this.beforeTransactionSelection=Pf(this,this.prosemirrorView.state)},ic)}initView(t){null!=this.prosemirrorView&&this.destroy(),this.prosemirrorView=t,this.doc.on("beforeAllTransactions",this.beforeAllTransactions),this.doc.on("afterAllTransactions",this.afterAllTransactions),this.type.observeDeep(this._observeFunction)}destroy(){null!=this.prosemirrorView&&(this.prosemirrorView=null,this.type.unobserveDeep(this._observeFunction),this.doc.off("beforeAllTransactions",this.beforeAllTransactions),this.doc.off("afterAllTransactions",this.afterAllTransactions))}}const zf=(t,e,n,r,o,i)=>{const s=n.mapping.get(t);if(void 0===s){if(t instanceof Pp)return Hf(t,e,n,r,o,i);throw kc()}return s},Hf=(t,e,n,r,o,i)=>{const s=[],a=t=>{if(t instanceof Pp){const a=zf(t,e,n,r,o,i);null!==a&&s.push(a)}else{var a;const l=null===(a=t._item.right)||void 0===a||null===(a=a.content)||void 0===a?void 0:a.type;l instanceof Rp&&!l._item.deleted&&l._item.id.client===l.doc.clientID&&(t.applyDelta([{retain:t.length},...l.toDelta()]),l.doc.transact(t=>{l._item.delete(t)}));const c=jf(t,e,n,r,o,i);null!==c&&c.forEach(t=>{null!==t&&s.push(t)})}};void 0===r||void 0===o?t.toArray().forEach(a):ep(t,new ih(o.ds,r.sv)).forEach(a);try{const a=t.getAttributes(r);void 0!==r&&(Rf(t._item,r)?Rf(t._item,o)||(a.ychange=i?i("added",t._item.id):{type:"added"}):a.ychange=i?i("removed",t._item.id):{type:"removed"});const l=e.node(t.nodeName,a,s);return n.mapping.set(t,l),l}catch(e){return t.doc.transact(e=>{t._item.delete(e)},ic),n.mapping.delete(t),null}},jf=(t,e,n,r,o,i)=>{const s=[],a=t.toDelta(r,o,i);try{for(let t=0;t<a.length;t++){const n=a[t];s.push(e.text(n.insert,tg(n.attributes,e)))}}catch(e){return t.doc.transact(e=>{t._item.delete(e)},ic),null}return s},Vf=(t,e)=>t instanceof Array?((t,e)=>{const n=new Hp,r=t.map(t=>({insert:t.text,attributes:eg(t.marks,e)}));return n.applyDelta(r),e.mapping.set(n,t),n})(t,e):((t,e)=>{const n=new Pp(t.type.name);for(const e in t.attrs){const r=t.attrs[e];null!==r&&"ychange"!==e&&n.setAttribute(e,r)}return n.insert(0,Wf(t).map(t=>Vf(t,e))),e.mapping.set(n,t),n})(t,e),qf=t=>"object"==typeof t&&null!==t,Uf=(t,e)=>{const n=Object.keys(t).filter(e=>null!==t[e]);let r=0;if(null!==e)try{r=Object.keys(e).filter(t=>null!==e[t]).length}catch(t){console.error("[yProsemirror] equalAttrs error",t)}let o=n.length===r;for(let r=0;r<n.length&&o;r++){const i=n[r],s=t[i],a=e[i];o="ychange"===i||s===a||qf(s)&&qf(a)&&Uf(s,a)}return o},Wf=t=>{const e=t.content.content,n=[];for(let t=0;t<e.length;t++){const r=e[t];if(r.isText){const r=[];for(let n=e[t];t<e.length&&n.isText;n=e[++t])r.push(n);t--,n.push(r)}else n.push(r)}return n},Jf=(t,e)=>{const n=t.toDelta();return n.length===e.length&&n.every((t,n)=>t.insert===e[n].text&&pc(t.attributes||{}).length===e[n].marks.length&&gc(t.attributes,(t,r)=>{var o;const i=Xf(r),s=e[n].marks;return Uf(t,null===(o=s.find(t=>t.type.name===i))||void 0===o?void 0:o.attrs)}))},Kf=(t,e)=>{if(t instanceof Pp&&!(e instanceof Array)&&rg(t,e)){const n=Wf(e);return t._length===n.length&&Uf(t.getAttributes(),e.attrs)&&t.toArray().every((t,e)=>Kf(t,n[e]))}return t instanceof Hp&&e instanceof Array&&Jf(t,e)},Gf=(t,e)=>t===e||t instanceof Array&&e instanceof Array&&t.length===e.length&&t.every((t,n)=>e[n]===t),Yf=(t,e,n)=>{const r=t.toArray(),o=Wf(e),i=o.length,s=r.length,a=cc(s,i);let l=0,c=0,u=!1;for(;l<a;l++){const t=r[l],e=o[l];if(Gf(n.mapping.get(t),e))u=!0;else if(!Kf(t,e))break}for(;l+c<a;c++){const t=r[s-c-1],e=o[i-c-1];if(Gf(n.mapping.get(t),e))u=!0;else if(!Kf(t,e))break}return{equalityFactor:l+c,foundMappedChild:u}},Zf=(t,e,n)=>{n.mapping.set(t,e);const{nAttrs:r,str:o}=(t=>{let e="",n=t._start;const r={};for(;null!==n;)n.deleted||(n.countable&&n.content instanceof Xp?e+=n.content.str:n.content instanceof Gp&&(r[n.content.key]=null)),n=n.right;return{str:e,nAttrs:r}})(t),i=e.map(t=>({insert:t.text,attributes:Object.assign({},r,eg(t.marks,n))})),{insert:s,remove:a,index:l}=((t,e)=>{let n=0,r=0;for(;n<t.length&&n<e.length&&t[n]===e[n];)n++;for(n>0&&vc.test(t[n-1])&&n--;r+n<t.length&&r+n<e.length&&t[t.length-r-1]===e[e.length-r-1];)r++;return r>0&&wc.test(t[t.length-r])&&r--,{index:n,remove:t.length-n-r,insert:e.slice(n,e.length-r)}})(o,i.map(t=>t.insert).join(""));t.delete(l,a),t.insert(l,s),t.applyDelta(i.map(t=>({retain:t.insert.length,attributes:t.attributes})))},Qf=/(.*)(--[a-zA-Z0-9+/=]{8})$/,Xf=t=>{var e;return(null===(e=Qf.exec(t))||void 0===e?void 0:e[1])??t},tg=(t,e)=>{const n=[];for(const r in t)n.push(e.mark(Xf(r),t[r]));return n},eg=(t,e)=>{const n={};return t.forEach(t=>{if("ychange"!==t.type.name){const i=Ec(e.isOMark,t.type,()=>!t.type.excludes(t.type));n[i?`${t.type.name}--${r=t.toJSON(),Ku((t=>{for(let e=6;e<t.length;e++)t[e%6]=t[e%6]^t[e];return t.slice(0,6)})((o=Gu(r),(new Lf).digest(o))))}`:t.type.name]=t.attrs}var r,o}),n},ng=(t,e,n,r)=>{if(e instanceof Pp&&e.nodeName!==n.type.name)throw new Error("node name mismatch!");if(r.mapping.set(e,n),e instanceof Pp){const t=e.getAttributes(),r=n.attrs;for(const n in r)null!==r[n]?t[n]!==r[n]&&"ychange"!==n&&e.setAttribute(n,r[n]):e.removeAttribute(n);for(const n in t)void 0===r[n]&&e.removeAttribute(n)}const o=Wf(n),i=o.length,s=e.toArray(),a=s.length,l=cc(i,a);let c=0,u=0;for(;c<l;c++){const t=s[c],e=o[c];if(!Gf(r.mapping.get(t),e)){if(!Kf(t,e))break;r.mapping.set(t,e)}}for(;u+c+1<l;u++){const t=s[a-u-1],e=o[i-u-1];if(!Gf(r.mapping.get(t),e)){if(!Kf(t,e))break;r.mapping.set(t,e)}}t.transact(()=>{for(;a-c-u>0&&i-c-u>0;){const n=s[c],l=o[c],d=s[a-u-1],h=o[i-u-1];if(n instanceof Hp&&l instanceof Array)Jf(n,l)||Zf(n,l,r),c+=1;else{let o=n instanceof Pp&&rg(n,l),i=d instanceof Pp&&rg(d,h);if(o&&i){const t=Yf(n,l,r),e=Yf(d,h,r);t.foundMappedChild&&!e.foundMappedChild?i=!1:!t.foundMappedChild&&e.foundMappedChild||t.equalityFactor<e.equalityFactor?o=!1:i=!1}o?(ng(t,n,l,r),c+=1):i?(ng(t,d,h,r),u+=1):(r.mapping.delete(e.get(c)),e.delete(c,1),e.insert(c,[Vf(l,r)]),c+=1)}}const n=a-c-u;if(1===a&&0===i&&s[0]instanceof Hp?(r.mapping.delete(s[0]),s[0].delete(0,s[0].length)):n>0&&(e.slice(c,c+n).forEach(t=>r.mapping.delete(t)),e.delete(c,n)),c+u<i){const t=[];for(let e=c;e<i-u;e++)t.push(Vf(o[e],r));e.insert(c,t)}},ic)},rg=(t,e)=>!(e instanceof Array)&&t.nodeName===e.type.name,og=new Set(["paragraph"]),ig=Za.create({name:"collaboration",priority:1e3,addOptions:()=>({document:null,field:"default",fragment:null}),onCreate(){this.editor.extensionManager.extensions.find(t=>"history"===t.name||"undoRedo"===t.name)&&console.warn('[tiptap warn]: "@tiptap/extension-collaboration" comes with its own history support and is not compatible with "@tiptap/extension-history" or "@tiptap/extension-undo-redo".')},addCommands:()=>({undo:()=>({tr:t,state:e,dispatch:n})=>(t.setMeta("preventDispatch",!0),0!==sc.getState(e).undoManager.undoStack.length&&(!n||(t=>{var e;return null!=(null===(e=sc.getState(t))||void 0===e||null===(e=e.undoManager)||void 0===e?void 0:e.undo())})(e))),redo:()=>({tr:t,state:e,dispatch:n})=>(t.setMeta("preventDispatch",!0),0!==sc.getState(e).undoManager.redoStack.length&&(!n||(t=>{var e;return null!=(null===(e=sc.getState(t))||void 0===e||null===(e=e.undoManager)||void 0===e?void 0:e.redo())})(e)))}),addProseMirrorPlugins(){const t=this.options.fragment?this.options.fragment:this.options.document.getXmlFragment(this.options.field),e=function(){let{protectedNodes:t=og,trackedOrigins:e=[],undoManager:n=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Me({key:sc,state:{init:(r,o)=>{const i=ic.getState(o),s=n||new Th(i.type,{trackedOrigins:new Set([ic].concat(e)),deleteFilter:e=>((t,e)=>!(t instanceof gf&&t.content instanceof cf&&(t.content.type instanceof Rp||t.content.type instanceof Pp&&e.has(t.content.type.nodeName))&&0!==t.content.type._length))(e,t),captureTransaction:t=>!1!==t.meta.get("addToHistory")});return{undoManager:s,prevSel:null,hasUndoOps:s.undoStack.length>0,hasRedoOps:s.redoStack.length>0}},apply:(t,e,n,r)=>{const o=ic.getState(r).binding,i=e.undoManager,s=i.undoStack.length>0,a=i.redoStack.length>0;return o?{undoManager:i,prevSel:Pf(o,n),hasUndoOps:s,hasRedoOps:a}:s!==e.hasUndoOps||a!==e.hasRedoOps?Object.assign({},e,{hasUndoOps:i.undoStack.length>0,hasRedoOps:i.redoStack.length>0}):e}},view:t=>{const e=ic.getState(t.state),n=sc.getState(t.state).undoManager;return n.on("stack-item-added",n=>{let{stackItem:r}=n;const o=e.binding;o&&r.meta.set(o,sc.getState(t.state).prevSel)}),n.on("stack-item-popped",t=>{let{stackItem:n}=t;const r=e.binding;r&&(r.beforeTransactionSelection=n.meta.get(r)||r.beforeTransactionSelection)}),{destroy:()=>{n.destroy()}}}})}(),n=e.spec.view;e.spec.view=t=>{const{undoManager:e}=sc.getState(t.state);e.restore&&(e.restore(),e.restore=()=>{});const r=n?n(t):void 0;return{destroy:()=>{const t=e.trackedOrigins.has(e),n=e._observers;e.restore=()=>{t&&e.trackedOrigins.add(e),e.doc.on("afterTransaction",e.afterTransactionHandler),e._observers=n},(null==r?void 0:r.destroy)&&r.destroy()}}};const r=this.options.onFirstRender,o=function(t){let{colors:e=Bf,colorMapping:n=new Map,permanentUserData:r=null,onFirstRender:o=()=>{},mapping:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=!1;const a=new Ff(t,i),l=new Me({props:{editable:t=>{const e=ic.getState(t);return null==e.snapshot&&null==e.prevSnapshot}},key:ic,state:{init:(o,i)=>({type:t,doc:t.doc,binding:a,snapshot:null,prevSnapshot:null,isChangeOrigin:!1,isUndoRedoOperation:!1,addToHistory:!0,colors:e,colorMapping:n,permanentUserData:r}),apply:(t,e)=>{const n=t.getMeta(ic);if(void 0!==n){e=Object.assign({},e);for(const t in n)e[t]=n[t]}const r=t.getMeta("appendedTransaction");return e.addToHistory=!1!==t.getMeta("addToHistory")&&!(r&&!1===r.getMeta("addToHistory")),e.isChangeOrigin=void 0!==n&&!!n.isChangeOrigin,e.isUndoRedoOperation=void 0!==n&&!!n.isChangeOrigin&&!!n.isUndoRedoOperation,null!==a.prosemirrorView&&(void 0===n||null==n.snapshot&&null==n.prevSnapshot||Ef(0,()=>{null!=a.prosemirrorView&&(null==n.restore?a._renderSnapshot(n.snapshot,n.prevSnapshot,e):(a._renderSnapshot(n.snapshot,n.snapshot,e),delete e.restore,delete e.snapshot,delete e.prevSnapshot,a.mux(()=>{a._prosemirrorChanged(a.prosemirrorView.state.doc)})))})),e}},view:t=>(a.initView(t),null==i&&a._forceRerender(),o(),{update:()=>{const e=l.getState(t.state);if(null==e.snapshot&&null==e.prevSnapshot&&(s||null!==t.state.doc.content.findDiffStart(t.state.doc.type.createAndFill().content))){if(s=!0,!1===e.addToHistory&&!e.isChangeOrigin){const e=sc.getState(t.state),n=e&&e.undoManager;n&&n.stopCapturing()}a.mux(()=>{e.doc.transact(n=>{n.meta.set("addToHistory",e.addToHistory),a._prosemirrorChanged(t.state.doc)},ic)})}},destroy:()=>{a.destroy()}})});return l}(t,r?{onFirstRender:r}:{});return[o,e]}});var sg=Cl.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,"\n\n"):""});let ag=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&n[t]];return e};const lg=t=>{let e="h-"+ag();return"blockHook"===t?"b"+e:"inlineHook"===t?"i"+e:e},cg=(t,e)=>{const n=((t,e)=>{let n=null;return t.descendants((t,r,o)=>{if(t===e)return n=o,!1}),n})(t,e);return!n||0!==e.type.name.indexOf("table")||0!==n.type.name.indexOf("table")},ug=(t,e)=>t.some(t=>t.type===e.type.name),dg=t=>{try{return t&&t.length>0&&/^[a-zA-Z0-9-_]+$/.test(t)}catch(e){return console.error("[isHookIdValid] Error validating id: ",t,e),!1}},hg=t=>{const e=[];return t.descendants((t,n)=>{e.push(...t.marks.map(t=>({mark:t,pos:n})))}),e};let pg=[],fg=[];const gg=Za.create({name:"hook",priority:1e4,addOptions(){var t;return{...null===(t=this.options)||void 0===t?void 0:t.call(this),HTMLAttributes:{},targets:[],type:"",filterTransaction:null}},addGlobalAttributes(){return[{types:this.options.targets.map(t=>t.type),attributes:{hookId:{default:null,defaultOnSplit:!0,parseHTML:t=>t.getAttribute("id"),renderHTML:t=>({id:t.hookId})},hookType:{default:this.options.type,parseHTML:t=>t.getAttribute("data-hook-type"),renderHTML:t=>({"data-hook-type":t.hookType})}}}]},extendNodeSchema:t=>({allowHooks:Gs(Us(t,"allowHooks",{name:t.name,options:t.options}))}),onCreate(){const{view:t,state:e}=this.editor,{tr:n,doc:r}=e,{targets:o}=this.options;Hs(r,t=>ug(o,t)&&!cg(r,t)&&(!t.attrs.hookId||!dg(t.attrs.hookId))).forEach(t=>{let{node:e,pos:o}=t;if(cg(r,e)){const t=n.storedMarks;n.setNodeMarkup(o,void 0,{...e.attrs,hookId:lg(this.options.type)}),t&&t.length>0&&n.setStoredMarks(t)}});const i=((t,e)=>{const n={},r=[];return Hs(t,t=>t&&t.type&&ug(e,t)&&t.attrs.hookId).forEach(t=>{const{node:e}=t;n[e.attrs.hookId]?r.push(t):n[e.attrs.hookId]=!0}),r})(r,o);i.forEach(t=>{let{node:e,pos:r}=t;const o=n.storedMarks;n.setNodeMarkup(r,void 0,{...e.attrs,hookId:lg(this.options.type)}),o&&o.length>0&&n.setStoredMarks(o)}),t.dispatch(n)},onUpdate(){(()=>{if(fg.length>0){const t=new CustomEvent("napkinEventMarksDeleted",{detail:[...fg]});fg=[],document.dispatchEvent(t)}})(),(()=>{if(pg.length>0){const t=new CustomEvent("napkinEventMarksChanged",{detail:[...pg]});pg=[],document.dispatchEvent(t)}})()},addProseMirrorPlugins(){let t=null,e=!1;return[new Me({key:new De(this.options.type+"Plugin"),appendTransaction:(t,e,n)=>{const r=hg(e.doc),o=hg(n.doc);((t,e)=>{const n=new Set(t.map(t=>t.mark.attrs.hookId)),r=new Set(e.map(t=>t.mark.attrs.hookId));fg=[...n].filter(t=>!r.has(t))})(r,o),((t,e)=>{const n=[];if(t.forEach((t,r)=>{var o,i;i=e[r],!(o=t)&&!i||o&&i&&o.pos==i.pos||n.push(t)}),n.length>0){var r=n.filter(t=>null!==t.pos&&null!==t.mark.attrs.hookId&&"inlineHookMark"===t.mark.type.name).map(t=>t.mark.attrs.hookId);pg=[...r]}})(r,o);const i=t.some(t=>t.docChanged)&&!e.doc.eq(n.doc),s=this.options.filterTransaction&&t.some(t=>{var e,n;return!(null===(n=(e=this.options).filterTransaction)||void 0===n?void 0:n.call(e,t))});if(!i||s)return;const{tr:a}=n,l=this.options.targets,c=zs(e.doc,t),{mapping:u}=c,d=ca(c);var h=!1;return d.forEach(t=>{let{newRange:r,oldRange:o}=t;const i=js(n.doc,r,t=>ug(l,t)&&cg(n.doc,t)),s=js(e.doc,o,t=>ug(l,t)&&cg(e.doc,t));1!=h&&(h=((t,e)=>{if(t.length==e.length){for(var n=!1,r=0;r<t.length;r++)if(null!=t[r].node.attrs.textAlign&&null!=e[r].node.attrs.textAlign&&t[r].node.attrs.textAlign!=e[r].node.attrs.textAlign){n=!0;break}return n}})(s,i));const c=i.map(t=>{let{node:e}=t;return e.attrs.hookId}).filter(t=>null!==t),d=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.stringify;const n={};return t.filter(t=>{const r=e(t);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)})}((p=c).filter((t,e)=>p.indexOf(t)!==e));var p;i.forEach(t=>{let{node:e,pos:r}=t;if(!cg(n.doc,e))return;var o;const i=null===(o=a.doc.nodeAt(r))||void 0===o?void 0:o.attrs.hookId;if(null===i){var l;s.forEach(t=>{let{node:e,pos:n}=t;n==r&&"heading"==e.type.name&&(l=e.attrs.hookId)});const t=a.storedMarks||n.storedMarks;return a.setNodeMarkup(r,void 0,{...e.attrs,hookId:l&&dg(l)?l:lg(this.options.type)}),t&&t.length>0&&a.setStoredMarks(t),void(null!=l&&a.setMeta("headingToggled",l))}const{deleted:c}=u.invert().mapResult(r);if(c&&d.includes(i)){const t=a.storedMarks;a.setNodeMarkup(r,void 0,{...e.attrs,hookId:lg(this.options.type)}),t&&t.length>0&&a.setStoredMarks(t)}})}),h&&(t=>{t=t.map(t=>t.mark.attrs.hookId),pg=[...t]})(o),a.steps.length?(this.options.onTransaction&&this.options.onTransaction(a),a):void 0},view(e){const n=n=>{var r;t=(null===(r=e.dom.parentElement)||void 0===r?void 0:r.contains(n.target))?e.dom.parentElement:null};return window.addEventListener("dragstart",n),{destroy(){window.removeEventListener("dragstart",n)}}},props:{handleDOMEvents:{drop:(n,r)=>{var o;return t===n.dom.parentElement&&"copy"!==(null===(o=r.dataTransfer)||void 0===o?void 0:o.effectAllowed)||(t=null,e=!0),!1},paste:()=>(e=!0,!1)},transformPasted:t=>{if(!e)return t;const{state:n}=this.editor,{doc:r}=n,o=this.options.targets,i=t=>{const e=[];return t.forEach(t=>{if(!t)return;if(t.isText){if(0==t.marks.length)e.push(t);else{var n=[];t.marks.forEach(t=>{"inlineHook"!=t.attrs.hookType&&n.push(t)}),t.marks=[...n],e.push(t)}return}if(!ug(o,t)||!cg(r,t))return void e.push(t.copy(i(t.content)));const s=t.type.create({...t.attrs,hookId:null},i(t.content),t.marks);e.push(s)}),d.from(e)};return e=!1,new y(i(t.content),t.openStart,t.openEnd)}}})]}});function mg(t,e,n){const r=Math.min(n,5e3);for(var o=[],i=0;i<r;i++)o.push({type:"paragraph",attrs:{hookId:lg("blockHook"),hookType:"blockHook"}});return t.insertContentAt(e,o,{updateSelection:!1}),!0}function yg(t){return t&&t.type&&"paragraph"===t.type.name&&""===t.textContent}function bg(t,e,n){let r=t.dom;if(!r||!r.getBoundingClientRect)return!1;let o=r.getBoundingClientRect().top+n,i=t.nodeDOM(e);return!(!i||!i.getBoundingClientRect)&&i.getBoundingClientRect().top>o}const vg=sg.extend({content:"title block*",addOptions(){var t;return{...null===(t=this.options)||void 0===t?void 0:t.call(this),lineHeight:25,lineHeightThreshold:25,lineHeightThresholdDeletion:250}},addCommands(){return{insertBlankLines:(t,e,n)=>r=>{let{editor:o,tr:i,dispatch:s,commands:a,state:l,view:c,chain:u}=r;return i.setMeta("addToHistory",n),mg(a,t,e)},deleteRangeWithHistory:(t,e,n)=>r=>{let{editor:o,tr:i,dispatch:s,commands:a,state:l,view:c,chain:u}=r;return i.setMeta("addToHistory",n),a.deleteRange({from:t,to:e}),!0},expandContent:t=>e=>{let{editor:n,tr:r,dispatch:o,commands:i,state:s,view:a,chain:l}=e,c=a.dom,u=c.lastElementChild;if(!c||!u)return!1;const d=this.options.domScaleGetter()||1;let h=c.getBoundingClientRect(),p=u.getBoundingClientRect(),f=Math.floor((p.bottom-h.top)/d),g=f-t;if(f<=0)return console.warn("[expandContent] currentHeight is 0: ",{currentHeight:f,height:t,deltaHeight:g}),!1;if(g>0&&g<this.options.lineHeightThreshold)return!1;if(g<0){if(g<-500&&console.debug("[expandContent] large delta detected (adding lines): ",{currentHeight:f,height:t,deltaHeight:g}),o){let t=Math.abs(g)+this.options.lineHeightThreshold,e=Math.ceil(t/this.options.lineHeight);r.setMeta("addToHistory",!1),mg(i,s.doc.content.size,e)}return!0}if(g>this.options.lineHeightThresholdDeletion){if(g>500&&console.debug("[expandContent] large delta detected (removing lines): ",{currentHeight:f,height:t,deltaHeight:g}),o){let e=t+this.options.lineHeightThresholdDeletion;r.setMeta("addToHistory",!1),function(t,e,n,r){if(!r||r<=0)return;if(!t.doc.content.lastChild)return;let o=t.doc.nodeSize-1-1,i=o,s=o;for(let e=t.doc.childCount-1;e>0;e--){let o=t.doc.child(e);if(!o||!yg(o))break;let i=s-o.nodeSize;if(!bg(n,i,r))break;s=i}s!==i&&e.deleteRange({from:s,to:i})}(s,i,a,e)}return!0}return!1},clearSlashCommand:t=>e=>{let{tr:n,dispatch:r,commands:o,chain:i}=e;return console.assert(t,"command must be valid"),"slash"!=t.name?(console.warn("clearCommand: command is not slash"),!1):r?(t.steps&&t.steps.forEach(t=>{n.step(t)}),o.blur()):(n.setMeta("addToHistory",!1),!0)}}}}),wg=vg,Ag={};function kg(t,e){"string"!=typeof e&&(e=kg.defaultChars);const n=function(t){let e=Ag[t];if(e)return e;e=Ag[t]=[];for(let t=0;t<128;t++){const n=String.fromCharCode(t);e.push(n)}for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);e[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return e}(e);return t.replace(/(%[a-f0-9]{2})+/gi,function(t){let e="";for(let r=0,o=t.length;r<o;r+=3){const i=parseInt(t.slice(r+1,r+3),16);if(i<128)e+=n[i];else{if(192==(224&i)&&r+3<o){const n=parseInt(t.slice(r+4,r+6),16);if(128==(192&n)){const t=i<<6&1984|63&n;e+=t<128?"":String.fromCharCode(t),r+=3;continue}}if(224==(240&i)&&r+6<o){const n=parseInt(t.slice(r+4,r+6),16),o=parseInt(t.slice(r+7,r+9),16);if(128==(192&n)&&128==(192&o)){const t=i<<12&61440|n<<6&4032|63&o;e+=t<2048||t>=55296&&t<=57343?"":String.fromCharCode(t),r+=6;continue}}if(240==(248&i)&&r+9<o){const n=parseInt(t.slice(r+4,r+6),16),o=parseInt(t.slice(r+7,r+9),16),s=parseInt(t.slice(r+10,r+12),16);if(128==(192&n)&&128==(192&o)&&128==(192&s)){let t=i<<18&1835008|n<<12&258048|o<<6&4032|63&s;t<65536||t>1114111?e+="":(t-=65536,e+=String.fromCharCode(55296+(t>>10),56320+(1023&t))),r+=9;continue}}e+=""}}return e})}kg.defaultChars=";/?:@&=+$,#",kg.componentChars="";const xg=kg,Cg={};function Sg(t,e,n){"string"!=typeof e&&(n=e,e=Sg.defaultChars),void 0===n&&(n=!0);const r=function(t){let e=Cg[t];if(e)return e;e=Cg[t]=[];for(let t=0;t<128;t++){const n=String.fromCharCode(t);/^[0-9a-z]$/i.test(n)?e.push(n):e.push("%"+("0"+t.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<t.length;n++)e[t.charCodeAt(n)]=t[n];return e}(e);let o="";for(let e=0,i=t.length;e<i;e++){const s=t.charCodeAt(e);if(n&&37===s&&e+2<i&&/^[0-9a-f]{2}$/i.test(t.slice(e+1,e+3)))o+=t.slice(e,e+3),e+=2;else if(s<128)o+=r[s];else if(s>=55296&&s<=57343){if(s>=55296&&s<=56319&&e+1<i){const n=t.charCodeAt(e+1);if(n>=56320&&n<=57343){o+=encodeURIComponent(t[e]+t[e+1]),e++;continue}}o+="%EF%BF%BD"}else o+=encodeURIComponent(t[e])}return o}Sg.defaultChars=";/?:@&=+$,-_.!~*'()#",Sg.componentChars="-_.!~*'()";const Eg=Sg;function Mg(t){let e="";return e+=t.protocol||"",e+=t.slashes?"//":"",e+=t.auth?t.auth+"@":"",t.hostname&&-1!==t.hostname.indexOf(":")?e+="["+t.hostname+"]":e+=t.hostname||"",e+=t.port?":"+t.port:"",e+=t.pathname||"",e+=t.search||"",e+=t.hash||"",e}function _g(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const Tg=/^([a-z0-9.+-]+:)/i,Dg=/:[0-9]*$/,Og=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Ng=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),Ig=["'"].concat(Ng),Lg=["%","/","?",";","#"].concat(Ig),Rg=["/","?","#"],Bg=/^[+a-z0-9A-Z_-]{0,63}$/,$g=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Pg={javascript:!0,"javascript:":!0},Fg={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};_g.prototype.parse=function(t,e){let n,r,o,i=t;if(i=i.trim(),!e&&1===t.split("#").length){const t=Og.exec(i);if(t)return this.pathname=t[1],t[2]&&(this.search=t[2]),this}let s=Tg.exec(i);if(s&&(s=s[0],n=s.toLowerCase(),this.protocol=s,i=i.substr(s.length)),(e||s||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(o="//"===i.substr(0,2),!o||s&&Pg[s]||(i=i.substr(2),this.slashes=!0)),!Pg[s]&&(o||s&&!Fg[s])){let t,e,n=-1;for(let t=0;t<Rg.length;t++)r=i.indexOf(Rg[t]),-1!==r&&(-1===n||r<n)&&(n=r);e=-1===n?i.lastIndexOf("@"):i.lastIndexOf("@",n),-1!==e&&(t=i.slice(0,e),i=i.slice(e+1),this.auth=t),n=-1;for(let t=0;t<Lg.length;t++)r=i.indexOf(Lg[t]),-1!==r&&(-1===n||r<n)&&(n=r);-1===n&&(n=i.length),":"===i[n-1]&&n--;const o=i.slice(0,n);i=i.slice(n),this.parseHost(o),this.hostname=this.hostname||"";const s="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!s){const t=this.hostname.split(/\./);for(let e=0,n=t.length;e<n;e++){const n=t[e];if(n&&!n.match(Bg)){let r="";for(let t=0,e=n.length;t<e;t++)n.charCodeAt(t)>127?r+="x":r+=n[t];if(!r.match(Bg)){const r=t.slice(0,e),o=t.slice(e+1),s=n.match($g);s&&(r.push(s[1]),o.unshift(s[2])),o.length&&(i=o.join(".")+i),this.hostname=r.join(".");break}}}}this.hostname.length>255&&(this.hostname=""),s&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const a=i.indexOf("#");-1!==a&&(this.hash=i.substr(a),i=i.slice(0,a));const l=i.indexOf("?");return-1!==l&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),Fg[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this},_g.prototype.parseHost=function(t){let e=Dg.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const zg=function(t,e){if(t&&t instanceof _g)return t;const n=new _g;return n.parse(t,e),n},Hg=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,jg=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,Vg=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,qg=/[\0-\x1F\x7F-\x9F]/,Ug=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,Wg=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,Jg=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(t=>t.charCodeAt(0))),Kg=new Uint16Array("aglq\t\0\0p;os;t;t;uot;".split("").map(t=>t.charCodeAt(0)));var Gg;const Yg=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Zg=null!==(Gg=String.fromCodePoint)&&void 0!==Gg?Gg:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|1023&t),e+=String.fromCharCode(t),e};var Qg,Xg,tm,em,nm;function rm(t){return t>=Qg.ZERO&&t<=Qg.NINE}function om(t){return t>=Qg.UPPER_A&&t<=Qg.UPPER_F||t>=Qg.LOWER_A&&t<=Qg.LOWER_F}function im(t){return t===Qg.EQUALS||function(t){return t>=Qg.UPPER_A&&t<=Qg.UPPER_Z||t>=Qg.LOWER_A&&t<=Qg.LOWER_Z||rm(t)}(t)}!function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"}(Qg||(Qg={})),function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"}(Xg||(Xg={})),function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"}(tm||(tm={})),(nm=em||(em={}))[nm.Legacy=0]="Legacy",nm[nm.Strict=1]="Strict",nm[nm.Attribute=2]="Attribute";class sm{constructor(t,e,n){this.decodeTree=t,this.emitCodePoint=e,this.errors=n,this.state=tm.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=em.Strict}startEntity(t){this.decodeMode=t,this.state=tm.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,e){switch(this.state){case tm.EntityStart:return t.charCodeAt(e)===Qg.NUM?(this.state=tm.NumericStart,this.consumed+=1,this.stateNumericStart(t,e+1)):(this.state=tm.NamedEntity,this.stateNamedEntity(t,e));case tm.NumericStart:return this.stateNumericStart(t,e);case tm.NumericDecimal:return this.stateNumericDecimal(t,e);case tm.NumericHex:return this.stateNumericHex(t,e);case tm.NamedEntity:return this.stateNamedEntity(t,e)}}stateNumericStart(t,e){return e>=t.length?-1:(32|t.charCodeAt(e))===Qg.LOWER_X?(this.state=tm.NumericHex,this.consumed+=1,this.stateNumericHex(t,e+1)):(this.state=tm.NumericDecimal,this.stateNumericDecimal(t,e))}addToNumericResult(t,e,n,r){if(e!==n){const o=n-e;this.result=this.result*Math.pow(r,o)+parseInt(t.substr(e,o),r),this.consumed+=o}}stateNumericHex(t,e){const n=e;for(;e<t.length;){const r=t.charCodeAt(e);if(!rm(r)&&!om(r))return this.addToNumericResult(t,n,e,16),this.emitNumericEntity(r,3);e+=1}return this.addToNumericResult(t,n,e,16),-1}stateNumericDecimal(t,e){const n=e;for(;e<t.length;){const r=t.charCodeAt(e);if(!rm(r))return this.addToNumericResult(t,n,e,10),this.emitNumericEntity(r,2);e+=1}return this.addToNumericResult(t,n,e,10),-1}emitNumericEntity(t,e){var n;if(this.consumed<=e)return null===(n=this.errors)||void 0===n||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===Qg.SEMI)this.consumed+=1;else if(this.decodeMode===em.Strict)return 0;return this.emitCodePoint(function(t){var e;return t>=55296&&t<=57343||t>1114111?65533:null!==(e=Yg.get(t))&&void 0!==e?e:t}(this.result),this.consumed),this.errors&&(t!==Qg.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,e){const{decodeTree:n}=this;let r=n[this.treeIndex],o=(r&Xg.VALUE_LENGTH)>>14;for(;e<t.length;e++,this.excess++){const i=t.charCodeAt(e);if(this.treeIndex=lm(n,r,this.treeIndex+Math.max(1,o),i),this.treeIndex<0)return 0===this.result||this.decodeMode===em.Attribute&&(0===o||im(i))?0:this.emitNotTerminatedNamedEntity();if(r=n[this.treeIndex],o=(r&Xg.VALUE_LENGTH)>>14,0!==o){if(i===Qg.SEMI)return this.emitNamedEntityData(this.treeIndex,o,this.consumed+this.excess);this.decodeMode!==em.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:e,decodeTree:n}=this,r=(n[e]&Xg.VALUE_LENGTH)>>14;return this.emitNamedEntityData(e,r,this.consumed),null===(t=this.errors)||void 0===t||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,e,n){const{decodeTree:r}=this;return this.emitCodePoint(1===e?r[t]&~Xg.VALUE_LENGTH:r[t+1],n),3===e&&this.emitCodePoint(r[t+2],n),n}end(){var t;switch(this.state){case tm.NamedEntity:return 0===this.result||this.decodeMode===em.Attribute&&this.result!==this.treeIndex?0:this.emitNotTerminatedNamedEntity();case tm.NumericDecimal:return this.emitNumericEntity(0,2);case tm.NumericHex:return this.emitNumericEntity(0,3);case tm.NumericStart:return null===(t=this.errors)||void 0===t||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case tm.EntityStart:return 0}}}function am(t){let e="";const n=new sm(t,t=>e+=Zg(t));return function(t,r){let o=0,i=0;for(;(i=t.indexOf("&",i))>=0;){e+=t.slice(o,i),n.startEntity(r);const s=n.write(t,i+1);if(s<0){o=i+n.end();break}o=i+s,i=0===s?o+1:o}const s=e+t.slice(o);return e="",s}}function lm(t,e,n,r){const o=(e&Xg.BRANCH_LENGTH)>>7,i=e&Xg.JUMP_TABLE;if(0===o)return 0!==i&&r===i?n:-1;if(i){const e=r-i;return e<0||e>=o?-1:t[n+e]-1}let s=n,a=s+o-1;for(;s<=a;){const e=s+a>>>1,n=t[e];if(n<r)s=e+1;else{if(!(n>r))return t[e+o];a=e-1}}return-1}const cm=am(Jg);function um(t,e=em.Legacy){return cm(t,e)}function dm(t){for(let e=1;e<t.length;e++)t[e][0]+=t[e-1][0]+1;return t}am(Kg),new Map(dm([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(dm([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(dm([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(dm([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]));const hm=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]);function pm(t,e){return function(n){let r,o=0,i="";for(;r=t.exec(n);)o!==r.index&&(i+=n.substring(o,r.index)),i+=e.get(r[0].charCodeAt(0)),o=r.index+1;return i+n.substring(o)}}var fm,gm;function mm(t){return"[object String]"===function(t){return Object.prototype.toString.call(t)}(t)}String.prototype.codePointAt,pm(/[&<>'"]/g,hm),pm(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),pm(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]])),function(t){t[t.XML=0]="XML",t[t.HTML=1]="HTML"}(fm||(fm={})),function(t){t[t.UTF8=0]="UTF8",t[t.ASCII=1]="ASCII",t[t.Extensive=2]="Extensive",t[t.Attribute=3]="Attribute",t[t.Text=4]="Text"}(gm||(gm={}));const ym=Object.prototype.hasOwnProperty;function bm(t,e){return ym.call(t,e)}function vm(t){return Array.prototype.slice.call(arguments,1).forEach(function(e){if(e){if("object"!=typeof e)throw new TypeError(e+"must be object");Object.keys(e).forEach(function(n){t[n]=e[n]})}}),t}function wm(t,e,n){return[].concat(t.slice(0,e),n,t.slice(e+1))}function Am(t){return!(t>=55296&&t<=57343||t>=64976&&t<=65007||!(65535&~t&&65534!=(65535&t))||t>=0&&t<=8||11===t||t>=14&&t<=31||t>=127&&t<=159||t>1114111)}function km(t){if(t>65535){const e=55296+((t-=65536)>>10),n=56320+(1023&t);return String.fromCharCode(e,n)}return String.fromCharCode(t)}const xm=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,Cm=new RegExp(xm.source+"|"+/&([a-z#][a-z0-9]{1,31});/gi.source,"gi"),Sm=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function Em(t){return t.indexOf("\\")<0?t:t.replace(xm,"$1")}function Mm(t){return t.indexOf("\\")<0&&t.indexOf("&")<0?t:t.replace(Cm,function(t,e,n){return e||function(t,e){if(35===e.charCodeAt(0)&&Sm.test(e)){const n="x"===e[1].toLowerCase()?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return Am(n)?km(n):t}const n=um(t);return n!==t?n:t}(t,n)})}const _m=/[&<>"]/,Tm=/[&<>"]/g,Dm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function Om(t){return Dm[t]}function Nm(t){return _m.test(t)?t.replace(Tm,Om):t}const Im=/[.?*+^$[\]\\(){}|-]/g;function Lm(t){return t.replace(Im,"\\$&")}function Rm(t){switch(t){case 9:case 32:return!0}return!1}function Bm(t){if(t>=8192&&t<=8202)return!0;switch(t){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function $m(t){return Hg.test(t)||jg.test(t)}function Pm(t){switch(t){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function Fm(t){return t=t.trim().replace(/\s+/g," "),""==="".toLowerCase()&&(t=t.replace(//g,"")),t.toLowerCase().toUpperCase()}const zm={mdurl:r,ucmicro:o};function Hm(t,e,n){let r,o,i,s;const a=t.posMax,l=t.pos;for(t.pos=e+1,r=1;t.pos<a;){if(i=t.src.charCodeAt(t.pos),93===i&&(r--,0===r)){o=!0;break}if(s=t.pos,t.md.inline.skipToken(t),91===i)if(s===t.pos-1)r++;else if(n)return t.pos=l,-1}let c=-1;return o&&(c=t.pos),t.pos=l,c}function jm(t,e,n){let r,o=e;const i={ok:!1,pos:0,str:""};if(60===t.charCodeAt(o)){for(o++;o<n;){if(r=t.charCodeAt(o),10===r)return i;if(60===r)return i;if(62===r)return i.pos=o+1,i.str=Mm(t.slice(e+1,o)),i.ok=!0,i;92===r&&o+1<n?o+=2:o++}return i}let s=0;for(;o<n&&(r=t.charCodeAt(o),32!==r)&&!(r<32||127===r);)if(92===r&&o+1<n){if(32===t.charCodeAt(o+1))break;o+=2}else{if(40===r&&(s++,s>32))return i;if(41===r){if(0===s)break;s--}o++}return e===o||0!==s||(i.str=Mm(t.slice(e,o)),i.pos=o,i.ok=!0),i}function Vm(t,e,n,r){let o,i=e;const s={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)s.str=r.str,s.marker=r.marker;else{if(i>=n)return s;let r=t.charCodeAt(i);if(34!==r&&39!==r&&40!==r)return s;e++,i++,40===r&&(r=41),s.marker=r}for(;i<n;){if(o=t.charCodeAt(i),o===s.marker)return s.pos=i+1,s.str+=Mm(t.slice(e,i)),s.ok=!0,s;if(40===o&&41===s.marker)return s;92===o&&i+1<n&&i++,i++}return s.can_continue=!0,s.str+=Mm(t.slice(e,i)),s}const qm={};function Um(){this.rules=vm({},qm)}qm.code_inline=function(t,e,n,r,o){const i=t[e];return"<code"+o.renderAttrs(i)+">"+Nm(i.content)+"</code>"},qm.code_block=function(t,e,n,r,o){const i=t[e];return"<pre"+o.renderAttrs(i)+"><code>"+Nm(t[e].content)+"</code></pre>\n"},qm.fence=function(t,e,n,r,o){const i=t[e],s=i.info?Mm(i.info).trim():"";let a,l="",c="";if(s){const t=s.split(/(\s+)/g);l=t[0],c=t.slice(2).join("")}if(a=n.highlight&&n.highlight(i.content,l,c)||Nm(i.content),0===a.indexOf("<pre"))return a+"\n";if(s){const t=i.attrIndex("class"),e=i.attrs?i.attrs.slice():[];t<0?e.push(["class",n.langPrefix+l]):(e[t]=e[t].slice(),e[t][1]+=" "+n.langPrefix+l);const r={attrs:e};return`<pre><code${o.renderAttrs(r)}>${a}</code></pre>\n`}return`<pre><code${o.renderAttrs(i)}>${a}</code></pre>\n`},qm.image=function(t,e,n,r,o){const i=t[e];return i.attrs[i.attrIndex("alt")][1]=o.renderInlineAsText(i.children,n,r),o.renderToken(t,e,n)},qm.hardbreak=function(t,e,n){return n.xhtmlOut?"<br />\n":"<br>\n"},qm.softbreak=function(t,e,n){return n.breaks?n.xhtmlOut?"<br />\n":"<br>\n":"\n"},qm.text=function(t,e){return Nm(t[e].content)},qm.html_block=function(t,e){return t[e].content},qm.html_inline=function(t,e){return t[e].content},Um.prototype.renderAttrs=function(t){let e,n,r;if(!t.attrs)return"";for(r="",e=0,n=t.attrs.length;e<n;e++)r+=" "+Nm(t.attrs[e][0])+'="'+Nm(t.attrs[e][1])+'"';return r},Um.prototype.renderToken=function(t,e,n){const r=t[e];let o="";if(r.hidden)return"";r.block&&-1!==r.nesting&&e&&t[e-1].hidden&&(o+="\n"),o+=(-1===r.nesting?"</":"<")+r.tag,o+=this.renderAttrs(r),0===r.nesting&&n.xhtmlOut&&(o+=" /");let i=!1;if(r.block&&(i=!0,1===r.nesting&&e+1<t.length)){const n=t[e+1];("inline"===n.type||n.hidden||-1===n.nesting&&n.tag===r.tag)&&(i=!1)}return o+=i?">\n":">",o},Um.prototype.renderInline=function(t,e,n){let r="";const o=this.rules;for(let i=0,s=t.length;i<s;i++){const s=t[i].type;void 0!==o[s]?r+=o[s](t,i,e,n,this):r+=this.renderToken(t,i,e)}return r},Um.prototype.renderInlineAsText=function(t,e,n){let r="";for(let o=0,i=t.length;o<i;o++)switch(t[o].type){case"text":case"html_inline":case"html_block":r+=t[o].content;break;case"image":r+=this.renderInlineAsText(t[o].children,e,n);break;case"softbreak":case"hardbreak":r+="\n"}return r},Um.prototype.render=function(t,e,n){let r="";const o=this.rules;for(let i=0,s=t.length;i<s;i++){const s=t[i].type;"inline"===s?r+=this.renderInline(t[i].children,e,n):void 0!==o[s]?r+=o[s](t,i,e,n,this):r+=this.renderToken(t,i,e,n)}return r};const Wm=Um;function Jm(){this.__rules__=[],this.__cache__=null}Jm.prototype.__find__=function(t){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===t)return e;return-1},Jm.prototype.__compile__=function(){const t=this,e=[""];t.__rules__.forEach(function(t){t.enabled&&t.alt.forEach(function(t){e.indexOf(t)<0&&e.push(t)})}),t.__cache__={},e.forEach(function(e){t.__cache__[e]=[],t.__rules__.forEach(function(n){n.enabled&&(e&&n.alt.indexOf(e)<0||t.__cache__[e].push(n.fn))})})},Jm.prototype.at=function(t,e,n){const r=this.__find__(t),o=n||{};if(-1===r)throw new Error("Parser rule not found: "+t);this.__rules__[r].fn=e,this.__rules__[r].alt=o.alt||[],this.__cache__=null},Jm.prototype.before=function(t,e,n,r){const o=this.__find__(t),i=r||{};if(-1===o)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o,0,{name:e,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null},Jm.prototype.after=function(t,e,n,r){const o=this.__find__(t),i=r||{};if(-1===o)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o+1,0,{name:e,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null},Jm.prototype.push=function(t,e,n){const r=n||{};this.__rules__.push({name:t,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null},Jm.prototype.enable=function(t,e){Array.isArray(t)||(t=[t]);const n=[];return t.forEach(function(t){const r=this.__find__(t);if(r<0){if(e)return;throw new Error("Rules manager: invalid rule name "+t)}this.__rules__[r].enabled=!0,n.push(t)},this),this.__cache__=null,n},Jm.prototype.enableOnly=function(t,e){Array.isArray(t)||(t=[t]),this.__rules__.forEach(function(t){t.enabled=!1}),this.enable(t,e)},Jm.prototype.disable=function(t,e){Array.isArray(t)||(t=[t]);const n=[];return t.forEach(function(t){const r=this.__find__(t);if(r<0){if(e)return;throw new Error("Rules manager: invalid rule name "+t)}this.__rules__[r].enabled=!1,n.push(t)},this),this.__cache__=null,n},Jm.prototype.getRules=function(t){return null===this.__cache__&&this.__compile__(),this.__cache__[t]||[]};const Km=Jm;function Gm(t,e,n){this.type=t,this.tag=e,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}Gm.prototype.attrIndex=function(t){if(!this.attrs)return-1;const e=this.attrs;for(let n=0,r=e.length;n<r;n++)if(e[n][0]===t)return n;return-1},Gm.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]},Gm.prototype.attrSet=function(t,e){const n=this.attrIndex(t),r=[t,e];n<0?this.attrPush(r):this.attrs[n]=r},Gm.prototype.attrGet=function(t){const e=this.attrIndex(t);let n=null;return e>=0&&(n=this.attrs[e][1]),n},Gm.prototype.attrJoin=function(t,e){const n=this.attrIndex(t);n<0?this.attrPush([t,e]):this.attrs[n][1]=this.attrs[n][1]+" "+e};const Ym=Gm;function Zm(t,e,n){this.src=t,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=e}Zm.prototype.Token=Ym;const Qm=Zm,Xm=/\r\n?|\n/g,ty=/\0/g;function ey(t){return/^<a[>\s]/i.test(t)}function ny(t){return/^<\/a\s*>/i.test(t)}const ry=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,oy=/\((c|tm|r)\)/i,iy=/\((c|tm|r)\)/gi,sy={c:"",r:"",tm:""};function ay(t,e){return sy[e.toLowerCase()]}function ly(t){let e=0;for(let n=t.length-1;n>=0;n--){const r=t[n];"text"!==r.type||e||(r.content=r.content.replace(iy,ay)),"link_open"===r.type&&"auto"===r.info&&e--,"link_close"===r.type&&"auto"===r.info&&e++}}function cy(t){let e=0;for(let n=t.length-1;n>=0;n--){const r=t[n];"text"!==r.type||e||ry.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/gm,"$1").replace(/(^|\s)--(?=\s|$)/gm,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/gm,"$1")),"link_open"===r.type&&"auto"===r.info&&e--,"link_close"===r.type&&"auto"===r.info&&e++}}const uy=/['"]/,dy=/['"]/g;function hy(t,e,n){return t.slice(0,e)+n+t.slice(e+1)}function py(t,e){let n;const r=[];for(let o=0;o<t.length;o++){const i=t[o],s=t[o].level;for(n=r.length-1;n>=0&&!(r[n].level<=s);n--);if(r.length=n+1,"text"!==i.type)continue;let a=i.content,l=0,c=a.length;t:for(;l<c;){dy.lastIndex=l;const u=dy.exec(a);if(!u)break;let d=!0,h=!0;l=u.index+1;const p="'"===u[0];let f=32;if(u.index-1>=0)f=a.charCodeAt(u.index-1);else for(n=o-1;n>=0&&"softbreak"!==t[n].type&&"hardbreak"!==t[n].type;n--)if(t[n].content){f=t[n].content.charCodeAt(t[n].content.length-1);break}let g=32;if(l<c)g=a.charCodeAt(l);else for(n=o+1;n<t.length&&"softbreak"!==t[n].type&&"hardbreak"!==t[n].type;n++)if(t[n].content){g=t[n].content.charCodeAt(0);break}const m=Pm(f)||$m(String.fromCharCode(f)),y=Pm(g)||$m(String.fromCharCode(g)),b=Bm(f),v=Bm(g);if(v?d=!1:y&&(b||m||(d=!1)),b?h=!1:m&&(v||y||(h=!1)),34===g&&'"'===u[0]&&f>=48&&f<=57&&(h=d=!1),d&&h&&(d=m,h=y),d||h){if(h)for(n=r.length-1;n>=0;n--){let d=r[n];if(r[n].level<s)break;if(d.single===p&&r[n].level===s){let s,h;d=r[n],p?(s=e.md.options.quotes[2],h=e.md.options.quotes[3]):(s=e.md.options.quotes[0],h=e.md.options.quotes[1]),i.content=hy(i.content,u.index,h),t[d.token].content=hy(t[d.token].content,d.pos,s),l+=h.length-1,d.token===o&&(l+=s.length-1),a=i.content,c=a.length,r.length=n;continue t}}d?r.push({token:o,pos:u.index,single:p,level:s}):h&&p&&(i.content=hy(i.content,u.index,""))}else p&&(i.content=hy(i.content,u.index,""))}}}const fy=[["normalize",function(t){let e;e=t.src.replace(Xm,"\n"),e=e.replace(ty,""),t.src=e}],["block",function(t){let e;t.inlineMode?(e=new t.Token("inline","",0),e.content=t.src,e.map=[0,1],e.children=[],t.tokens.push(e)):t.md.block.parse(t.src,t.md,t.env,t.tokens)}],["inline",function(t){const e=t.tokens;for(let n=0,r=e.length;n<r;n++){const r=e[n];"inline"===r.type&&t.md.inline.parse(r.content,t.md,t.env,r.children)}}],["linkify",function(t){const e=t.tokens;if(t.md.options.linkify)for(let n=0,r=e.length;n<r;n++){if("inline"!==e[n].type||!t.md.linkify.pretest(e[n].content))continue;let r=e[n].children,o=0;for(let i=r.length-1;i>=0;i--){const s=r[i];if("link_close"!==s.type){if("html_inline"===s.type&&(ey(s.content)&&o>0&&o--,ny(s.content)&&o++),!(o>0)&&"text"===s.type&&t.md.linkify.test(s.content)){const o=s.content;let a=t.md.linkify.match(o);const l=[];let c=s.level,u=0;a.length>0&&0===a[0].index&&i>0&&"text_special"===r[i-1].type&&(a=a.slice(1));for(let e=0;e<a.length;e++){const n=a[e].url,r=t.md.normalizeLink(n);if(!t.md.validateLink(r))continue;let i=a[e].text;i=a[e].schema?"mailto:"!==a[e].schema||/^mailto:/i.test(i)?t.md.normalizeLinkText(i):t.md.normalizeLinkText("mailto:"+i).replace(/^mailto:/,""):t.md.normalizeLinkText("http://"+i).replace(/^http:\/\//,"");const s=a[e].index;if(s>u){const e=new t.Token("text","",0);e.content=o.slice(u,s),e.level=c,l.push(e)}const d=new t.Token("link_open","a",1);d.attrs=[["href",r]],d.level=c++,d.markup="linkify",d.info="auto",l.push(d);const h=new t.Token("text","",0);h.content=i,h.level=c,l.push(h);const p=new t.Token("link_close","a",-1);p.level=--c,p.markup="linkify",p.info="auto",l.push(p),u=a[e].lastIndex}if(u<o.length){const e=new t.Token("text","",0);e.content=o.slice(u),e.level=c,l.push(e)}e[n].children=r=wm(r,i,l)}}else for(i--;r[i].level!==s.level&&"link_open"!==r[i].type;)i--}}}],["replacements",function(t){let e;if(t.md.options.typographer)for(e=t.tokens.length-1;e>=0;e--)"inline"===t.tokens[e].type&&(oy.test(t.tokens[e].content)&&ly(t.tokens[e].children),ry.test(t.tokens[e].content)&&cy(t.tokens[e].children))}],["smartquotes",function(t){if(t.md.options.typographer)for(let e=t.tokens.length-1;e>=0;e--)"inline"===t.tokens[e].type&&uy.test(t.tokens[e].content)&&py(t.tokens[e].children,t)}],["text_join",function(t){let e,n;const r=t.tokens,o=r.length;for(let t=0;t<o;t++){if("inline"!==r[t].type)continue;const o=r[t].children,i=o.length;for(e=0;e<i;e++)"text_special"===o[e].type&&(o[e].type="text");for(e=n=0;e<i;e++)"text"===o[e].type&&e+1<i&&"text"===o[e+1].type?o[e+1].content=o[e].content+o[e+1].content:(e!==n&&(o[n]=o[e]),n++);e!==n&&(o.length=n)}}]];function gy(){this.ruler=new Km;for(let t=0;t<fy.length;t++)this.ruler.push(fy[t][0],fy[t][1])}gy.prototype.process=function(t){const e=this.ruler.getRules("");for(let n=0,r=e.length;n<r;n++)e[n](t)},gy.prototype.State=Qm;const my=gy;function yy(t,e,n,r){this.src=t,this.md=e,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const o=this.src;for(let t=0,e=0,n=0,r=0,i=o.length,s=!1;e<i;e++){const a=o.charCodeAt(e);if(!s){if(Rm(a)){n++,9===a?r+=4-r%4:r++;continue}s=!0}10!==a&&e!==i-1||(10!==a&&e++,this.bMarks.push(t),this.eMarks.push(e),this.tShift.push(n),this.sCount.push(r),this.bsCount.push(0),s=!1,n=0,r=0,t=e+1)}this.bMarks.push(o.length),this.eMarks.push(o.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}yy.prototype.push=function(t,e,n){const r=new Ym(t,e,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r},yy.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]},yy.prototype.skipEmptyLines=function(t){for(let e=this.lineMax;t<e&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t},yy.prototype.skipSpaces=function(t){for(let e=this.src.length;t<e&&Rm(this.src.charCodeAt(t));t++);return t},yy.prototype.skipSpacesBack=function(t,e){if(t<=e)return t;for(;t>e;)if(!Rm(this.src.charCodeAt(--t)))return t+1;return t},yy.prototype.skipChars=function(t,e){for(let n=this.src.length;t<n&&this.src.charCodeAt(t)===e;t++);return t},yy.prototype.skipCharsBack=function(t,e,n){if(t<=n)return t;for(;t>n;)if(e!==this.src.charCodeAt(--t))return t+1;return t},yy.prototype.getLines=function(t,e,n,r){if(t>=e)return"";const o=new Array(e-t);for(let i=0,s=t;s<e;s++,i++){let t=0;const a=this.bMarks[s];let l,c=a;for(l=s+1<e||r?this.eMarks[s]+1:this.eMarks[s];c<l&&t<n;){const e=this.src.charCodeAt(c);if(Rm(e))9===e?t+=4-(t+this.bsCount[s])%4:t++;else{if(!(c-a<this.tShift[s]))break;t++}c++}o[i]=t>n?new Array(t-n+1).join(" ")+this.src.slice(c,l):this.src.slice(c,l)}return o.join("")},yy.prototype.Token=Ym;const by=yy;function vy(t,e){const n=t.bMarks[e]+t.tShift[e],r=t.eMarks[e];return t.src.slice(n,r)}function wy(t){const e=[],n=t.length;let r=0,o=t.charCodeAt(r),i=!1,s=0,a="";for(;r<n;)124===o&&(i?(a+=t.substring(s,r-1),s=r):(e.push(a+t.substring(s,r)),a="",s=r+1)),i=92===o,r++,o=t.charCodeAt(r);return e.push(a+t.substring(s)),e}function Ay(t,e){const n=t.eMarks[e];let r=t.bMarks[e]+t.tShift[e];const o=t.src.charCodeAt(r++);return 42!==o&&45!==o&&43!==o||r<n&&!Rm(t.src.charCodeAt(r))?-1:r}function ky(t,e){const n=t.bMarks[e]+t.tShift[e],r=t.eMarks[e];let o=n;if(o+1>=r)return-1;let i=t.src.charCodeAt(o++);if(i<48||i>57)return-1;for(;;){if(o>=r)return-1;if(i=t.src.charCodeAt(o++),!(i>=48&&i<=57)){if(41===i||46===i)break;return-1}if(o-n>=10)return-1}return o<r&&(i=t.src.charCodeAt(o),!Rm(i))?-1:o}const xy="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\x00-\\x20]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",Cy="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",Sy=new RegExp("^(?:"+xy+"|"+Cy+"|\x3c!---?>|\x3c!--(?:[^-]|-[^-]|--[^>])*--\x3e|<[?][\\s\\S]*?[?]>|<![A-Za-z][^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)"),Ey=new RegExp("^(?:"+xy+"|"+Cy+")"),My=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"].join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(Ey.source+"\\s*$"),/^$/,!1]],_y=[["table",function(t,e,n,r){if(e+2>n)return!1;let o=e+1;if(t.sCount[o]<t.blkIndent)return!1;if(t.sCount[o]-t.blkIndent>=4)return!1;let i=t.bMarks[o]+t.tShift[o];if(i>=t.eMarks[o])return!1;const s=t.src.charCodeAt(i++);if(124!==s&&45!==s&&58!==s)return!1;if(i>=t.eMarks[o])return!1;const a=t.src.charCodeAt(i++);if(124!==a&&45!==a&&58!==a&&!Rm(a))return!1;if(45===s&&Rm(a))return!1;for(;i<t.eMarks[o];){const e=t.src.charCodeAt(i);if(124!==e&&45!==e&&58!==e&&!Rm(e))return!1;i++}let l=vy(t,e+1),c=l.split("|");const u=[];for(let t=0;t<c.length;t++){const e=c[t].trim();if(!e){if(0===t||t===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(e))return!1;58===e.charCodeAt(e.length-1)?u.push(58===e.charCodeAt(0)?"center":"right"):58===e.charCodeAt(0)?u.push("left"):u.push("")}if(l=vy(t,e).trim(),-1===l.indexOf("|"))return!1;if(t.sCount[e]-t.blkIndent>=4)return!1;c=wy(l),c.length&&""===c[0]&&c.shift(),c.length&&""===c[c.length-1]&&c.pop();const d=c.length;if(0===d||d!==u.length)return!1;if(r)return!0;const h=t.parentType;t.parentType="table";const p=t.md.block.ruler.getRules("blockquote"),f=[e,0];t.push("table_open","table",1).map=f,t.push("thead_open","thead",1).map=[e,e+1],t.push("tr_open","tr",1).map=[e,e+1];for(let e=0;e<c.length;e++){const n=t.push("th_open","th",1);u[e]&&(n.attrs=[["style","text-align:"+u[e]]]);const r=t.push("inline","",0);r.content=c[e].trim(),r.children=[],t.push("th_close","th",-1)}let g;t.push("tr_close","tr",-1),t.push("thead_close","thead",-1);let m=0;for(o=e+2;o<n&&!(t.sCount[o]<t.blkIndent);o++){let r=!1;for(let e=0,i=p.length;e<i;e++)if(p[e](t,o,n,!0)){r=!0;break}if(r)break;if(l=vy(t,o).trim(),!l)break;if(t.sCount[o]-t.blkIndent>=4)break;if(c=wy(l),c.length&&""===c[0]&&c.shift(),c.length&&""===c[c.length-1]&&c.pop(),m+=d-c.length,m>65536)break;o===e+2&&(t.push("tbody_open","tbody",1).map=g=[e+2,0]),t.push("tr_open","tr",1).map=[o,o+1];for(let e=0;e<d;e++){const n=t.push("td_open","td",1);u[e]&&(n.attrs=[["style","text-align:"+u[e]]]);const r=t.push("inline","",0);r.content=c[e]?c[e].trim():"",r.children=[],t.push("td_close","td",-1)}t.push("tr_close","tr",-1)}return g&&(t.push("tbody_close","tbody",-1),g[1]=o),t.push("table_close","table",-1),f[1]=o,t.parentType=h,t.line=o,!0},["paragraph","reference"]],["code",function(t,e,n){if(t.sCount[e]-t.blkIndent<4)return!1;let r=e+1,o=r;for(;r<n;)if(t.isEmpty(r))r++;else{if(!(t.sCount[r]-t.blkIndent>=4))break;r++,o=r}t.line=o;const i=t.push("code_block","code",0);return i.content=t.getLines(e,o,4+t.blkIndent,!1)+"\n",i.map=[e,t.line],!0}],["fence",function(t,e,n,r){let o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(o+3>i)return!1;const s=t.src.charCodeAt(o);if(126!==s&&96!==s)return!1;let a=o;o=t.skipChars(o,s);let l=o-a;if(l<3)return!1;const c=t.src.slice(a,o),u=t.src.slice(o,i);if(96===s&&u.indexOf(String.fromCharCode(s))>=0)return!1;if(r)return!0;let d=e,h=!1;for(;!(d++,d>=n||(o=a=t.bMarks[d]+t.tShift[d],i=t.eMarks[d],o<i&&t.sCount[d]<t.blkIndent));)if(t.src.charCodeAt(o)===s&&!(t.sCount[d]-t.blkIndent>=4||(o=t.skipChars(o,s),o-a<l||(o=t.skipSpaces(o),o<i)))){h=!0;break}l=t.sCount[e],t.line=d+(h?1:0);const p=t.push("fence","code",0);return p.info=u,p.content=t.getLines(e+1,d,l,!0),p.markup=c,p.map=[e,t.line],!0},["paragraph","reference","blockquote","list"]],["blockquote",function(t,e,n,r){let o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];const s=t.lineMax;if(t.sCount[e]-t.blkIndent>=4)return!1;if(62!==t.src.charCodeAt(o))return!1;if(r)return!0;const a=[],l=[],c=[],u=[],d=t.md.block.ruler.getRules("blockquote"),h=t.parentType;t.parentType="blockquote";let p,f=!1;for(p=e;p<n;p++){const e=t.sCount[p]<t.blkIndent;if(o=t.bMarks[p]+t.tShift[p],i=t.eMarks[p],o>=i)break;if(62===t.src.charCodeAt(o++)&&!e){let e,n,r=t.sCount[p]+1;32===t.src.charCodeAt(o)?(o++,r++,n=!1,e=!0):9===t.src.charCodeAt(o)?(e=!0,(t.bsCount[p]+r)%4==3?(o++,r++,n=!1):n=!0):e=!1;let s=r;for(a.push(t.bMarks[p]),t.bMarks[p]=o;o<i;){const e=t.src.charCodeAt(o);if(!Rm(e))break;9===e?s+=4-(s+t.bsCount[p]+(n?1:0))%4:s++,o++}f=o>=i,l.push(t.bsCount[p]),t.bsCount[p]=t.sCount[p]+1+(e?1:0),c.push(t.sCount[p]),t.sCount[p]=s-r,u.push(t.tShift[p]),t.tShift[p]=o-t.bMarks[p];continue}if(f)break;let r=!1;for(let e=0,o=d.length;e<o;e++)if(d[e](t,p,n,!0)){r=!0;break}if(r){t.lineMax=p,0!==t.blkIndent&&(a.push(t.bMarks[p]),l.push(t.bsCount[p]),u.push(t.tShift[p]),c.push(t.sCount[p]),t.sCount[p]-=t.blkIndent);break}a.push(t.bMarks[p]),l.push(t.bsCount[p]),u.push(t.tShift[p]),c.push(t.sCount[p]),t.sCount[p]=-1}const g=t.blkIndent;t.blkIndent=0;const m=t.push("blockquote_open","blockquote",1);m.markup=">";const y=[e,0];m.map=y,t.md.block.tokenize(t,e,p),t.push("blockquote_close","blockquote",-1).markup=">",t.lineMax=s,t.parentType=h,y[1]=t.line;for(let n=0;n<u.length;n++)t.bMarks[n+e]=a[n],t.tShift[n+e]=u[n],t.sCount[n+e]=c[n],t.bsCount[n+e]=l[n];return t.blkIndent=g,!0},["paragraph","reference","blockquote","list"]],["hr",function(t,e,n,r){const o=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let i=t.bMarks[e]+t.tShift[e];const s=t.src.charCodeAt(i++);if(42!==s&&45!==s&&95!==s)return!1;let a=1;for(;i<o;){const e=t.src.charCodeAt(i++);if(e!==s&&!Rm(e))return!1;e===s&&a++}if(a<3)return!1;if(r)return!0;t.line=e+1;const l=t.push("hr","hr",0);return l.map=[e,t.line],l.markup=Array(a+1).join(String.fromCharCode(s)),!0},["paragraph","reference","blockquote","list"]],["list",function(t,e,n,r){let o,i,s,a,l=e,c=!0;if(t.sCount[l]-t.blkIndent>=4)return!1;if(t.listIndent>=0&&t.sCount[l]-t.listIndent>=4&&t.sCount[l]<t.blkIndent)return!1;let u,d,h,p=!1;if(r&&"paragraph"===t.parentType&&t.sCount[l]>=t.blkIndent&&(p=!0),(h=ky(t,l))>=0){if(u=!0,s=t.bMarks[l]+t.tShift[l],d=Number(t.src.slice(s,h-1)),p&&1!==d)return!1}else{if(!((h=Ay(t,l))>=0))return!1;u=!1}if(p&&t.skipSpaces(h)>=t.eMarks[l])return!1;if(r)return!0;const f=t.src.charCodeAt(h-1),g=t.tokens.length;u?(a=t.push("ordered_list_open","ol",1),1!==d&&(a.attrs=[["start",d]])):a=t.push("bullet_list_open","ul",1);const m=[l,0];a.map=m,a.markup=String.fromCharCode(f);let y=!1;const b=t.md.block.ruler.getRules("list"),v=t.parentType;for(t.parentType="list";l<n;){i=h,o=t.eMarks[l];const e=t.sCount[l]+h-(t.bMarks[l]+t.tShift[l]);let r=e;for(;i<o;){const e=t.src.charCodeAt(i);if(9===e)r+=4-(r+t.bsCount[l])%4;else{if(32!==e)break;r++}i++}const d=i;let p;p=d>=o?1:r-e,p>4&&(p=1);const g=e+p;a=t.push("list_item_open","li",1),a.markup=String.fromCharCode(f);const m=[l,0];a.map=m,u&&(a.info=t.src.slice(s,h-1));const v=t.tight,w=t.tShift[l],A=t.sCount[l],k=t.listIndent;if(t.listIndent=t.blkIndent,t.blkIndent=g,t.tight=!0,t.tShift[l]=d-t.bMarks[l],t.sCount[l]=r,d>=o&&t.isEmpty(l+1)?t.line=Math.min(t.line+2,n):t.md.block.tokenize(t,l,n,!0),t.tight&&!y||(c=!1),y=t.line-l>1&&t.isEmpty(t.line-1),t.blkIndent=t.listIndent,t.listIndent=k,t.tShift[l]=w,t.sCount[l]=A,t.tight=v,a=t.push("list_item_close","li",-1),a.markup=String.fromCharCode(f),l=t.line,m[1]=l,l>=n)break;if(t.sCount[l]<t.blkIndent)break;if(t.sCount[l]-t.blkIndent>=4)break;let x=!1;for(let e=0,r=b.length;e<r;e++)if(b[e](t,l,n,!0)){x=!0;break}if(x)break;if(u){if(h=ky(t,l),h<0)break;s=t.bMarks[l]+t.tShift[l]}else if(h=Ay(t,l),h<0)break;if(f!==t.src.charCodeAt(h-1))break}return a=u?t.push("ordered_list_close","ol",-1):t.push("bullet_list_close","ul",-1),a.markup=String.fromCharCode(f),m[1]=l,t.line=l,t.parentType=v,c&&function(t,e){const n=t.level+2;for(let r=e+2,o=t.tokens.length-2;r<o;r++)t.tokens[r].level===n&&"paragraph_open"===t.tokens[r].type&&(t.tokens[r+2].hidden=!0,t.tokens[r].hidden=!0,r+=2)}(t,g),!0},["paragraph","reference","blockquote"]],["reference",function(t,e,n,r){let o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e],s=e+1;if(t.sCount[e]-t.blkIndent>=4)return!1;if(91!==t.src.charCodeAt(o))return!1;function a(e){const n=t.lineMax;if(e>=n||t.isEmpty(e))return null;let r=!1;if(t.sCount[e]-t.blkIndent>3&&(r=!0),t.sCount[e]<0&&(r=!0),!r){const r=t.md.block.ruler.getRules("reference"),o=t.parentType;t.parentType="reference";let i=!1;for(let o=0,s=r.length;o<s;o++)if(r[o](t,e,n,!0)){i=!0;break}if(t.parentType=o,i)return null}const o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];return t.src.slice(o,i+1)}let l=t.src.slice(o,i+1);i=l.length;let c=-1;for(o=1;o<i;o++){const t=l.charCodeAt(o);if(91===t)return!1;if(93===t){c=o;break}if(10===t){const t=a(s);null!==t&&(l+=t,i=l.length,s++)}else if(92===t&&(o++,o<i&&10===l.charCodeAt(o))){const t=a(s);null!==t&&(l+=t,i=l.length,s++)}}if(c<0||58!==l.charCodeAt(c+1))return!1;for(o=c+2;o<i;o++){const t=l.charCodeAt(o);if(10===t){const t=a(s);null!==t&&(l+=t,i=l.length,s++)}else if(!Rm(t))break}const u=t.md.helpers.parseLinkDestination(l,o,i);if(!u.ok)return!1;const d=t.md.normalizeLink(u.str);if(!t.md.validateLink(d))return!1;o=u.pos;const h=o,p=s,f=o;for(;o<i;o++){const t=l.charCodeAt(o);if(10===t){const t=a(s);null!==t&&(l+=t,i=l.length,s++)}else if(!Rm(t))break}let g,m=t.md.helpers.parseLinkTitle(l,o,i);for(;m.can_continue;){const e=a(s);if(null===e)break;l+=e,o=i,i=l.length,s++,m=t.md.helpers.parseLinkTitle(l,o,i,m)}for(o<i&&f!==o&&m.ok?(g=m.str,o=m.pos):(g="",o=h,s=p);o<i&&Rm(l.charCodeAt(o));)o++;if(o<i&&10!==l.charCodeAt(o)&&g)for(g="",o=h,s=p;o<i&&Rm(l.charCodeAt(o));)o++;if(o<i&&10!==l.charCodeAt(o))return!1;const y=Fm(l.slice(1,c));return!!y&&(r||(void 0===t.env.references&&(t.env.references={}),void 0===t.env.references[y]&&(t.env.references[y]={title:g,href:d}),t.line=s),!0)}],["html_block",function(t,e,n,r){let o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(!t.md.options.html)return!1;if(60!==t.src.charCodeAt(o))return!1;let s=t.src.slice(o,i),a=0;for(;a<My.length&&!My[a][0].test(s);a++);if(a===My.length)return!1;if(r)return My[a][2];let l=e+1;if(!My[a][1].test(s))for(;l<n&&!(t.sCount[l]<t.blkIndent);l++)if(o=t.bMarks[l]+t.tShift[l],i=t.eMarks[l],s=t.src.slice(o,i),My[a][1].test(s)){0!==s.length&&l++;break}t.line=l;const c=t.push("html_block","",0);return c.map=[e,l],c.content=t.getLines(e,l,t.blkIndent,!0),!0},["paragraph","reference","blockquote"]],["heading",function(t,e,n,r){let o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let s=t.src.charCodeAt(o);if(35!==s||o>=i)return!1;let a=1;for(s=t.src.charCodeAt(++o);35===s&&o<i&&a<=6;)a++,s=t.src.charCodeAt(++o);if(a>6||o<i&&!Rm(s))return!1;if(r)return!0;i=t.skipSpacesBack(i,o);const l=t.skipCharsBack(i,35,o);l>o&&Rm(t.src.charCodeAt(l-1))&&(i=l),t.line=e+1;const c=t.push("heading_open","h"+String(a),1);c.markup="########".slice(0,a),c.map=[e,t.line];const u=t.push("inline","",0);return u.content=t.src.slice(o,i).trim(),u.map=[e,t.line],u.children=[],t.push("heading_close","h"+String(a),-1).markup="########".slice(0,a),!0},["paragraph","reference","blockquote"]],["lheading",function(t,e,n){const r=t.md.block.ruler.getRules("paragraph");if(t.sCount[e]-t.blkIndent>=4)return!1;const o=t.parentType;t.parentType="paragraph";let i,s=0,a=e+1;for(;a<n&&!t.isEmpty(a);a++){if(t.sCount[a]-t.blkIndent>3)continue;if(t.sCount[a]>=t.blkIndent){let e=t.bMarks[a]+t.tShift[a];const n=t.eMarks[a];if(e<n&&(i=t.src.charCodeAt(e),(45===i||61===i)&&(e=t.skipChars(e,i),e=t.skipSpaces(e),e>=n))){s=61===i?1:2;break}}if(t.sCount[a]<0)continue;let e=!1;for(let o=0,i=r.length;o<i;o++)if(r[o](t,a,n,!0)){e=!0;break}if(e)break}if(!s)return!1;const l=t.getLines(e,a,t.blkIndent,!1).trim();t.line=a+1;const c=t.push("heading_open","h"+String(s),1);c.markup=String.fromCharCode(i),c.map=[e,t.line];const u=t.push("inline","",0);return u.content=l,u.map=[e,t.line-1],u.children=[],t.push("heading_close","h"+String(s),-1).markup=String.fromCharCode(i),t.parentType=o,!0}],["paragraph",function(t,e,n){const r=t.md.block.ruler.getRules("paragraph"),o=t.parentType;let i=e+1;for(t.parentType="paragraph";i<n&&!t.isEmpty(i);i++){if(t.sCount[i]-t.blkIndent>3)continue;if(t.sCount[i]<0)continue;let e=!1;for(let o=0,s=r.length;o<s;o++)if(r[o](t,i,n,!0)){e=!0;break}if(e)break}const s=t.getLines(e,i,t.blkIndent,!1).trim();t.line=i,t.push("paragraph_open","p",1).map=[e,t.line];const a=t.push("inline","",0);return a.content=s,a.map=[e,t.line],a.children=[],t.push("paragraph_close","p",-1),t.parentType=o,!0}]];function Ty(){this.ruler=new Km;for(let t=0;t<_y.length;t++)this.ruler.push(_y[t][0],_y[t][1],{alt:(_y[t][2]||[]).slice()})}Ty.prototype.tokenize=function(t,e,n){const r=this.ruler.getRules(""),o=r.length,i=t.md.options.maxNesting;let s=e,a=!1;for(;s<n&&(t.line=s=t.skipEmptyLines(s),!(s>=n))&&!(t.sCount[s]<t.blkIndent);){if(t.level>=i){t.line=n;break}const e=t.line;let l=!1;for(let i=0;i<o;i++)if(l=r[i](t,s,n,!1),l){if(e>=t.line)throw new Error("block rule didn't increment state.line");break}if(!l)throw new Error("none of the block rules matched");t.tight=!a,t.isEmpty(t.line-1)&&(a=!0),s=t.line,s<n&&t.isEmpty(s)&&(a=!0,s++,t.line=s)}},Ty.prototype.parse=function(t,e,n,r){if(!t)return;const o=new this.State(t,e,n,r);this.tokenize(o,o.line,o.lineMax)},Ty.prototype.State=by;const Dy=Ty;function Oy(t,e,n,r){this.src=t,this.env=n,this.md=e,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}Oy.prototype.pushPending=function(){const t=new Ym("text","",0);return t.content=this.pending,t.level=this.pendingLevel,this.tokens.push(t),this.pending="",t},Oy.prototype.push=function(t,e,n){this.pending&&this.pushPending();const r=new Ym(t,e,n);let o=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],o={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(o),r},Oy.prototype.scanDelims=function(t,e){const n=this.posMax,r=this.src.charCodeAt(t),o=t>0?this.src.charCodeAt(t-1):32;let i=t;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const s=i-t,a=i<n?this.src.charCodeAt(i):32,l=Pm(o)||$m(String.fromCharCode(o)),c=Pm(a)||$m(String.fromCharCode(a)),u=Bm(o),d=Bm(a),h=!d&&(!c||u||l),p=!u&&(!l||d||c);return{can_open:h&&(e||!p||l),can_close:p&&(e||!h||c),length:s}},Oy.prototype.Token=Ym;const Ny=Oy;function Iy(t){switch(t){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}const Ly=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i,Ry=[];for(let t=0;t<256;t++)Ry.push(0);function By(t,e){let n;const r=[],o=e.length;for(let i=0;i<o;i++){const o=e[i];if(126!==o.marker)continue;if(-1===o.end)continue;const s=e[o.end];n=t.tokens[o.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=t.tokens[s.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="","text"===t.tokens[s.token-1].type&&"~"===t.tokens[s.token-1].content&&r.push(s.token-1)}for(;r.length;){const e=r.pop();let o=e+1;for(;o<t.tokens.length&&"s_close"===t.tokens[o].type;)o++;o--,e!==o&&(n=t.tokens[o],t.tokens[o]=t.tokens[e],t.tokens[e]=n)}}"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(t){Ry[t.charCodeAt(0)]=1});const $y={tokenize:function(t,e){const n=t.pos,r=t.src.charCodeAt(n);if(e)return!1;if(126!==r)return!1;const o=t.scanDelims(t.pos,!0);let i=o.length;const s=String.fromCharCode(r);if(i<2)return!1;let a;i%2&&(a=t.push("text","",0),a.content=s,i--);for(let e=0;e<i;e+=2)a=t.push("text","",0),a.content=s+s,t.delimiters.push({marker:r,length:0,token:t.tokens.length-1,end:-1,open:o.can_open,close:o.can_close});return t.pos+=o.length,!0},postProcess:function(t){const e=t.tokens_meta,n=t.tokens_meta.length;By(t,t.delimiters);for(let r=0;r<n;r++)e[r]&&e[r].delimiters&&By(t,e[r].delimiters)}};function Py(t,e){for(let n=e.length-1;n>=0;n--){const r=e[n];if(95!==r.marker&&42!==r.marker)continue;if(-1===r.end)continue;const o=e[r.end],i=n>0&&e[n-1].end===r.end+1&&e[n-1].marker===r.marker&&e[n-1].token===r.token-1&&e[r.end+1].token===o.token+1,s=String.fromCharCode(r.marker),a=t.tokens[r.token];a.type=i?"strong_open":"em_open",a.tag=i?"strong":"em",a.nesting=1,a.markup=i?s+s:s,a.content="";const l=t.tokens[o.token];l.type=i?"strong_close":"em_close",l.tag=i?"strong":"em",l.nesting=-1,l.markup=i?s+s:s,l.content="",i&&(t.tokens[e[n-1].token].content="",t.tokens[e[r.end+1].token].content="",n--)}}const Fy={tokenize:function(t,e){const n=t.pos,r=t.src.charCodeAt(n);if(e)return!1;if(95!==r&&42!==r)return!1;const o=t.scanDelims(t.pos,42===r);for(let e=0;e<o.length;e++)t.push("text","",0).content=String.fromCharCode(r),t.delimiters.push({marker:r,length:o.length,token:t.tokens.length-1,end:-1,open:o.can_open,close:o.can_close});return t.pos+=o.length,!0},postProcess:function(t){const e=t.tokens_meta,n=t.tokens_meta.length;Py(t,t.delimiters);for(let r=0;r<n;r++)e[r]&&e[r].delimiters&&Py(t,e[r].delimiters)}},zy=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,Hy=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/,jy=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,Vy=/^&([a-z][a-z0-9]{1,31});/i;function qy(t){const e={},n=t.length;if(!n)return;let r=0,o=-2;const i=[];for(let s=0;s<n;s++){const n=t[s];if(i.push(0),t[r].marker===n.marker&&o===n.token-1||(r=s),o=n.token,n.length=n.length||0,!n.close)continue;e.hasOwnProperty(n.marker)||(e[n.marker]=[-1,-1,-1,-1,-1,-1]);const a=e[n.marker][(n.open?3:0)+n.length%3];let l=r-i[r]-1,c=l;for(;l>a;l-=i[l]+1){const e=t[l];if(e.marker===n.marker&&e.open&&e.end<0){let r=!1;if((e.close||n.open)&&(e.length+n.length)%3==0&&(e.length%3==0&&n.length%3==0||(r=!0)),!r){const r=l>0&&!t[l-1].open?i[l-1]+1:0;i[s]=s-l+r,i[l]=r,n.open=!1,e.end=s,e.close=!1,c=-1,o=-2;break}}}-1!==c&&(e[n.marker][(n.open?3:0)+(n.length||0)%3]=c)}}const Uy=[["text",function(t,e){let n=t.pos;for(;n<t.posMax&&!Iy(t.src.charCodeAt(n));)n++;return n!==t.pos&&(e||(t.pending+=t.src.slice(t.pos,n)),t.pos=n,!0)}],["linkify",function(t,e){if(!t.md.options.linkify)return!1;if(t.linkLevel>0)return!1;const n=t.pos;if(n+3>t.posMax)return!1;if(58!==t.src.charCodeAt(n))return!1;if(47!==t.src.charCodeAt(n+1))return!1;if(47!==t.src.charCodeAt(n+2))return!1;const r=t.pending.match(Ly);if(!r)return!1;const o=r[1],i=t.md.linkify.matchAtStart(t.src.slice(n-o.length));if(!i)return!1;let s=i.url;if(s.length<=o.length)return!1;s=s.replace(/\*+$/,"");const a=t.md.normalizeLink(s);if(!t.md.validateLink(a))return!1;if(!e){t.pending=t.pending.slice(0,-o.length);const e=t.push("link_open","a",1);e.attrs=[["href",a]],e.markup="linkify",e.info="auto",t.push("text","",0).content=t.md.normalizeLinkText(s);const n=t.push("link_close","a",-1);n.markup="linkify",n.info="auto"}return t.pos+=s.length-o.length,!0}],["newline",function(t,e){let n=t.pos;if(10!==t.src.charCodeAt(n))return!1;const r=t.pending.length-1,o=t.posMax;if(!e)if(r>=0&&32===t.pending.charCodeAt(r))if(r>=1&&32===t.pending.charCodeAt(r-1)){let e=r-1;for(;e>=1&&32===t.pending.charCodeAt(e-1);)e--;t.pending=t.pending.slice(0,e),t.push("hardbreak","br",0)}else t.pending=t.pending.slice(0,-1),t.push("softbreak","br",0);else t.push("softbreak","br",0);for(n++;n<o&&Rm(t.src.charCodeAt(n));)n++;return t.pos=n,!0}],["escape",function(t,e){let n=t.pos;const r=t.posMax;if(92!==t.src.charCodeAt(n))return!1;if(n++,n>=r)return!1;let o=t.src.charCodeAt(n);if(10===o){for(e||t.push("hardbreak","br",0),n++;n<r&&(o=t.src.charCodeAt(n),Rm(o));)n++;return t.pos=n,!0}let i=t.src[n];if(o>=55296&&o<=56319&&n+1<r){const e=t.src.charCodeAt(n+1);e>=56320&&e<=57343&&(i+=t.src[n+1],n++)}const s="\\"+i;if(!e){const e=t.push("text_special","",0);o<256&&0!==Ry[o]?e.content=i:e.content=s,e.markup=s,e.info="escape"}return t.pos=n+1,!0}],["backticks",function(t,e){let n=t.pos;if(96!==t.src.charCodeAt(n))return!1;const r=n;n++;const o=t.posMax;for(;n<o&&96===t.src.charCodeAt(n);)n++;const i=t.src.slice(r,n),s=i.length;if(t.backticksScanned&&(t.backticks[s]||0)<=r)return e||(t.pending+=i),t.pos+=s,!0;let a,l=n;for(;-1!==(a=t.src.indexOf("`",l));){for(l=a+1;l<o&&96===t.src.charCodeAt(l);)l++;const r=l-a;if(r===s){if(!e){const e=t.push("code_inline","code",0);e.markup=i,e.content=t.src.slice(n,a).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return t.pos=l,!0}t.backticks[r]=a}return t.backticksScanned=!0,e||(t.pending+=i),t.pos+=s,!0}],["strikethrough",$y.tokenize],["emphasis",Fy.tokenize],["link",function(t,e){let n,r,o,i,s="",a="",l=t.pos,c=!0;if(91!==t.src.charCodeAt(t.pos))return!1;const u=t.pos,d=t.posMax,h=t.pos+1,p=t.md.helpers.parseLinkLabel(t,t.pos,!0);if(p<0)return!1;let f=p+1;if(f<d&&40===t.src.charCodeAt(f)){for(c=!1,f++;f<d&&(n=t.src.charCodeAt(f),Rm(n)||10===n);f++);if(f>=d)return!1;if(l=f,o=t.md.helpers.parseLinkDestination(t.src,f,t.posMax),o.ok){for(s=t.md.normalizeLink(o.str),t.md.validateLink(s)?f=o.pos:s="",l=f;f<d&&(n=t.src.charCodeAt(f),Rm(n)||10===n);f++);if(o=t.md.helpers.parseLinkTitle(t.src,f,t.posMax),f<d&&l!==f&&o.ok)for(a=o.str,f=o.pos;f<d&&(n=t.src.charCodeAt(f),Rm(n)||10===n);f++);}(f>=d||41!==t.src.charCodeAt(f))&&(c=!0),f++}if(c){if(void 0===t.env.references)return!1;if(f<d&&91===t.src.charCodeAt(f)?(l=f+1,f=t.md.helpers.parseLinkLabel(t,f),f>=0?r=t.src.slice(l,f++):f=p+1):f=p+1,r||(r=t.src.slice(h,p)),i=t.env.references[Fm(r)],!i)return t.pos=u,!1;s=i.href,a=i.title}if(!e){t.pos=h,t.posMax=p;const e=[["href",s]];t.push("link_open","a",1).attrs=e,a&&e.push(["title",a]),t.linkLevel++,t.md.inline.tokenize(t),t.linkLevel--,t.push("link_close","a",-1)}return t.pos=f,t.posMax=d,!0}],["image",function(t,e){let n,r,o,i,s,a,l,c,u="";const d=t.pos,h=t.posMax;if(33!==t.src.charCodeAt(t.pos))return!1;if(91!==t.src.charCodeAt(t.pos+1))return!1;const p=t.pos+2,f=t.md.helpers.parseLinkLabel(t,t.pos+1,!1);if(f<0)return!1;if(i=f+1,i<h&&40===t.src.charCodeAt(i)){for(i++;i<h&&(n=t.src.charCodeAt(i),Rm(n)||10===n);i++);if(i>=h)return!1;for(c=i,a=t.md.helpers.parseLinkDestination(t.src,i,t.posMax),a.ok&&(u=t.md.normalizeLink(a.str),t.md.validateLink(u)?i=a.pos:u=""),c=i;i<h&&(n=t.src.charCodeAt(i),Rm(n)||10===n);i++);if(a=t.md.helpers.parseLinkTitle(t.src,i,t.posMax),i<h&&c!==i&&a.ok)for(l=a.str,i=a.pos;i<h&&(n=t.src.charCodeAt(i),Rm(n)||10===n);i++);else l="";if(i>=h||41!==t.src.charCodeAt(i))return t.pos=d,!1;i++}else{if(void 0===t.env.references)return!1;if(i<h&&91===t.src.charCodeAt(i)?(c=i+1,i=t.md.helpers.parseLinkLabel(t,i),i>=0?o=t.src.slice(c,i++):i=f+1):i=f+1,o||(o=t.src.slice(p,f)),s=t.env.references[Fm(o)],!s)return t.pos=d,!1;u=s.href,l=s.title}if(!e){r=t.src.slice(p,f);const e=[];t.md.inline.parse(r,t.md,t.env,e);const n=t.push("image","img",0),o=[["src",u],["alt",""]];n.attrs=o,n.children=e,n.content=r,l&&o.push(["title",l])}return t.pos=i,t.posMax=h,!0}],["autolink",function(t,e){let n=t.pos;if(60!==t.src.charCodeAt(n))return!1;const r=t.pos,o=t.posMax;for(;;){if(++n>=o)return!1;const e=t.src.charCodeAt(n);if(60===e)return!1;if(62===e)break}const i=t.src.slice(r+1,n);if(Hy.test(i)){const n=t.md.normalizeLink(i);if(!t.md.validateLink(n))return!1;if(!e){const e=t.push("link_open","a",1);e.attrs=[["href",n]],e.markup="autolink",e.info="auto",t.push("text","",0).content=t.md.normalizeLinkText(i);const r=t.push("link_close","a",-1);r.markup="autolink",r.info="auto"}return t.pos+=i.length+2,!0}if(zy.test(i)){const n=t.md.normalizeLink("mailto:"+i);if(!t.md.validateLink(n))return!1;if(!e){const e=t.push("link_open","a",1);e.attrs=[["href",n]],e.markup="autolink",e.info="auto",t.push("text","",0).content=t.md.normalizeLinkText(i);const r=t.push("link_close","a",-1);r.markup="autolink",r.info="auto"}return t.pos+=i.length+2,!0}return!1}],["html_inline",function(t,e){if(!t.md.options.html)return!1;const n=t.posMax,r=t.pos;if(60!==t.src.charCodeAt(r)||r+2>=n)return!1;const o=t.src.charCodeAt(r+1);if(33!==o&&63!==o&&47!==o&&!function(t){const e=32|t;return e>=97&&e<=122}(o))return!1;const i=t.src.slice(r).match(Sy);if(!i)return!1;if(!e){const e=t.push("html_inline","",0);e.content=i[0],s=e.content,/^<a[>\s]/i.test(s)&&t.linkLevel++,function(t){return/^<\/a\s*>/i.test(t)}(e.content)&&t.linkLevel--}var s;return t.pos+=i[0].length,!0}],["entity",function(t,e){const n=t.pos,r=t.posMax;if(38!==t.src.charCodeAt(n))return!1;if(n+1>=r)return!1;if(35===t.src.charCodeAt(n+1)){const r=t.src.slice(n).match(jy);if(r){if(!e){const e="x"===r[1][0].toLowerCase()?parseInt(r[1].slice(1),16):parseInt(r[1],10),n=t.push("text_special","",0);n.content=Am(e)?km(e):km(65533),n.markup=r[0],n.info="entity"}return t.pos+=r[0].length,!0}}else{const r=t.src.slice(n).match(Vy);if(r){const n=um(r[0]);if(n!==r[0]){if(!e){const e=t.push("text_special","",0);e.content=n,e.markup=r[0],e.info="entity"}return t.pos+=r[0].length,!0}}}return!1}]],Wy=[["balance_pairs",function(t){const e=t.tokens_meta,n=t.tokens_meta.length;qy(t.delimiters);for(let t=0;t<n;t++)e[t]&&e[t].delimiters&&qy(e[t].delimiters)}],["strikethrough",$y.postProcess],["emphasis",Fy.postProcess],["fragments_join",function(t){let e,n,r=0;const o=t.tokens,i=t.tokens.length;for(e=n=0;e<i;e++)o[e].nesting<0&&r--,o[e].level=r,o[e].nesting>0&&r++,"text"===o[e].type&&e+1<i&&"text"===o[e+1].type?o[e+1].content=o[e].content+o[e+1].content:(e!==n&&(o[n]=o[e]),n++);e!==n&&(o.length=n)}]];function Jy(){this.ruler=new Km;for(let t=0;t<Uy.length;t++)this.ruler.push(Uy[t][0],Uy[t][1]);this.ruler2=new Km;for(let t=0;t<Wy.length;t++)this.ruler2.push(Wy[t][0],Wy[t][1])}Jy.prototype.skipToken=function(t){const e=t.pos,n=this.ruler.getRules(""),r=n.length,o=t.md.options.maxNesting,i=t.cache;if(void 0!==i[e])return void(t.pos=i[e]);let s=!1;if(t.level<o){for(let o=0;o<r;o++)if(t.level++,s=n[o](t,!0),t.level--,s){if(e>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}else t.pos=t.posMax;s||t.pos++,i[e]=t.pos},Jy.prototype.tokenize=function(t){const e=this.ruler.getRules(""),n=e.length,r=t.posMax,o=t.md.options.maxNesting;for(;t.pos<r;){const i=t.pos;let s=!1;if(t.level<o)for(let r=0;r<n;r++)if(s=e[r](t,!1),s){if(i>=t.pos)throw new Error("inline rule didn't increment state.pos");break}if(s){if(t.pos>=r)break}else t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()},Jy.prototype.parse=function(t,e,n,r){const o=new this.State(t,e,n,r);this.tokenize(o);const i=this.ruler2.getRules(""),s=i.length;for(let t=0;t<s;t++)i[t](o)},Jy.prototype.State=Ny;const Ky=Jy;function Gy(t){return Array.prototype.slice.call(arguments,1).forEach(function(e){e&&Object.keys(e).forEach(function(n){t[n]=e[n]})}),t}function Yy(t){return Object.prototype.toString.call(t)}function Zy(t){return"[object Function]"===Yy(t)}function Qy(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const Xy={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1},tb={"http:":{validate:function(t,e,n){const r=t.slice(e);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,n){const r=t.slice(e);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?e>=3&&":"===t[e-3]||e>=3&&"/"===t[e-3]?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,n){const r=t.slice(e);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},eb="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function nb(t){const e=t.re=function(t){const e={};t=t||{},e.src_Any=Vg.source,e.src_Cc=qg.source,e.src_Z=Wg.source,e.src_P=Hg.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");return e.src_pseudo_letter="(?:(?![><]|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|[><]|"+e.src_ZPCc+")(?!"+(t["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|[><]|[()[\\]{}.,\"'?!\\-;]).|\\[(?:(?!"+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy='(^|[><]|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}(t.__opts__),n=t.__tlds__.slice();function r(t){return t.replace("%TLDS%",e.src_tlds)}t.onCompile(),t.__tlds_replaced__||n.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),n.push(e.src_xn),e.src_tlds=n.join("|"),e.email_fuzzy=RegExp(r(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(r(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(r(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(r(e.tpl_host_fuzzy_test),"i");const o=[];function i(t,e){throw new Error('(LinkifyIt) Invalid schema "'+t+'": '+e)}t.__compiled__={},Object.keys(t.__schemas__).forEach(function(e){const n=t.__schemas__[e];if(null===n)return;const r={validate:null,link:null};if(t.__compiled__[e]=r,"[object Object]"===Yy(n))return"[object RegExp]"!==Yy(n.validate)?Zy(n.validate)?r.validate=n.validate:i(e,n):r.validate=function(t){return function(e,n){const r=e.slice(n);return t.test(r)?r.match(t)[0].length:0}}(n.validate),void(Zy(n.normalize)?r.normalize=n.normalize:n.normalize?i(e,n):r.normalize=function(t,e){e.normalize(t)});!function(t){return"[object String]"===Yy(t)}(n)?i(e,n):o.push(e)}),o.forEach(function(e){t.__compiled__[t.__schemas__[e]]&&(t.__compiled__[e].validate=t.__compiled__[t.__schemas__[e]].validate,t.__compiled__[e].normalize=t.__compiled__[t.__schemas__[e]].normalize)}),t.__compiled__[""]={validate:null,normalize:function(t,e){e.normalize(t)}};const s=Object.keys(t.__compiled__).filter(function(e){return e.length>0&&t.__compiled__[e]}).map(Qy).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+s+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+s+")","ig"),t.re.schema_at_start=RegExp("^"+t.re.schema_search.source,"i"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),function(t){t.__index__=-1,t.__text_cache__=""}(t)}function rb(t,e){const n=t.__index__,r=t.__last_index__,o=t.__text_cache__.slice(n,r);this.schema=t.__schema__.toLowerCase(),this.index=n+e,this.lastIndex=r+e,this.raw=o,this.text=o,this.url=o}function ob(t,e){const n=new rb(t,e);return t.__compiled__[n.schema].normalize(n,t),n}function ib(t,e){if(!(this instanceof ib))return new ib(t,e);var n;e||(n=t,Object.keys(n||{}).reduce(function(t,e){return t||Xy.hasOwnProperty(e)},!1)&&(e=t,t={})),this.__opts__=Gy({},Xy,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=Gy({},tb,t),this.__compiled__={},this.__tlds__=eb,this.__tlds_replaced__=!1,this.re={},nb(this)}ib.prototype.add=function(t,e){return this.__schemas__[t]=e,nb(this),this},ib.prototype.set=function(t){return this.__opts__=Gy(this.__opts__,t),this},ib.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let e,n,r,o,i,s,a,l,c;if(this.re.schema_test.test(t))for(a=this.re.schema_search,a.lastIndex=0;null!==(e=a.exec(t));)if(o=this.testSchemaAt(t,e[2],a.lastIndex),o){this.__schema__=e[2],this.__index__=e.index+e[1].length,this.__last_index__=e.index+e[0].length+o;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=t.search(this.re.host_fuzzy_test),l>=0&&(this.__index__<0||l<this.__index__)&&null!==(n=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(i=n.index+n[1].length,(this.__index__<0||i<this.__index__)&&(this.__schema__="",this.__index__=i,this.__last_index__=n.index+n[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(c=t.indexOf("@"),c>=0&&null!==(r=t.match(this.re.email_fuzzy))&&(i=r.index+r[1].length,s=r.index+r[0].length,(this.__index__<0||i<this.__index__||i===this.__index__&&s>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=i,this.__last_index__=s))),this.__index__>=0},ib.prototype.pretest=function(t){return this.re.pretest.test(t)},ib.prototype.testSchemaAt=function(t,e,n){return this.__compiled__[e.toLowerCase()]?this.__compiled__[e.toLowerCase()].validate(t,n,this):0},ib.prototype.match=function(t){const e=[];let n=0;this.__index__>=0&&this.__text_cache__===t&&(e.push(ob(this,n)),n=this.__last_index__);let r=n?t.slice(n):t;for(;this.test(r);)e.push(ob(this,n)),r=r.slice(this.__last_index__),n+=this.__last_index__;return e.length?e:null},ib.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const e=this.re.schema_at_start.exec(t);if(!e)return null;const n=this.testSchemaAt(t,e[2],e[0].length);return n?(this.__schema__=e[2],this.__index__=e.index+e[1].length,this.__last_index__=e.index+e[0].length+n,ob(this,0)):null},ib.prototype.tlds=function(t,e){return t=Array.isArray(t)?t:[t],e?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(t,e,n){return t!==n[e-1]}).reverse(),nb(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,nb(this),this)},ib.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),"mailto:"!==t.schema||/^mailto:/i.test(t.url)||(t.url="mailto:"+t.url)},ib.prototype.onCompile=function(){};const sb=ib,ab=2147483647,lb=36,cb=/^xn--/,ub=/[^\0-\x7F]/,db=/[\x2E\u3002\uFF0E\uFF61]/g,hb={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},pb=Math.floor,fb=String.fromCharCode;function gb(t){throw new RangeError(hb[t])}function mb(t,e){const n=t.split("@");let r="";n.length>1&&(r=n[0]+"@",t=n[1]);const o=function(t,e){const n=[];let r=t.length;for(;r--;)n[r]=e(t[r]);return n}((t=t.replace(db,".")).split("."),e).join(".");return r+o}function yb(t){const e=[];let n=0;const r=t.length;for(;n<r;){const o=t.charCodeAt(n++);if(o>=55296&&o<=56319&&n<r){const r=t.charCodeAt(n++);56320==(64512&r)?e.push(((1023&o)<<10)+(1023&r)+65536):(e.push(o),n--)}else e.push(o)}return e}const bb=function(t){return t>=48&&t<58?t-48+26:t>=65&&t<91?t-65:t>=97&&t<123?t-97:lb},vb=function(t,e){return t+22+75*(t<26)-((0!=e)<<5)},wb=function(t,e,n){let r=0;for(t=n?pb(t/700):t>>1,t+=pb(t/e);t>455;r+=lb)t=pb(t/35);return pb(r+36*t/(t+38))},Ab=function(t){const e=[],n=t.length;let r=0,o=128,i=72,s=t.lastIndexOf("-");s<0&&(s=0);for(let n=0;n<s;++n)t.charCodeAt(n)>=128&&gb("not-basic"),e.push(t.charCodeAt(n));for(let a=s>0?s+1:0;a<n;){const s=r;for(let e=1,o=lb;;o+=lb){a>=n&&gb("invalid-input");const s=bb(t.charCodeAt(a++));s>=lb&&gb("invalid-input"),s>pb((ab-r)/e)&&gb("overflow"),r+=s*e;const l=o<=i?1:o>=i+26?26:o-i;if(s<l)break;const c=lb-l;e>pb(ab/c)&&gb("overflow"),e*=c}const l=e.length+1;i=wb(r-s,l,0==s),pb(r/l)>ab-o&&gb("overflow"),o+=pb(r/l),r%=l,e.splice(r++,0,o)}return String.fromCodePoint(...e)},kb=function(t){const e=[],n=(t=yb(t)).length;let r=128,o=0,i=72;for(const n of t)n<128&&e.push(fb(n));const s=e.length;let a=s;for(s&&e.push("-");a<n;){let n=ab;for(const e of t)e>=r&&e<n&&(n=e);const l=a+1;n-r>pb((ab-o)/l)&&gb("overflow"),o+=(n-r)*l,r=n;for(const n of t)if(n<r&&++o>ab&&gb("overflow"),n===r){let t=o;for(let n=lb;;n+=lb){const r=n<=i?1:n>=i+26?26:n-i;if(t<r)break;const o=t-r,s=lb-r;e.push(fb(vb(r+o%s,0))),t=pb(o/s)}e.push(fb(vb(t,0))),i=wb(o,l,a===s),o=0,++a}++o,++r}return e.join("")},xb=function(t){return mb(t,function(t){return ub.test(t)?"xn--"+kb(t):t})},Cb=function(t){return mb(t,function(t){return cb.test(t)?Ab(t.slice(4).toLowerCase()):t})},Sb={default:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},zero:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},commonmark:{options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}}},Eb=/^(vbscript|javascript|file|data):/,Mb=/^data:image\/(gif|png|jpeg|webp);/;function _b(t){const e=t.trim().toLowerCase();return!Eb.test(e)||Mb.test(e)}const Tb=["http:","https:","mailto:"];function Db(t){const e=zg(t,!0);if(e.hostname&&(!e.protocol||Tb.indexOf(e.protocol)>=0))try{e.hostname=xb(e.hostname)}catch(t){}return Eg(Mg(e))}function Ob(t){const e=zg(t,!0);if(e.hostname&&(!e.protocol||Tb.indexOf(e.protocol)>=0))try{e.hostname=Cb(e.hostname)}catch(t){}return xg(Mg(e),xg.defaultChars+"%")}function Nb(t,e){if(!(this instanceof Nb))return new Nb(t,e);e||mm(t)||(e=t||{},t="default"),this.inline=new Ky,this.block=new Dy,this.core=new my,this.renderer=new Wm,this.linkify=new sb,this.validateLink=_b,this.normalizeLink=Db,this.normalizeLinkText=Ob,this.utils=i,this.helpers=vm({},s),this.options={},this.configure(t),e&&this.set(e)}Nb.prototype.set=function(t){return vm(this.options,t),this},Nb.prototype.configure=function(t){const e=this;if(mm(t)){const e=t;if(!(t=Sb[e]))throw new Error('Wrong `markdown-it` preset "'+e+'", check name')}if(!t)throw new Error("Wrong `markdown-it` preset, can't be empty");return t.options&&e.set(t.options),t.components&&Object.keys(t.components).forEach(function(n){t.components[n].rules&&e[n].ruler.enableOnly(t.components[n].rules),t.components[n].rules2&&e[n].ruler2.enableOnly(t.components[n].rules2)}),this},Nb.prototype.enable=function(t,e){let n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(e){n=n.concat(this[e].ruler.enable(t,!0))},this),n=n.concat(this.inline.ruler2.enable(t,!0));const r=t.filter(function(t){return n.indexOf(t)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this},Nb.prototype.disable=function(t,e){let n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(e){n=n.concat(this[e].ruler.disable(t,!0))},this),n=n.concat(this.inline.ruler2.disable(t,!0));const r=t.filter(function(t){return n.indexOf(t)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this},Nb.prototype.use=function(t){const e=[this].concat(Array.prototype.slice.call(arguments,1));return t.apply(t,e),this},Nb.prototype.parse=function(t,e){if("string"!=typeof t)throw new Error("Input data should be a String");const n=new this.core.State(t,this,e);return this.core.process(n),n.tokens},Nb.prototype.render=function(t,e){return e=e||{},this.renderer.render(this.parse(t,e),this.options,e)},Nb.prototype.parseInline=function(t,e){const n=new this.core.State(t,this,e);return n.inlineMode=!0,this.core.process(n),n.tokens},Nb.prototype.renderInline=function(t,e){return e=e||{},this.renderer.render(this.parseInline(t,e),this.options,e)};const Ib=Nb;var Lb=(t,e)=>{if("slot"===t)return 0;if(t instanceof Function)return t(e);const{children:n,...r}=null!=e?e:{};if("svg"===t)throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,r,n]},Rb=/^\s*>\s$/,Bb=Cl.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML(t){let{HTMLAttributes:e}=t;return Lb("blockquote",{...Qs(this.options.HTMLAttributes,e),children:Lb("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=[];return t.content.forEach(t=>{const r=e.renderChildren(t).split("\n").map(t=>`> ${t}`).join("\n");n.push(r)}),n.flatMap(t=>[t,"> "]).slice(0,-1).join("\n")},addCommands(){return{setBlockquote:()=>t=>{let{commands:e}=t;return e.wrapIn(this.name)},toggleBlockquote:()=>t=>{let{commands:e}=t;return e.toggleWrap(this.name)},unsetBlockquote:()=>t=>{let{commands:e}=t;return e.lift(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[fl({find:Rb,type:this.type})]}}),$b=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Pb=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Fb=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,zb=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Hb=Wa.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>"normal"!==t.style.fontWeight&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML(t){let{HTMLAttributes:e}=t;return Lb("strong",{...Qs(this.options.HTMLAttributes,e),children:Lb("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>t=>{let{commands:e}=t;return e.setMark(this.name)},toggleBold:()=>t=>{let{commands:e}=t;return e.toggleMark(this.name)},unsetBold:()=>t=>{let{commands:e}=t;return e.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[ul({find:$b,type:this.type}),ul({find:Fb,type:this.type})]},addPasteRules(){return[Sl({find:Pb,type:this.type}),Sl({find:zb,type:this.type})]}}),jb=Hb,Vb=/(^|[^`])`([^`]+)`(?!`)$/,qb=/(^|[^`])`([^`]+)`(?!`)/g,Ub=Wa.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML(t){let{HTMLAttributes:e}=t;return["code",Qs(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>t=>{let{commands:e}=t;return e.setMark(this.name)},toggleCode:()=>t=>{let{commands:e}=t;return e.toggleMark(this.name)},unsetCode:()=>t=>{let{commands:e}=t;return e.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[ul({find:Vb,type:this.type})]},addPasteRules(){return[Sl({find:qb,type:this.type})]}}),Wb=/^```([a-z]+)?[\s\n]$/,Jb=/^~~~([a-z]+)?[\s\n]$/,Kb=Cl.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:4,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;return[...(null==(e=t.firstElementChild)?void 0:e.classList)||[]].filter(t=>t.startsWith(n)).map(t=>t.replace(n,""))[0]||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML(t){let{node:e,HTMLAttributes:n}=t;return["pre",Qs(this.options.HTMLAttributes,n),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return!1===(null==(n=t.raw)?void 0:n.startsWith("```"))&&"indented"!==t.codeBlockStyle?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let r="";const o=(null==(n=t.attrs)?void 0:n.language)||"";return r=t.content?[`\`\`\`${o}`,e.renderChildren(t.content),"```"].join("\n"):`\`\`\`${o}\n\n\`\`\``,r},addCommands(){return{setCodeBlock:t=>e=>{let{commands:n}=e;return n.setNode(this.name,t)},toggleCodeBlock:t=>e=>{let{commands:n}=e;return n.toggleNode(this.name,"paragraph",t)}}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=1===e.pos;return!(!t||e.parent.type.name!==this.name)&&!(!n&&e.parent.textContent.length)&&this.editor.commands.clearNodes()},Tab:t=>{let{editor:e}=t;var n;if(!this.options.enableTabIndentation)return!1;const r=null!=(n=this.options.tabSize)?n:4,{state:o}=e,{selection:i}=o,{$from:s,empty:a}=i;if(s.parent.type!==this.type)return!1;const l=" ".repeat(r);return a?e.commands.insertContent(l):e.commands.command(t=>{let{tr:e}=t;const{from:n,to:r}=i,s=o.doc.textBetween(n,r,"\n","\n").split("\n").map(t=>l+t).join("\n");return e.replaceWith(n,r,o.schema.text(s)),!0})},"Shift-Tab":t=>{let{editor:e}=t;var n;if(!this.options.enableTabIndentation)return!1;const r=null!=(n=this.options.tabSize)?n:4,{state:o}=e,{selection:i}=o,{$from:s,empty:a}=i;return s.parent.type===this.type&&(a?e.commands.command(t=>{let{tr:e}=t;var n;const{pos:i}=s,a=s.start(),l=s.end(),c=o.doc.textBetween(a,l,"\n","\n").split("\n");let u=0,d=0;const h=i-a;for(let t=0;t<c.length;t+=1){if(d+c[t].length>=h){u=t;break}d+=c[t].length+1}const p=(null==(n=c[u].match(/^ */))?void 0:n[0])||"",f=Math.min(p.length,r);if(0===f)return!0;let g=a;for(let t=0;t<u;t+=1)g+=c[t].length+1;return e.delete(g,g+f),i-g<=f&&e.setSelection(he.create(e.doc,g)),!0}):e.commands.command(t=>{let{tr:e}=t;const{from:n,to:s}=i,a=o.doc.textBetween(n,s,"\n","\n").split("\n").map(t=>{var e;const n=(null==(e=t.match(/^ */))?void 0:e[0])||"",o=Math.min(n.length,r);return t.slice(o)}).join("\n");return e.replaceWith(n,s,o.schema.text(a)),!0}))},Enter:t=>{let{editor:e}=t;if(!this.options.exitOnTripleEnter)return!1;const{state:n}=e,{selection:r}=n,{$from:o,empty:i}=r;if(!i||o.parent.type!==this.type)return!1;const s=o.parentOffset===o.parent.nodeSize-2,a=o.parent.textContent.endsWith("\n\n");return!(!s||!a)&&e.chain().command(t=>{let{tr:e}=t;return e.delete(o.pos-2,o.pos),!0}).exitCode().run()},ArrowDown:t=>{let{editor:e}=t;if(!this.options.exitOnArrowDown)return!1;const{state:n}=e,{selection:r,doc:o}=n,{$from:i,empty:s}=r;if(!s||i.parent.type!==this.type)return!1;if(i.parentOffset!==i.parent.nodeSize-2)return!1;const a=i.after();return void 0!==a&&(o.nodeAt(a)?e.commands.command(t=>{let{tr:e}=t;return e.setSelection(le.near(o.resolve(a))),!0}):e.commands.exitCode())}}},addInputRules(){return[hl({find:Wb,type:this.type,getAttributes:t=>({language:t[1]})}),hl({find:Jb,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Me({key:new De("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),o=r?JSON.parse(r):void 0,i=null==o?void 0:o.mode;if(!n||!i)return!1;const{tr:s,schema:a}=t.state,l=a.text(n.replace(/\r\n?/g,"\n"));return s.replaceSelectionWith(this.type.create({language:i},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(he.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),Gb=Kb,Yb=Cl.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML(t){let{HTMLAttributes:e}=t;return["br",Qs(this.options.HTMLAttributes,e)]},renderText:()=>"\n",renderMarkdown:(t,e)=>e.indent("\n"),addCommands(){return{setHardBreak:()=>t=>{let{commands:e,chain:n,state:r,editor:o}=t;return e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:t,storedMarks:e}=r;if(t.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:s}=o.extensionManager,a=e||t.$to.parentOffset&&t.$from.marks();return n().insertContent({type:this.name}).command(t=>{let{tr:e,dispatch:n}=t;if(n&&a&&i){const t=a.filter(t=>s.includes(t.type.name));e.ensureMarks(t)}return!0}).run()})])}}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Zb=Yb,Qb=Cl.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML(t){let{node:e,HTMLAttributes:n}=t;return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,Qs(this.options.HTMLAttributes,n),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var n;const r=(null==(n=t.attrs)?void 0:n.level)?parseInt(t.attrs.level,10):1,o="#".repeat(r);return t.content?`${o} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>e=>{let{commands:n}=e;return!!this.options.levels.includes(t.level)&&n.setNode(this.name,t)},toggleHeading:t=>e=>{let{commands:n}=e;return!!this.options.levels.includes(t.level)&&n.toggleNode(this.name,"paragraph",t)}}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>hl({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),Xb=Qb,tv=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,ev=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,nv=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,rv=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,ov=Wa.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>"normal"!==t.style.fontStyle&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML(t){let{HTMLAttributes:e}=t;return["em",Qs(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>t=>{let{commands:e}=t;return e.setMark(this.name)},toggleItalic:()=>t=>{let{commands:e}=t;return e.toggleMark(this.name)},unsetItalic:()=>t=>{let{commands:e}=t;return e.unsetMark(this.name)}}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[ul({find:tv,type:this.type}),ul({find:nv,type:this.type})]},addPasteRules(){return[Sl({find:ev,type:this.type}),Sl({find:rv,type:this.type})]}}),iv=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,sv=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,av=Wa.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>!!t.includes("line-through")&&{}}],renderHTML(t){let{HTMLAttributes:e}=t;return["s",Qs(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>t=>{let{commands:e}=t;return e.setMark(this.name)},toggleStrike:()=>t=>{let{commands:e}=t;return e.toggleMark(this.name)},unsetStrike:()=>t=>{let{commands:e}=t;return e.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[ul({find:iv,type:this.type})]},addPasteRules(){return[Sl({find:sv,type:this.type})]}}),lv=Wa.create({name:"underline",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>!!t.includes("underline")&&{}}],renderHTML(t){let{HTMLAttributes:e}=t;return["u",Qs(this.options.HTMLAttributes,e),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown:(t,e)=>`++${e.renderChildren(t)}++`,markdownTokenizer:{name:"underline",level:"inline",start:t=>t.indexOf("++"),tokenize(t,e,n){const r=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!r)return;const o=r[2].trim();return{type:"underline",raw:r[0],text:o,tokens:n.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>t=>{let{commands:e}=t;return e.setMark(this.name)},toggleUnderline:()=>t=>{let{commands:e}=t;return e.toggleMark(this.name)},unsetUnderline:()=>t=>{let{commands:e}=t;return e.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});const cv="numeric",uv="ascii",dv="alpha",hv="asciinumeric",pv="alphanumeric",fv="domain",gv="emoji",mv="scheme",yv="slashscheme",bv="whitespace";function vv(t,e){return t in e||(e[t]=[]),e[t]}function wv(t,e,n){e[cv]&&(e[hv]=!0,e[pv]=!0),e[uv]&&(e[hv]=!0,e[dv]=!0),e[hv]&&(e[pv]=!0),e[dv]&&(e[pv]=!0),e[pv]&&(e[fv]=!0),e[gv]&&(e[fv]=!0);for(const r in e){const e=vv(r,n);e.indexOf(t)<0&&e.push(t)}}function Av(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}Av.groups={},Av.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let n=0;n<e.jr.length;n++){const r=e.jr[n][0],o=e.jr[n][1];if(o&&r.test(t))return o}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let o=0;o<t.length;o++)this.tt(t[o],e,n,r)},tr(t,e,n,r){let o;return r=r||Av.groups,e&&e.j?o=e:(o=new Av(e),n&&r&&wv(e,n,r)),this.jr.push([t,o]),o},ts(t,e,n,r){let o=this;const i=t.length;if(!i)return o;for(let e=0;e<i-1;e++)o=o.tt(t[e]);return o.tt(t[i-1],e,n,r)},tt(t,e,n,r){r=r||Av.groups;const o=this;if(e&&e.j)return o.j[t]=e,e;const i=e;let s,a=o.go(t);if(a?(s=new Av,Object.assign(s.j,a.j),s.jr.push.apply(s.jr,a.jr),s.jd=a.jd,s.t=a.t):s=new Av,i){if(r)if(s.t&&"string"==typeof s.t){const t=Object.assign(function(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}(s.t,r),n);wv(i,t,r)}else n&&wv(i,n,r);s.t=i}return o.j[t]=s,s}};const kv=(t,e,n,r,o)=>t.ta(e,n,r,o),xv=(t,e,n,r,o)=>t.tr(e,n,r,o),Cv=(t,e,n,r,o)=>t.ts(e,n,r,o),Sv=(t,e,n,r,o)=>t.tt(e,n,r,o),Ev="WORD",Mv="UWORD",_v="ASCIINUMERICAL",Tv="ALPHANUMERICAL",Dv="LOCALHOST",Ov="TLD",Nv="UTLD",Iv="SCHEME",Lv="SLASH_SCHEME",Rv="NUM",Bv="WS",$v="NL",Pv="OPENBRACE",Fv="CLOSEBRACE",zv="OPENBRACKET",Hv="CLOSEBRACKET",jv="OPENPAREN",Vv="CLOSEPAREN",qv="OPENANGLEBRACKET",Uv="CLOSEANGLEBRACKET",Wv="FULLWIDTHLEFTPAREN",Jv="FULLWIDTHRIGHTPAREN",Kv="LEFTCORNERBRACKET",Gv="RIGHTCORNERBRACKET",Yv="LEFTWHITECORNERBRACKET",Zv="RIGHTWHITECORNERBRACKET",Qv="FULLWIDTHLESSTHAN",Xv="FULLWIDTHGREATERTHAN",tw="AMPERSAND",ew="APOSTROPHE",nw="ASTERISK",rw="AT",ow="BACKSLASH",iw="BACKTICK",sw="CARET",aw="COLON",lw="COMMA",cw="DOLLAR",uw="DOT",dw="EQUALS",hw="EXCLAMATION",pw="HYPHEN",fw="PERCENT",gw="PIPE",mw="PLUS",yw="POUND",bw="QUERY",vw="QUOTE",ww="FULLWIDTHMIDDLEDOT",Aw="SEMI",kw="SLASH",xw="TILDE",Cw="UNDERSCORE",Sw="EMOJI",Ew="SYM";var Mw=Object.freeze({__proto__:null,ALPHANUMERICAL:Tv,AMPERSAND:tw,APOSTROPHE:ew,ASCIINUMERICAL:_v,ASTERISK:nw,AT:rw,BACKSLASH:ow,BACKTICK:iw,CARET:sw,CLOSEANGLEBRACKET:Uv,CLOSEBRACE:Fv,CLOSEBRACKET:Hv,CLOSEPAREN:Vv,COLON:aw,COMMA:lw,DOLLAR:cw,DOT:uw,EMOJI:Sw,EQUALS:dw,EXCLAMATION:hw,FULLWIDTHGREATERTHAN:Xv,FULLWIDTHLEFTPAREN:Wv,FULLWIDTHLESSTHAN:Qv,FULLWIDTHMIDDLEDOT:ww,FULLWIDTHRIGHTPAREN:Jv,HYPHEN:pw,LEFTCORNERBRACKET:Kv,LEFTWHITECORNERBRACKET:Yv,LOCALHOST:Dv,NL:$v,NUM:Rv,OPENANGLEBRACKET:qv,OPENBRACE:Pv,OPENBRACKET:zv,OPENPAREN:jv,PERCENT:fw,PIPE:gw,PLUS:mw,POUND:yw,QUERY:bw,QUOTE:vw,RIGHTCORNERBRACKET:Gv,RIGHTWHITECORNERBRACKET:Zv,SCHEME:Iv,SEMI:Aw,SLASH:kw,SLASH_SCHEME:Lv,SYM:Ew,TILDE:xw,TLD:Ov,UNDERSCORE:Cw,UTLD:Nv,UWORD:Mv,WORD:Ev,WS:Bv});const _w=/[a-z]/,Tw=/\p{L}/u,Dw=/\p{Emoji}/u,Ow=/\d/,Nw=/\s/;let Iw=null,Lw=null;function Rw(t,e){const n=function(t){const e=[],n=t.length;let r=0;for(;r<n;){let o,i=t.charCodeAt(r),s=i<55296||i>56319||r+1===n||(o=t.charCodeAt(r+1))<56320||o>57343?t[r]:t.slice(r,r+2);e.push(s),r+=s.length}return e}(e.replace(/[A-Z]/g,t=>t.toLowerCase())),r=n.length,o=[];let i=0,s=0;for(;s<r;){let a=t,l=null,c=0,u=null,d=-1,h=-1;for(;s<r&&(l=a.go(n[s]));)a=l,a.accepts()?(d=0,h=0,u=a):d>=0&&(d+=n[s].length,h++),c+=n[s].length,i+=n[s].length,s++;i-=d,s-=h,c-=d,o.push({t:u.t,v:e.slice(i-c,i),s:i-c,e:i})}return o}function Bw(t,e,n,r,o){let i;const s=e.length;for(let n=0;n<s-1;n++){const s=e[n];t.j[s]?i=t.j[s]:(i=new Av(r),i.jr=o.slice(),t.j[s]=i),t=i}return i=new Av(n),i.jr=o.slice(),t.j[e[s-1]]=i,i}function $w(t){const e=[],n=[];let r=0;for(;r<t.length;){let o=0;for(;"0123456789".indexOf(t[r+o])>=0;)o++;if(o>0){e.push(n.join(""));for(let e=parseInt(t.substring(r,r+o),10);e>0;e--)n.pop();r+=o}else n.push(t[r]),r++}return e}const Pw={defaultProtocol:"http",events:null,format:zw,formatHref:zw,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Fw(t,e=null){let n=Object.assign({},Pw);t&&(n=Object.assign(n,t instanceof Fw?t.o:t));const r=n.ignoreTags,o=[];for(let t=0;t<r.length;t++)o.push(r[t].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=o}function zw(t){return t}function Hw(t,e){this.t="token",this.v=t,this.tk=e}function jw(t,e){class n extends Hw{constructor(e,n){super(e,n),this.t=t}}for(const t in e)n.prototype[t]=e[t];return n.t=t,n}Fw.prototype={o:Pw,ignoreTags:[],defaultRender:t=>t,check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=null!=e;let o=this.o[t];return o?("object"==typeof o?(o=n.t in o?o[n.t]:Pw[t],"function"==typeof o&&r&&(o=o(e,n))):"function"==typeof o&&r&&(o=o(e,n.t,n)),o):o},getObj(t,e,n){let r=this.o[t];return"function"==typeof r&&null!=e&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}},Hw.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=Pw.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),o=t.get("tagName",n,e),i=this.toFormattedString(t),s={},a=t.get("className",n,e),l=t.get("target",n,e),c=t.get("rel",n,e),u=t.getObj("attributes",n,e),d=t.getObj("events",n,e);return s.href=r,a&&(s.class=a),l&&(s.target=l),c&&(s.rel=c),u&&Object.assign(s,u),{tagName:o,attributes:s,content:i,eventListeners:d}}};const Vw=jw("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),qw=jw("text"),Uw=jw("nl"),Ww=jw("url",{isLink:!0,toHref(t=Pw.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Dv&&t[1].t===aw}}),Jw=t=>new Av(t);function Kw(t,e,n){const r=n[0].s,o=n[n.length-1].e;return new t(e.slice(r,o),n)}const Gw="undefined"!=typeof console&&console&&console.warn||(()=>{}),Yw={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Zw(t,e=!1){if(Yw.initialized&&Gw(`linkifyjs: already initialized - will not register custom scheme "${t}" until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error('linkifyjs: incorrect scheme format.\n1. Must only contain digits, lowercase ASCII letters or "-"\n2. Cannot start or end with "-"\n3. "-" cannot repeat');Yw.customSchemes.push([t,e])}function Qw(t){return Yw.initialized||function(){Yw.scanner=function(t=[]){const e={};Av.groups=e;const n=new Av;null==Iw&&(Iw=$w("aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2")),null==Lw&&(Lw=$w("121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222")),Sv(n,"'",ew),Sv(n,"{",Pv),Sv(n,"}",Fv),Sv(n,"[",zv),Sv(n,"]",Hv),Sv(n,"(",jv),Sv(n,")",Vv),Sv(n,"<",qv),Sv(n,">",Uv),Sv(n,"",Wv),Sv(n,"",Jv),Sv(n,"",Kv),Sv(n,"",Gv),Sv(n,"",Yv),Sv(n,"",Zv),Sv(n,"",Qv),Sv(n,"",Xv),Sv(n,"&",tw),Sv(n,"*",nw),Sv(n,"@",rw),Sv(n,"`",iw),Sv(n,"^",sw),Sv(n,":",aw),Sv(n,",",lw),Sv(n,"$",cw),Sv(n,".",uw),Sv(n,"=",dw),Sv(n,"!",hw),Sv(n,"-",pw),Sv(n,"%",fw),Sv(n,"|",gw),Sv(n,"+",mw),Sv(n,"#",yw),Sv(n,"?",bw),Sv(n,'"',vw),Sv(n,"/",kw),Sv(n,";",Aw),Sv(n,"~",xw),Sv(n,"_",Cw),Sv(n,"\\",ow),Sv(n,"",ww);const r=xv(n,Ow,Rv,{[cv]:!0});xv(r,Ow,r);const o=xv(r,_w,_v,{[hv]:!0}),i=xv(r,Tw,Tv,{[pv]:!0}),s=xv(n,_w,Ev,{[uv]:!0});xv(s,Ow,o),xv(s,_w,s),xv(o,Ow,o),xv(o,_w,o);const a=xv(n,Tw,Mv,{[dv]:!0});xv(a,_w),xv(a,Ow,i),xv(a,Tw,a),xv(i,Ow,i),xv(i,_w),xv(i,Tw,i);const l=Sv(n,"\n",$v,{[bv]:!0}),c=Sv(n,"\r",Bv,{[bv]:!0}),u=xv(n,Nw,Bv,{[bv]:!0});Sv(n,"",u),Sv(c,"\n",l),Sv(c,"",u),xv(c,Nw,u),Sv(u,"\r"),Sv(u,"\n"),xv(u,Nw,u),Sv(u,"",u);const d=xv(n,Dw,Sw,{[gv]:!0});Sv(d,"#"),xv(d,Dw,d),Sv(d,"",d);const h=Sv(d,"");Sv(h,"#"),xv(h,Dw,d);const p=[[_w,s],[Ow,o]],f=[[_w,null],[Tw,a],[Ow,i]];for(let t=0;t<Iw.length;t++)Bw(n,Iw[t],Ov,Ev,p);for(let t=0;t<Lw.length;t++)Bw(n,Lw[t],Nv,Mv,f);wv(Ov,{tld:!0,ascii:!0},e),wv(Nv,{utld:!0,alpha:!0},e),Bw(n,"file",Iv,Ev,p),Bw(n,"mailto",Iv,Ev,p),Bw(n,"http",Lv,Ev,p),Bw(n,"https",Lv,Ev,p),Bw(n,"ftp",Lv,Ev,p),Bw(n,"ftps",Lv,Ev,p),wv(Iv,{scheme:!0,ascii:!0},e),wv(Lv,{slashscheme:!0,ascii:!0},e),t=t.sort((t,e)=>t[0]>e[0]?1:-1);for(let e=0;e<t.length;e++){const r=t[e][0],o=t[e][1]?{[mv]:!0}:{[yv]:!0};r.indexOf("-")>=0?o[fv]=!0:_w.test(r)?Ow.test(r)?o[hv]=!0:o[uv]=!0:o[cv]=!0,Cv(n,r,r,o)}return Cv(n,"localhost",Dv,{ascii:!0}),n.jd=new Av(Ew),{start:n,tokens:Object.assign({groups:e},Mw)}}(Yw.customSchemes);for(let t=0;t<Yw.tokenQueue.length;t++)Yw.tokenQueue[t][1]({scanner:Yw.scanner});Yw.parser=function({groups:t}){const e=t.domain.concat([tw,nw,rw,ow,iw,sw,cw,dw,pw,Rv,fw,gw,mw,yw,kw,Ew,xw,Cw]),n=[ew,aw,lw,uw,hw,fw,bw,vw,Aw,qv,Uv,Pv,Fv,Hv,zv,jv,Vv,Wv,Jv,Kv,Gv,Yv,Zv,Qv,Xv],r=[tw,ew,nw,ow,iw,sw,cw,dw,pw,Pv,Fv,fw,gw,mw,yw,bw,kw,Ew,xw,Cw],o=Jw(),i=Sv(o,xw);kv(i,r,i),kv(i,t.domain,i);const s=Jw(),a=Jw(),l=Jw();kv(o,t.domain,s),kv(o,t.scheme,a),kv(o,t.slashscheme,l),kv(s,r,i),kv(s,t.domain,s);const c=Sv(s,rw);Sv(i,rw,c),Sv(a,rw,c),Sv(l,rw,c);const u=Sv(i,uw);kv(u,r,i),kv(u,t.domain,i);const d=Jw();kv(c,t.domain,d),kv(d,t.domain,d);const h=Sv(d,uw);kv(h,t.domain,d);const p=Jw(Vw);kv(h,t.tld,p),kv(h,t.utld,p),Sv(c,Dv,p);const f=Sv(d,pw);Sv(f,pw,f),kv(f,t.domain,d),kv(p,t.domain,d),Sv(p,uw,h),Sv(p,pw,f);const g=Sv(p,aw);kv(g,t.numeric,Vw);const m=Sv(s,pw),y=Sv(s,uw);Sv(m,pw,m),kv(m,t.domain,s),kv(y,r,i),kv(y,t.domain,s);const b=Jw(Ww);kv(y,t.tld,b),kv(y,t.utld,b),kv(b,t.domain,s),kv(b,r,i),Sv(b,uw,y),Sv(b,pw,m),Sv(b,rw,c);const v=Sv(b,aw),w=Jw(Ww);kv(v,t.numeric,w);const A=Jw(Ww),k=Jw();kv(A,e,A),kv(A,n,k),kv(k,e,A),kv(k,n,k),Sv(b,kw,A),Sv(w,kw,A);const x=Sv(a,aw),C=Sv(l,aw),S=Sv(C,kw),E=Sv(S,kw);kv(a,t.domain,s),Sv(a,uw,y),Sv(a,pw,m),kv(l,t.domain,s),Sv(l,uw,y),Sv(l,pw,m),kv(x,t.domain,A),Sv(x,kw,A),Sv(x,bw,A),kv(E,t.domain,A),kv(E,e,A),Sv(E,kw,A);const M=[[Pv,Fv],[zv,Hv],[jv,Vv],[qv,Uv],[Wv,Jv],[Kv,Gv],[Yv,Zv],[Qv,Xv]];for(let t=0;t<M.length;t++){const[r,o]=M[t],i=Sv(A,r);Sv(k,r,i),Sv(i,o,A);const s=Jw(Ww);kv(i,e,s);const a=Jw();kv(i,n),kv(s,e,s),kv(s,n,a),kv(a,e,s),kv(a,n,a),Sv(s,o,A),Sv(a,o,A)}return Sv(o,Dv,b),Sv(o,$v,Uw),{start:o,tokens:Mw}}(Yw.scanner.tokens);for(let t=0;t<Yw.pluginQueue.length;t++)Yw.pluginQueue[t][1]({scanner:Yw.scanner,parser:Yw.parser});Yw.initialized=!0}(),function(t,e,n){let r=n.length,o=0,i=[],s=[];for(;o<r;){let a=t,l=null,c=null,u=0,d=null,h=-1;for(;o<r&&!(l=a.go(n[o].t));)s.push(n[o++]);for(;o<r&&(c=l||a.go(n[o].t));)l=null,a=c,a.accepts()?(h=0,d=a):h>=0&&h++,o++,u++;if(h<0)o-=u,o<r&&(s.push(n[o]),o++);else{s.length>0&&(i.push(Kw(qw,e,s)),s=[]),o-=h,u-=h;const t=d.t,r=n.slice(o-u,o);i.push(Kw(t,e,r))}}return s.length>0&&i.push(Kw(qw,e,s)),i}(Yw.parser.start,t,Rw(Yw.scanner.start,t))}function Xw(t,e=null,n=null){if(e&&"object"==typeof e){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new Fw(n),o=Qw(t),i=[];for(let t=0;t<o.length;t++){const n=o[t];!n.isLink||e&&n.t!==e||!r.check(n)||i.push(n.toFormattedObject(r))}return i}Qw.scan=Rw;var tA="[\0- -\u2029]",eA=new RegExp(tA),nA=new RegExp(`${tA}$`),rA=new RegExp(tA,"g");function oA(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(t=>{const e="string"==typeof t?t:t.scheme;e&&n.push(e)}),!t||t.replace(rA,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var iA=Wa.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{"string"!=typeof t?Zw(t.scheme,t.optionalSlashes):Zw(t)})},onDestroy(){Av.groups={},Yw.scanner=null,Yw.parser=null,Yw.tokenQueue=[],Yw.pluginQueue=[],Yw.customSchemes=[],Yw.initialized=!1},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!oA(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}),addAttributes(){return{href:{default:null,parseHTML:t=>t.getAttribute("href")},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!(!e||!this.options.isAllowedUri(e,{defaultValidate:t=>!!oA(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&null}}]},renderHTML(t){let{HTMLAttributes:e}=t;return this.options.isAllowedUri(e.href,{defaultValidate:t=>!!oA(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Qs(this.options.HTMLAttributes,e),0]:["a",Qs(this.options.HTMLAttributes,{...e,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var n;const r=(null==(n=t.attrs)?void 0:n.href)||"";return`[${e.renderChildren(t)}](${r})`},addCommands(){return{setLink:t=>e=>{let{chain:n}=e;const{href:r}=t;return!!this.options.isAllowedUri(r,{defaultValidate:t=>!!oA(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})&&n().setMark(this.name,t).setMeta("preventAutolink",!0).run()},toggleLink:t=>e=>{let{chain:n}=e;const{href:r}=t||{};return!(r&&!this.options.isAllowedUri(r,{defaultValidate:t=>!!oA(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&n().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>t=>{let{chain:e}=t;return e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}}},addPasteRules(){return[Sl({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,o=Xw(t).filter(t=>t.isLink&&this.options.isAllowedUri(t.value,{defaultValidate:t=>!!oA(t,n),protocols:n,defaultProtocol:r}));o.length&&o.forEach(t=>{this.options.shouldAutoLink(t.value)&&e.push({text:t.value,data:{href:t.href},index:t.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:null==(e=t.data)?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push((r={type:this.type,defaultProtocol:this.options.defaultProtocol,validate:t=>this.options.isAllowedUri(t,{defaultValidate:t=>!!oA(t,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink},new Me({key:new De("autolink"),appendTransaction:(t,e,n)=>{const o=t.some(t=>t.docChanged)&&!e.doc.eq(n.doc),i=t.some(t=>t.getMeta("preventAutolink"));if(!o||i)return;const{tr:s}=n;return ca(zs(e.doc,[...t])).forEach(t=>{let{newRange:e}=t;const o=js(n.doc,e,t=>t.isTextblock);let i,a;if(o.length>1)i=o[0],a=n.doc.textBetween(i.pos,i.pos+i.node.nodeSize,void 0," ");else if(o.length){const t=n.doc.textBetween(e.from,e.to," "," ");if(!nA.test(t))return;i=o[0],a=n.doc.textBetween(i.pos,e.to,void 0," ")}if(i&&a){const t=a.split(eA).filter(Boolean);if(t.length<=0)return!1;const e=t[t.length-1],o=i.pos+a.lastIndexOf(e);if(!e)return!1;const c=Qw(e).map(t=>t.toObject(r.defaultProtocol));if(!(1===(l=c).length?l[0].isLink:3===l.length&&l[1].isLink&&["()","[]"].includes(l[0].value+l[2].value)))return!1;c.filter(t=>t.isLink).map(t=>({...t,from:o+t.start+1,to:o+t.end+1})).filter(t=>!n.schema.marks.code||!n.doc.rangeHasMark(t.from,t.to,n.schema.marks.code)).filter(t=>r.validate(t.value)).filter(t=>r.shouldAutoLink(t.value)).forEach(t=>{ua(t.from,t.to,n.doc).some(t=>t.mark.type===r.type)||s.addMark(t.from,t.to,r.type.create({href:t.href}))})}var l}),s.steps.length?s:void 0}}))),!0===this.options.openOnClick&&t.push(function(t){return new Me({key:new De("handleClickLink"),props:{handleClick:(e,n,r)=>{var o,i;if(0!==r.button)return!1;if(!e.editable)return!1;let s=null;if(r.target instanceof HTMLAnchorElement)s=r.target;else{let t=r.target;const e=[];for(;"DIV"!==t.nodeName;)e.push(t),t=t.parentNode;s=e.find(t=>"A"===t.nodeName)}if(!s)return!1;const a=la(e.state,t.type.name),l=null!=(o=null==s?void 0:s.href)?o:a.href,c=null!=(i=null==s?void 0:s.target)?i:a.target;return t.enableClickSelection&&t.editor.commands.extendMarkRange(t.type.name),!(!s||!l||(window.open(l,c),0))}}})}({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(function(t){return new Me({key:new De("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{shouldAutoLink:o}=t,{state:i}=e,{selection:s}=i,{empty:a}=s;if(a)return!1;let l="";r.content.forEach(t=>{l+=t.textContent});const c=Xw(l,{defaultProtocol:t.defaultProtocol}).find(t=>t.isLink&&t.value===l);return!(!l||!c||void 0!==o&&!o(c.href))&&t.editor.commands.setMark(t.type,{href:c.href})}}})}({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t;var r}}),sA=iA,aA=Object.defineProperty,lA="textStyle",cA=/^\s*([-+*])\s$/,uA=Cl.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML(t){let{HTMLAttributes:e}=t;return["ul",Qs(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>"list"!==t.type||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,"\n"):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>t=>{let{commands:e,chain:n}=t;return this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(lA)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=fl({find:cA,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=fl({find:cA,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(lA),editor:this.editor})),[t]}}),dA=Cl.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML(t){let{HTMLAttributes:e}=t;return["li",Qs(this.options.HTMLAttributes,e),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if("list_item"!==t.type)return[];let n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(t=>"paragraph"===t.type))n=e.parseChildren(t.tokens);else{const r=t.tokens[0];if(r&&"text"===r.type&&r.tokens&&r.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(r.tokens)}],t.tokens.length>1){const r=t.tokens.slice(1),o=e.parseChildren(r);n.push(...o)}}else n=e.parseChildren(t.tokens)}return 0===n.length&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>xl(t,e,t=>"bulletList"===t.parentType?"- ":"orderedList"===t.parentType?`${t.index+1}. `:"- ",n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}});((t,e)=>{for(var n in e)aA(t,n,{get:e[n],enumerable:!0})})({},{findListItemPos:()=>hA,getNextListDepth:()=>pA,handleBackspace:()=>yA,handleDelete:()=>wA,hasListBefore:()=>fA,hasListItemAfter:()=>AA,hasListItemBefore:()=>gA,listItemHasSubList:()=>mA,nextListIsDeeper:()=>bA,nextListIsHigher:()=>vA});var hA=(t,e)=>{const{$from:n}=e.selection,r=zi(t,e.schema);let o=null,i=n.depth,s=n.pos,a=null;for(;i>0&&null===a;)o=n.node(i),o.type===r?a=i:(i-=1,s-=1);return null===a?null:{$pos:e.doc.resolve(s),depth:a}},pA=(t,e)=>{const n=hA(t,e);if(!n)return!1;const[,r]=function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20;const o=t.doc.resolve(n);let i=r,s=null;for(;i>0&&null===s;){const t=o.node(i);(null==t?void 0:t.type.name)===e?s=t:i-=1}return[s,i]}(e,t,n.$pos.pos+4);return r},fA=(t,e,n)=>{const{$anchor:r}=t.selection,o=Math.max(0,r.pos-2),i=t.doc.resolve(o).node();return!(!i||!n.includes(i.type.name))},gA=(t,e)=>{var n;const{$anchor:r}=e.selection,o=e.doc.resolve(r.pos-2);return 0!==o.index()&&(null==(n=o.nodeBefore)?void 0:n.type.name)===t},mA=(t,e,n)=>{if(!n)return!1;const r=zi(t,e.schema);let o=!1;return n.descendants(t=>{t.type===r&&(o=!0)}),o},yA=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!ks(t.state,e)&&fA(t.state,e,n)){const{$anchor:n}=t.state.selection,r=t.state.doc.resolve(n.before()-1),o=[];r.node().descendants((t,n)=>{t.type.name===e&&o.push({node:t,pos:n})});const i=o.at(-1);if(!i)return!1;const s=t.state.doc.resolve(r.start()+i.pos+1);return t.chain().cut({from:n.start()-1,to:n.end()+1},s.end()).joinForward().run()}if(!ks(t.state,e))return!1;if(!(t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)})(t.state))return!1;const r=hA(e,t.state);if(!r)return!1;const o=t.state.doc.resolve(r.$pos.pos-2).node(r.depth),i=mA(e,t.state,o);return gA(e,t.state)&&!i?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},bA=(t,e)=>{const n=pA(t,e),r=hA(t,e);return!(!r||!n)&&n>r.depth},vA=(t,e)=>{const n=pA(t,e),r=hA(t,e);return!(!r||!n)&&n<r.depth},wA=(t,e)=>{if(!ks(t.state,e))return!1;if(!((t,e)=>{const{$from:n,$to:r,$anchor:o}=t.selection;if(e){const n=qs(t=>t.type.name===e)(t.selection);if(!n)return!1;const r=t.doc.resolve(n.pos+1);return o.pos+1===r.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)})(t.state,e))return!1;const{selection:n}=t.state,{$from:r,$to:o}=n;return!(!n.empty&&r.sameParent(o))&&(bA(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():vA(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward())},AA=(t,e)=>{var n;const{$anchor:r}=e.selection,o=e.doc.resolve(r.pos-r.parentOffset-2);return o.index()!==o.parent.childCount-1&&(null==(n=o.nodeAfter)?void 0:n.type.name)===t},kA=Za.create({name:"listKeymap",addOptions:()=>({listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}),addKeyboardShortcuts(){return{Delete:t=>{let{editor:e}=t,n=!1;return this.options.listTypes.forEach(t=>{let{itemName:r}=t;void 0!==e.state.schema.nodes[r]&&wA(e,r)&&(n=!0)}),n},"Mod-Delete":t=>{let{editor:e}=t,n=!1;return this.options.listTypes.forEach(t=>{let{itemName:r}=t;void 0!==e.state.schema.nodes[r]&&wA(e,r)&&(n=!0)}),n},Backspace:t=>{let{editor:e}=t,n=!1;return this.options.listTypes.forEach(t=>{let{itemName:r,wrapperNames:o}=t;void 0!==e.state.schema.nodes[r]&&yA(e,r,o)&&(n=!0)}),n},"Mod-Backspace":t=>{let{editor:e}=t,n=!1;return this.options.listTypes.forEach(t=>{let{itemName:r,wrapperNames:o}=t;void 0!==e.state.schema.nodes[r]&&yA(e,r,o)&&(n=!0)}),n}}}}),xA=/^(\s*)(\d+)\.\s+(.*)$/,CA=/^\s/;function SA(t,e,n){var r;const o=[];let i=0;for(;i<t.length;){const s=t[i];if(s.indent===e){const a=s.content.split("\n"),l=(null==(r=a[0])?void 0:r.trim())||"",c=[];l&&c.push({type:"paragraph",raw:l,tokens:n.inlineTokens(l)});const u=a.slice(1).join("\n").trim();if(u){const t=n.blockTokens(u);c.push(...t)}let d=i+1;const h=[];for(;d<t.length&&t[d].indent>e;)h.push(t[d]),d+=1;if(h.length>0){const t=Math.min(...h.map(t=>t.indent)),e=SA(h,t,n);c.push({type:"list",ordered:!0,start:h[0].number,items:e,raw:h.map(t=>t.raw).join("\n")})}o.push({type:"list_item",raw:s.raw,tokens:c}),i=d}else i+=1}return o}var EA,MA="textStyle",_A=/^(\d+)\.\s$/,TA=Cl.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}),parseHTML:()=>[{tag:"ol"}],renderHTML(t){let{HTMLAttributes:e}=t;const{start:n,...r}=e;return 1===n?["ol",Qs(this.options.HTMLAttributes,r),0]:["ol",Qs(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if("list"!==t.type||!t.ordered)return[];const n=t.start||1,r=t.items?function(t,e){return t.map(t=>{if("list_item"!==t.type)return e.parseChildren([t])[0];const n=[];return t.tokens&&t.tokens.length>0&&t.tokens.forEach(t=>{if("paragraph"===t.type||"list"===t.type||"blockquote"===t.type||"code"===t.type)n.push(...e.parseChildren([t]));else if("text"===t.type&&t.tokens){const r=e.parseChildren([t]);n.push({type:"paragraph",content:r})}else{const r=e.parseChildren([t]);r.length>0&&n.push(...r)}}),{type:"listItem",content:n}})}(t.items,e):[];return 1!==n?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,"\n"):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=null==e?void 0:e.index;return void 0!==n?n:-1},tokenize:(t,e,n)=>{var r;const o=t.split("\n"),[i,s]=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const o=t[n],i=o.match(xA);if(!i)break;const[,s,a,l]=i,c=s.length;let u=l,d=n+1;const h=[o];for(;d<t.length;){const e=t[d];if(e.match(xA))break;if(""===e.trim())h.push(e),u+="\n",d+=1;else{if(!e.match(CA))break;h.push(e),u+=`\n${e.slice(c+2)}`,d+=1}}e.push({indent:c,number:parseInt(a,10),content:u.trim(),raw:h.join("\n")}),r=d,n=d}return[e,r]}(o);if(0===i.length)return;const a=SA(i,0,n);return 0!==a.length?{type:"list",ordered:!0,start:(null==(r=i[0])?void 0:r.number)||1,items:a,raw:o.slice(0,s).join("\n")}:void 0}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>t=>{let{commands:e,chain:n}=t;return this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(MA)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=fl({find:_A,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=fl({find:_A,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(MA)}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1],editor:this.editor})),[t]}}),DA=/^\s*(\[([( |x])?\])\s$/,OA=Cl.create({name:"taskItem",addOptions:()=>({nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}),content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes:()=>({checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return""===e||"true"===e},renderHTML:t=>({"data-checked":t.checked})}}),parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML(t){let{node:e,HTMLAttributes:n}=t;return["li",Qs(this.options.HTMLAttributes,n,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const r=e.parseChildren(t.nestedTokens);n.push(...r)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;return xl(t,e,`- [${(null==(n=t.attrs)?void 0:n.checked)?"x":" "}] `)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return t=>{let{node:e,HTMLAttributes:n,getPos:r,editor:o}=t;const i=document.createElement("li"),s=document.createElement("label"),a=document.createElement("span"),l=document.createElement("input"),c=document.createElement("div"),u=t=>{var e,n;l.ariaLabel=(null==(n=null==(e=this.options.a11y)?void 0:e.checkboxLabel)?void 0:n.call(e,t,l.checked))||`Task item checkbox for ${t.textContent||"empty task item"}`};return u(e),s.contentEditable="false",l.type="checkbox",l.addEventListener("mousedown",t=>t.preventDefault()),l.addEventListener("change",t=>{if(!o.isEditable&&!this.options.onReadOnlyChecked)return void(l.checked=!l.checked);const{checked:n}=t.target;o.isEditable&&"function"==typeof r&&o.chain().focus(void 0,{scrollIntoView:!1}).command(t=>{let{tr:e}=t;const o=r();if("number"!=typeof o)return!1;const i=e.doc.nodeAt(o);return e.setNodeMarkup(o,void 0,{...null==i?void 0:i.attrs,checked:n}),!0}).run(),!o.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,n)||(l.checked=!l.checked))}),Object.entries(this.options.HTMLAttributes).forEach(t=>{let[e,n]=t;i.setAttribute(e,n)}),i.dataset.checked=e.attrs.checked,l.checked=e.attrs.checked,s.append(l,a),i.append(s,c),Object.entries(n).forEach(t=>{let[e,n]=t;i.setAttribute(e,n)}),{dom:i,contentDOM:c,update:t=>t.type===this.type&&(i.dataset.checked=t.attrs.checked,l.checked=t.attrs.checked,u(t),!0)}}},addInputRules(){return[fl({find:DA,type:this.type,getAttributes:t=>({checked:"x"===t[t.length-1]})})]}}),NA=Cl.create({name:"taskList",addOptions:()=>({itemTypeName:"taskItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML(t){let{HTMLAttributes:e}=t;return["ul",Qs(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,"\n"):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=null==(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))?void 0:e.index;return void 0!==n?n:-1},tokenize(t,e,n){const r=t=>{const e=kl(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:t=>({indentLevel:t[1].length,mainContent:t[4],checked:"x"===t[3].toLowerCase()}),createToken:(t,e)=>({type:"taskItem",raw:"",mainContent:t.mainContent,indentLevel:t.indentLevel,checked:t.checked,text:t.mainContent,tokens:n.inlineTokens(t.mainContent),nestedTokens:e}),customNestedParser:r},n);return e?[{type:"taskList",raw:e.raw,items:e.items}]:n.blockTokens(t)},o=kl(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:t=>({indentLevel:t[1].length,mainContent:t[4],checked:"x"===t[3].toLowerCase()}),createToken:(t,e)=>({type:"taskItem",raw:"",mainContent:t.mainContent,indentLevel:t.indentLevel,checked:t.checked,text:t.mainContent,tokens:n.inlineTokens(t.mainContent),nestedTokens:e}),customNestedParser:r},n);if(o)return{type:"taskList",raw:o.raw,items:o.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>t=>{let{commands:e}=t;return e.toggleList(this.name,this.options.itemTypeName)}}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),IA=(Za.create({name:"listKit",addExtensions(){const t=[];return!1!==this.options.bulletList&&t.push(uA.configure(this.options.bulletList)),!1!==this.options.listItem&&t.push(dA.configure(this.options.listItem)),!1!==this.options.listKeymap&&t.push(kA.configure(this.options.listKeymap)),!1!==this.options.orderedList&&t.push(TA.configure(this.options.orderedList)),!1!==this.options.taskItem&&t.push(OA.configure(this.options.taskItem)),!1!==this.options.taskList&&t.push(NA.configure(this.options.taskList)),t}}),"---"),LA="A-Za-z--------",RA=new RegExp("^[^"+LA+"]*["+IA+"]"),BA=new RegExp("^[^"+IA+"]*["+LA+"]"),$A=["ltr","rtl","auto"],PA=!1;function FA({types:t}){return new Me({key:new De("textDirection"),appendTransaction:(e,n,r)=>{if(PA)return null;if(!e.some(t=>t.docChanged))return;let o=!1;const i=r.tr;return r.doc.descendants((e,n)=>{if(t.includes(e.type.name)){if(null!==e.attrs.dir&&e.textContent.length>0)return;const t=i.storedMarks||[];i.setNodeAttribute(n,"dir",0==(r=e.textContent).length?null:RA.test(r)?"rtl":BA.test(r)?"ltr":null);for(const e of t)i.addStoredMark(e);o=!0}var r}),o?i:null},props:{handleDOMEvents:{compositionstart:()=>(PA||(PA=!0,clearTimeout(EA),EA=setTimeout(()=>{PA=!1},2e3)),!1),compositionend:()=>(PA=!1,clearTimeout(EA),!1)}}})}var zA=Za.create({name:"textDirection",addOptions:()=>({types:[],defaultDirection:null}),addGlobalAttributes(){return[{types:this.options.types,attributes:{dir:{default:null,parseHTML:t=>t.dir||this.options.defaultDirection,renderHTML:t=>t.dir===this.options.defaultDirection?{}:{dir:t.dir}}}}]},addCommands(){return{setTextDirection:t=>({commands:e})=>!!$A.includes(t)&&this.options.types.every(n=>e.updateAttributes(n,{dir:t})),unsetTextDirection:()=>({commands:t})=>this.options.types.every(e=>t.resetAttributes(e,"dir"))}},addKeyboardShortcuts(){return{"Mod-Alt-l":()=>this.editor.commands.setTextDirection("ltr"),"Mod-Alt-r":()=>this.editor.commands.setTextDirection("rtl")}},addProseMirrorPlugins(){return[FA({types:this.options.types})]}});const HA=Cl.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML(t){let{HTMLAttributes:e}=t;return["p",Qs(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>{const n=t.tokens||[];return 1===n.length&&"image"===n[0].type?e.parseChildren([n[0]]):e.createNode("paragraph",void 0,e.parseInline(n))},renderMarkdown:(t,e)=>t&&Array.isArray(t.content)?e.renderChildren(t.content):"",addCommands(){return{setParagraph:()=>t=>{let{commands:e}=t;return e.setNode(this.name)}}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}).extend({group:"block",content:"inline*",allowHooks:!0,addOptions(){var t;return{...null===(t=this.options)||void 0===t?void 0:t.call(this),emptyEditorClass:"is-editor-empty",hasPlaceholderClass:"has-placeholder",placeholder:"",showOnlyWhenEditable:!0}},renderHTML(t){let{HTMLAttributes:e}=t;return["p",Qs(this.options.HTMLAttributes,e),0]},addProseMirrorPlugins(){return[new Me({props:{decorations:t=>{let{doc:e}=t;try{const t=this.editor.isEditable||!this.options.showOnlyWhenEditable,r=[];if(!t)return;const o=this.editor.state.selection;if(!o.empty)return;const i=o.$anchor.parent;if(!i||i.type.name!==this.name)return;if(!i.textContent){const t=[this.options.hasPlaceholderClass];this.editor.isEmpty&&t.push(this.options.emptyEditorClass);const e=o.$anchor.before();var n=this.editor.view.coordsAtPos(e);const s=Po.node(e,e+i.nodeSize,{class:t.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder(n.left,n.top):this.options.placeholder});r.push(s)}if(r.length)return Ho.create(e,r)}catch(t){console.error("[TiptapExtensionParagraph] Error in decorations:",t)}return Ho.empty}}})]}}),jA=HA;const VA=Cl.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}).extend({group:"inline"});var qA=Za.create({name:"typography",addOptions:()=>({closeDoubleQuote:"",closeSingleQuote:"",copyright:"",ellipsis:"",emDash:"",laquo:"",leftArrow:"",multiplication:"",notEqual:"",oneHalf:"",oneQuarter:"",openDoubleQuote:"",openSingleQuote:"",plusMinus:"",raquo:"",registeredTrademark:"",rightArrow:"",servicemark:"",superscriptThree:"",superscriptTwo:"",threeQuarters:"",trademark:""}),addInputRules(){const t=[];var e;return!1!==this.options.emDash&&t.push(pl({find:/--$/,replace:null!=(e=this.options.emDash)?e:""})),!1!==this.options.ellipsis&&t.push((t=>pl({find:/\.\.\.$/,replace:null!=t?t:""}))(this.options.ellipsis)),!1!==this.options.openDoubleQuote&&t.push((t=>pl({find:/(?:^|[\s{[(<'"\u2018\u201C])(")$/,replace:null!=t?t:""}))(this.options.openDoubleQuote)),!1!==this.options.closeDoubleQuote&&t.push((t=>pl({find:/"$/,replace:null!=t?t:""}))(this.options.closeDoubleQuote)),!1!==this.options.openSingleQuote&&t.push((t=>pl({find:/(?:^|[\s{[(<'"\u2018\u201C])(')$/,replace:null!=t?t:""}))(this.options.openSingleQuote)),!1!==this.options.closeSingleQuote&&t.push((t=>pl({find:/'$/,replace:null!=t?t:""}))(this.options.closeSingleQuote)),!1!==this.options.leftArrow&&t.push((t=>pl({find:/<-$/,replace:null!=t?t:""}))(this.options.leftArrow)),!1!==this.options.rightArrow&&t.push((t=>pl({find:/->$/,replace:null!=t?t:""}))(this.options.rightArrow)),!1!==this.options.copyright&&t.push((t=>pl({find:/\(c\)$/,replace:null!=t?t:""}))(this.options.copyright)),!1!==this.options.trademark&&t.push((t=>pl({find:/\(tm\)$/,replace:null!=t?t:""}))(this.options.trademark)),!1!==this.options.servicemark&&t.push((t=>pl({find:/\(sm\)$/,replace:null!=t?t:""}))(this.options.servicemark)),!1!==this.options.registeredTrademark&&t.push((t=>pl({find:/\(r\)$/,replace:null!=t?t:""}))(this.options.registeredTrademark)),!1!==this.options.oneHalf&&t.push((t=>pl({find:/(?:^|\s)(1\/2)\s$/,replace:null!=t?t:""}))(this.options.oneHalf)),!1!==this.options.plusMinus&&t.push((t=>pl({find:/\+\/-$/,replace:null!=t?t:""}))(this.options.plusMinus)),!1!==this.options.notEqual&&t.push((t=>pl({find:/!=$/,replace:null!=t?t:""}))(this.options.notEqual)),!1!==this.options.laquo&&t.push((t=>pl({find:/<<$/,replace:null!=t?t:""}))(this.options.laquo)),!1!==this.options.raquo&&t.push((t=>pl({find:/>>$/,replace:null!=t?t:""}))(this.options.raquo)),!1!==this.options.multiplication&&t.push((t=>pl({find:/\d+\s?([*x])\s?\d+$/,replace:null!=t?t:""}))(this.options.multiplication)),!1!==this.options.superscriptTwo&&t.push((t=>pl({find:/\^2$/,replace:null!=t?t:""}))(this.options.superscriptTwo)),!1!==this.options.superscriptThree&&t.push((t=>pl({find:/\^3$/,replace:null!=t?t:""}))(this.options.superscriptThree)),!1!==this.options.oneQuarter&&t.push((t=>pl({find:/(?:^|\s)(1\/4)\s$/,replace:null!=t?t:""}))(this.options.oneQuarter)),!1!==this.options.threeQuarters&&t.push((t=>pl({find:/(?:^|\s)(3\/4)\s$/,replace:null!=t?t:""}))(this.options.threeQuarters)),t}});function UA(t,e,n){return Object.fromEntries(Object.entries(n).filter(n=>{let[r]=n;const o=t.find(t=>t.type===e&&t.name===r);return!!o&&o.attribute.keepOnSplit}).map(n=>{let[r,o]=n;const i=t.find(t=>t.type===e&&t.name===r);return i&&i.attribute.defaultOnSplit&&(o=i.attribute.default),[r,o]}))}function WA(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(t=>null==e?void 0:e.includes(t.type.name));t.tr.ensureMarks(r)}}const JA=function(){let{keepMarks:t=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=>{let{tr:n,state:r,dispatch:o,editor:i}=e;const{selection:s,doc:a}=n,{$from:l,$to:c}=s,u=UA(i.extensionManager.attributes,l.node().type.name,l.node().attrs);if(s instanceof fe&&s.node.isBlock)return!(!l.parentOffset||!Ht(a,l.pos)||(o&&(t&&WA(r,i.extensionManager.splittableMarks),n.split(l.pos).scrollIntoView()),0));if(!l.parent.isBlock)return!1;if(o){const e=0===l.parentOffset,o=c.parentOffset===c.parent.content.size,a=e&&!o;s instanceof he&&n.deleteSelection();const d=0===l.depth?void 0:function(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(l.node(-1).contentMatchAt(l.indexAfter(-1)));let h=!a&&d?[{type:d,attrs:u}]:void 0,p=Ht(n.doc,n.mapping.map(l.pos),1,h);if(h||p||!Ht(n.doc,n.mapping.map(l.pos),1,d?[{type:d}]:void 0)||(p=!0,h=d?[{type:d,attrs:u}]:void 0),p){try{n.split(n.mapping.map(l.pos),1,h)}catch(t){console.error("Error splitting block",t,h,l.pos),console.log("tr.mapping",n.mapping)}if(d&&a&&(l.parent.type!==d||l.parent.attrs!==u)){const t=n.mapping.map(l.before()),e=n.doc.resolve(t);l.node(-1).canReplaceWith(e.index(),e.index()+1,d)&&n.setNodeMarkup(t,d,u)}}t&&WA(r,i.extensionManager.splittableMarks),n.scrollIntoView()}return!0}};function KA(t,e){return"string"==typeof t?e.nodes[t]:t}const GA=t=>e=>{let{tr:n,state:r,dispatch:o,editor:i}=e;const s=KA(t,r.schema),{$from:a,$to:l}=r.selection,c=r.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const u=i.extensionManager.attributes;var h=n.storedMarks||r.storedMarks||[];try{const t=a.node();if(t&&t.content&&Array.isArray(t.content.content)&&t.content.content.length>0){const e=t.content.content[t.content.content.length-1];h=[...h,...e.marks||[]]}}catch(t){console.error("[splitListItemImproved] Error while getting the source node marks",t)}if(0===a.parent.content.size&&a.node(-1).childCount===a.indexAfter(-1)){if(2===a.depth||a.node(-3).type!==s||a.index(-2)!==a.node(-2).childCount-1)return!1;if(o){var p;let t=d.empty;const e=a.index(-1)?1:a.index(-2)?2:3;for(let n=a.depth-e;n>=a.depth-3;n-=1)t=d.from(a.node(n).copy(t));const r=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,o=UA(u,a.node().type.name,a.node().attrs),i=(null===(p=s.contentMatch.defaultType)||void 0===p?void 0:p.createAndFill(o))||void 0;t=t.append(d.from(s.createAndFill(null,i)||void 0));const l=a.before(a.depth-(e-1));n.replace(l,a.after(-r),new y(t,4-e,0));let c=-1;n.doc.nodesBetween(l,n.doc.content.size,(t,e)=>{if(c>-1)return!1;t.isTextblock&&0===t.content.size&&(c=e+1)}),c>-1&&n.setSelection(he.near(n.doc.resolve(c))),n.scrollIntoView()}return!0}const f=a.node(-1);if(f.type!==s)return!1;const g=a.node(),m=UA(u,f.type.name,f.attrs),b=UA(u,g.type.name,g.attrs),v=l.pos===a.start(),w=l.pos===a.end(),A=v&&!w,k=f.contentMatchAt(0).defaultType,x=!A&&k?[{type:s,attrs:m},{type:k,attrs:b}]:[{type:s,attrs:m}];if(n.delete(a.pos,l.pos),!Ht(n.doc,a.pos,2))return!1;if(o){if(n.split(a.pos,2,x),k&&A&&(a.parent.type!=k||a.parent.attrs!=b)){const t=n.mapping.map(a.before()),e=n.doc.resolve(t);a.node(-1).canReplaceWith(e.index(),e.index()+1,k)&&n.setNodeMarkup(t,k,b)}h&&h.length>0&&n.setStoredMarks(h),n.scrollIntoView()}return!0},YA=t=>e=>{let{tr:n,state:r,dispatch:o,editor:i,commands:s}=e;const a=KA(t,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;if(0!==l.parent.content.size||l.node(-1).childCount!==l.indexAfter(-1))return!1;const d=n.storedMarks||r.storedMarks;if(2!==l.depth&&l.node(-3).type===a&&l.index(-2)===l.node(-2).childCount-1)return!1;const h=s.liftListItem(a);if(h&&o){const t=l.node(-2),e=UA(i.extensionManager.attributes,t.type.name,t.attrs),r=n.mapping.map(l.after()),o=n.doc.resolve(r),s=o.nodeAfter;t&&s&&s.type===t.type&&s.attrs!=e&&(o.parent.canReplaceWith(o.index(),o.index()+1,t.type)&&(n.setNodeMarkup(r,t.type,e),d&&d.length>0&&n.setStoredMarks(d)),n.scrollIntoView())}return h},ZA=dA.extend({addCommands:()=>({splitListItemImproved:GA,liftEmptyListItemImproved:YA}),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.first(t=>{let{commands:e}=t;return[()=>e.liftEmptyListItemImproved("listItem"),()=>e.splitListItemImproved("listItem")]}),Tab:()=>this.editor.commands.sinkListItem("listItem"),"Shift-Tab":()=>this.editor.commands.liftListItem("listItem")}}});var QA,XA;if("undefined"!=typeof WeakMap){let t=new WeakMap;QA=e=>t.get(e),XA=(e,n)=>(t.set(e,n),n)}else{const t=[],e=10;let n=0;QA=e=>{for(let n=0;n<t.length;n+=2)if(t[n]==e)return t[n+1]},XA=(r,o)=>(n==e&&(n=0),t[n++]=r,t[n++]=o)}var tk=class{constructor(t,e,n,r){this.width=t,this.height=e,this.map=n,this.problems=r}findCell(t){for(let e=0;e<this.map.length;e++){const n=this.map[e];if(n!=t)continue;const r=e%this.width,o=e/this.width|0;let i=r+1,s=o+1;for(let t=1;i<this.width&&this.map[e+t]==n;t++)i++;for(let t=1;s<this.height&&this.map[e+this.width*t]==n;t++)s++;return{left:r,top:o,right:i,bottom:s}}throw new RangeError(`No cell with offset ${t} found`)}colCount(t){for(let e=0;e<this.map.length;e++)if(this.map[e]==t)return e%this.width;throw new RangeError(`No cell with offset ${t} found`)}nextCell(t,e,n){const{left:r,right:o,top:i,bottom:s}=this.findCell(t);return"horiz"==e?(n<0?0==r:o==this.width)?null:this.map[i*this.width+(n<0?r-1:o)]:(n<0?0==i:s==this.height)?null:this.map[r+this.width*(n<0?i-1:s)]}rectBetween(t,e){const{left:n,right:r,top:o,bottom:i}=this.findCell(t),{left:s,right:a,top:l,bottom:c}=this.findCell(e);return{left:Math.min(n,s),top:Math.min(o,l),right:Math.max(r,a),bottom:Math.max(i,c)}}cellsInRect(t){const e=[],n={};for(let r=t.top;r<t.bottom;r++)for(let o=t.left;o<t.right;o++){const i=r*this.width+o,s=this.map[i];n[s]||(n[s]=!0,o==t.left&&o&&this.map[i-1]==s||r==t.top&&r&&this.map[i-this.width]==s||e.push(s))}return e}positionAt(t,e,n){for(let r=0,o=0;;r++){const i=o+n.child(r).nodeSize;if(r==t){let n=e+t*this.width;const r=(t+1)*this.width;for(;n<r&&this.map[n]<o;)n++;return n==r?i-1:this.map[n]}o=i}}static get(t){return QA(t)||XA(t,function(t){if("table"!=t.type.spec.tableRole)throw new RangeError("Not a table node: "+t.type.name);const e=function(t){let e=-1,n=!1;for(let r=0;r<t.childCount;r++){const o=t.child(r);let i=0;if(n)for(let e=0;e<r;e++){const n=t.child(e);for(let t=0;t<n.childCount;t++){const o=n.child(t);e+o.attrs.rowspan>r&&(i+=o.attrs.colspan)}}for(let t=0;t<o.childCount;t++){const e=o.child(t);i+=e.attrs.colspan,e.attrs.rowspan>1&&(n=!0)}-1==e?e=i:e!=i&&(e=Math.max(e,i))}return e}(t),n=t.childCount,r=[];let o=0,i=null;const s=[];for(let t=0,o=e*n;t<o;t++)r[t]=0;for(let a=0,l=0;a<n;a++){const c=t.child(a);l++;for(let t=0;;t++){for(;o<r.length&&0!=r[o];)o++;if(t==c.childCount)break;const u=c.child(t),{colspan:d,rowspan:h,colwidth:p}=u.attrs;for(let t=0;t<h;t++){if(t+a>=n){(i||(i=[])).push({type:"overlong_rowspan",pos:l,n:h-t});break}const c=o+t*e;for(let t=0;t<d;t++){0==r[c+t]?r[c+t]=l:(i||(i=[])).push({type:"collision",row:a,pos:l,n:d-t});const n=p&&p[t];if(n){const r=(c+t)%e*2,o=s[r];null==o||o!=n&&1==s[r+1]?(s[r]=n,s[r+1]=1):o==n&&s[r+1]++}}}o+=d,l+=u.nodeSize}const u=(a+1)*e;let d=0;for(;o<u;)0==r[o++]&&d++;d&&(i||(i=[])).push({type:"missing",row:a,n:d}),l++}0!==e&&0!==n||(i||(i=[])).push({type:"zero_sized"});const a=new tk(e,n,r,i);let l=!1;for(let t=0;!l&&t<s.length;t+=2)null!=s[t]&&s[t+1]<n&&(l=!0);return l&&function(t,e,n){t.problems||(t.problems=[]);const r={};for(let o=0;o<t.map.length;o++){const i=t.map[o];if(r[i])continue;r[i]=!0;const s=n.nodeAt(i);if(!s)throw new RangeError(`No cell with offset ${i} found`);let a=null;const l=s.attrs;for(let n=0;n<l.colspan;n++){const r=e[(o+n)%t.width*2];null==r||l.colwidth&&l.colwidth[n]==r||((a||(a=ek(l)))[n]=r)}a&&t.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:a})}}(a,s,t),a}(t))}};function ek(t){if(t.colwidth)return t.colwidth.slice();const e=[];for(let n=0;n<t.colspan;n++)e.push(0);return e}function nk(t){let e=t.cached.tableNodeTypes;if(!e){e=t.cached.tableNodeTypes={};for(const n in t.nodes){const r=t.nodes[n],o=r.spec.tableRole;o&&(e[o]=r)}}return e}var rk=new De("selectingCells");function ok(t){for(let e=t.depth-1;e>0;e--)if("row"==t.node(e).type.spec.tableRole)return t.node(0).resolve(t.before(e+1));return null}function ik(t){const e=t.selection.$head;for(let t=e.depth;t>0;t--)if("row"==e.node(t).type.spec.tableRole)return!0;return!1}function sk(t){const e=t.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&"cell"==e.node.type.spec.tableRole)return e.$anchor;const n=ok(e.$head)||function(t){for(let e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){const r=e.type.spec.tableRole;if("cell"==r||"header_cell"==r)return t.doc.resolve(n)}for(let e=t.nodeBefore,n=t.pos;e;e=e.lastChild,n--){const r=e.type.spec.tableRole;if("cell"==r||"header_cell"==r)return t.doc.resolve(n-e.nodeSize)}}(e.$head);if(n)return n;throw new RangeError(`No cell found around position ${e.head}`)}function ak(t){return"row"==t.parent.type.spec.tableRole&&!!t.nodeAfter}function lk(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function ck(t,e,n){const r=t.node(-1),o=tk.get(r),i=t.start(-1),s=o.nextCell(t.pos-i,e,n);return null==s?null:t.node(0).resolve(i+s)}function uk(t,e,n=1){const r={...t,colspan:t.colspan-n};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,n),r.colwidth.some(t=>t>0)||(r.colwidth=null)),r}function dk(t,e,n=1){const r={...t,colspan:t.colspan+n};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let t=0;t<n;t++)r.colwidth.splice(e,0,0)}return r}var hk=class t extends le{constructor(t,e=t){const n=t.node(-1),r=tk.get(n),o=t.start(-1),i=r.rectBetween(t.pos-o,e.pos-o),s=t.node(0),a=r.cellsInRect(i).filter(t=>t!=e.pos-o);a.unshift(e.pos-o);const l=a.map(t=>{const e=n.nodeAt(t);if(!e)throw RangeError(`No cell with offset ${t} found`);const r=o+t+1;return new ce(s.resolve(r),s.resolve(r+e.content.size))});super(l[0].$from,l[0].$to,l),this.$anchorCell=t,this.$headCell=e}map(e,n){const r=e.resolve(n.map(this.$anchorCell.pos)),o=e.resolve(n.map(this.$headCell.pos));if(ak(r)&&ak(o)&&lk(r,o)){const e=this.$anchorCell.node(-1)!=r.node(-1);return e&&this.isRowSelection()?t.rowSelection(r,o):e&&this.isColSelection()?t.colSelection(r,o):new t(r,o)}return he.between(r,o)}content(){const t=this.$anchorCell.node(-1),e=tk.get(t),n=this.$anchorCell.start(-1),r=e.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n),o={},i=[];for(let n=r.top;n<r.bottom;n++){const s=[];for(let i=n*e.width+r.left,a=r.left;a<r.right;a++,i++){const n=e.map[i];if(o[n])continue;o[n]=!0;const a=e.findCell(n);let l=t.nodeAt(n);if(!l)throw RangeError(`No cell with offset ${n} found`);const c=r.left-a.left,u=a.right-r.right;if(c>0||u>0){let t=l.attrs;if(c>0&&(t=uk(t,0,c)),u>0&&(t=uk(t,t.colspan-u,u)),a.left<r.left){if(l=l.type.createAndFill(t),!l)throw RangeError(`Could not create cell with attrs ${JSON.stringify(t)}`)}else l=l.type.create(t,l.content)}if(a.top<r.top||a.bottom>r.bottom){const t={...l.attrs,rowspan:Math.min(a.bottom,r.bottom)-Math.max(a.top,r.top)};l=a.top<r.top?l.type.createAndFill(t):l.type.create(t,l.content)}s.push(l)}i.push(t.child(n).copy(d.from(s)))}const s=this.isColSelection()&&this.isRowSelection()?t:i;return new y(d.from(s),1,1)}replace(t,e=y.empty){const n=t.steps.length,r=this.ranges;for(let o=0;o<r.length;o++){const{$from:i,$to:s}=r[o],a=t.mapping.slice(n);t.replace(a.map(i.pos),a.map(s.pos),o?y.empty:e)}const o=le.findFrom(t.doc.resolve(t.mapping.slice(n).map(this.to)),-1);o&&t.setSelection(o)}replaceWith(t,e){this.replace(t,new y(d.from(e),0,0))}forEachCell(t){const e=this.$anchorCell.node(-1),n=tk.get(e),r=this.$anchorCell.start(-1),o=n.cellsInRect(n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r));for(let n=0;n<o.length;n++)t(e.nodeAt(o[n]),r+o[n])}isColSelection(){const t=this.$anchorCell.index(-1),e=this.$headCell.index(-1);if(Math.min(t,e)>0)return!1;const n=t+this.$anchorCell.nodeAfter.attrs.rowspan,r=e+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(n,r)==this.$headCell.node(-1).childCount}static colSelection(e,n=e){const r=e.node(-1),o=tk.get(r),i=e.start(-1),s=o.findCell(e.pos-i),a=o.findCell(n.pos-i),l=e.node(0);return s.top<=a.top?(s.top>0&&(e=l.resolve(i+o.map[s.left])),a.bottom<o.height&&(n=l.resolve(i+o.map[o.width*(o.height-1)+a.right-1]))):(a.top>0&&(n=l.resolve(i+o.map[a.left])),s.bottom<o.height&&(e=l.resolve(i+o.map[o.width*(o.height-1)+s.right-1]))),new t(e,n)}isRowSelection(){const t=this.$anchorCell.node(-1),e=tk.get(t),n=this.$anchorCell.start(-1),r=e.colCount(this.$anchorCell.pos-n),o=e.colCount(this.$headCell.pos-n);if(Math.min(r,o)>0)return!1;const i=r+this.$anchorCell.nodeAfter.attrs.colspan,s=o+this.$headCell.nodeAfter.attrs.colspan;return Math.max(i,s)==e.width}eq(e){return e instanceof t&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,n=e){const r=e.node(-1),o=tk.get(r),i=e.start(-1),s=o.findCell(e.pos-i),a=o.findCell(n.pos-i),l=e.node(0);return s.left<=a.left?(s.left>0&&(e=l.resolve(i+o.map[s.top*o.width])),a.right<o.width&&(n=l.resolve(i+o.map[o.width*(a.top+1)-1]))):(a.left>0&&(n=l.resolve(i+o.map[a.top*o.width])),s.right<o.width&&(e=l.resolve(i+o.map[o.width*(s.top+1)-1]))),new t(e,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,n){return new t(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){return new t(e.resolve(n),e.resolve(r))}getBookmark(){return new pk(this.$anchorCell.pos,this.$headCell.pos)}};hk.prototype.visible=!1,le.jsonID("cell",hk);var pk=class t{constructor(t,e){this.anchor=t,this.head=e}map(e){return new t(e.map(this.anchor),e.map(this.head))}resolve(t){const e=t.resolve(this.anchor),n=t.resolve(this.head);return"row"==e.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&e.index()<e.parent.childCount&&n.index()<n.parent.childCount&&lk(e,n)?new hk(e,n):le.near(n,1)}};function fk(t){if(!(t.selection instanceof hk))return null;const e=[];return t.selection.forEachCell((t,n)=>{e.push(Po.node(n,n+t.nodeSize,{class:"selectedCell"}))}),Ho.create(t.doc,e)}var gk=new De("fix-tables");function mk(t,e,n,r){const o=t.childCount,i=e.childCount;t:for(let s=0,a=0;s<i;s++){const i=e.child(s);for(let e=a,r=Math.min(o,s+3);e<r;e++)if(t.child(e)==i){a=e+1,n+=i.nodeSize;continue t}r(i,n),a<o&&t.child(a).sameMarkup(i)?mk(t.child(a),i,n+1,r):i.nodesBetween(0,i.content.size,r,n+1),n+=i.nodeSize}}function yk(t,e){let n;const r=(e,r)=>{"table"==e.type.spec.tableRole&&(n=function(t,e,n,r){const o=tk.get(e);if(!o.problems)return r;r||(r=t.tr);const i=[];for(let t=0;t<o.height;t++)i.push(0);for(let t=0;t<o.problems.length;t++){const s=o.problems[t];if("collision"==s.type){const t=e.nodeAt(s.pos);if(!t)continue;const o=t.attrs;for(let t=0;t<o.rowspan;t++)i[s.row+t]+=s.n;r.setNodeMarkup(r.mapping.map(n+1+s.pos),null,uk(o,o.colspan-s.n,s.n))}else if("missing"==s.type)i[s.row]+=s.n;else if("overlong_rowspan"==s.type){const t=e.nodeAt(s.pos);if(!t)continue;r.setNodeMarkup(r.mapping.map(n+1+s.pos),null,{...t.attrs,rowspan:t.attrs.rowspan-s.n})}else if("colwidth mismatch"==s.type){const t=e.nodeAt(s.pos);if(!t)continue;r.setNodeMarkup(r.mapping.map(n+1+s.pos),null,{...t.attrs,colwidth:s.colwidth})}else if("zero_sized"==s.type){const t=r.mapping.map(n);r.delete(t,t+e.nodeSize)}}let s,a;for(let t=0;t<i.length;t++)i[t]&&(null==s&&(s=t),a=t);for(let l=0,c=n+1;l<o.height;l++){const n=e.child(l),o=c+n.nodeSize,u=i[l];if(u>0){let e="cell";n.firstChild&&(e=n.firstChild.type.spec.tableRole);const i=[];for(let n=0;n<u;n++){const n=nk(t.schema)[e].createAndFill();n&&i.push(n)}const d=0!=l&&s!=l-1||a!=l?o-1:c+1;r.insert(r.mapping.map(d),i)}c=o}return r.setMeta(gk,{fixTables:!0})}(t,e,r,n))};return e?e.doc!=t.doc&&mk(e.doc,t.doc,0,r):t.doc.descendants(r),n}function bk(t){const e=t.selection,n=sk(t),r=n.node(-1),o=n.start(-1),i=tk.get(r);return{...e instanceof hk?i.rectBetween(e.$anchorCell.pos-o,e.$headCell.pos-o):i.findCell(n.pos-o),tableStart:o,map:i,table:r}}function vk(t,{map:e,tableStart:n,table:r},o){let i=o>0?-1:0;(function(t,e,n){const r=nk(e.type.schema).header_cell;for(let o=0;o<t.height;o++)if(e.nodeAt(t.map[n+o*t.width]).type!=r)return!1;return!0})(e,r,o+i)&&(i=0==o||o==e.width?null:0);for(let s=0;s<e.height;s++){const a=s*e.width+o;if(o>0&&o<e.width&&e.map[a-1]==e.map[a]){const i=e.map[a],l=r.nodeAt(i);t.setNodeMarkup(t.mapping.map(n+i),null,dk(l.attrs,o-e.colCount(i))),s+=l.attrs.rowspan-1}else{const l=null==i?nk(r.type.schema).cell:r.nodeAt(e.map[a+i]).type,c=e.positionAt(s,o,r);t.insert(t.mapping.map(n+c),l.createAndFill())}}return t}function wk(t,{map:e,table:n,tableStart:r},o){const i=t.mapping.maps.length;for(let s=0;s<e.height;){const a=s*e.width+o,l=e.map[a],c=n.nodeAt(l),u=c.attrs;if(o>0&&e.map[a-1]==l||o<e.width-1&&e.map[a+1]==l)t.setNodeMarkup(t.mapping.slice(i).map(r+l),null,uk(u,o-e.colCount(l)));else{const e=t.mapping.slice(i).map(r+l);t.delete(e,e+c.nodeSize)}s+=u.rowspan}}function Ak(t,{map:e,tableStart:n,table:r},o){var i;let s=n;for(let t=0;t<o;t++)s+=r.child(t).nodeSize;const a=[];let l=o>0?-1:0;(function(t,e,n){var r;const o=nk(e.type.schema).header_cell;for(let i=0;i<t.width;i++)if((null==(r=e.nodeAt(t.map[i+n*t.width]))?void 0:r.type)!=o)return!1;return!0})(e,r,o+l)&&(l=0==o||o==e.height?null:0);for(let s=0,c=e.width*o;s<e.width;s++,c++)if(o>0&&o<e.height&&e.map[c]==e.map[c-e.width]){const o=e.map[c],i=r.nodeAt(o).attrs;t.setNodeMarkup(n+o,null,{...i,rowspan:i.rowspan+1}),s+=i.colspan-1}else{const t=null==l?nk(r.type.schema).cell:null==(i=r.nodeAt(e.map[c+l*e.width]))?void 0:i.type,n=null==t?void 0:t.createAndFill();n&&a.push(n)}return t.insert(s,nk(r.type.schema).row.create(null,a)),t}function kk(t,{map:e,table:n,tableStart:r},o){let i=0;for(let t=0;t<o;t++)i+=n.child(t).nodeSize;const s=i+n.child(o).nodeSize,a=t.mapping.maps.length;t.delete(i+r,s+r);const l=new Set;for(let i=0,s=o*e.width;i<e.width;i++,s++){const c=e.map[s];if(!l.has(c))if(l.add(c),o>0&&c==e.map[s-e.width]){const e=n.nodeAt(c).attrs;t.setNodeMarkup(t.mapping.slice(a).map(c+r),null,{...e,rowspan:e.rowspan-1}),i+=e.colspan-1}else if(o<e.height&&c==e.map[s+e.width]){const s=n.nodeAt(c),l=s.attrs,u=s.type.create({...l,rowspan:s.attrs.rowspan-1},s.content),d=e.positionAt(o+1,i,n);t.insert(t.mapping.slice(a).map(r+d),u),i+=l.colspan-1}}}function xk(t){const e=t.content;return 1==e.childCount&&e.child(0).isTextblock&&0==e.child(0).childCount}function Ck(t,e){const n=t.selection;if(!(n instanceof hk)||n.$anchorCell.pos==n.$headCell.pos)return!1;const r=bk(t),{map:o}=r;if(function({width:t,height:e,map:n},r){let o=r.top*t+r.left,i=o,s=(r.bottom-1)*t+r.left,a=o+(r.right-r.left-1);for(let e=r.top;e<r.bottom;e++){if(r.left>0&&n[i]==n[i-1]||r.right<t&&n[a]==n[a+1])return!0;i+=t,a+=t}for(let i=r.left;i<r.right;i++){if(r.top>0&&n[o]==n[o-t]||r.bottom<e&&n[s]==n[s+t])return!0;o++,s++}return!1}(o,r))return!1;if(e){const n=t.tr,i={};let s,a,l=d.empty;for(let t=r.top;t<r.bottom;t++)for(let e=r.left;e<r.right;e++){const c=o.map[t*o.width+e],u=r.table.nodeAt(c);if(!i[c]&&u)if(i[c]=!0,null==s)s=c,a=u;else{xk(u)||(l=l.append(u.content));const t=n.mapping.map(c+r.tableStart);n.delete(t,t+u.nodeSize)}}if(null==s||null==a)return!0;if(n.setNodeMarkup(s+r.tableStart,null,{...dk(a.attrs,a.attrs.colspan,r.right-r.left-a.attrs.colspan),rowspan:r.bottom-r.top}),l.size){const t=s+1+a.content.size,e=xk(a)?s+1:t;n.replaceWith(e+r.tableStart,t+r.tableStart,l)}n.setSelection(new hk(n.doc.resolve(s+r.tableStart))),e(n)}return!0}function Sk(t,e){const n=nk(t.schema);return(r=({node:t})=>n[t.type.spec.tableRole],(t,e)=>{var n;const o=t.selection;let i,s;if(o instanceof hk){if(o.$anchorCell.pos!=o.$headCell.pos)return!1;i=o.$anchorCell.nodeAfter,s=o.$anchorCell.pos}else{if(i=function(t){for(let e=t.depth;e>0;e--){const n=t.node(e).type.spec.tableRole;if("cell"===n||"header_cell"===n)return t.node(e)}return null}(o.$from),!i)return!1;s=null==(n=ok(o.$from))?void 0:n.pos}if(null==i||null==s)return!1;if(1==i.attrs.colspan&&1==i.attrs.rowspan)return!1;if(e){let n=i.attrs;const a=[],l=n.colwidth;n.rowspan>1&&(n={...n,rowspan:1}),n.colspan>1&&(n={...n,colspan:1});const c=bk(t),u=t.tr;for(let t=0;t<c.right-c.left;t++)a.push(l?{...n,colwidth:l&&l[t]?[l[t]]:null}:n);let d;for(let t=c.top;t<c.bottom;t++){let e=c.map.positionAt(t,c.left,c.table);t==c.top&&(e+=i.nodeSize);for(let n=c.left,o=0;n<c.right;n++,o++)n==c.left&&t==c.top||u.insert(d=u.mapping.map(e+c.tableStart,1),r({node:i,row:t,col:n}).createAndFill(a[o]))}u.setNodeMarkup(s,r({node:i,row:c.top,col:c.left}),a[0]),o instanceof hk&&u.setSelection(new hk(u.doc.resolve(o.$anchorCell.pos),d?u.doc.resolve(d):void 0)),e(u)}return!0})(t,e);var r}function Ek(t,e,n){const r=e.map.cellsInRect({left:0,top:0,right:"row"==t?e.map.width:1,bottom:"column"==t?e.map.height:1});for(let t=0;t<r.length;t++){const o=e.table.nodeAt(r[t]);if(o&&o.type!==n.header_cell)return!1}return!0}function Mk(t,e){return(e=e||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(t){return function(e,n){if(!ik(e))return!1;if(n){const r=nk(e.schema),o=bk(e),i=e.tr,s=o.map.cellsInRect("column"==t?{left:o.left,top:0,right:o.right,bottom:o.map.height}:"row"==t?{left:0,top:o.top,right:o.map.width,bottom:o.bottom}:o),a=s.map(t=>o.table.nodeAt(t));for(let t=0;t<s.length;t++)a[t].type==r.header_cell&&i.setNodeMarkup(o.tableStart+s[t],r.cell,a[t].attrs);if(0==i.steps.length)for(let t=0;t<s.length;t++)i.setNodeMarkup(o.tableStart+s[t],r.header_cell,a[t].attrs);n(i)}return!0}}(t):function(e,n){if(!ik(e))return!1;if(n){const r=nk(e.schema),o=bk(e),i=e.tr,s=Ek("row",o,r),a=Ek("column",o,r),l=("column"===t?s:"row"===t&&a)?1:0,c="column"==t?{left:0,top:l,right:1,bottom:o.map.height}:"row"==t?{left:l,top:0,right:o.map.width,bottom:1}:o,u="column"==t?a?r.cell:r.header_cell:"row"==t?s?r.cell:r.header_cell:r.cell;o.map.cellsInRect(c).forEach(t=>{const e=t+o.tableStart,n=i.doc.nodeAt(e);n&&i.setNodeMarkup(e,u,n.attrs)}),n(i)}return!0}}Mk("row",{useDeprecatedLogic:!0}),Mk("column",{useDeprecatedLogic:!0});var _k=Mk("cell",{useDeprecatedLogic:!0});function Tk(t){return function(e,n){if(!ik(e))return!1;const r=function(t,e){if(e<0){const e=t.nodeBefore;if(e)return t.pos-e.nodeSize;for(let e=t.index(-1)-1,n=t.before();e>=0;e--){const r=t.node(-1).child(e),o=r.lastChild;if(o)return n-1-o.nodeSize;n-=r.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;const e=t.node(-1);for(let n=t.indexAfter(-1),r=t.after();n<e.childCount;n++){const t=e.child(n);if(t.childCount)return r+1;r+=t.nodeSize}}return null}(sk(e),t);if(null==r)return!1;if(n){const t=e.doc.resolve(r);n(e.tr.setSelection(he.between(t,(o=t,o.node(0).resolve(o.pos+o.nodeAfter.nodeSize)))).scrollIntoView())}var o;return!0}}function Dk(t,e){const n=t.selection;if(!(n instanceof hk))return!1;if(e){const r=t.tr,o=nk(t.schema).cell.createAndFill().content;n.forEachCell((t,e)=>{t.content.eq(o)||r.replace(r.mapping.map(e+1),r.mapping.map(e+t.nodeSize-1),new y(o,0,0))}),r.docChanged&&e(r)}return!0}function Ok(t,e){const n=t.createAndFill();return new se(n).replace(0,n.content.size,e).doc}function Nk(t,e,n,r,o,i,s,a){if(0==s||s==e.height)return!1;let l=!1;for(let c=o;c<i;c++){const o=s*e.width+c,i=e.map[o];if(e.map[o-e.width]==i){l=!0;const o=n.nodeAt(i),{top:u,left:d}=e.findCell(i);t.setNodeMarkup(t.mapping.slice(a).map(i+r),null,{...o.attrs,rowspan:s-u}),t.insert(t.mapping.slice(a).map(e.positionAt(s,d,n)),o.type.createAndFill({...o.attrs,rowspan:u+o.attrs.rowspan-s})),c+=o.attrs.colspan-1}}return l}function Ik(t,e,n,r,o,i,s,a){if(0==s||s==e.width)return!1;let l=!1;for(let c=o;c<i;c++){const o=c*e.width+s,i=e.map[o];if(e.map[o-1]==i){l=!0;const o=n.nodeAt(i),u=e.colCount(i),d=t.mapping.slice(a).map(i+r);t.setNodeMarkup(d,null,uk(o.attrs,s-u,o.attrs.colspan-(s-u))),t.insert(d+o.nodeSize,o.type.createAndFill(uk(o.attrs,0,s-u))),c+=o.attrs.rowspan-1}}return l}function Lk(t,e,n,r,o){let i=n?t.doc.nodeAt(n-1):t.doc;if(!i)throw new Error("No table found");let s=tk.get(i);const{top:a,left:l}=r,c=l+o.width,u=a+o.height,h=t.tr;let p=0;function f(){if(i=n?h.doc.nodeAt(n-1):h.doc,!i)throw new Error("No table found");s=tk.get(i),p=h.mapping.maps.length}(function(t,e,n,r,o,i,s){const a=nk(t.doc.type.schema);let l,c;if(o>e.width)for(let i=0,u=0;i<e.height;i++){const d=n.child(i);u+=d.nodeSize;const h=[];let p;p=null==d.lastChild||d.lastChild.type==a.cell?l||(l=a.cell.createAndFill()):c||(c=a.header_cell.createAndFill());for(let t=e.width;t<o;t++)h.push(p);t.insert(t.mapping.slice(s).map(u-1+r),h)}if(i>e.height){const u=[];for(let t=0,r=(e.height-1)*e.width;t<Math.max(e.width,o);t++){const o=!(t>=e.width)&&n.nodeAt(e.map[r+t]).type==a.header_cell;u.push(o?c||(c=a.header_cell.createAndFill()):l||(l=a.cell.createAndFill()))}const h=a.row.create(null,d.from(u)),p=[];for(let t=e.height;t<i;t++)p.push(h);t.insert(t.mapping.slice(s).map(r+n.nodeSize-2),p)}return!(!l&&!c)})(h,s,i,n,c,u,p)&&f(),Nk(h,s,i,n,l,c,a,p)&&f(),Nk(h,s,i,n,l,c,u,p)&&f(),Ik(h,s,i,n,a,u,l,p)&&f(),Ik(h,s,i,n,a,u,c,p)&&f();for(let t=a;t<u;t++){const e=s.positionAt(t,l,i),r=s.positionAt(t,c,i);h.replace(h.mapping.slice(p).map(e+n),h.mapping.slice(p).map(r+n),new y(o.rows[t-a],0,0))}f(),h.setSelection(new hk(h.doc.resolve(n+s.positionAt(a,l,i)),h.doc.resolve(n+s.positionAt(u-1,c-1,i)))),e(h)}var Rk=Mi({ArrowLeft:$k("horiz",-1),ArrowRight:$k("horiz",1),ArrowUp:$k("vert",-1),ArrowDown:$k("vert",1),"Shift-ArrowLeft":Pk("horiz",-1),"Shift-ArrowRight":Pk("horiz",1),"Shift-ArrowUp":Pk("vert",-1),"Shift-ArrowDown":Pk("vert",1),Backspace:Dk,"Mod-Backspace":Dk,Delete:Dk,"Mod-Delete":Dk});function Bk(t,e,n){return!n.eq(t.selection)&&(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function $k(t,e){return(n,r,o)=>{if(!o)return!1;const i=n.selection;if(i instanceof hk)return Bk(n,r,le.near(i.$headCell,e));if("horiz"!=t&&!i.empty)return!1;const s=jk(o,t,e);if(null==s)return!1;if("horiz"==t)return Bk(n,r,le.near(n.doc.resolve(i.head+e),e));{const o=n.doc.resolve(s),i=ck(o,t,e);let a;return a=i?le.near(i,1):e<0?le.near(n.doc.resolve(o.before(-1)),-1):le.near(n.doc.resolve(o.after(-1)),1),Bk(n,r,a)}}}function Pk(t,e){return(n,r,o)=>{if(!o)return!1;const i=n.selection;let s;if(i instanceof hk)s=i;else{const r=jk(o,t,e);if(null==r)return!1;s=new hk(n.doc.resolve(r))}const a=ck(s.$headCell,t,e);return!!a&&Bk(n,r,new hk(s.$anchorCell,a))}}function Fk(t,e){const n=ok(t.state.doc.resolve(e));return!!n&&(t.dispatch(t.state.tr.setSelection(new hk(n))),!0)}function zk(t,e,n){if(!ik(t.state))return!1;let r=function(t){if(!t.size)return null;let{content:e,openStart:n,openEnd:r}=t;for(;1==e.childCount&&(n>0&&r>0||"table"==e.child(0).type.spec.tableRole);)n--,r--,e=e.child(0).content;const o=e.child(0),i=o.type.spec.tableRole,s=o.type.schema,a=[];if("row"==i)for(let t=0;t<e.childCount;t++){let o=e.child(t).content;const i=t?0:Math.max(0,n-1),l=t<e.childCount-1?0:Math.max(0,r-1);(i||l)&&(o=Ok(nk(s).row,new y(o,i,l)).content),a.push(o)}else{if("cell"!=i&&"header_cell"!=i)return null;a.push(n||r?Ok(nk(s).row,new y(e,n,r)).content:e)}return function(t,e){const n=[];for(let t=0;t<e.length;t++){const r=e[t];for(let e=r.childCount-1;e>=0;e--){const{rowspan:o,colspan:i}=r.child(e).attrs;for(let e=t;e<t+o;e++)n[e]=(n[e]||0)+i}}let r=0;for(let t=0;t<n.length;t++)r=Math.max(r,n[t]);for(let o=0;o<n.length;o++)if(o>=e.length&&e.push(d.empty),n[o]<r){const i=nk(t).cell.createAndFill(),s=[];for(let t=n[o];t<r;t++)s.push(i);e[o]=e[o].append(d.from(s))}return{height:e.length,width:r,rows:e}}(s,a)}(n);const o=t.state.selection;if(o instanceof hk){r||(r={width:1,height:1,rows:[d.from(Ok(nk(t.state.schema).cell,n))]});const e=o.$anchorCell.node(-1),i=o.$anchorCell.start(-1),s=tk.get(e).rectBetween(o.$anchorCell.pos-i,o.$headCell.pos-i);return r=function({width:t,height:e,rows:n},r,o){if(t!=r){const e=[],o=[];for(let t=0;t<n.length;t++){const i=n[t],s=[];for(let n=e[t]||0,o=0;n<r;o++){let a=i.child(o%i.childCount);n+a.attrs.colspan>r&&(a=a.type.createChecked(uk(a.attrs,a.attrs.colspan,n+a.attrs.colspan-r),a.content)),s.push(a),n+=a.attrs.colspan;for(let n=1;n<a.attrs.rowspan;n++)e[t+n]=(e[t+n]||0)+a.attrs.colspan}o.push(d.from(s))}n=o,t=r}if(e!=o){const t=[];for(let r=0,i=0;r<o;r++,i++){const s=[],a=n[i%e];for(let t=0;t<a.childCount;t++){let e=a.child(t);r+e.attrs.rowspan>o&&(e=e.type.create({...e.attrs,rowspan:Math.max(1,o-e.attrs.rowspan)},e.content)),s.push(e)}t.push(d.from(s))}n=t,e=o}return{width:t,height:e,rows:n}}(r,s.right-s.left,s.bottom-s.top),Lk(t.state,t.dispatch,i,s,r),!0}if(r){const e=sk(t.state),n=e.start(-1);return Lk(t.state,t.dispatch,n,tk.get(e.node(-1)).findCell(e.pos-n),r),!0}return!1}function Hk(t,e){var n;if(e.ctrlKey||e.metaKey)return;const r=Vk(t,e.target);let o;if(e.shiftKey&&t.state.selection instanceof hk)i(t.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&null!=(o=ok(t.state.selection.$anchor))&&(null==(n=qk(t,e))?void 0:n.pos)!=o.pos)i(o,e),e.preventDefault();else if(!r)return;function i(e,n){let r=qk(t,n);const o=null==rk.getState(t.state);if(!r||!lk(e,r)){if(!o)return;r=e}const i=new hk(e,r);if(o||!t.state.selection.eq(i)){const n=t.state.tr.setSelection(i);o&&n.setMeta(rk,e.pos),t.dispatch(n)}}function s(){t.root.removeEventListener("mouseup",s),t.root.removeEventListener("dragstart",s),t.root.removeEventListener("mousemove",a),null!=rk.getState(t.state)&&t.dispatch(t.state.tr.setMeta(rk,-1))}function a(n){const o=n,a=rk.getState(t.state);let l;if(null!=a)l=t.state.doc.resolve(a);else if(Vk(t,o.target)!=r&&(l=qk(t,e),!l))return s();l&&i(l,o)}t.root.addEventListener("mouseup",s),t.root.addEventListener("dragstart",s),t.root.addEventListener("mousemove",a)}function jk(t,e,n){if(!(t.state.selection instanceof he))return null;const{$head:r}=t.state.selection;for(let o=r.depth-1;o>=0;o--){const i=r.node(o);if((n<0?r.index(o):r.indexAfter(o))!=(n<0?0:i.childCount))return null;if("cell"==i.type.spec.tableRole||"header_cell"==i.type.spec.tableRole){const i=r.before(o),s="vert"==e?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(s)?i:null}}return null}function Vk(t,e){for(;e&&e!=t.dom;e=e.parentNode)if("TD"==e.nodeName||"TH"==e.nodeName)return e;return null}function qk(t,e){const n=t.posAtCoords({left:e.clientX,top:e.clientY});return n&&n?ok(t.state.doc.resolve(n.pos)):null}var Uk=class{constructor(t,e){this.node=t,this.defaultCellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${e}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Wk(t,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type==this.node.type&&(this.node=t,Wk(t,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(t){return"attributes"==t.type&&(t.target==this.table||this.colgroup.contains(t.target))}};function Wk(t,e,n,r,o,i){var s;let a=0,l=!0,c=e.firstChild;const u=t.firstChild;if(u){for(let t=0,n=0;t<u.childCount;t++){const{colspan:s,colwidth:d}=u.child(t).attrs;for(let t=0;t<s;t++,n++){const s=o==n?i:d&&d[t],u=s?s+"px":"";if(a+=s||r,s||(l=!1),c)c.style.width!=u&&(c.style.width=u),c=c.nextSibling;else{const t=document.createElement("col");t.style.width=u,e.appendChild(t)}}}for(;c;){const t=c.nextSibling;null==(s=c.parentNode)||s.removeChild(c),c=t}l?(n.style.width=a+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=a+"px")}}var Jk=new De("tableColumnResizing");var Kk=class t{constructor(t,e){this.activeHandle=t,this.dragging=e}apply(e){const n=this,r=e.getMeta(Jk);if(r&&null!=r.setHandle)return new t(r.setHandle,!1);if(r&&void 0!==r.setDragging)return new t(n.activeHandle,r.setDragging);if(n.activeHandle>-1&&e.docChanged){let r=e.mapping.map(n.activeHandle,-1);return ak(e.doc.resolve(r))||(r=-1),new t(r,n.dragging)}return n}};function Gk(t,e,n,r){const o="right"==n?-r:r,i=t.posAtCoords({left:e.clientX+o,top:e.clientY});if(!i)return-1;const{pos:s}=i,a=ok(t.state.doc.resolve(s));if(!a)return-1;if("right"==n)return a.pos;const l=tk.get(a.node(-1)),c=a.start(-1),u=l.map.indexOf(a.pos-c);return u%l.width==0?-1:c+l.map[u-1]}function Yk(t,e,n){const r=e.clientX-t.startX;return Math.max(n,t.startWidth+r)}function Zk(t,e){t.dispatch(t.state.tr.setMeta(Jk,{setHandle:e}))}function Qk(t,e,n,r){const o=t.state.doc.resolve(e),i=o.node(-1),s=o.start(-1),a=tk.get(i).colCount(o.pos-s)+o.nodeAfter.attrs.colspan-1;let l=t.domAtPos(o.start(-1)).node;for(;l&&"TABLE"!=l.nodeName;)l=l.parentNode;l&&Wk(i,l.firstChild,l,r,a,n)}function Xk(t){return Array(t).fill(0)}function tx({allowTableNodeSelection:t=!1}={}){return new Me({key:rk,state:{init:()=>null,apply(t,e){const n=t.getMeta(rk);if(null!=n)return-1==n?null:n;if(null==e||!t.docChanged)return e;const{deleted:r,pos:o}=t.mapping.mapResult(e);return r?null:o}},props:{decorations:fk,handleDOMEvents:{mousedown:Hk},createSelectionBetween:t=>null!=rk.getState(t.state)?t.state.selection:null,handleTripleClick:Fk,handleKeyDown:Rk,handlePaste:zk},appendTransaction:(e,n,r)=>function(t,e,n){const r=(e||t).selection,o=(e||t).doc;let i,s;if(r instanceof fe&&(s=r.node.type.spec.tableRole)){if("cell"==s||"header_cell"==s)i=hk.create(o,r.from);else if("row"==s){const t=o.resolve(r.from+1);i=hk.rowSelection(t,t)}else if(!n){const t=tk.get(r.node),e=r.from+1,n=e+t.map[t.width*t.height-1];i=hk.create(o,e+1,n)}}else r instanceof he&&function({$from:t,$to:e}){if(t.pos==e.pos||t.pos<e.pos-6)return!1;let n=t.pos,r=e.pos,o=t.depth;for(;o>=0&&!(t.after(o+1)<t.end(o));o--,n++);for(let t=e.depth;t>=0&&!(e.before(t+1)>e.start(t));t--,r--);return n==r&&/row|table/.test(t.node(o).type.spec.tableRole)}(r)?i=he.create(o,r.from):r instanceof he&&function({$from:t,$to:e}){let n,r;for(let e=t.depth;e>0;e--){const r=t.node(e);if("cell"===r.type.spec.tableRole||"header_cell"===r.type.spec.tableRole){n=r;break}}for(let t=e.depth;t>0;t--){const n=e.node(t);if("cell"===n.type.spec.tableRole||"header_cell"===n.type.spec.tableRole){r=n;break}}return n!==r&&0===e.parentOffset}(r)&&(i=he.create(o,r.$from.start(),r.$from.end()));return i&&(e||(e=t.tr)).setSelection(i),e}(r,yk(r,n),t)})}var ex=Cl.create({name:"tableCell",addOptions:()=>({HTMLAttributes:{}}),content:"block+",addAttributes:()=>({colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth"),n=e?e.split(",").map(t=>parseInt(t,10)):null;if(!n){const e=t.closest("table")?.querySelectorAll("colgroup > col"),n=Array.from(t.parentElement?.children||[]).indexOf(t);if(n&&n>-1&&e&&e[n]){const t=e[n].getAttribute("width");return t?[parseInt(t,10)]:null}}return n}}}),tableRole:"cell",isolating:!0,parseHTML:()=>[{tag:"td"}],renderHTML({HTMLAttributes:t}){return["td",Qs(this.options.HTMLAttributes,t),0]}}),nx=Cl.create({name:"tableHeader",addOptions:()=>({HTMLAttributes:{}}),content:"block+",addAttributes:()=>({colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?e.split(",").map(t=>parseInt(t,10)):null}}}),tableRole:"header_cell",isolating:!0,parseHTML:()=>[{tag:"th"}],renderHTML({HTMLAttributes:t}){return["th",Qs(this.options.HTMLAttributes,t),0]}}),rx=Cl.create({name:"tableRow",addOptions:()=>({HTMLAttributes:{}}),content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML:()=>[{tag:"tr"}],renderHTML({HTMLAttributes:t}){return["tr",Qs(this.options.HTMLAttributes,t),0]}});function ox(t,e){return e?["width",`${Math.max(e,t)}px`]:["min-width",`${t}px`]}function ix(t,e,n,r,o,i){let s=0,a=!0,l=e.firstChild;const c=t.firstChild;if(null!==c)for(let t=0,n=0;t<c.childCount;t+=1){const{colspan:u,colwidth:d}=c.child(t).attrs;for(let t=0;t<u;t+=1,n+=1){const c=o===n?i:d&&d[t],u=c?`${c}px`:"";if(s+=c||r,c||(a=!1),l){if(l.style.width!==u){const[t,e]=ox(r,c);l.style.setProperty(t,e)}l=l.nextSibling}else{const t=document.createElement("col"),[n,o]=ox(r,c);t.style.setProperty(n,o),e.appendChild(t)}}}for(;l;){const t=l.nextSibling;l.parentNode?.removeChild(l),l=t}a?(n.style.width=`${s}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${s}px`)}var sx=class{constructor(t,e=25,n,r,o=!1){this.isDragging=!1,this.dragStartX=0,this.dragStartScrollLeft=0,this.rafId=null,this.node=t,this.cellMinWidth=e||25,this.view=n,this.getPos=r,this.customScrollbar=o,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.customScrollbar?this.setupCustomScrollbar():(this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),ix(t,this.colgroup,this.table,this.cellMinWidth),this.contentDOM=this.table.appendChild(document.createElement("tbody"))),this.captureColumnWidths()}setupCustomScrollbar(){this.scrollContainer=document.createElement("div"),this.scrollContainer.className="tableScrollContainer";const t=document.createElement("style");this.dom.appendChild(t),this.table=this.scrollContainer.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),ix(this.node,this.colgroup,this.table,this.cellMinWidth),this.contentDOM=this.table.appendChild(document.createElement("tbody")),this.dom.appendChild(this.scrollContainer),this.scrollbarTrack=document.createElement("div"),this.scrollbarTrack.className="customScrollbarTrack",this.scrollbarThumb=document.createElement("div"),this.scrollbarThumb.className="customScrollbarThumb",this.scrollbarThumb.addEventListener("mouseenter",()=>{!this.isDragging&&this.scrollbarThumb&&(this.scrollbarThumb.style.background="rgba(0, 0, 0, 0.5)")}),this.scrollbarThumb.addEventListener("mouseleave",()=>{!this.isDragging&&this.scrollbarThumb&&(this.scrollbarThumb.style.background="rgba(0, 0, 0, 0.3)")}),this.scrollbarTrack.appendChild(this.scrollbarThumb),this.dom.appendChild(this.scrollbarTrack),this.setupScrollbarEvents(),this.setupObservers(),this.updateScrollbar()}setupScrollbarEvents(){if(!this.scrollContainer||!this.scrollbarThumb||!this.scrollbarTrack)return;this.scrollContainer.addEventListener("wheel",t=>{if(!this.scrollContainer)return;if(this.table.scrollWidth<=this.scrollContainer.clientWidth)return;const e=Math.abs(t.deltaX),n=Math.abs(t.deltaY);if(!(e>n||t.shiftKey&&n>0))return;const r=this.scrollContainer.scrollLeft,o=this.scrollContainer.scrollWidth-this.scrollContainer.clientWidth;let i=t.deltaX;0===i&&t.shiftKey&&(i=t.deltaY),(i<0&&r>0||i>0&&r<o)&&(t.preventDefault(),null===this.rafId&&(this.rafId=requestAnimationFrame(()=>{if(!this.scrollContainer)return void(this.rafId=null);const t=Math.max(0,Math.min(o,r+i));this.scrollContainer.scrollLeft=t,this.updateScrollbarPosition(),this.rafId=null})))},{passive:!1});const t=t=>{if(!this.isDragging||!this.scrollContainer||!this.scrollbarTrack)return;t.preventDefault();const e=t.clientX-this.dragStartX,n=this.scrollbarTrack.clientWidth,r=this.scrollContainer.scrollWidth,o=this.scrollContainer.clientWidth,i=e*(r/n);this.scrollContainer.scrollLeft=Math.max(0,Math.min(r-o,this.dragStartScrollLeft+i)),this.updateScrollbarPosition()},e=()=>{this.isDragging=!1,this.scrollbarThumb&&(this.scrollbarThumb.style.cursor="grab",this.scrollbarThumb.style.background="rgba(0, 0, 0, 0.3)"),document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",e)};this.scrollbarThumb.addEventListener("mousedown",n=>{this.scrollContainer&&(n.preventDefault(),this.isDragging=!0,this.dragStartX=n.clientX,this.dragStartScrollLeft=this.scrollContainer.scrollLeft,this.scrollbarThumb&&(this.scrollbarThumb.style.cursor="grabbing",this.scrollbarThumb.style.background="rgba(0, 0, 0, 0.5)"),document.addEventListener("mousemove",t),document.addEventListener("mouseup",e))}),this.scrollbarTrack.addEventListener("click",t=>{if(!this.scrollContainer||!this.scrollbarTrack||!this.scrollbarThumb||t.target===this.scrollbarThumb)return;const e=this.scrollbarTrack.getBoundingClientRect(),n=t.clientX-e.left,r=this.scrollbarTrack.clientWidth,o=this.scrollbarThumb.clientWidth,i=Math.max(0,Math.min(r-o,n-o/2)),s=(this.scrollContainer.scrollWidth-this.scrollContainer.clientWidth)/(r-o);this.scrollContainer.scrollLeft=i*s,this.updateScrollbarPosition()})}setupObservers(){this.scrollContainer&&(this.resizeObserver=new ResizeObserver(()=>{this.updateScrollbar()}),this.resizeObserver.observe(this.scrollContainer),this.resizeObserver.observe(this.table),this.mutationObserver=new MutationObserver(()=>{null!==this.rafId&&cancelAnimationFrame(this.rafId),this.rafId=requestAnimationFrame(()=>{this.updateScrollbar(),this.rafId=null})}),this.mutationObserver.observe(this.table,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","class"]}))}updateScrollbar(){if(!this.scrollContainer||!this.scrollbarTrack||!this.scrollbarThumb)return;const t=this.scrollContainer.scrollWidth,e=this.scrollContainer.clientWidth;if(t>e){this.scrollbarTrack.style.display="block";const n=Math.max(30,e/t*this.scrollbarTrack.clientWidth);this.scrollbarThumb.style.width=`${n}px`,this.updateScrollbarPosition()}else this.scrollbarTrack.style.display="none",this.scrollContainer.scrollLeft=0}updateScrollbarPosition(){if(!this.scrollContainer||!this.scrollbarTrack||!this.scrollbarThumb)return;const t=this.scrollContainer.scrollLeft,e=this.scrollContainer.scrollWidth,n=this.scrollContainer.clientWidth,r=this.scrollbarTrack.clientWidth,o=this.scrollbarThumb.clientWidth,i=e-n,s=i>0?t/i*(r-o):0;this.scrollbarThumb.style.left=`${s}px`}captureColumnWidths(){this.view&&this.getPos&&requestAnimationFrame(()=>{if(!this.view||!this.getPos)return;if(void 0===this.getPos())return;const t=this.colgroup.querySelectorAll("col");t.forEach(t=>{t.style.width="",t.style.minWidth=""}),requestAnimationFrame(()=>{if(!this.view||!this.getPos)return;const e=this.getPos();if(void 0===e)return;const n=[];if(t.forEach(t=>{n.push(t.offsetWidth)}),0===n.length)return;const r=this.view.state.doc.nodeAt(e);if(!r||!r.firstChild)return;const o=[];r.forEach(t=>{const e=[];let r=0;t.forEach(t=>{const{colspan:o}=t.attrs,i=[];for(let t=0;t<o;t+=1)r+t<n.length&&i.push(n[r+t]);const s={...t.attrs,colwidth:i.length>0?i:t.attrs.colwidth},a=t.type.create(s,t.content,t.marks);e.push(a),r+=o});const i=t.type.create(t.attrs,e,t.marks);o.push(i)});const i=r.type.create(r.attrs,o,r.marks),s=this.view.state.tr.replaceWith(e,e+r.nodeSize,i);s.docChanged&&(this.view.dispatch(s),setTimeout(()=>{if(!this.view||!this.getPos)return;const t=this.getPos();if(void 0===t)return;const e=this.view.state.doc.nodeAt(t);e&&(this.node=e,ix(e,this.colgroup,this.table,this.cellMinWidth),this.customScrollbar&&this.updateScrollbar())},100))})})}update(t){return t.type===this.node.type&&(this.node=t,ix(t,this.colgroup,this.table,this.cellMinWidth),this.customScrollbar&&this.updateScrollbar(),!0)}ignoreMutation(t){const e=t.target,n=this.dom.contains(e),r=this.contentDOM.contains(e);return!(!n||r||"attributes"!==t.type&&"childList"!==t.type&&"characterData"!==t.type)}destroy(){null!==this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=void 0),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=void 0),this.scrollContainer=void 0,this.scrollbarTrack=void 0,this.scrollbarThumb=void 0}};function ax(t,e){return e?t.createChecked(null,e):t.createAndFill()}var lx=({editor:t})=>{const{selection:e}=t.state;if(!(e instanceof hk))return!1;let n=0;const r=Vs(e.ranges[0].$from,t=>"table"===t.type.name);return r?.node.descendants(t=>{if("table"===t.type.name)return!1;["tableCell","tableHeader"].includes(t.type.name)&&(n+=1)}),n===e.ranges.length&&(t.commands.deleteTable(),!0)},cx=Cl.create({name:"table",addOptions:()=>({HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:function(t,e,n,r){return new sx(t,e,n,r,!1)},lastColumnResizable:!0,allowTableNodeSelection:!1,customScrollbar:!1}),content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML:()=>[{tag:"table"}],renderHTML({node:t,HTMLAttributes:e}){const{colgroup:n,tableWidth:r,tableMinWidth:o}=function(t,e){let n=0,r=!0;const o=[],i=t.firstChild;if(!i)return{};for(let t=0,s=0;t<i.childCount;t+=1){const{colspan:a,colwidth:l}=i.child(t).attrs;for(let t=0;t<a;t+=1,s+=1){const i=undefined===s?undefined:l&&l[t];n+=i||e,i||(r=!1);const[a,c]=ox(e,i);o.push(["col",{style:`${a}: ${c}`}])}}const s=r?`${n}px`:"",a=r?"":`${n}px`;return{colgroup:["colgroup",{},...o],tableWidth:s,tableMinWidth:a}}(t,this.options.cellMinWidth);return["table",Qs(this.options.HTMLAttributes,e,{style:r?`width: ${r}`:`min-width: ${o}`}),n,["tbody",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.header){const r=[];t.header.forEach(t=>{r.push(e.createNode("tableHeader",{},[{type:"paragraph",content:e.parseInline(t.tokens)}]))}),n.push(e.createNode("tableRow",{},r))}return t.rows&&t.rows.forEach(t=>{const r=[];t.forEach(t=>{r.push(e.createNode("tableCell",{},[{type:"paragraph",content:e.parseInline(t.tokens)}]))}),n.push(e.createNode("tableRow",{},r))}),e.createNode("table",void 0,n)},renderMarkdown:(t,e)=>function(t,e,n={}){const r=n.cellLineSeparator??"";if(!t||!t.content||0===t.content.length)return"";const o=[];t.content.forEach(t=>{const n=[];t.content&&t.content.forEach(t=>{let o="";o=t.content&&Array.isArray(t.content)&&t.content.length>1?t.content.map(t=>e.renderChildren(t)).join(r):t.content?e.renderChildren(t.content):"";const i=(o||"").replace(/\s+/g," ").trim(),s="tableHeader"===t.type;n.push({text:i,isHeader:s})}),o.push(n)});const i=o.reduce((t,e)=>Math.max(t,e.length),0);if(0===i)return"";const s=new Array(i).fill(0);o.forEach(t=>{for(let e=0;e<i;e+=1){const n=(t[e]?.text||"").length;n>s[e]&&(s[e]=n),s[e]<3&&(s[e]=3)}});const a=(t,e)=>t+" ".repeat(Math.max(0,e-t.length)),l=o[0],c=l.some(t=>t.isHeader);let u="\n";const d=new Array(i).fill(0).map((t,e)=>c&&l[e]&&l[e].text||"");return u+=`| ${d.map((t,e)=>a(t,s[e])).join(" | ")} |\n`,u+=`| ${s.map(t=>"-".repeat(Math.max(3,t))).join(" | ")} |\n`,(c?o.slice(1):o).forEach(t=>{u+=`| ${new Array(i).fill(0).map((e,n)=>a(t[n]&&t[n].text||"",s[n])).join(" | ")} |\n`}),u}(t,e),addCommands:()=>({insertTable:({rows:t=3,cols:e=3,withHeaderRow:n=!0}={})=>({tr:r,dispatch:o,editor:i})=>{const s=function(t,e,n,r,o){const i=function(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;const e={};return Object.keys(t.nodes).forEach(n=>{const r=t.nodes[n];r.spec.tableRole&&(e[r.spec.tableRole]=r)}),t.cached.tableNodeTypes=e,e}(t),s=[],a=[];for(let t=0;t<n;t+=1){const t=ax(i.cell,o);if(t&&a.push(t),r){const t=ax(i.header_cell,o);t&&s.push(t)}}const l=[];for(let t=0;t<e;t+=1)l.push(i.row.createChecked(null,r&&0===t?s:a));return i.table.createChecked(null,l)}(i.schema,t,e,n);if(o){const t=r.selection.from+1;r.replaceSelectionWith(s).scrollIntoView().setSelection(he.near(r.doc.resolve(t)))}return!0},addColumnBefore:()=>({state:t,dispatch:e})=>function(t,e){if(!ik(t))return!1;if(e){const n=bk(t);e(vk(t.tr,n,n.left))}return!0}(t,e),addColumnAfter:()=>({state:t,dispatch:e})=>function(t,e){if(!ik(t))return!1;if(e){const n=bk(t);e(vk(t.tr,n,n.right))}return!0}(t,e),deleteColumn:()=>({state:t,dispatch:e})=>function(t,e){if(!ik(t))return!1;if(e){const n=bk(t),r=t.tr;if(0==n.left&&n.right==n.map.width)return!1;for(let t=n.right-1;wk(r,n,t),t!=n.left;t--){const t=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!t)throw RangeError("No table found");n.table=t,n.map=tk.get(t)}e(r)}return!0}(t,e),addRowBefore:()=>({state:t,dispatch:e})=>function(t,e){if(!ik(t))return!1;if(e){const n=bk(t);e(Ak(t.tr,n,n.top))}return!0}(t,e),addRowAfter:()=>({state:t,dispatch:e})=>function(t,e){if(!ik(t))return!1;if(e){const n=bk(t);e(Ak(t.tr,n,n.bottom))}return!0}(t,e),deleteRow:()=>({state:t,dispatch:e})=>function(t,e){if(!ik(t))return!1;if(e){const n=bk(t),r=t.tr;if(0==n.top&&n.bottom==n.map.height)return!1;for(let t=n.bottom-1;kk(r,n,t),t!=n.top;t--){const t=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!t)throw RangeError("No table found");n.table=t,n.map=tk.get(n.table)}e(r)}return!0}(t,e),deleteTable:()=>({state:t,dispatch:e})=>function(t,e){const n=t.selection.$anchor;for(let r=n.depth;r>0;r--)if("table"==n.node(r).type.spec.tableRole)return e&&e(t.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0;return!1}(t,e),mergeCells:()=>({state:t,dispatch:e})=>Ck(t,e),splitCell:()=>({state:t,dispatch:e})=>Sk(t,e),toggleHeaderColumn:()=>({state:t,dispatch:e})=>Mk("column")(t,e),toggleHeaderRow:()=>({state:t,dispatch:e})=>Mk("row")(t,e),toggleHeaderCell:()=>({state:t,dispatch:e})=>_k(t,e),mergeOrSplit:()=>({state:t,dispatch:e})=>!!Ck(t,e)||Sk(t,e),setCellAttribute:(t,e)=>({state:n,dispatch:r})=>function(t,e){return function(n,r){if(!ik(n))return!1;const o=sk(n);if(o.nodeAfter.attrs[t]===e)return!1;if(r){const i=n.tr;n.selection instanceof hk?n.selection.forEachCell((n,r)=>{n.attrs[t]!==e&&i.setNodeMarkup(r,null,{...n.attrs,[t]:e})}):i.setNodeMarkup(o.pos,null,{...o.nodeAfter.attrs,[t]:e}),r(i)}return!0}}(t,e)(n,r),goToNextCell:()=>({state:t,dispatch:e})=>Tk(1)(t,e),goToPreviousCell:()=>({state:t,dispatch:e})=>Tk(-1)(t,e),fixTables:()=>({state:t,dispatch:e})=>(e&&yk(t),!0),setCellSelection:t=>({tr:e,dispatch:n})=>{if(n){const n=hk.create(e.doc,t.anchorCell,t.headCell);e.setSelection(n)}return!0}}),addKeyboardShortcuts(){return{Tab:()=>!!this.editor.commands.goToNextCell()||!!this.editor.can().addRowAfter()&&this.editor.chain().addRowAfter().goToNextCell().run(),"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:lx,"Mod-Backspace":lx,Delete:lx,"Mod-Delete":lx}},addNodeView(){const t=this.options.customScrollbar,e=this.options.cellMinWidth;if(!this.options.resizable||!this.editor.isEditable)return({node:n,view:r,getPos:o})=>new sx(n,e,r,"function"==typeof o?o:void 0,t)},addProseMirrorPlugins(){const t=this.options.resizable&&this.editor.isEditable,e=this.options.customScrollbar,n=this.options.cellMinWidth,r=class extends sx{constructor(t,r,o,i){super(t,n,o,i,e)}};t&&(this.options.View=r);const o=t?function({handleWidth:t=5,cellMinWidth:e=25,defaultCellMinWidth:n=100,View:r=Uk,lastColumnResizable:o=!0}={}){const i=new Me({key:Jk,state:{init(t,e){var o,s;const a=null==(s=null==(o=i.spec)?void 0:o.props)?void 0:s.nodeViews,l=nk(e.schema).table.name;return r&&a&&(a[l]=(t,e)=>new r(t,n,e)),new Kk(-1,!1)},apply:(t,e)=>e.apply(t)},props:{attributes:t=>{const e=Jk.getState(t);return e&&e.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(e,n)=>{!function(t,e,n,r){if(!t.editable)return;const o=Jk.getState(t.state);if(o&&!o.dragging){const i=function(t){for(;t&&"TD"!=t.nodeName&&"TH"!=t.nodeName;)t=t.classList&&t.classList.contains("ProseMirror")?null:t.parentNode;return t}(e.target);let s=-1;if(i){const{left:r,right:o}=i.getBoundingClientRect();e.clientX-r<=n?s=Gk(t,e,"left",n):o-e.clientX<=n&&(s=Gk(t,e,"right",n))}if(s!=o.activeHandle){if(!r&&-1!==s){const e=t.state.doc.resolve(s),n=e.node(-1),r=tk.get(n),o=e.start(-1);if(r.colCount(e.pos-o)+e.nodeAfter.attrs.colspan-1==r.width-1)return}Zk(t,s)}}}(e,n,t,o)},mouseleave:t=>{!function(t){if(!t.editable)return;const e=Jk.getState(t.state);e&&e.activeHandle>-1&&!e.dragging&&Zk(t,-1)}(t)},mousedown:(t,r)=>{!function(t,e,n,r){var o;if(!t.editable)return!1;const i=null!=(o=t.dom.ownerDocument.defaultView)?o:window,s=Jk.getState(t.state);if(!s||-1==s.activeHandle||s.dragging)return!1;const a=t.state.doc.nodeAt(s.activeHandle),l=function(t,e,{colspan:n,colwidth:r}){const o=r&&r[r.length-1];if(o)return o;const i=t.domAtPos(e);let s=i.node.childNodes[i.offset].offsetWidth,a=n;if(r)for(let t=0;t<n;t++)r[t]&&(s-=r[t],a--);return s/a}(t,s.activeHandle,a.attrs);function c(e){i.removeEventListener("mouseup",c),i.removeEventListener("mousemove",u);const r=Jk.getState(t.state);(null==r?void 0:r.dragging)&&(function(t,e,n){const r=t.state.doc.resolve(e),o=r.node(-1),i=tk.get(o),s=r.start(-1),a=i.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1,l=t.state.tr;for(let t=0;t<i.height;t++){const e=t*i.width+a;if(t&&i.map[e]==i.map[e-i.width])continue;const r=i.map[e],c=o.nodeAt(r).attrs,u=1==c.colspan?0:a-i.colCount(r);if(c.colwidth&&c.colwidth[u]==n)continue;const d=c.colwidth?c.colwidth.slice():Xk(c.colspan);d[u]=n,l.setNodeMarkup(s+r,null,{...c,colwidth:d})}l.docChanged&&t.dispatch(l)}(t,r.activeHandle,Yk(r.dragging,e,n)),t.dispatch(t.state.tr.setMeta(Jk,{setDragging:null})))}function u(e){if(!e.which)return c(e);const o=Jk.getState(t.state);if(o&&o.dragging){const i=Yk(o.dragging,e,n);Qk(t,o.activeHandle,i,r)}}t.dispatch(t.state.tr.setMeta(Jk,{setDragging:{startX:e.clientX,startWidth:l}})),Qk(t,s.activeHandle,l,r),i.addEventListener("mouseup",c),i.addEventListener("mousemove",u),e.preventDefault()}(t,r,e,n)}},decorations:t=>{const e=Jk.getState(t);if(e&&e.activeHandle>-1)return function(t,e){var n;const r=[],o=t.doc.resolve(e),i=o.node(-1);if(!i)return Ho.empty;const s=tk.get(i),a=o.start(-1),l=s.colCount(o.pos-a)+o.nodeAfter.attrs.colspan-1;for(let e=0;e<s.height;e++){const o=l+e*s.width;if(!(l!=s.width-1&&s.map[o]==s.map[o+1]||0!=e&&s.map[o]==s.map[o-s.width])){const e=s.map[o],l=a+e+i.nodeAt(e).nodeSize-1,c=document.createElement("div");c.className="column-resize-handle",(null==(n=Jk.getState(t))?void 0:n.dragging)&&r.push(Po.node(a+e,a+e+i.nodeAt(e).nodeSize,{class:"column-resize-dragging"})),r.push(Po.widget(l,c))}}return Ho.create(t.doc,r)}(t,e.activeHandle)},nodeViews:{}}});return i}({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:r,lastColumnResizable:this.options.lastColumnResizable}):null;return[...t&&o?[o]:[],tx({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema:t=>({tableRole:Gs(Us(t,"tableRole",{name:t.name,options:t.options,storage:t.storage}))})});Za.create({name:"tableKit",addExtensions(){const t=[];return!1!==this.options.table&&t.push(cx.configure(this.options.table)),!1!==this.options.tableCell&&t.push(ex.configure(this.options.tableCell)),!1!==this.options.tableHeader&&t.push(nx.configure(this.options.tableHeader)),!1!==this.options.tableRow&&t.push(rx.configure(this.options.tableRow)),t}});const ux=new De("tableCellIndex"),dx=new De("tableRowIndex"),hx=ex.extend({addAttributes(){var t;return{...null===(t=this.parent)||void 0===t?void 0:t.call(this),cellIndex:{default:null,parseHTML:t=>t.getAttribute("data-cell-index"),renderHTML:t=>null==t.cellIndex?{}:{"data-cell-index":t.cellIndex}}}},addProseMirrorPlugins:()=>[new Me({key:ux,appendTransaction:(t,e,n)=>{const r=n.tr;let o=!1;try{n.doc.descendants((t,e)=>{if("tableCell"===t.type.name||"tableHeader"===t.type.name){const i=function(t,e){const n=e.doc.resolve(t);let r=0;for(let e=n.depth;e>0;e--)if("tableRow"===n.node(e).type.name){const o=n.node(e);let i=n.start(e)+1;o.forEach((e,n)=>{i+n<t&&("tableCell"!==e.type.name&&"tableHeader"!==e.type.name||r++)});break}return r}(e,n);t.attrs.cellIndex!==i&&(r.setNodeMarkup(e,null,{...t.attrs,cellIndex:i}),o=!0)}})}catch(t){console.error("[tableCellIndexPlugin] Error:",t)}return o?r:null}})]}),px=nx.extend({addAttributes(){var t;return{...null===(t=this.parent)||void 0===t?void 0:t.call(this),cellIndex:{default:null,parseHTML:t=>t.getAttribute("data-cell-index"),renderHTML:t=>null==t.cellIndex?{}:{"data-cell-index":t.cellIndex}}}}}),fx=rx.extend({addAttributes(){var t;return{...null===(t=this.parent)||void 0===t?void 0:t.call(this),rowIndex:{default:null,parseHTML:t=>t.getAttribute("data-row-index"),renderHTML:t=>null==t.rowIndex?{}:{"data-row-index":t.rowIndex}}}},addProseMirrorPlugins:()=>[new Me({key:dx,appendTransaction:(t,e,n)=>{const r=n.tr;let o=!1;try{n.doc.descendants((t,e)=>{if("tableRow"===t.type.name){const i=function(t,e){const n=e.doc.resolve(t);let r=0;for(let e=n.depth;e>0;e--)if("table"===n.node(e).type.name){const o=n.node(e);let i=n.start(e)+1;o.forEach((e,n)=>{i+n<t&&"tableRow"===e.type.name&&r++});break}return r}(e,n);t.attrs.rowIndex!==i&&(r.setNodeMarkup(e,null,{...t.attrs,rowIndex:i}),o=!0)}})}catch(t){console.error("[tableRowIndexPlugin] Error:",t)}return o?r:null}})]});class gx extends sx{constructor(t,e,n,r,o){super(t,e,n,r,o),this.applyAttributes(t.attrs)}applyAttributes(t){if(t)for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&null!=t[e]&&("hookId"===e?this.table.setAttribute("id",t[e]):this.table.setAttribute(e,t[e]))}update(t){const e=super.update(t);return e&&this.applyAttributes(t.attrs),e}}const mx=cx.extend({addNodeView(){const t=this.options.customScrollbar;return e=>{let{node:n,cellMinWidth:r,view:o,getPos:i}=e;return new gx(n,r,o,i,t)}}});function yx(t,e,n,r,o){const i=r.appendIfNotEmpty&&!function(t){for(var e=0;e<t.content.childCount;e++)if(t.content.child(e).textContent.length>0)return!1;return!0}(t.state.doc),s=r.fromImport||!1,a=function(t,e){return na(oa(t),e)}([sg,...i?[Nx]:[],...bx(o)]),l=vx(function(t){let{text:e,type:n,options:r,contentOptions:o,schema:i,titleType:s,isSchemaWithTitle:a=!1,fromContentImport:l=!1}=t,c=function(t,e){if("text/html"===e)return t;if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){const e=Ib({html:!0,breaks:!0,linkify:!0}).render(t);if(e!==t)return e}return t.split("\n").map(t=>`<p>${t}</p>`).join("")}(e,n,r.parseMarkdown||!1);(c.match(/<\/[^>]*>/g)||[]).length>1&&(c+="<p><br></p>");const u=cs(function(t){let e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).enableTables?{}:{table:"div",tr:"div",td:"span",th:"span",tbody:"div",thead:"div",tfoot:"div"};return Object.keys(n).forEach(e=>{const r=n[e];"td"===e&&(t=(t=t.replace(new RegExp(`<${e}([^<]*)>(s)*</${e}>`,"gi"),"")).replace(new RegExp(`<${e}([^<]*)</${e}>( *)<${e}`,"gi"),`<${e}$1</${e}><${r}> | </${r}><${e}`)),t=function(t,e,n){return(t=t.replace(new RegExp(`<${e}`,"g"),`<${n}`)).replace(new RegExp(`</${e}>`,"g"),`</${n}>`)}(t,e,r)}),e&&(t=t.replace(/<p>(\s*)<strong>/gi,(e,n,r)=>{const o=t.substring(0,r).trim();return""===o||/<p>\s*<\/p>\s*$/.test(o)?e:"<p></p><p><strong>"})),t}(c,o,l));let d=r.forceUpgradeToTitle||!1;u.firstChild&&"function"==typeof u.firstChild.getAttribute&&"title"===u.firstChild.getAttribute("name")&&(d=!0);const h=nt.fromSchema(i).parse(u),p=h.content.firstChild;r.downgradeFromHeading&&function(t,e){return!(!t||"heading"!==t.type.name||1!==e.content.childCount&&function(t){var e=!1;return t.content.forEach(t=>{e|="paragraph"===t.type.name&&""!==t.textContent}),e}(e))}(p,h)&&(p.attrs={},p.type=i.nodes.paragraph);(r.upgradeToTitle||d)&&function(t,e){if(!t)return!1;if(!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])){if("heading"!==t.type.name)return!1;if(function(t,e){var n=!1;return t.content.forEach(t=>{n|=t!==e&&"heading"===t.type.name&&t.attrs.level<=e.attrs.level}),n}(e,t))return!1;if(!function(t,e){var n=!1;return t.content.forEach(t=>{n|=t!==e&&"heading"!==t.type.name&&Boolean(t.textContent)}),n}(e,t))return!1}const n=t.textContent;return!(n.length>100||n.includes("\n"))}(p,h,d)&&(p.attrs={},p.type=s);return!a||p&&"title"===p.type.name||(h.content=h.content.addToStart(s.create())),h.toJSON()}({text:e,type:n,titleType:t.schema.nodes.title,options:r,contentOptions:o,schema:a,isSchemaWithTitle:i,fromContentImport:s}),r);i?t.chain().insertContent(l).run():t.chain().setContent(l).run()}function bx(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=[jA.configure({placeholder:""}),VA,Bb,uA,Ub,Gb,Xb,Zb,jb,ov,ZA,TA,av,lv,sA.configure({defaultProtocol:"https",openOnClick:!1,HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow"}}),qA.configure({oneHalf:!1,oneQuarter:!1,threeQuarters:!1,servicemark:!1,plusMinus:!1,notEqual:!1}),zA.configure({types:!0===t.enableRightToLeft?["blockquote","bulletList","codeBlock","heading","orderedList","paragraph","title"]:[]})];return!0===t.enableTables&&(e.push(mx.configure({resizable:!0,customScrollbar:!0})),e.push(fx),e.push(px),e.push(hx)),e}function vx(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.disableLinks||!1;if(t.marks&&(t.marks=t.marks.filter(t=>{if("link"===t.type){if(n)return console.debug("[normalizeJsonContent] Removing link mark:",t.attrs.href),!1;if("string"!=typeof t.attrs.href)return console.debug("[normalizeJsonContent] Removing link mark with invalid href:",t.attrs.href),!1}return!0})),"title"===t.type)try{t.content=t.content.filter(t=>"text"===t.type)}catch(t){console.error("normalizeJsonContent - title",t)}if(t.content)for(let n=0;n<t.content.length;n++)t.content[n]=vx(t.content[n],e);return t}function wx(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{for(const e of Ax.rules)for(const n of e.conversion)t=t.replaceAll(n.source,n.target)}catch(e){console.error("Error in normalizeText: ",e,t)}return t}const Ax={rules:[{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:""},{target:"1",source:""},{target:"2",source:""},{target:"3",source:""},{target:"4",source:""},{target:"5",source:""},{target:"6",source:""},{target:"7",source:""},{target:"8",source:""},{target:"9",source:""},{target:"!",source:""},{target:"?",source:""},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"serif-bold"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:"0"},{target:"1",source:"1"},{target:"2",source:"2"},{target:"3",source:"3"},{target:"4",source:"4"},{target:"5",source:"5"},{target:"6",source:"6"},{target:"7",source:"7"},{target:"8",source:"8"},{target:"9",source:"9"},{target:"!",source:"!"},{target:"?",source:"?"},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"serif-italic"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:""},{target:"1",source:""},{target:"2",source:""},{target:"3",source:""},{target:"4",source:""},{target:"5",source:""},{target:"6",source:""},{target:"7",source:""},{target:"8",source:""},{target:"9",source:""},{target:"!",source:""},{target:"?",source:""},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"serif-bold-italic"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:""},{target:"1",source:""},{target:"2",source:""},{target:"3",source:""},{target:"4",source:""},{target:"5",source:""},{target:"6",source:""},{target:"7",source:""},{target:"8",source:""},{target:"9",source:""},{target:"!",source:"!"},{target:"?",source:"?"},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"sans"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:""},{target:"1",source:""},{target:"2",source:""},{target:"3",source:""},{target:"4",source:""},{target:"5",source:""},{target:"6",source:""},{target:"7",source:""},{target:"8",source:""},{target:"9",source:""},{target:"!",source:""},{target:"?",source:""},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"sans-bold"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:"0"},{target:"1",source:"1"},{target:"2",source:"2"},{target:"3",source:"3"},{target:"4",source:"4"},{target:"5",source:"5"},{target:"6",source:"6"},{target:"7",source:"7"},{target:"8",source:"8"},{target:"9",source:"9"},{target:"!",source:"!"},{target:"?",source:"?"},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"sans-italic"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:""},{target:"1",source:""},{target:"2",source:""},{target:"3",source:""},{target:"4",source:""},{target:"5",source:""},{target:"6",source:""},{target:"7",source:""},{target:"8",source:""},{target:"9",source:""},{target:"!",source:""},{target:"?",source:""},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"sans-bold-italic"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:"0"},{target:"1",source:"1"},{target:"2",source:"2"},{target:"3",source:"3"},{target:"4",source:"4"},{target:"5",source:"5"},{target:"6",source:"6"},{target:"7",source:"7"},{target:"8",source:"8"},{target:"9",source:"9"},{target:"!",source:"!"},{target:"?",source:"?"},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"script"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:""},{target:"1",source:""},{target:"2",source:""},{target:"3",source:""},{target:"4",source:""},{target:"5",source:""},{target:"6",source:""},{target:"7",source:""},{target:"8",source:""},{target:"9",source:""},{target:"!",source:""},{target:"?",source:""},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"script-bold"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:"0"},{target:"1",source:"1"},{target:"2",source:"2"},{target:"3",source:"3"},{target:"4",source:"4"},{target:"5",source:"5"},{target:"6",source:"6"},{target:"7",source:"7"},{target:"8",source:"8"},{target:"9",source:"9"},{target:"!",source:"!"},{target:"?",source:"?"},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"fraktur"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:""},{target:"1",source:""},{target:"2",source:""},{target:"3",source:""},{target:"4",source:""},{target:"5",source:""},{target:"6",source:""},{target:"7",source:""},{target:"8",source:""},{target:"9",source:""},{target:"!",source:""},{target:"?",source:""},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"fraktur-bold"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:""},{target:"1",source:""},{target:"2",source:""},{target:"3",source:""},{target:"4",source:""},{target:"5",source:""},{target:"6",source:""},{target:"7",source:""},{target:"8",source:""},{target:"9",source:""},{target:"!",source:""},{target:"?",source:""},{target:".",source:""},{target:",",source:""},{target:'"',source:""},{target:"'",source:""}],_name:"monospace"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:""},{target:"1",source:""},{target:"2",source:""},{target:"3",source:""},{target:"4",source:""},{target:"5",source:""},{target:"6",source:""},{target:"7",source:""},{target:"8",source:""},{target:"9",source:""},{target:"!",source:""},{target:"?",source:""},{target:".",source:""},{target:",",source:""},{target:'"',source:""},{target:"'",source:""}],_name:"fullwidth"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:""},{target:"1",source:""},{target:"2",source:""},{target:"3",source:""},{target:"4",source:""},{target:"5",source:""},{target:"6",source:""},{target:"7",source:""},{target:"8",source:""},{target:"9",source:""},{target:"!",source:""},{target:"?",source:""},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"doublestruck"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:"q"},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:"x"},{target:"y",source:""},{target:"z",source:""},{target:"A",source:"A"},{target:"B",source:"B"},{target:"C",source:"C"},{target:"D",source:"D"},{target:"E",source:"E"},{target:"F",source:"F"},{target:"G",source:"G"},{target:"H",source:"H"},{target:"I",source:"I"},{target:"J",source:"J"},{target:"K",source:"K"},{target:"L",source:"L"},{target:"M",source:"M"},{target:"N",source:"N"},{target:"O",source:"O"},{target:"P",source:"P"},{target:"Q",source:"Q"},{target:"R",source:"R"},{target:"S",source:"S"},{target:"T",source:"T"},{target:"U",source:"U"},{target:"V",source:"V"},{target:"W",source:"W"},{target:"X",source:"X"},{target:"Y",source:"Y"},{target:"Z",source:"Z"},{target:"0",source:"0"},{target:"1",source:"1"},{target:"2",source:"2"},{target:"3",source:"3"},{target:"4",source:"4"},{target:"5",source:"5"},{target:"6",source:"6"},{target:"7",source:"7"},{target:"8",source:"8"},{target:"9",source:"9"},{target:"!",source:""},{target:"?",source:""},{target:".",source:""},{target:",",source:""},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"capitalized"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:""},{target:"1",source:""},{target:"2",source:""},{target:"3",source:""},{target:"4",source:""},{target:"5",source:""},{target:"6",source:""},{target:"7",source:""},{target:"8",source:""},{target:"9",source:""},{target:"!",source:"!"},{target:"?",source:"?"},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"circled"},{conversion:[{target:"a",source:""},{target:"b",source:""},{target:"c",source:""},{target:"d",source:""},{target:"e",source:""},{target:"f",source:""},{target:"g",source:""},{target:"h",source:""},{target:"i",source:""},{target:"j",source:""},{target:"k",source:""},{target:"l",source:""},{target:"m",source:""},{target:"n",source:""},{target:"o",source:""},{target:"p",source:""},{target:"q",source:""},{target:"r",source:""},{target:"s",source:""},{target:"t",source:""},{target:"u",source:""},{target:"v",source:""},{target:"w",source:""},{target:"x",source:""},{target:"y",source:""},{target:"z",source:""},{target:"A",source:""},{target:"B",source:""},{target:"C",source:""},{target:"D",source:""},{target:"E",source:""},{target:"F",source:""},{target:"G",source:""},{target:"H",source:""},{target:"I",source:""},{target:"J",source:""},{target:"K",source:""},{target:"L",source:""},{target:"M",source:""},{target:"N",source:""},{target:"O",source:""},{target:"P",source:""},{target:"Q",source:""},{target:"R",source:""},{target:"S",source:""},{target:"T",source:""},{target:"U",source:""},{target:"V",source:""},{target:"W",source:""},{target:"X",source:""},{target:"Y",source:""},{target:"Z",source:""},{target:"0",source:""},{target:"1",source:""},{target:"2",source:""},{target:"3",source:""},{target:"4",source:""},{target:"5",source:""},{target:"6",source:""},{target:"7",source:""},{target:"8",source:""},{target:"9",source:""},{target:"!",source:"!"},{target:"?",source:"?"},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"parenthesized"},{conversion:[{target:"a",source:"a"},{target:"b",source:"b"},{target:"c",source:"c"},{target:"d",source:"d"},{target:"e",source:"e"},{target:"f",source:"f"},{target:"g",source:"g"},{target:"h",source:"h"},{target:"i",source:"i"},{target:"j",source:"j"},{target:"k",source:"k"},{target:"l",source:"l"},{target:"m",source:"m"},{target:"n",source:"n"},{target:"o",source:"o"},{target:"p",source:"p"},{target:"q",source:"q"},{target:"r",source:"r"},{target:"s",source:"s"},{target:"t",source:"t"},{target:"u",source:"u"},{target:"v",source:"v"},{target:"w",source:"w"},{target:"x",source:"x"},{target:"y",source:"y"},{target:"z",source:"z"},{target:"A",source:"A"},{target:"B",source:"B"},{target:"C",source:"C"},{target:"D",source:"D"},{target:"E",source:"E"},{target:"F",source:"F"},{target:"G",source:"G"},{target:"H",source:"H"},{target:"I",source:"I"},{target:"J",source:"J"},{target:"K",source:"K"},{target:"L",source:"L"},{target:"M",source:"M"},{target:"N",source:"N"},{target:"O",source:"O"},{target:"P",source:"P"},{target:"Q",source:"Q"},{target:"R",source:"R"},{target:"S",source:"S"},{target:"T",source:"T"},{target:"U",source:"U"},{target:"V",source:"V"},{target:"W",source:"W"},{target:"X",source:"X"},{target:"Y",source:"Y"},{target:"Z",source:"Z"},{target:"0",source:"0"},{target:"1",source:"1"},{target:"2",source:"2"},{target:"3",source:"3"},{target:"4",source:"4"},{target:"5",source:"5"},{target:"6",source:"6"},{target:"7",source:"7"},{target:"8",source:"8"},{target:"9",source:"9"},{target:"!",source:"!"},{target:"?",source:"?"},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"underlined-single"},{conversion:[{target:"a",source:"a"},{target:"b",source:"b"},{target:"c",source:"c"},{target:"d",source:"d"},{target:"e",source:"e"},{target:"f",source:"f"},{target:"g",source:"g"},{target:"h",source:"h"},{target:"i",source:"i"},{target:"j",source:"j"},{target:"k",source:"k"},{target:"l",source:"l"},{target:"m",source:"m"},{target:"n",source:"n"},{target:"o",source:"o"},{target:"p",source:"p"},{target:"q",source:"q"},{target:"r",source:"r"},{target:"s",source:"s"},{target:"t",source:"t"},{target:"u",source:"u"},{target:"v",source:"v"},{target:"w",source:"w"},{target:"x",source:"x"},{target:"y",source:"y"},{target:"z",source:"z"},{target:"A",source:"A"},{target:"B",source:"B"},{target:"C",source:"C"},{target:"D",source:"D"},{target:"E",source:"E"},{target:"F",source:"F"},{target:"G",source:"G"},{target:"H",source:"H"},{target:"I",source:"I"},{target:"J",source:"J"},{target:"K",source:"K"},{target:"L",source:"L"},{target:"M",source:"M"},{target:"N",source:"N"},{target:"O",source:"O"},{target:"P",source:"P"},{target:"Q",source:"Q"},{target:"R",source:"R"},{target:"S",source:"S"},{target:"T",source:"T"},{target:"U",source:"U"},{target:"V",source:"V"},{target:"W",source:"W"},{target:"X",source:"X"},{target:"Y",source:"Y"},{target:"Z",source:"Z"},{target:"0",source:"0"},{target:"1",source:"1"},{target:"2",source:"2"},{target:"3",source:"3"},{target:"4",source:"4"},{target:"5",source:"5"},{target:"6",source:"6"},{target:"7",source:"7"},{target:"8",source:"8"},{target:"9",source:"9"},{target:"!",source:"!"},{target:"?",source:"?"},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"underlined-double"},{conversion:[{target:"a",source:"a"},{target:"b",source:"b"},{target:"c",source:"c"},{target:"d",source:"d"},{target:"e",source:"e"},{target:"f",source:"f"},{target:"g",source:"g"},{target:"h",source:"h"},{target:"i",source:"i"},{target:"j",source:"j"},{target:"k",source:"k"},{target:"l",source:"l"},{target:"m",source:"m"},{target:"n",source:"n"},{target:"o",source:"o"},{target:"p",source:"p"},{target:"q",source:"q"},{target:"r",source:"r"},{target:"s",source:"s"},{target:"t",source:"t"},{target:"u",source:"u"},{target:"v",source:"v"},{target:"w",source:"w"},{target:"x",source:"x"},{target:"y",source:"y"},{target:"z",source:"z"},{target:"A",source:"A"},{target:"B",source:"B"},{target:"C",source:"C"},{target:"D",source:"D"},{target:"E",source:"E"},{target:"F",source:"F"},{target:"G",source:"G"},{target:"H",source:"H"},{target:"I",source:"I"},{target:"J",source:"J"},{target:"K",source:"K"},{target:"L",source:"L"},{target:"M",source:"M"},{target:"N",source:"N"},{target:"O",source:"O"},{target:"P",source:"P"},{target:"Q",source:"Q"},{target:"R",source:"R"},{target:"S",source:"S"},{target:"T",source:"T"},{target:"U",source:"U"},{target:"V",source:"V"},{target:"W",source:"W"},{target:"X",source:"X"},{target:"Y",source:"Y"},{target:"Z",source:"Z"},{target:"0",source:"0"},{target:"1",source:"1"},{target:"2",source:"2"},{target:"3",source:"3"},{target:"4",source:"4"},{target:"5",source:"5"},{target:"6",source:"6"},{target:"7",source:"7"},{target:"8",source:"8"},{target:"9",source:"9"},{target:"!",source:"!"},{target:"?",source:"?"},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"strikethrough-single"},{conversion:[{target:"a",source:"a"},{target:"b",source:"b"},{target:"c",source:"c"},{target:"d",source:"d"},{target:"e",source:"e"},{target:"f",source:"f"},{target:"g",source:"g"},{target:"h",source:"h"},{target:"i",source:"i"},{target:"j",source:"j"},{target:"k",source:"k"},{target:"l",source:"l"},{target:"m",source:"m"},{target:"n",source:"n"},{target:"o",source:"o"},{target:"p",source:"p"},{target:"q",source:"q"},{target:"r",source:"r"},{target:"s",source:"s"},{target:"t",source:"t"},{target:"u",source:"u"},{target:"v",source:"v"},{target:"w",source:"w"},{target:"x",source:"x"},{target:"y",source:"y"},{target:"z",source:"z"},{target:"A",source:"A"},{target:"B",source:"B"},{target:"C",source:"C"},{target:"D",source:"D"},{target:"E",source:"E"},{target:"F",source:"F"},{target:"G",source:"G"},{target:"H",source:"H"},{target:"I",source:"I"},{target:"J",source:"J"},{target:"K",source:"K"},{target:"L",source:"L"},{target:"M",source:"M"},{target:"N",source:"N"},{target:"O",source:"O"},{target:"P",source:"P"},{target:"Q",source:"Q"},{target:"R",source:"R"},{target:"S",source:"S"},{target:"T",source:"T"},{target:"U",source:"U"},{target:"V",source:"V"},{target:"W",source:"W"},{target:"X",source:"X"},{target:"Y",source:"Y"},{target:"Z",source:"Z"},{target:"0",source:"0"},{target:"1",source:"1"},{target:"2",source:"2"},{target:"3",source:"3"},{target:"4",source:"4"},{target:"5",source:"5"},{target:"6",source:"6"},{target:"7",source:"7"},{target:"8",source:"8"},{target:"9",source:"9"},{target:"!",source:"!"},{target:"?",source:"?"},{target:".",source:"."},{target:",",source:","},{target:'"',source:'"'},{target:"'",source:"'"}],_name:"crosshatch"}]};function kx(t){return wx(t)}function xx(t){return wx(t)}const Cx={kind:"string",type:"application/json+napkin.ai/text-web-lib",key:"ignoreClipboardData",value:!0};function Sx(t){return!!(t&&t.type&&t.type.name)&&("image"===t.type.name?(console.debug("[shouldIgnorePasteFromNode] ignoring paste: image found"),!0):!(!t.attrs||!t.attrs.src)&&(0===t.attrs.src.indexOf("data:image/png;base64")?(console.debug("[shouldIgnorePasteFromNode] ignoring paste: graph item found"),!0):0===t.attrs.indexOf("data:image/svg+xml")&&(console.debug("[shouldIgnorePasteFromNode] ignoring paste: svg found"),!0)))}function Ex(t){if(!t||!t.items)return!1;if(t.types.includes("application/napkin+json"))return console.log("[shouldIgnorePasteFromEvent] skip paste: application/napkin+json found"),!0;for(var e=!1,n=0;n<t.items.length;n++){const r=t.items[n];if(r&&r.type)if("image/png"!==r.type)if("image/svg+xml"!==r.type){if("text/plain"===r.type&&"string"===r.kind){const e=t.getData("text/plain");if(e&&0===e.indexOf("<svg")){console.log("[shouldIgnorePasteFromEvent] ignoring paste: svg tag found in text/plain");continue}if(e&&e.indexOf('<?xml version="1.0" encoding="UTF-8"?><svg')>0){console.log("[shouldIgnorePasteFromEvent] ignoring paste: svg as xml found in text/plain");continue}}0===r.type.indexOf("text/")&&(e=!0)}else console.log("[shouldIgnorePasteFromEvent] ignoring paste: image/svg+xml found");else console.log("[shouldIgnorePasteFromEvent] ignoring paste: image/png found")}return!1===e}const Mx=new De("clipboard"),_x=t=>{const e=t.onPasteHandler,n=t.onTablePasteHandler;return new Me({key:Mx,props:{handlePaste(t,r,o){const i=((t,r,o)=>{console.debug("[handlePasteEvent] event",r);try{if(!r.clipboardData)return console.debug("[handlePasteEvent] ignoring paste: no clipboard data"),!0;if(Ex(r.clipboardData))return console.debug("[handlePasteEvent] ignoring paste: clipboard data should be ignored"),!0;const t=o.content;if(!t||0===t.size||0===t.content.length)return console.debug("[handlePasteEvent] ignoring paste: no content"),!0;e&&e(r);const s=function(t,e){let n=!1,r=0,o=0,i=[];if(t.clipboardData){const e=t.clipboardData.getData("text/html");e&&/<table/i.test(e)&&(n=!0)}if(e&&e.content)try{e.content.descendants(t=>{if(t.type&&"table"===t.type.name){n=!0,r=t.content.childCount;for(let e=0;e<t.content.childCount;e++){const n=t.content.child(e),r=[];if(n&&n.content){0===e&&(o=n.content.childCount);for(let t=0;t<n.content.childCount;t++){const e=n.content.child(t),o=e&&e.textContent?e.textContent:"";r.push(o.length)}}i.push(r)}return!1}return!0})}catch(t){console.error("[detectTableInPaste] Error while checking for table",t)}return{hasTable:n,rows:r,cols:o,cellSizes:i}}(r,o);if(s.hasTable&&n)try{n(r,o,s)}catch(t){console.error("[handlePasteEvent] Error in table paste handler:",t)}const a=[];t.nodesBetween(0,t.size,t=>{try{t&&t.type&&t.type.name&&a.push(t.type.name)}catch(t){console.error("handlePasteEvent - nodesBetween",t)}return!0}),console.debug("handlePasteEvent",a,t&&t.content?t.content:void 0);for(var i=0;i<t.content.length;i++)if(Sx(t.content[i]))return!0}catch(t){console.error("handlePasteEvent",t)}return!1})(0,r,o);return 0==i&&r.stopPropagation(),i}}})},Tx=Za.create({name:"clipboard",addOptions:()=>({excludeRules:Cx}),onBeforeCreate(){},onCreate(){},onUpdate(){},addProseMirrorPlugins(){return[_x({...this.options||{},excludeRules:this.options.excludeRules})]}});function Dx(t){try{if(!t)return null;if(t.marks&&Array.isArray(t.marks)&&(t.marks=t.marks.filter(t=>"link"!=t.type.name)),t.content&&Array.isArray(t.content))for(var e=0;e<t.content.length;e++)t.content[e]=Dx(t.content[e]);else t.content&&(t.content=Dx(t.content));return t}catch(e){return console.error("normalizeTitleNode",e),t}}const Ox=Cl.create({name:"title",addOptions:()=>({HTMLAttributes:{},position:0,emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Title",showOnlyWhenEditable:!1,showOnlyCurrent:!0}),priority:9e3,content:"text*",group:"title",defining:!0,addAttributes:()=>({name:{default:"title"},class:{default:"title"}}),addCommands(){return{setTitle:t=>e=>{let{editor:n,tr:r,dispatch:o,commands:i,state:s,view:a,chain:l}=e;if(o){const e=r.doc.nodeAt(this.options.position);if(!e)return!0;const n={from:this.options.position,to:this.options.position+e.nodeSize};t?i.insertContentAt(n,{type:"title",content:[{type:"text",text:t}],attrs:e.attrs}):i.deleteRange(n),function(t,e){const n=t.steps.length-1;if(n<e)return;const r=t.steps[n];if(!(r instanceof Ot||r instanceof Nt))return;const o=t.mapping.maps[n];let i=0;o.forEach((t,e,n,r)=>{0===i&&(i=r)}),t.setSelection(le.near(t.doc.resolve(i),1))}(r,r.steps.length-1)}return!0}}},parseHTML:()=>[{tag:'p[data-name="title"]'}],renderHTML(t){let{HTMLAttributes:e}=t;return["p",Qs(this.options.HTMLAttributes,e),0]},addProseMirrorPlugins(){return[new Me({appendTransaction:(t,e,n)=>{const r=e.selection,o=n.selection,i=t=>"title"===t.$anchor.parent.type.name;if(!r.eq(o)&&i(r)&&!i(o)){const t=new CustomEvent("napkinEventTitleDefocused",{detail:{type:"title",nodeId:r.$anchor.parent.attrs.hookId}});document.dispatchEvent(t)}},props:{decorations:t=>{let{doc:e}=t;const n=[];if(!this.editor.isEditable&&this.options.showOnlyWhenEditable)return;const r=this.options.position,o=Dx(e.nodeAt(r));if(o){if(!o.textContent){const t=[this.options.emptyNodeClass];this.editor.isEmpty&&t.push(this.options.emptyEditorClass);const e=Po.node(r,r+o.nodeSize,{class:t.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder({editor:this.editor,title:o}):this.options.placeholder});n.push(e)}return Ho.create(e,n)}},handlePaste:(t,e,n)=>{const{dispatch:r}=t;if(!this.editor.isActive("title"))return!1;if(Ex(e.clipboardData))return console.debug("[handlePasteEvent] ignoring paste: clipboard data should be ignored"),!1;e.stopPropagation();const o=e.clipboardData||window.clipboardData;if(o&&r){var i,s;const t=["text/html","text/plain"];for(var a=0;a<t.length;a++){const e=t[a];if(o.types.includes(e)){switch(i=o.getData(e),e){case"text/plain":i=kx(i);break;case"text/html":i=xx(i)}s=e;break}}try{if(!i||0==i.length)return console.debug("Ignoring paste of plain text: no text",i,s),!1;console.debug("[handlePaste] Pasting text",i,s),yx(this.editor,i,s,{parseMarkdown:!0,downgradeFromHeading:!0,forceUpgradeToTitle:!0,appendIfNotEmpty:!0,disableLinks:!0})}catch(t){return console.error("Error while pasting plain text",i,t),!1}}return!0}}})]}}),Nx=Ox;const Ix=Za.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>t=>{let{state:e,dispatch:n}=t;return tc(e,n)},redo:()=>t=>{let{state:e,dispatch:n}=t;return ec(e,n)}}),addProseMirrorPlugins(){return[Ql(this.options)]}}),Lx=Tx,Rx=new De("dragdrop"),Bx=Za.create({name:"dragdrop",addOptions:()=>({}),onBeforeCreate(){},onCreate(){},onUpdate(){},addProseMirrorPlugins:()=>[new Me({key:Rx,props:{handleDOMEvents:{drop:(t,e)=>(e.preventDefault(),!1)}}})]}),$x=Za.create({name:"textAlign",addOptions:()=>({types:[],alignments:["left","center","right","justify"],defaultAlignment:null}),addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const e=t.style.textAlign;return this.options.alignments.includes(e)?e:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>e=>{let{commands:n}=e;return!!this.options.alignments.includes(t)&&this.options.types.map(e=>n.updateAttributes(e,{textAlign:t})).every(t=>t)},unsetTextAlign:()=>t=>{let{commands:e}=t;return this.options.types.map(t=>e.resetAttributes(t,"textAlign")).every(t=>t)},toggleTextAlign:t=>e=>{let{editor:n,commands:r}=e;return!!this.options.alignments.includes(t)&&(n.isActive({textAlign:t})?r.unsetTextAlign():r.setTextAlign(t))}}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}).extend({addKeyboardShortcuts:()=>({})}).configure({types:["heading","paragraph","bulletList","orderedList"]}),Px=Za.create({name:"linkInterceptor",addOptions:()=>({onLinkClick:null}),addProseMirrorPlugins(){return[new Me({props:{handleDOMEvents:{click:(t,e)=>{const n=e.target,r=n&&n.closest&&n.closest("a");if(!r)return!1;if(!t.dom.contains(r))return!1;const o=r.getAttribute("href")||"";if(!o||!function(t){if("string"!=typeof t)return!1;try{return"https:"===new URL(t.trim()).protocol}catch{return!1}}(o))return!1;const i=this.options.onLinkClick;if("function"!=typeof i)return!1;e.preventDefault(),e.stopPropagation();try{i(o,r)}catch(t){console.error("[LinkInterceptor] Error calling onLinkClick",t)}return!0}}}})]}});function Fx(t,e){var n=null,r=null,o=null;if(t.state.doc.descendants((t,i,s)=>{if(t.attrs.hookType&&t.attrs.hookId===e)return r=t,n=i,!1;var a=t.marks.find(t=>t&&t.attrs&&t.attrs.hookType&&t.attrs.hookId===e);return a?(o=a,n=i,!1):void 0}),null==n)return null;try{var i=ba(t.view,n,n),s={left:i.left,top:i.top};return{position:n,block:r,inline:o,...s}}catch(t){return console.error("Error in getHookLocation: ",t),null}}function zx(t){if(!t||"string"!=typeof t)return null;const e=t.split("/");if(3!==e.length)return null;const[n,r,o]=e,i=parseInt(o,10);return n&&r&&!isNaN(i)?{parentId:n,type:r,index:i}:null}function Hx(t,e,n,r){if(!t||!t.content)return null;if(n<0||n>=t.content.childCount)return console.log(`[${r}] Index ${n} out of bounds (childCount: ${t.content.childCount})`),null;const o=t.content.child(n);return"text"===e&&o.isText||"hardBreak"===e&&"hardBreak"===o.type.name?o:(console.log(`[${r}] Child at index ${n} is not of type ${e}. Found: ${o.isText?"text":o.type.name}`),null)}function jx(t,e){var n=null;return t.descendants((t,r,o)=>t.attrs.hookType&&t.attrs.hookId===e||t.marks.find(t=>t.attrs.hookType&&t.attrs.hookId===e)?(n=r,!1):void 0),n}function Vx(t,e){if(t){for(var n=e=Math.min(Math.max(e,0),t.content.size);n>=0;n--)if(!1!==(r=qx(t,n)))return r;for(n=e;n<t.content.size;n++){var r;if(!1!==(r=qx(t,n)))return r}return null}}function qx(t,e){var n=t.nodeAt(e);return!!n&&(n.isBlock?n:!!n.isInline&&t.resolve(e).node())}const Ux=gg.extend({name:"blockHook",addOptions(){var t,e;return{...null===(t=this.options)||void 0===t?void 0:t.call(this),...null===(e=this.parent)||void 0===e?void 0:e.call(this),targets:[{type:"title"},{type:"blockquote"},{type:"codeBlock"},{type:"heading"},{type:"image"},{type:"paragraph"},{type:"listItem"},{type:"bulletList"},{type:"orderedList"},{type:"spacer"},{type:"horizontalRule"},{type:"table"},{type:"tableCell"},{type:"tableRow"}],type:"blockHook"}}});function Wx(t,e,n,r){if(!t)return;const o=t.state.doc.content.size;return e=Math.min(Math.max(e,0),o),r?Jx(t,n,e,1)||Jx(t,n,e,-1):Jx(t,n,e,-1)||Jx(t,n,e,1)}function Jx(t,e,n,r){const{doc:o}=t.state,i=1===r?1:-1;for(let r=n;r>=0&&r<o.content.size;r+=i){const o=Gx(t,e,r);if(!1!==o){const e=Kx(o,t),r=Kx(n,t);return Math.abs(e.top-r.top)>16?null:o}}return null}function Kx(t,e){const n=e.view.coordsAtPos(function(t,e){return Math.min(Math.max(t,0),e.content.size-1)}(t,e.state.doc));return{left:n.left,top:n.top,right:n.right,bottom:n.bottom}}function Gx(t,e,n){var r=t.state.doc;e&&(n=r.resolve(n).start());var o=r.nodeAt(n);return!(!o||!o.isText)&&n}Cl.create({name:"blockHookNode",addOptions:()=>({}),group:"block",content:"block*",parseHTML:()=>[{tag:"div"}],renderHTML(t){let{HTMLAttributes:e}=t;return["div",Qs(this.options.HTMLAttributes,e),0]}});const Yx=gg.extend({name:"inlineHook",addOptions(){var t,e;return{...null===(t=this.options)||void 0===t?void 0:t.call(this),...null===(e=this.parent)||void 0===e?void 0:e.call(this),targets:["inlineHookMark"],type:"inlineHook"}}}),Zx=Wa.create({name:"inlineHookMark",addOptions:()=>({}),group:"inlineHook",inclusive:!1,spanning:!1,parseHTML:()=>[{tag:'span[data-name="inline-hook-mark"]'}],renderHTML(t){let{HTMLAttributes:e}=t;return["span",Qs({"data-name":"inline-hook-mark"},this.options.HTMLAttributes,e),0]},addCommands:()=>({setInlineHookMark:t=>{let{editor:e,position:n,id:r,nodeSearchForward:o}=t;return t=>{let{state:i,tr:s,chain:a}=t;const l=Wx(e,n,!1,o),c=r&&dg(r)?r:lg("inlineHook"),u=e.view.state.schema.marks.inlineHookMark.create({hookId:c});var d=new Mt(l,l+1,u);return a(i.tr.step(d))}},unsetInlineHookMark:t=>{let{editor:e,position:n,nodeSearchForward:r}=t;return t=>{let{state:o,tr:i,chain:s}=t;const a=Wx(e,n,!1,r);return s().setTextSelection({from:a,to:a+1}).unsetMark("inlineHookMark").setTextSelection({from:a}).run()}}})});var Qx=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Xx=Cl.create({name:"image",addOptions:()=>({inline:!1,allowBase64:!1,HTMLAttributes:{}}),inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes:()=>({src:{default:null},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}}),parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML(t){let{HTMLAttributes:e}=t;return["img",Qs(this.options.HTMLAttributes,e)]},parseMarkdown:(t,e)=>e.createNode("image",{src:t.href,title:t.title,alt:t.text}),renderMarkdown:t=>{var e,n,r,o,i,s;const a=null!=(n=null==(e=t.attrs)?void 0:e.src)?n:"",l=null!=(o=null==(r=t.attrs)?void 0:r.alt)?o:"",c=null!=(s=null==(i=t.attrs)?void 0:i.title)?s:"";return c?`![${l}](${a} "${c}")`:`![${l}](${a})`},addCommands(){return{setImage:t=>e=>{let{commands:n}=e;return n.insertContent({type:this.name,attrs:t})}}},addInputRules(){return[dl({find:Qx,type:this.type,getAttributes:t=>{const[,,e,n,r]=t;return{src:n,alt:e,title:r}}})]}});const tC=Xx;class eC{constructor(t){this._node=t,this._nodeId=!1}hasCoreNode(){return!(!this._node||!this._node.type)}getCoreNode(){return this._node}getId(){return!1!==this._nodeId&&""!==this._nodeId&&this._nodeId||(this._nodeId=this.parseId()),this._nodeId||""}parseId(){if(this.hasCoreNode()){if(this._node.attrs.hookType&&this._node.attrs.hookId)return this._node.attrs.hookId||"";if(this._node.marks&&this._node.marks.length>0){var t=this._node.marks.find(t=>{var e;return t&&t.attrs&&t.attrs.hookType&&(null===(e=t.attrs.hookId)||void 0===e?void 0:e.length)>0});if(t)return t.attrs.hookId||"";const e=this._node.marks.find(t=>t.attrs.hookType);if(e)return e.attrs.hookId||""}}return""}getAttributes(){return this.hasCoreNode()?this._node.attrs:{}}getType(){return this.hasCoreNode()?this._node.type.name:""}getText(){if(this.hasCoreNode()){const t=this._node.isText?this._node.nodeSize:this._node.nodeSize-2;return this._node.textBetween(0,t,"\n")}return""}isBlock(){return this.hasCoreNode()&&this._node.isBlock}isTextBlock(){return this.hasCoreNode()&&this._node.isTextblock}isText(){return this.hasCoreNode()&&this._node.isText}isHardBreak(){return this.getType()==Zb.name}isParagraph(){return this.getType()==jA.name}isImage(){return this.getType()==tC.name}isSpacer(){return this.getType()==oC.name}isCodeBlock(){return this.getType()==Gb.name}isBlockquote(){return this.getType()==Bb.name}isBulletList(){return this.getType()===uA.name}isOrderedList(){return this.getType()===TA.name}isTitle(){return this.getType()===Nx.name}isHeading(){return this.getType()===Xb.name}isTable(){return this.getType()===mx.name}isTableCell(){return this.getType()===hx.name}isTableRow(){return this.getType()===fx.name}isTableHeader(){return this.getType()===px.name}getSize(){if(this.hasCoreNode())return this._node.content.size}getDescendants(){var t=[];return this.hasCoreNode()&&this._node.content.descendants(e=>(t.push(new eC(e)),!0)),t}toJson(){return this.hasCoreNode()?{id:this.getId(),type:this.getType(),content:this.getText()}:{}}asHeading(){return this.isHeading()?new nC(this._node):null}toString(){return JSON.stringify(this.toJson())}}class nC extends eC{constructor(t){super(t)}getLevel(){return this.hasCoreNode()&&this._node.attrs.level||1}}const rC=eC,oC=Cl.create({name:"spacer",group:"block",inline:!1,defining:!0,leaf:!0,atom:!0,isolating:!0,addOptions:()=>({HTMLAttributes:{}}),addAttributes:()=>({name:{default:"spacer"},class:{default:"spacer"},height:{default:0,parseHTML:t=>t.getAttribute("data-height"),renderHTML:t=>({"data-height":t.height,style:`height: ${t.height}px;`})}}),parseHTML:()=>[{tag:'p[name="spacer"]'}],renderHTML(t){let{HTMLAttributes:e}=t;return["p",Qs(this.options.HTMLAttributes,e),0]},addCommands:()=>({getAllSpacers:()=>t=>{let{editor:e}=t;const n=[];return e.state.doc.descendants(t=>{"spacer"===t.attrs.class&&n.push(new rC(t))}),n},insertSpacerAt:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r=>{let{commands:o,tr:i}=r;const s=lg("blockHook");return i.setMeta("addToHistory",n),o.insertContentAt(t,{type:"spacer",attrs:{height:e,hookId:s,hookType:"blockHook"}})?s:null}},removeSpacer:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n=>{let{editor:r,commands:o,tr:i}=n,s=Fx(r,t);if(s&&s.position&&s.block&&s.block.type&&"spacer"==s.block.type.name){let t=s.position,n={from:t,to:t+s.block.nodeSize};return i.setMeta("addToHistory",e),o.deleteRange(n)}return!1}},updateSpacer:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return i=>{let{editor:s,commands:a,tr:l}=i,c=Fx(s,t);if(c&&c.position&&c.block&&c.block.type&&"spacer"==c.block.type.name){if(n){const n=document.querySelector(`p[name="spacer"]#${t}`);if(null===n)return!1;const o=()=>{try{n.removeEventListener("transitionend",o),r&&r()}catch(e){console.warn(`[updateSpacer] cannot set height to spacer ${t}`,e)}};return n.addEventListener("transitionend",o),n.style.height=`${e}px`,!0}l.setMeta("addToHistory",o),a.updateAttributes("spacer",{height:e}),window.requestAnimationFrame(()=>{const n=document.querySelector(`p[name="spacer"]#${t}`);null!==n&&(n.style.height=`${e}px`)})}return!1}},syncSpacerHeight:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n=>{let{editor:r,commands:o,tr:i}=n,s=Fx(r,t);if(s&&s.position&&s.block&&s.block.type&&"spacer"==s.block.type.name){const n=document.querySelector(`p[name="spacer"]#${t}`);if(!n)return!1;i.setMeta("addToHistory",e);const r=n.offsetHeight;return o.updateAttributes("spacer",{height:r}),!0}}}})}),iC=oC;function sC(t,e,n){return(e=function(t){var e=function(t){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aC(t){const e=atob(t);return Uint8Array.from(e,t=>t.codePointAt(0))}const lC=class extends Nc{constructor(t){var e;super(),e=this,sC(this,"_onDocumentLoad",function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];console.debug("YJSProvider: onDocumentLoad"),e._documentLoadCallback?e._documentLoadCallback(t):console.warn("YJSProvider: No document load callback")}),sC(this,"_onUpdate",(t,e)=>{(null!==e||this._updateCallbackIncludeLocalUpdates)&&this._updateCallback&&this._updateCallback(t)}),this._synced=!1,this._updateCallback=null,this._updateCallbackIncludeLocalUpdates=!1,this._documentLoadCallback=null,this._documentId=t,this.document=new Nd,this.document.on("update",this._onUpdate),this._allUpdates=[],window.injectJson=t=>{const e=[];for(const n of t.updates)e.push(aC(n));console.debug("YJSProvider: injectJson",{json:t,updates:e}),this.loadDocument(aC(t.document),e),this._checkForMissingUpdates()},window.injectJsonFromRefreshData=t=>{var e,n=null;const r=[];for(const e of t){const{key:t,value:o}=e;t.includes("document")?n=o.update:r.push(aC(o.update))}const o=null===(e=this.document.store.pendingStructs)||void 0===e?void 0:e.missing;console.debug("YJSProvider: injectJsonFromRefreshData",{documentUpdate:n,updates:r,missingUpdates:o}),this.loadDocument(aC(n),r)},window.prepareJsonFromRefreshData=t=>{const e=Object.entries(t);e.sort((t,e)=>(console.log(t[1].hlc,e[1].hlc),t[1].hlc>e[1].hlc?1:-1));const n=[];e.forEach(t=>{n.push({key:t[0],value:t[1].value,hlc:t[1].hlc})}),console.log(n)},window.decodeBase64Update=t=>((t,e=Bd)=>{const n=[],r=new e(gu(t)),o=new Dh(r,!1);for(let t=o.curr;null!==t;t=o.next())n.push(t);fd("Structs: ",n);const i=Td(r);fd("DeleteSet: ",i)})(aC(t),Ld),window.debugUpdates=t=>{const e=new Nd,n=[];for(const o of t){var r;const{key:t,value:i}=o;Vd(e,aC(i.update));const s=Oh(aC(i.update));n.push({key:t,pendingDs:e.store.pendingDs,pendingStructs:null===(r=e.store.pendingStructs)||void 0===r?void 0:r.missing,...s.structs.map(t=>({...t.id}))})}return n}}setupDocument(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._synced||(console.debug("YJSProvider: setupDocument"),this._synced=t,this.document.isSynced=t)}loadDocument(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];console.debug("YJSProvider: loadDocument",{documentState:null==t?void 0:t.length,updates:null==e?void 0:e.length}),this._storeUpdates([t,...e]);const n=!this._synced;this.setupDocument(),this.applyUpdates([t,...e]),this._onDocumentLoad(n),this._checkForMissingUpdates()}saveDocument(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(console.debug("YJSProvider: saveDocument",{synced:this._synced,force:t}),!this._synced||t)return this._synced||(this.setupDocument(),this._onDocumentLoad(!0)),(()=>((t,e=new Uint8Array([0]),n=new zd)=>{((t,e,n=new Map)=>{Hd(t,e.store,n),_d(t,Md(e.store))})(n,t,qd(e));const r=[n.toUint8Array()];if(t.store.pendingDs&&r.push(t.store.pendingDs),t.store.pendingStructs&&r.push($h(t.store.pendingStructs.update,e)),r.length>1){if(n.constructor===Pd)return Lh(r.map((t,e)=>0===e?t:Hh(t)));if(n.constructor===zd)return Bh(r)}return r[0]})(this.document,void 0,new Pd))();console.warn("YJSProvider: Document already exists, skipping save")}onUpdate(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._updateCallbackIncludeLocalUpdates=e,this._updateCallback=t}onLoad(t){this._documentLoadCallback=t}applyUpdates(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(console.debug("YJSProvider: applyUpdates",t.length,{updates:t.length,force:e}),this._synced||e)try{this.document.transact(()=>{t.forEach(t=>Vd(this.document,t,this))})}catch(t){console.error("YJSProvider: Error while applying updates",t)}else console.warn("YJSProvider: Document not synced yet")}destroy(){this.document.off("update",this._onUpdate),this._indexedDBProvider.destroy(),super.destroy()}_storeUpdates(t){const e=t.filter(t=>!this._allUpdates.includes(t));return this._allUpdates=[...this._allUpdates,...e],e}_refreshDocument(){this.applyUpdates(this._allUpdates,!0)}_checkForMissingUpdates(){try{var t,e;null!==(t=this.document.store.pendingStructs)&&void 0!==t&&t.missing&&console.error("YJSProvider: Missing updates detected",JSON.stringify(null===(e=this.document.store.pendingStructs)||void 0===e?void 0:e.missing))}catch(t){console.error("YJSProvider: Error while checking for missing updates",t)}}};function cC(t,e,n){const r=t.replace().split(/(?:\r\n?|\n)/),o=[];r.forEach(t=>{let n={type:"paragraph"};t.length>0&&(n.content=[{type:"text",text:t}]);let r=R.fromJSON(e.doc.type.schema,n);o.push(r)});const i=d.fromArray(o);return y.maxOpen(i)}const uC=new De("anchorMarkHighlight");function dC(t){let{marks:e,mark:n,from:r,to:o}=t;return!n&&e.length>0&&(n=e[0]),n?{id:n.attrs["data-anchor-id"],type:n.attrs["data-anchor-type"],entityIds:JSON.parse(n.attrs["data-anchor-entities"]||"[]"),startPosition:r,endPosition:o}:null}const hC=new De("anchorMarkChange");const pC=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hookId";const n=[];return t.descendants((t,r)=>{var o;t.isText&&null!==(o=t.marks)&&void 0!==o&&o.length&&t.marks.forEach(o=>{if(!o.attrs[e])return;const i=n.find(t=>t.mark.attrs[e]===o.attrs[e]);i?(i.to=r+t.text.length,i.text+=t.text):n.push({mark:o,from:r,to:r+t.text.length,text:t.text})})}),n},fC=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data-anchor-id";const r=[];return t.forEach(t=>{const o=e.find(e=>e.mark.attrs[n]===t.mark.attrs[n]);yC(t,o,n)?mC(t,o,n)||r.push({oldMark:t,newMark:o}):r.push({oldMark:t,newMark:o,isInnerEdit:!0})}),r},gC=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data-anchor-id";const r=new Map(e.map(t=>[t.mark.attrs[n],t])),o=[];return t.forEach(t=>{const e=t.mark.attrs[n];r.has(e)||o.push({oldMark:t,newMark:null})}),o},mC=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data-anchor-id";return!(!t||!e)&&t.mark.attrs[n]===e.mark.attrs[n]&&t.from===e.from&&t.to===e.to},yC=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data-anchor-id";return!(!t||!e)&&t.mark.attrs[n]===e.mark.attrs[n]&&t.text===e.text},bC=new De("anchorMarkInteraction");function vC(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onMouseEnter:e,onMouseLeave:n,onSelectionEnter:r,onSelectionLeave:o}=t;let i=new Map,s=new Map;return new Me({key:bC,state:{init:()=>({lastSelection:null}),apply:(t,e)=>({lastSelection:t.selection})},props:{handleDOMEvents:{mouseover(t,r){try{const o=t.posAtCoords({left:r.clientX,top:r.clientY});if(!o||void 0===o.pos)return!1;const{doc:s}=t.state,a=t.state.schema.marks.anchorMark,l=s.nodeAt(o.pos);if(!l)return!1;const c=l.marks.filter(t=>t.type===a);if(!c.length)return i.size>0&&(i.forEach(t=>{n&&n(t.id,t.type)}),i.clear()),!1;const u=new Map;c.forEach(t=>{const e=t.attrs["data-anchor-id"],n=t.attrs["data-anchor-type"];u.set(e,{id:e,type:n})});for(const[t,n]of u.entries())i.has(t)||e&&e(n.id,n.type);for(const[t,e]of i.entries())u.has(t)||n&&n(e.id,e.type);return i=u,!1}catch(t){return console.error("[AnchorMarkInteraction.mouseover] Error handling mouse events",t),!1}},mouseout(t,e){try{const r=t.dom.getBoundingClientRect();return(e.clientX<r.left||e.clientX>r.right||e.clientY<r.top||e.clientY>r.bottom)&&i.size>0&&(i.forEach(t=>{n&&n(t.id,t.type)}),i.clear()),!1}catch(t){return console.error("[AnchorMarkInteraction.mouseout] Error handling mouse events",t),!1}}},decorations(t){try{const{doc:e,selection:n}=t,i=t.schema.marks.anchorMark,a=new Map;e.nodesBetween(n.from,n.to,(t,e)=>{if(t.isText&&t.marks){const e=t.marks.filter(t=>t.type===i);for(const t of e){const e=t.attrs["data-anchor-id"],n=t.attrs["data-anchor-type"];a.set(e,{id:e,type:n})}}return!0});for(const[t,e]of a.entries())s.has(t)||r&&r(e.id,e.type);for(const[t,e]of s.entries())a.has(t)||o&&o(e.id,e.type);return s=a,null}catch(t){console.error("[AnchorMarkInteraction.decorations] Error handling selection events",t)}}}})}const wC=new De("anchorMarkPaste");function AC(t,e){return t.some(t=>function(t,e){if(t.type!==e.type)return!1;const n=null==t.attrs?{}:t.attrs||{},r=null==e.attrs?{}:e.attrs||{},o=new Set([...Object.keys(n),...Object.keys(r)]);for(const t of o)if(n[t]!==r[t])return!1;return!0}(t,e))}function kC(t,e){if(t.isText){const n=[...t.marks];for(const t of e)AC(n,t)||n.push(t);return t.mark(n)}if(!t.inlineContent||t.isLeaf)return t;const n=[];return t.content.forEach(t=>{n.push(kC(t,e))}),t.copy(d.fromArray(n))}function xC(t,e){const n=[];return t.content.forEach(t=>{n.push(kC(t,e))}),new y(d.fromArray(n),t.openStart,t.openEnd)}const CC=Wa.create({name:"anchorMark",excludes:"",inclusive:!0,addOptions:()=>({HTMLAttributes:{"data-name":"anchor-mark"},onMarkUpdate:null,onMarkDeletion:null}),addAttributes:()=>({"data-anchor-id":{default:null,parseHTML:t=>t.getAttribute("data-anchor-id"),renderHTML:t=>t["data-anchor-id"]?{"data-anchor-id":t["data-anchor-id"]}:{}},"data-anchor-type":{default:null,parseHTML:t=>t.getAttribute("data-anchor-type"),renderHTML:t=>t["data-anchor-type"]?{"data-anchor-type":t["data-anchor-type"]}:{}},"data-anchor-entities":{default:null,parseHTML:t=>t.getAttribute("data-anchor-entities"),renderHTML:t=>t["data-anchor-entities"]?{"data-anchor-entities":t["data-anchor-entities"]}:{}}}),parseHTML:()=>[],renderHTML(t){let{HTMLAttributes:e}=t;return["span",Qs(this.options.HTMLAttributes,e),0]},addCommands:()=>({addAnchorMark:t=>{let{startPosition:e,endPosition:n,type:r,entityId:o,onCreate:i}=t;return t=>{let{state:s,tr:a,chain:l}=t;try{if(e>=n)return null;const t="am-"+ag(),c=s.schema.marks.anchorMark,u=JSON.stringify([o]),d=c.create({"data-anchor-id":t,"data-anchor-type":r,"data-anchor-entities":u});return a.addMark(e,n,d),null==l||l(a),null==i||i(t),!0}catch(t){console.error("setAnchorMark failed",t)}return!1}},removeAnchorMark:t=>{let{id:e}=t;return t=>{let{state:n,tr:r,chain:o}=t;const i=n.schema.marks.anchorMark;let s=!1;return n.doc.descendants((t,n)=>{var o;if(!t.isText||null===(o=t.marks)||void 0===o||!o.length)return!0;const a=t.marks.find(t=>t.type===i&&t.attrs["data-anchor-id"]===e);return a&&(r.removeMark(n,n+t.nodeSize,a),s=!0),!0}),s&&(o?o(r):editor.view.dispatch(r)),s}},addAnchorMarkHighlight:t=>{let{id:e}=t;return t=>{let{state:n,tr:r,chain:o}=t;return r.setMeta(uC,{action:"addHighlight",id:e}),o?o(r):editor.view.dispatch(r),!0}},removeAnchorMarkHighlight:t=>{let{id:e}=t;return t=>{let{state:n,tr:r,chain:o}=t;return r.setMeta(uC,{action:"removeHighlight",id:e}),o?o(r):editor.view.dispatch(r),!0}},removeAllAnchorMarkHighlights:()=>t=>{let{state:e,tr:n,chain:r}=t;return n.setMeta(uC,{action:"clearHighlights"}),r?r(n):editor.view.dispatch(n),!0}}),addProseMirrorPlugins(){return[(t=this.options,new Me({key:hC,appendTransaction:(e,n,r)=>{try{const e=pC(n.doc,"data-anchor-id"),o=pC(r.doc,"data-anchor-id"),i=gC(e,o),s=fC(e,o);s&&Array.isArray(s)&&s.length>0&&t.onMarkUpdate&&t.onMarkUpdate(s.map(t=>{let{newMark:e,isInnerEdit:n}=t;return function(t,e){return t?{mark:dC(t),isInnerEdit:1==e}:null}(e,n)}).filter(t=>null!=t)),i&&Array.isArray(i)&&i.length>0&&t.onMarkDeletion&&t.onMarkDeletion(i.map(t=>{let{oldMark:e}=t;return dC(e)}).filter(t=>null!=t))}catch(t){console.error("[anchorMark] Error in appendTransaction",t)}}})),vC(this.options),new Me({key:uC,state:{init:()=>({highlightedIds:new Set}),apply:(t,e,n,r)=>{try{const n=t.getMeta(uC);if(n){const t=new Set(e.highlightedIds);return"addHighlight"===n.action&&n.id?t.add(n.id):"removeHighlight"===n.action&&n.id?t.delete(n.id):"clearHighlights"===n.action&&t.clear(),{highlightedIds:t}}}catch(t){console.error("[AnchorMarkHighlightPlugin.state.apply] Error applying plugin state",t)}return e}},props:{decorations(t){try{const{doc:e}=t,{highlightedIds:n}=this.getState(t);if(0===n.size)return Ho.empty;const r=[],o=t.schema.marks.anchorMark;return o?(e.descendants((t,e)=>{t.isText&&t.marks&&0!==t.marks.length&&t.marks.forEach(i=>{if(i.type===o&&i.attrs["data-anchor-id"]){const o=i.attrs["data-anchor-id"];if(n.has(o)){const n=i.attrs["data-anchor-type"];r.push(Po.inline(e,e+t.nodeSize,{class:["anchor-highlighted","anchor-highlighted-"+n].join(" ")}))}}})}),Ho.create(e,r)):Ho.empty}catch(t){return console.error("[AnchorMarkHighlightPlugin.decorations] Error creating decorations",t),Ho.empty}}}}),(e=this.editor.schema.marks.anchorMark,new Me({key:wC,props:{handlePaste(t,n,r){try{const{state:n}=t,{from:o,$from:i}=n.selection,s=(n.storedMarks||i.marks()).filter(t=>t.type===e);if(!s.length)return!1;const a=xC(r,s),l=n.tr.replaceSelection(a);return t.dispatch(l),!0}catch(t){return console.error("[AnchorMarkPaste.handlePaste] Error applying marks",t),!1}}}}))];var t,e}}),SC=CC,EC=["top","right","bottom","left"],MC=["start","end"],_C=EC.reduce((t,e)=>t.concat(e,e+"-"+MC[0],e+"-"+MC[1]),[]),TC=Math.min,DC=Math.max,OC=Math.round,NC=(Math.floor,t=>({x:t,y:t})),IC={left:"right",right:"left",bottom:"top",top:"bottom"},LC={start:"end",end:"start"};function RC(t,e,n){return DC(t,TC(e,n))}function BC(t,e){return"function"==typeof t?t(e):t}function $C(t){return t.split("-")[0]}function PC(t){return t.split("-")[1]}function FC(t){return"x"===t?"y":"x"}function zC(t){return"y"===t?"height":"width"}const HC=new Set(["top","bottom"]);function jC(t){return HC.has($C(t))?"y":"x"}function VC(t){return FC(jC(t))}function qC(t,e,n){void 0===n&&(n=!1);const r=PC(t),o=VC(t),i=zC(o);let s="x"===o?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return e.reference[i]>e.floating[i]&&(s=YC(s)),[s,YC(s)]}function UC(t){return t.replace(/start|end/g,t=>LC[t])}const WC=["left","right"],JC=["right","left"],KC=["top","bottom"],GC=["bottom","top"];function YC(t){return t.replace(/left|right|bottom|top/g,t=>IC[t])}function ZC(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function QC(t){const{x:e,y:n,width:r,height:o}=t;return{width:r,height:o,top:n,left:e,right:e+r,bottom:n+o,x:e,y:n}}function XC(t,e,n){let{reference:r,floating:o}=t;const i=jC(e),s=VC(e),a=zC(s),l=$C(e),c="y"===i,u=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,h=r[a]/2-o[a]/2;let p;switch(l){case"top":p={x:u,y:r.y-o.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-o.width,y:d};break;default:p={x:r.x,y:r.y}}switch(PC(e)){case"start":p[s]-=h*(n&&c?-1:1);break;case"end":p[s]+=h*(n&&c?-1:1)}return p}async function tS(t,e){var n;void 0===e&&(e={});const{x:r,y:o,platform:i,rects:s,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=BC(e,t),f=ZC(p),g=a[h?"floating"===d?"reference":"floating":d],m=QC(await i.getClippingRect({element:null==(n=await(null==i.isElement?void 0:i.isElement(g)))||n?g:g.contextElement||await(null==i.getDocumentElement?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),y="floating"===d?{x:r,y:o,width:s.floating.width,height:s.floating.height}:s.reference,b=await(null==i.getOffsetParent?void 0:i.getOffsetParent(a.floating)),v=await(null==i.isElement?void 0:i.isElement(b))&&await(null==i.getScale?void 0:i.getScale(b))||{x:1,y:1},w=QC(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:b,strategy:l}):y);return{top:(m.top-w.top+f.top)/v.y,bottom:(w.bottom-m.bottom+f.bottom)/v.y,left:(m.left-w.left+f.left)/v.x,right:(w.right-m.right+f.right)/v.x}}function eS(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function nS(t){return EC.some(e=>t[e]>=0)}function rS(t){const e=TC(...t.map(t=>t.left)),n=TC(...t.map(t=>t.top));return{x:e,y:n,width:DC(...t.map(t=>t.right))-e,height:DC(...t.map(t=>t.bottom))-n}}const oS=new Set(["left","top"]);function iS(){return"undefined"!=typeof window}function sS(t){return cS(t)?(t.nodeName||"").toLowerCase():"#document"}function aS(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function lS(t){var e;return null==(e=(cS(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function cS(t){return!!iS()&&(t instanceof Node||t instanceof aS(t).Node)}function uS(t){return!!iS()&&(t instanceof Element||t instanceof aS(t).Element)}function dS(t){return!!iS()&&(t instanceof HTMLElement||t instanceof aS(t).HTMLElement)}function hS(t){return!(!iS()||"undefined"==typeof ShadowRoot)&&(t instanceof ShadowRoot||t instanceof aS(t).ShadowRoot)}const pS=new Set(["inline","contents"]);function fS(t){const{overflow:e,overflowX:n,overflowY:r,display:o}=ES(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!pS.has(o)}const gS=new Set(["table","td","th"]);function mS(t){return gS.has(sS(t))}const yS=[":popover-open",":modal"];function bS(t){return yS.some(e=>{try{return t.matches(e)}catch(t){return!1}})}const vS=["transform","translate","scale","rotate","perspective"],wS=["transform","translate","scale","rotate","perspective","filter"],AS=["paint","layout","strict","content"];function kS(t){const e=xS(),n=uS(t)?ES(t):t;return vS.some(t=>!!n[t]&&"none"!==n[t])||!!n.containerType&&"normal"!==n.containerType||!e&&!!n.backdropFilter&&"none"!==n.backdropFilter||!e&&!!n.filter&&"none"!==n.filter||wS.some(t=>(n.willChange||"").includes(t))||AS.some(t=>(n.contain||"").includes(t))}function xS(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const CS=new Set(["html","body","#document"]);function SS(t){return CS.has(sS(t))}function ES(t){return aS(t).getComputedStyle(t)}function MS(t){return uS(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function _S(t){if("html"===sS(t))return t;const e=t.assignedSlot||t.parentNode||hS(t)&&t.host||lS(t);return hS(e)?e.host:e}function TS(t){const e=_S(t);return SS(e)?t.ownerDocument?t.ownerDocument.body:t.body:dS(e)&&fS(e)?e:TS(e)}function DS(t,e,n){var r;void 0===e&&(e=[]),void 0===n&&(n=!0);const o=TS(t),i=o===(null==(r=t.ownerDocument)?void 0:r.body),s=aS(o);if(i){const t=OS(s);return e.concat(s,s.visualViewport||[],fS(o)?o:[],t&&n?DS(t):[])}return e.concat(o,DS(o,[],n))}function OS(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function NS(t){const e=ES(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const o=dS(t),i=o?t.offsetWidth:n,s=o?t.offsetHeight:r,a=OC(n)!==i||OC(r)!==s;return a&&(n=i,r=s),{width:n,height:r,$:a}}function IS(t){return uS(t)?t:t.contextElement}function LS(t){const e=IS(t);if(!dS(e))return NC(1);const n=e.getBoundingClientRect(),{width:r,height:o,$:i}=NS(e);let s=(i?OC(n.width):n.width)/r,a=(i?OC(n.height):n.height)/o;return s&&Number.isFinite(s)||(s=1),a&&Number.isFinite(a)||(a=1),{x:s,y:a}}const RS=NC(0);function BS(t){const e=aS(t);return xS()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:RS}function $S(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=!1);const o=t.getBoundingClientRect(),i=IS(t);let s=NC(1);e&&(r?uS(r)&&(s=LS(r)):s=LS(t));const a=function(t,e,n){return void 0===e&&(e=!1),!(!n||e&&n!==aS(t))&&e}(i,n,r)?BS(i):NC(0);let l=(o.left+a.x)/s.x,c=(o.top+a.y)/s.y,u=o.width/s.x,d=o.height/s.y;if(i){const t=aS(i),e=r&&uS(r)?aS(r):r;let n=t,o=OS(n);for(;o&&r&&e!==n;){const t=LS(o),e=o.getBoundingClientRect(),r=ES(o),i=e.left+(o.clientLeft+parseFloat(r.paddingLeft))*t.x,s=e.top+(o.clientTop+parseFloat(r.paddingTop))*t.y;l*=t.x,c*=t.y,u*=t.x,d*=t.y,l+=i,c+=s,n=aS(o),o=OS(n)}}return QC({width:u,height:d,x:l,y:c})}function PS(t,e){const n=MS(t).scrollLeft;return e?e.left+n:$S(lS(t)).left+n}function FS(t,e){const n=t.getBoundingClientRect();return{x:n.left+e.scrollLeft-PS(t,n),y:n.top+e.scrollTop}}const zS=new Set(["absolute","fixed"]);function HS(t,e,n){let r;if("viewport"===e)r=function(t,e){const n=aS(t),r=lS(t),o=n.visualViewport;let i=r.clientWidth,s=r.clientHeight,a=0,l=0;if(o){i=o.width,s=o.height;const t=xS();(!t||t&&"fixed"===e)&&(a=o.offsetLeft,l=o.offsetTop)}const c=PS(r);if(c<=0){const t=r.ownerDocument,e=t.body,n=getComputedStyle(e),o="CSS1Compat"===t.compatMode&&parseFloat(n.marginLeft)+parseFloat(n.marginRight)||0,s=Math.abs(r.clientWidth-e.clientWidth-o);s<=25&&(i-=s)}else c<=25&&(i+=c);return{width:i,height:s,x:a,y:l}}(t,n);else if("document"===e)r=function(t){const e=lS(t),n=MS(t),r=t.ownerDocument.body,o=DC(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=DC(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+PS(t);const a=-n.scrollTop;return"rtl"===ES(r).direction&&(s+=DC(e.clientWidth,r.clientWidth)-o),{width:o,height:i,x:s,y:a}}(lS(t));else if(uS(e))r=function(t,e){const n=$S(t,!0,"fixed"===e),r=n.top+t.clientTop,o=n.left+t.clientLeft,i=dS(t)?LS(t):NC(1);return{width:t.clientWidth*i.x,height:t.clientHeight*i.y,x:o*i.x,y:r*i.y}}(e,n);else{const n=BS(t);r={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return QC(r)}function jS(t,e){const n=_S(t);return!(n===e||!uS(n)||SS(n))&&("fixed"===ES(n).position||jS(n,e))}function VS(t,e,n){const r=dS(e),o=lS(e),i="fixed"===n,s=$S(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=NC(0);function c(){l.x=PS(o)}if(r||!r&&!i)if(("body"!==sS(e)||fS(o))&&(a=MS(e)),r){const t=$S(e,!0,i,e);l.x=t.x+e.clientLeft,l.y=t.y+e.clientTop}else o&&c();i&&!r&&o&&c();const u=!o||r||i?NC(0):FS(o,a);return{x:s.left+a.scrollLeft-l.x-u.x,y:s.top+a.scrollTop-l.y-u.y,width:s.width,height:s.height}}function qS(t){return"static"===ES(t).position}function US(t,e){if(!dS(t)||"fixed"===ES(t).position)return null;if(e)return e(t);let n=t.offsetParent;return lS(t)===n&&(n=n.ownerDocument.body),n}function WS(t,e){const n=aS(t);if(bS(t))return n;if(!dS(t)){let e=_S(t);for(;e&&!SS(e);){if(uS(e)&&!qS(e))return e;e=_S(e)}return n}let r=US(t,e);for(;r&&mS(r)&&qS(r);)r=US(r,e);return r&&SS(r)&&qS(r)&&!kS(r)?n:r||function(t){let e=_S(t);for(;dS(e)&&!SS(e);){if(kS(e))return e;if(bS(e))return null;e=_S(e)}return null}(t)||n}const JS={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{elements:e,rect:n,offsetParent:r,strategy:o}=t;const i="fixed"===o,s=lS(r),a=!!e&&bS(e.floating);if(r===s||a&&i)return n;let l={scrollLeft:0,scrollTop:0},c=NC(1);const u=NC(0),d=dS(r);if((d||!d&&!i)&&(("body"!==sS(r)||fS(s))&&(l=MS(r)),dS(r))){const t=$S(r);c=LS(r),u.x=t.x+r.clientLeft,u.y=t.y+r.clientTop}const h=!s||d||i?NC(0):FS(s,l);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}},getDocumentElement:lS,getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:r,strategy:o}=t;const i="clippingAncestors"===n?bS(e)?[]:function(t,e){const n=e.get(t);if(n)return n;let r=DS(t,[],!1).filter(t=>uS(t)&&"body"!==sS(t)),o=null;const i="fixed"===ES(t).position;let s=i?_S(t):t;for(;uS(s)&&!SS(s);){const e=ES(s),n=kS(s);n||"fixed"!==e.position||(o=null),(i?!n&&!o:!n&&"static"===e.position&&o&&zS.has(o.position)||fS(s)&&!n&&jS(t,s))?r=r.filter(t=>t!==s):o=e,s=_S(s)}return e.set(t,r),r}(e,this._c):[].concat(n),s=[...i,r],a=s[0],l=s.reduce((t,n)=>{const r=HS(e,n,o);return t.top=DC(r.top,t.top),t.right=TC(r.right,t.right),t.bottom=TC(r.bottom,t.bottom),t.left=DC(r.left,t.left),t},HS(e,a,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:WS,getElementRects:async function(t){const e=this.getOffsetParent||WS,n=this.getDimensions,r=await n(t.floating);return{reference:VS(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){const{width:e,height:n}=NS(t);return{width:e,height:n}},getScale:LS,isElement:uS,isRTL:function(t){return"rtl"===ES(t).direction}},KS=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:o,y:i,placement:s,middlewareData:a}=e,l=await async function(t,e){const{placement:n,platform:r,elements:o}=t,i=await(null==r.isRTL?void 0:r.isRTL(o.floating)),s=$C(n),a=PC(n),l="y"===jC(n),c=oS.has(s)?-1:1,u=i&&l?-1:1,d=BC(e,t);let{mainAxis:h,crossAxis:p,alignmentAxis:f}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&"number"==typeof f&&(p="end"===a?-1*f:f),l?{x:p*u,y:h*c}:{x:h*c,y:p*u}}(e,t);return s===(null==(n=a.offset)?void 0:n.placement)&&null!=(r=a.arrow)&&r.alignmentOffset?{}:{x:o+l.x,y:i+l.y,data:{...l,placement:s}}}}},GS=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:o}=e,{mainAxis:i=!0,crossAxis:s=!1,limiter:a={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...l}=BC(t,e),c={x:n,y:r},u=await tS(e,l),d=jC($C(o)),h=FC(d);let p=c[h],f=c[d];if(i){const t="y"===h?"bottom":"right";p=RC(p+u["y"===h?"top":"left"],p,p-u[t])}if(s){const t="y"===d?"bottom":"right";f=RC(f+u["y"===d?"top":"left"],f,f-u[t])}const g=a.fn({...e,[h]:p,[d]:f});return{...g,data:{x:g.x-n,y:g.y-r,enabled:{[h]:i,[d]:s}}}}}},YS=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:o,middlewareData:i,rects:s,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:g=!0,...m}=BC(t,e);if(null!=(n=i.arrow)&&n.alignmentOffset)return{};const y=$C(o),b=jC(a),v=$C(a)===a,w=await(null==l.isRTL?void 0:l.isRTL(c.floating)),A=h||(v||!g?[YC(a)]:function(t){const e=YC(t);return[UC(t),e,UC(e)]}(a)),k="none"!==f;!h&&k&&A.push(...function(t,e,n,r){const o=PC(t);let i=function(t,e,n){switch(t){case"top":case"bottom":return n?e?JC:WC:e?WC:JC;case"left":case"right":return e?KC:GC;default:return[]}}($C(t),"start"===n,r);return o&&(i=i.map(t=>t+"-"+o),e&&(i=i.concat(i.map(UC)))),i}(a,g,f,w));const x=[a,...A],C=await tS(e,m),S=[];let E=(null==(r=i.flip)?void 0:r.overflows)||[];if(u&&S.push(C[y]),d){const t=qC(o,s,w);S.push(C[t[0]],C[t[1]])}if(E=[...E,{placement:o,overflows:S}],!S.every(t=>t<=0)){var M,_;const t=((null==(M=i.flip)?void 0:M.index)||0)+1,e=x[t];if(e&&("alignment"!==d||b===jC(e)||E.every(t=>jC(t.placement)!==b||t.overflows[0]>0)))return{data:{index:t,overflows:E},reset:{placement:e}};let n=null==(_=E.filter(t=>t.overflows[0]<=0).sort((t,e)=>t.overflows[1]-e.overflows[1])[0])?void 0:_.placement;if(!n)switch(p){case"bestFit":{var T;const t=null==(T=E.filter(t=>{if(k){const e=jC(t.placement);return e===b||"y"===e}return!0}).map(t=>[t.placement,t.overflows.filter(t=>t>0).reduce((t,e)=>t+e,0)]).sort((t,e)=>t[1]-e[1])[0])?void 0:T[0];t&&(n=t);break}case"initialPlacement":n=a}if(o!==n)return{reset:{placement:n}}}return{}}}},ZS=(t,e,n)=>{const r=new Map,o={platform:JS,...n},i={...o.platform,_c:r};return(async(t,e,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:s}=n,a=i.filter(Boolean),l=await(null==s.isRTL?void 0:s.isRTL(e));let c=await s.getElementRects({reference:t,floating:e,strategy:o}),{x:u,y:d}=XC(c,r,l),h=r,p={},f=0;for(let n=0;n<a.length;n++){const{name:i,fn:g}=a[n],{x:m,y,data:b,reset:v}=await g({x:u,y:d,initialPlacement:r,placement:h,strategy:o,middlewareData:p,rects:c,platform:s,elements:{reference:t,floating:e}});u=null!=m?m:u,d=null!=y?y:d,p={...p,[i]:{...p[i],...b}},v&&f<=50&&(f++,"object"==typeof v&&(v.placement&&(h=v.placement),v.rects&&(c=!0===v.rects?await s.getElementRects({reference:t,floating:e,strategy:o}):v.rects),({x:u,y:d}=XC(c,h,l))),n=-1)}return{x:u,y:d,placement:h,strategy:o,middlewareData:p}})(t,e,{...o,platform:i})};function QS(t,e,n){return(e=function(t){var e=function(t){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class XS{constructor(t){let{editor:e,element:n,view:r,floatingOptions:o,shouldShow:i,domScaleGetter:s,canShowGetter:a}=t;QS(this,"shouldShow",t=>{let{editor:e,state:n,from:r,to:o}=t;const{doc:i,selection:s}=n,{empty:a}=s;if(!1===e.isEditable)return!1;const l=!i.textBetween(r,o).length&&ts(n.selection);if(a||l)return!1;let c=!1;return ya(s)?c=s.node:ts(s)&&(c=s.$anchor.parent),!(!c||!c.attrs.bubbleMenu)}),QS(this,"mousedownHandler",t=>{t.preventDefault()}),QS(this,"mouseupHandler",()=>{window.setTimeout(()=>this.update(this.editor.view))}),QS(this,"dragstartHandler",()=>{this.hide()}),QS(this,"focusHandler",()=>{window.setTimeout(()=>this.update(this.editor.view))}),QS(this,"blurHandler",t=>{var e;let{event:n}=t;this.preventHide?this.preventHide=!1:null!=n&&n.relatedTarget&&null!==(e=this.element.parentNode)&&void 0!==e&&e.contains(n.relatedTarget)||this.hide()}),this.preventHide=!1,this.editor=e,this.element=n,this.view=r,this.domScaleGetter=s,this.canShowGetter=a,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.element.addEventListener("mouseup",this.mouseupHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.element.style.visibility="visible",requestAnimationFrame(()=>{this.createTooltip(o)})}createTooltip(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.floatingOptions={placement:"top",...t},this.element.style.position="fixed",this.element.style.width="max-content",this.hide()}update(t,e){var n;const{state:r,composing:o}=t,{doc:i,selection:s}=r,a=e&&e.doc.eq(i)&&e.selection.eq(s);if(o||a)return;const{ranges:l}=s,c=Math.min(...l.map(t=>t.$from.pos)),u=Math.max(...l.map(t=>t.$to.pos));this.shouldShow({editor:this.editor,view:t,state:r,oldState:e,from:c,to:u})&&!1!==(null===(n=this.canShowGetter)||void 0===n?void 0:n.call(this))?(this.getReferenceClientRect=()=>{if(ya(r.selection))try{const e=t.nodeDOM(c);if(e)return e.getBoundingClientRect()}catch(t){return console.error(`BubbleMenuView: Error getting node selection rect at position ${c}`,{selection:r.selection.toJSON(),error:t}),new DOMRect(0,0,0,0)}try{return ba(t,c,u)}catch(t){return console.error(`BubbleMenuView: Error getting text selection rect from ${c} to ${u}`,{selection:r.selection.toJSON(),error:t}),new DOMRect(0,0,0,0)}},this.show()):this.hide()}async show(){var t;this.element.style.display="block";const e=null===(t=this.getReferenceClientRect)||void 0===t?void 0:t.call(this);if(!e)return;const n={getBoundingClientRect:()=>e},r=[KS(6),YS(),GS({padding:8})];try{const{x:t,y:e}=await ZS(n,this.element,{placement:this.floatingOptions.placement||"top",middleware:r,strategy:"fixed"});Object.assign(this.element.style,{left:`${t}px`,top:`${e}px`})}catch(t){console.error("Error positioning bubble menu:",t)}window.setTimeout(()=>this.element.classList.add("active"))}hide(){this.element.style.display="none",this.element.classList.remove("active")}destroy(){this.element.removeEventListener("mousedown",this.mousedownHandler),this.element.removeEventListener("mouseup",this.mouseupHandler),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler),this.domScaleGetter=null,this.canShowGetter=null,this.getReferenceClientRect=null}}const tE=["blockquote","bulletList","codeBlock","heading","orderedList","paragraph","title"],eE=Za.create({name:"bubbleMenu",addOptions:()=>({element:null,targets:tE,floatingOptions:{placement:"top"},pluginKey:"bubbleMenu",shouldShow:null,domScaleGetter:null,canShowGetter:null}),addGlobalAttributes(){return[{types:this.options.targets,attributes:{bubbleMenu:{default:!0,keepOnSplit:!1,parseHTML:t=>t.getAttribute("data-bubble-menu"),renderHTML:t=>t.bubbleMenu?{"data-bubble-menu":!0}:{}}}}]},addProseMirrorPlugins(){return this.options.element?[(t={pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,floatingOptions:this.options.floatingOptions,shouldShow:this.options.shouldShow,domScaleGetter:this.options.domScaleGetter,canShowGetter:this.options.canShowGetter},new Me({key:"string"==typeof t.pluginKey?new De(t.pluginKey):t.pluginKey,view:e=>new XS({view:e,...t})}))]:[];var t}});var nE=class{constructor(t){let{editor:e,element:n,view:r,options:o,appendTo:i,shouldShow:s}=t;this.preventHide=!1,this.isVisible=!1,this.shouldShow=t=>{let{view:e,state:n}=t;const{selection:r}=n,{$anchor:o,empty:i}=r,s=1===o.depth,a=o.parent.isTextblock&&!o.parent.type.spec.code&&!o.parent.textContent&&0===o.parent.childCount&&!this.getTextContent(o.parent);return!!(e.hasFocus()&&i&&s&&a&&this.editor.isEditable)},this.floatingUIOptions={strategy:"absolute",placement:"right",offset:8,flip:{},shift:{},arrow:!1,size:!1,autoPlacement:!1,hide:!1,inline:!1},this.updateHandler=(t,e,n,r)=>{const{composing:o}=t;o||!e&&!n||(this.getShouldShow(r)?(this.updatePosition(),this.show()):this.hide())},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=t=>{let{event:e}=t;var n;this.preventHide?this.preventHide=!1:(null==e?void 0:e.relatedTarget)&&(null==(n=this.element.parentNode)?void 0:n.contains(e.relatedTarget))||(null==e?void 0:e.relatedTarget)!==this.editor.view.dom&&this.hide()},this.editor=e,this.element=n,this.view=r,this.appendTo=i,this.floatingUIOptions={...this.floatingUIOptions,...o},this.element.tabIndex=0,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.update(r,r.state),this.getShouldShow()&&(this.show(),this.updatePosition())}getTextContent(t){return sa(t,{textSerializers:aa(this.editor.schema)})}get middlewares(){const t=[];return this.floatingUIOptions.flip&&t.push(YS("boolean"!=typeof this.floatingUIOptions.flip?this.floatingUIOptions.flip:void 0)),this.floatingUIOptions.shift&&t.push(GS("boolean"!=typeof this.floatingUIOptions.shift?this.floatingUIOptions.shift:void 0)),this.floatingUIOptions.offset&&t.push(KS("boolean"!=typeof this.floatingUIOptions.offset?this.floatingUIOptions.offset:void 0)),this.floatingUIOptions.arrow&&t.push({name:"arrow",options:e=this.floatingUIOptions.arrow,async fn(t){const{x:n,y:r,placement:o,rects:i,platform:s,elements:a,middlewareData:l}=t,{element:c,padding:u=0}=BC(e,t)||{};if(null==c)return{};const d=ZC(u),h={x:n,y:r},p=VC(o),f=zC(p),g=await s.getDimensions(c),m="y"===p,y=m?"top":"left",b=m?"bottom":"right",v=m?"clientHeight":"clientWidth",w=i.reference[f]+i.reference[p]-h[p]-i.floating[f],A=h[p]-i.reference[p],k=await(null==s.getOffsetParent?void 0:s.getOffsetParent(c));let x=k?k[v]:0;x&&await(null==s.isElement?void 0:s.isElement(k))||(x=a.floating[v]||i.floating[f]);const C=w/2-A/2,S=x/2-g[f]/2-1,E=TC(d[y],S),M=TC(d[b],S),_=E,T=x-g[f]-M,D=x/2-g[f]/2+C,O=RC(_,D,T),N=!l.arrow&&null!=PC(o)&&D!==O&&i.reference[f]/2-(D<_?E:M)-g[f]/2<0,I=N?D<_?D-_:D-T:0;return{[p]:h[p]+I,data:{[p]:O,centerOffset:D-O-I,...N&&{alignmentOffset:I}},reset:N}}}),this.floatingUIOptions.size&&t.push(function(t){return void 0===t&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:o,rects:i,platform:s,elements:a}=e,{apply:l=()=>{},...c}=BC(t,e),u=await tS(e,c),d=$C(o),h=PC(o),p="y"===jC(o),{width:f,height:g}=i.floating;let m,y;"top"===d||"bottom"===d?(m=d,y=h===(await(null==s.isRTL?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(y=d,m="end"===h?"top":"bottom");const b=g-u.top-u.bottom,v=f-u.left-u.right,w=TC(g-u[m],b),A=TC(f-u[y],v),k=!e.middlewareData.shift;let x=w,C=A;if(null!=(n=e.middlewareData.shift)&&n.enabled.x&&(C=v),null!=(r=e.middlewareData.shift)&&r.enabled.y&&(x=b),k&&!h){const t=DC(u.left,0),e=DC(u.right,0),n=DC(u.top,0),r=DC(u.bottom,0);p?C=f-2*(0!==t||0!==e?t+e:DC(u.left,u.right)):x=g-2*(0!==n||0!==r?n+r:DC(u.top,u.bottom))}await l({...e,availableWidth:C,availableHeight:x});const S=await s.getDimensions(a.floating);return f!==S.width||g!==S.height?{reset:{rects:!0}}:{}}}}("boolean"!=typeof this.floatingUIOptions.size?this.floatingUIOptions.size:void 0)),this.floatingUIOptions.autoPlacement&&t.push(function(t){return void 0===t&&(t={}),{name:"autoPlacement",options:t,async fn(e){var n,r,o;const{rects:i,middlewareData:s,placement:a,platform:l,elements:c}=e,{crossAxis:u=!1,alignment:d,allowedPlacements:h=_C,autoAlignment:p=!0,...f}=BC(t,e),g=void 0!==d||h===_C?function(t,e,n){return(t?[...n.filter(e=>PC(e)===t),...n.filter(e=>PC(e)!==t)]:n.filter(t=>$C(t)===t)).filter(n=>!t||PC(n)===t||!!e&&UC(n)!==n)}(d||null,p,h):h,m=await tS(e,f),y=(null==(n=s.autoPlacement)?void 0:n.index)||0,b=g[y];if(null==b)return{};const v=qC(b,i,await(null==l.isRTL?void 0:l.isRTL(c.floating)));if(a!==b)return{reset:{placement:g[0]}};const w=[m[$C(b)],m[v[0]],m[v[1]]],A=[...(null==(r=s.autoPlacement)?void 0:r.overflows)||[],{placement:b,overflows:w}],k=g[y+1];if(k)return{data:{index:y+1,overflows:A},reset:{placement:k}};const x=A.map(t=>{const e=PC(t.placement);return[t.placement,e&&u?t.overflows.slice(0,2).reduce((t,e)=>t+e,0):t.overflows[0],t.overflows]}).sort((t,e)=>t[1]-e[1]),C=(null==(o=x.filter(t=>t[2].slice(0,PC(t[0])?2:3).every(t=>t<=0))[0])?void 0:o[0])||x[0][0];return C!==a?{data:{index:y+1,overflows:A},reset:{placement:C}}:{}}}}("boolean"!=typeof this.floatingUIOptions.autoPlacement?this.floatingUIOptions.autoPlacement:void 0)),this.floatingUIOptions.hide&&t.push(function(t){return void 0===t&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...o}=BC(t,e);switch(r){case"referenceHidden":{const t=eS(await tS(e,{...o,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:t,referenceHidden:nS(t)}}}case"escaped":{const t=eS(await tS(e,{...o,altBoundary:!0}),n.floating);return{data:{escapedOffsets:t,escaped:nS(t)}}}default:return{}}}}}("boolean"!=typeof this.floatingUIOptions.hide?this.floatingUIOptions.hide:void 0)),this.floatingUIOptions.inline&&t.push(function(t){return void 0===t&&(t={}),{name:"inline",options:t,async fn(e){const{placement:n,elements:r,rects:o,platform:i,strategy:s}=e,{padding:a=2,x:l,y:c}=BC(t,e),u=Array.from(await(null==i.getClientRects?void 0:i.getClientRects(r.reference))||[]),d=function(t){const e=t.slice().sort((t,e)=>t.y-e.y),n=[];let r=null;for(let t=0;t<e.length;t++){const o=e[t];!r||o.y-r.y>r.height/2?n.push([o]):n[n.length-1].push(o),r=o}return n.map(t=>QC(rS(t)))}(u),h=QC(rS(u)),p=ZC(a),f=await i.getElementRects({reference:{getBoundingClientRect:function(){if(2===d.length&&d[0].left>d[1].right&&null!=l&&null!=c)return d.find(t=>l>t.left-p.left&&l<t.right+p.right&&c>t.top-p.top&&c<t.bottom+p.bottom)||h;if(d.length>=2){if("y"===jC(n)){const t=d[0],e=d[d.length-1],r="top"===$C(n),o=t.top,i=e.bottom,s=r?t.left:e.left,a=r?t.right:e.right;return{top:o,bottom:i,left:s,right:a,width:a-s,height:i-o,x:s,y:o}}const t="left"===$C(n),e=DC(...d.map(t=>t.right)),r=TC(...d.map(t=>t.left)),o=d.filter(n=>t?n.left===r:n.right===e),i=o[0].top,s=o[o.length-1].bottom;return{top:i,bottom:s,left:r,right:e,width:e-r,height:s-i,x:r,y:i}}return h}},floating:r.floating,strategy:s});return o.reference.x!==f.reference.x||o.reference.y!==f.reference.y||o.reference.width!==f.reference.width||o.reference.height!==f.reference.height?{reset:{rects:f}}:{}}}}("boolean"!=typeof this.floatingUIOptions.inline?this.floatingUIOptions.inline:void 0)),t;var e}getShouldShow(t){var e;const{state:n}=this.view,{selection:r}=n,{ranges:o}=r,i=Math.min(...o.map(t=>t.$from.pos)),s=Math.max(...o.map(t=>t.$to.pos));return null==(e=this.shouldShow)?void 0:e.call(this,{editor:this.editor,view:this.view,state:n,oldState:t,from:i,to:s})}updatePosition(){const{selection:t}=this.editor.state,e=ba(this.view,t.from,t.to);ZS({getBoundingClientRect:()=>e,getClientRects:()=>[e]},this.element,{placement:this.floatingUIOptions.placement,strategy:this.floatingUIOptions.strategy,middleware:this.middlewares}).then(t=>{let{x:e,y:n,strategy:r}=t;this.element.style.width="max-content",this.element.style.position=r,this.element.style.left=`${e}px`,this.element.style.top=`${n}px`,this.isVisible&&this.floatingUIOptions.onUpdate&&this.floatingUIOptions.onUpdate()})}update(t,e){const n=!(null==e?void 0:e.selection.eq(t.state.selection)),r=!(null==e?void 0:e.doc.eq(t.state.doc));this.updateHandler(t,n,r,e)}show(){var t;if(this.isVisible)return;this.element.style.visibility="visible",this.element.style.opacity="1";const e="function"==typeof this.appendTo?this.appendTo():this.appendTo;null==(t=null!=e?e:this.view.dom.parentElement)||t.appendChild(this.element),this.floatingUIOptions.onShow&&this.floatingUIOptions.onShow(),this.isVisible=!0}hide(){this.isVisible&&(this.element.style.visibility="hidden",this.element.style.opacity="0",this.element.remove(),this.floatingUIOptions.onHide&&this.floatingUIOptions.onHide(),this.isVisible=!1)}destroy(){this.hide(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler),this.floatingUIOptions.onDestroy&&this.floatingUIOptions.onDestroy()}};Za.create({name:"floatingMenu",addOptions:()=>({element:null,options:{},pluginKey:"floatingMenu",appendTo:void 0,shouldShow:null}),addProseMirrorPlugins(){return this.options.element?[(t={pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,options:this.options.options,appendTo:this.options.appendTo,shouldShow:this.options.shouldShow},new Me({key:"string"==typeof t.pluginKey?new De(t.pluginKey):t.pluginKey,view:e=>new nE({view:e,...t})}))]:[];var t}}).extend({});const rE=Za.create({name:"keymapEnter",addCommands:()=>({splitBlockImproved:JA}),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.first(t=>{let{commands:e}=t;return[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlockImproved()]})}}}),oE=Za.create({name:"KeymapTab",addCommands:()=>({splitBlockImproved:JA}),addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.first(t=>{let{commands:e}=t;return[()=>e.insertContent("\t")]})}}});var iE=n(5072),sE=n.n(iE),aE=n(7825),lE=n.n(aE),cE=n(7659),uE=n.n(cE),dE=n(5056),hE=n.n(dE),pE=n(540),fE=n.n(pE),gE=n(1113),mE=n.n(gE),yE=n(6287),bE={};bE.styleTagTransform=mE(),bE.setAttributes=hE(),bE.insert=uE().bind(null,"head"),bE.domAPI=lE(),bE.insertStyleElement=fE(),sE()(yE.A,bE),yE.A&&yE.A.locals&&yE.A.locals;class vE{constructor(t){this._state=t}hasCoreState(){return!!this._state}hasCoreDoc(){return!(!this._state||!this._state.doc)}getCoreDoc(){return this._state&&this._state.doc}getDoc(){return this.hasCoreDoc()?new rC(this.getCoreDoc()):null}getSelection(){return this._state&&this._state.selection?new kE(this._state.selection):null}}class wE{constructor(t,e,n,r,o){this._additions=t,this._deletions=e,this._updates=n,this._nodesWithDescendantAdditions=r,this._nodesWithDescendantDeletions=o}getAdditions(){return this._additions}getDeletions(){return this._deletions}getUpdates(){return this._updates}getDescendantAdditions(){return this._nodesWithDescendantAdditions}getDescendantDeletions(){return this._nodesWithDescendantDeletions}toString(){return JSON.stringify({additions:this._additions.map(t=>t.toJson()),deletions:this._deletions.map(t=>t.toJson()),updates:this._updates.map(t=>t.toJson()),nodesWithDescendantAdditions:this._nodesWithDescendantAdditions.map(t=>t.toJson()),nodesWithDescendantDeletions:this._nodesWithDescendantDeletions.map(t=>t.toJson())},null,2)}}class AE{constructor(t){this._tr=t}isFromServer(){var t,e;return!0===(null===(t=this._tr)||void 0===t||null===(t=t.getMeta("y-sync$"))||void 0===t?void 0:t.isChangeOrigin)&&!1===(null===(e=this._tr)||void 0===e||null===(e=e.getMeta("y-sync$"))||void 0===e?void 0:e.isUndoRedoOperation)}isValid(){return!!this._tr}hasChanges(){return!(!this._tr||!this._tr.docChanged)}_removeDuplicates(t){let e=[],n={};return t.forEach(t=>{n[t.getId()]||(n[t.getId()]=!0,e.push(t))}),e}getChanges(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isValid()||!this.hasChanges())return new wE([],[],[],[],[]);const e=[],n={},r=[],o={};ca(this._tr).forEach(t=>{let{oldRange:i,newRange:s}=t;this._tr.before.nodesBetween(i.from,i.to,(t,r,o,i)=>{let s=new rC(t),a=s.getId();return a&&!n[a]&&(n[a]={node:s,position:r,descendantsCount:s.getDescendants().length},e.push(a)),!0}),this._tr.doc.nodesBetween(s.from,s.to,(t,e,n,i)=>{const s=new rC(t),a=s.getId();return a&&!o[a]&&(o[a]={node:s,position:e,descendantsCount:s.getDescendants().length},r.push(a)),!0})});var i=[],s=[],a=[],l=[],c=[];if(e.forEach(t=>{o[t]||i.push(n[t].node)}),r.forEach(t=>{const e=o[t].node;n[t]?(a.push(e),n[t].descendantsCount>o[t].descendantsCount?l.push(e):n[t].descendantsCount<o[t].descendantsCount&&c.push(e)):s.push(e)}),t)try{i.forEach(t=>{const e=n[t.getId()].position;if(e<this._tr.doc.content.size){const t=this._tr.doc.nodeAt(e);t&&a.push(new rC(t))}else{const t=this._tr.doc.lastChild;t&&a.push(new rC(t))}})}catch(t){console.error("[ERROR] Failed to include the node before the deleted node:",t)}return i=this._removeDuplicates(i),s=this._removeDuplicates(s),a=this._removeDuplicates(a),l=this._removeDuplicates(l),c=this._removeDuplicates(c),new wE(s,i,a,c,l)}getSlashCommand(){if(!this.isValid())return null;if(!this._tr.docChanged||!this._tr.selection.empty)return null;let t=this._tr.selection.$from,e=t.nodeBefore;if(!e||!e.isText)return null;if("/"===e.text.trim()){let n=[];return this._tr.steps.forEach(t=>{n.push(t.invert(this._tr.before))}),{name:"slash",node:e,position:t.pos,steps:n}}return null}getMeta(t){return this.isValid()?this._tr.getMeta(t):null}getStepsLength(){return this._tr.steps.length||0}toString(){return this.isValid()?this._tr.toString():""}}class kE{constructor(t){this._selection=t}isValid(){return!!this._selection}isEmpty(){return!(!this._selection||!this._selection.empty)}getNode(){if(!this.isValid())return null;if(!ts(this._selection))return null;const t=this._selection.$cursor;if(!t)return null;const e=t.parent;return e?new rC(e):null}getPosition(){if(!this.isValid())return null;if(!ts(this._selection))return null;const t=this._selection.$cursor;return t?t.pos:null}toString(){return this.isValid()?this._selection.toString():""}}class xE{constructor(t,e,n){this._position=t,this._coreNode=e,this._coreDom=n}getPosition(){return this._position||console.warn("EditorViewNode.getPosition() called without position"),this._position||0}getFirstTextCharacterPosition(){try{if(this._coreNode&&this._coreNode.content.content){var t=this._position||0;for(let n=0;n<this._coreNode.content.content.length;n++){var e;const r=this._coreNode.content.content[n];if(r&&r.isText&&(null===(e=r.text)||void 0===e?void 0:e.length)>0)return t+1;r&&(t+=r.nodeSize)}}}catch(t){console.error("Error while getting first text character position",t)}return this.getPosition()}getSize(){return this._coreNode?this._coreNode.nodeSize:0}hasCoreNode(){return!!this._coreNode}getCoreNode(){return this._coreNode}getNode(){return new rC(this._coreNode)}hasCoreDom(){return!!this._coreDom}getDom(){return this._coreDom}}const CE=class{constructor(t){this._coreView=t}hasCoreView(){return!!this._coreView}hasCoreState(){return!(!this._coreView||!this._coreView.state)}getCoreState(){return this._coreView&&this._coreView.state}getDOM(){return this._coreView&&this._coreView.dom}getState(){return this.hasCoreState()?new State(this.getCoreState()):null}getRoot(){return this.hasCoreState()&&this._coreView.dom?new xE(0,this._coreView.state.doc,this._coreView.dom):null}getChildren(t){var e=[];if(this.hasCoreState()){let n=0,r=this._coreView.state.doc;t&&t.hasCoreNode()&&(n=t.getPosition(),r=t.getCoreNode()),r.content.forEach((t,r)=>{let o=n+r+1,i=this._coreView.nodeDOM(o);e.push(new xE(o,t,i))})}return e}getDescendants(t){var e=[];if(this.hasCoreState()){let n=this._coreView.state.doc;t&&t.hasCoreNode()&&(n=t.getCoreNode()),n.content.descendants((t,n)=>{var r=this._coreView.nodeDOM(n);return e.push(new xE(n,t,r)),!0})}return e}walk(t){this.hasCoreState()&&this._coreView.state.doc.content.descendants((e,n,r,o)=>{var i=this._coreView.nodeDOM(n);return t(new xE(n,e,i),new rC(r),o),!0})}domElementAtPos(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(this.hasCoreView()){var n=this._coreView.domAtPos(t).node;if(!n)return null;if(e=e.map(t=>t.toUpperCase()),e.length&&!e.includes(n.nodeName))for(;n&&!e.includes(n.nodeName);)n=n.parentNode;return n}return null}};function SE(t,e,n){return(e=function(t){var e=function(t){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class EE{constructor(t,e,n){this.nodes=t,this.marks=e,this.options=n}serialize(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=Object.assign({},this.options,e);let n=new _E(this.nodes,this.marks,e);return n.renderContent(t),null!=e.maxSize?ME(n.out,e.maxSize):n.out}serializeBefore(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=Object.assign({},this.options,e);const n={};t.descendants((t,e,r)=>("heading"===t.type.name&&(n[t.attrs.level]=t),!0)),e.writeDetails=Object.entries(n).every(t=>{let[e,n]=t;return null===n}),e.headings=n;let r=new _E(this.nodes,this.marks,e);return r.renderContent(t),null!=e.maxSize?ME(r.out,e.maxSize):r.out}serializeAfter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=Object.assign({},this.options,e);let n=new _E(this.nodes,this.marks,e);return n.renderContent(t),null!=e.maxSize?ME(n.out,e.maxSize):n.out}}function ME(t,e){if(t.length<=e)return t;let n=t.slice(0,e),r=n.lastIndexOf("\n");return-1!==r?n.slice(0,r):n}class _E{constructor(t,e,n){SE(this,"delim",""),SE(this,"out",""),SE(this,"closed",null),SE(this,"inAutolink",void 0),SE(this,"atBlockStart",!1),SE(this,"inTightList",!1),this.nodes=t,this.marks=e,this.options=n,void 0===this.options.tightLists&&(this.options.tightLists=!1),void 0===this.options.hardBreakNodeName&&(this.options.hardBreakNodeName="hard_break"),void 0===this.options.skipEmptyBlocks&&(this.options.skipEmptyBlocks=!1)}flushClose(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;if(this.closed){if(this.atBlank()||(this.out+="\n"),t>1){let e=this.delim,n=/\s+$/.exec(e);n&&(e=e.slice(0,e.length-n[0].length));for(let n=1;n<t;n++)this.out+=e}this.closed=null}}wrapBlock(t,e,n,r){let o=this.delim;this.write(null!=e?e:t),this.delim+=t,r(),this.delim=o,this.closeBlock(n)}atBlank(){return/(^|\n)$/.test(this.out)}ensureNewLine(){this.atBlank()||(this.out+="\n")}write(t){this.flushClose(),this.delim&&this.atBlank()&&(this.out+=this.delim),t&&(this.out+=t)}closeBlock(t){this.closed=t}text(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.split("\n");for(let t=0;t<n.length;t++)this.write(),!e&&"["==n[t][0]&&/(^|[^\\])\!$/.test(this.out)&&(this.out=this.out.slice(0,this.out.length-1)+"\\!"),this.out+=e?this.esc(n[t],this.atBlockStart):n[t],t!=n.length-1&&(this.out+="\n")}render(t,e,n){if(!this.nodes[t.type.name])throw new Error("Token type `"+t.type.name+"` not supported by Markdown renderer");this.nodes[t.type.name](this,t,e,n)}renderContent(t){t.forEach((e,n,r)=>{this.render(e,t,r)})}renderInline(t){this.atBlockStart=!0;let e=[],n="",r=(r,o,i)=>{let s=r?r.marks:[];r&&r.type.name===this.options.hardBreakNodeName&&(s=s.filter(e=>{if(i+1==t.childCount)return!1;let n=t.child(i+1);return e.isInSet(n.marks)&&(!n.isText||/\S/.test(n.text))}));let a=n;if(n="",r&&r.isText&&s.some(t=>{let n=this.marks[t.type.name];return n&&n.expelEnclosingWhitespace&&!t.isInSet(e)})){let[t,n,o]=/^(\s*)(.*)$/m.exec(r.text);n&&(a+=n,(r=o?r.withText(o):null)||(s=e))}if(r&&r.isText&&s.some(e=>{let n=this.marks[e.type.name];return n&&n.expelEnclosingWhitespace&&(i==t.childCount-1||!e.isInSet(t.child(i+1).marks))})){let[t,o,i]=/^(.*?)(\s*)$/m.exec(r.text);i&&(n=i,(r=o?r.withText(o):null)||(s=e))}let l=s.length?s[s.length-1]:null,c=l&&!1===this.marks[l.type.name].escape,u=s.length-(c?1:0);t:for(let t=0;t<u;t++){let n=s[t];if(!this.marks[n.type.name].mixable)break;for(let r=0;r<e.length;r++){let o=e[r];if(!this.marks[o.type.name].mixable)break;if(n.eq(o)){t>r?s=s.slice(0,r).concat(n).concat(s.slice(r,t)).concat(s.slice(t+1,u)):r>t&&(s=s.slice(0,t).concat(s.slice(t+1,r)).concat(n).concat(s.slice(r,u)));continue t}}}let d=0;for(;d<Math.min(e.length,u)&&s[d].eq(e[d]);)++d;for(;d<e.length;)this.text(this.markString(e.pop(),!1,t,i),!1);if(a&&this.text(a),r){for(;e.length<u;){let n=s[e.length];e.push(n),this.text(this.markString(n,!0,t,i),!1),this.atBlockStart=!1}c&&r.isText?this.text(this.markString(l,!0,t,i)+r.text+this.markString(l,!1,t,i+1),!1):this.render(r,t,i),this.atBlockStart=!1}r&&r.isText&&r.nodeSize>0&&(this.atBlockStart=!1)};t.forEach(r),r(null,0,t.childCount),this.atBlockStart=!1}renderList(t,e,n){this.closed&&this.closed.type==t.type?this.flushClose(3):this.inTightList&&this.flushClose(1);let r=void 0!==t.attrs.tight?t.attrs.tight:this.options.tightLists,o=this.inTightList;this.inTightList=r,t.forEach((o,i,s)=>{s&&r&&this.flushClose(1),this.wrapBlock(e,n(s),t,()=>this.render(o,t,s))}),this.inTightList=o}esc(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t=t.replace(/[`*\\~\[\]_]/g,(e,n)=>"_"==e&&n>0&&n+1<t.length&&t[n-1].match(/\w/)&&t[n+1].match(/\w/)?e:"\\"+e),e&&(t=t.replace(/^[\-*+>]/,"\\$&").replace(/^(\s*)(#{1,6})(\s|$)/,"$1\\$2$3").replace(/^(\s*\d+)\.\s/,"$1\\. ")),this.options.escapeExtraCharacters&&(t=t.replace(this.options.escapeExtraCharacters,"\\$&")),t}quote(t){let e=-1==t.indexOf('"')?'""':-1==t.indexOf("'")?"''":"()";return e[0]+t+e[1]}repeat(t,e){let n="";for(let r=0;r<e;r++)n+=t;return n}markString(t,e,n,r){let o=this.marks[t.type.name],i=e?o.open:o.close;return"string"==typeof i?i:i(this,t,n,r)}getEnclosingWhitespace(t){return{leading:(t.match(/^(\s+)/)||[void 0])[0],trailing:(t.match(/(\s+)$/)||[void 0])[0]}}containsTextNode(t){let e=!1;return t.descendants(t=>(e|=t.isText,!e)),e}}const TE={title(t,e){t.write("# "),t.renderInline(e),t.closeBlock(e)},heading(t,e){t.write(t.repeat("#",e.attrs.level+1)+" "),t.renderInline(e),t.closeBlock(e)},blockquote(t,e){t.wrapBlock("> ",null,e,()=>t.renderContent(e))},codeBlock(t,e){if(t.options.skipEmptyBlocks&&!t.containsTextNode(e))return;const n=e.textContent.match(/`{3,}/gm),r=n?n.sort().slice(-1)[0]+"`":"```";t.write(r+(e.attrs.params||"")+"\n"),t.text(e.textContent,!1),t.write("\n"),t.write(r),t.closeBlock(e)},bulletList(t,e){t.options.skipEmptyBlocks&&!t.containsTextNode(e)||t.renderList(e,"  ",()=>(e.attrs.bullet||"*")+" ")},orderedList(t,e){if(t.options.skipEmptyBlocks&&!t.containsTextNode(e))return;let n=e.attrs.order||1,r=String(n+e.childCount-1).length,o=t.repeat(" ",r+2);t.renderList(e,o,e=>{let o=String(n+e);return t.repeat(" ",r-o.length)+o+". "})},listItem(t,e){t.renderContent(e)},paragraph(t,e){t.renderInline(e),t.closeBlock(e)},hardBreak(t,e,n,r){if(null!=n)for(let o=r+1;o<n.childCount;o++)if(n.child(o).type!=e.type)return void t.write("\n")},text(t,e){t.text(e.text,!t.inAutolink)},spacer(t,e){t.write("\n\n")},table(t,e){var n,r;if(t.options.skipEmptyBlocks&&!t.containsTextNode(e))return;let o="tableHeader"===(null===(n=e.firstChild)||void 0===n||null===(r=n.child)||void 0===r||null===(r=r.call(n,0))||void 0===r||null===(r=r.type)||void 0===r?void 0:r.name),i=e.content.content;for(let e=0;e<i.length;e++){let n=i[e];t.write("|"),t.render(n),t.write("\n"),0===e&&o&&t.write(`|${Array(n.childCount).fill(" --- ").join("|")}|\n`)}t.write("\n")},tableRow(t,e){t.renderInline(e)},tableHeader(t,e){var n;const r=null===(n=e.textContent)||void 0===n?void 0:n.replace(/\n/g," ").trim();null!=r&&t.write(` ${r}`),t.write(" |")},tableCell(t,e){var n;const r=null===(n=e.textContent)||void 0===n?void 0:n.replace(/\n/g," ").trim();null!=r&&t.write(` ${r}`),t.write(" |")}},DE={...TE,heading(t,e){null!=t.options.headingLevel&&e.attrs.level>t.options.headingLevel||(TE.heading(t,e),t.options.headingLevel=e.attrs.level)},blockquote(t,e){null==t.options.headingLevel&&TE.blockquote(t,e)},codeBlock(t,e){null==t.options.headingLevel&&TE.codeBlock(t,e)},bulletList(t,e){null==t.options.headingLevel&&TE.bulletList(t,e)},orderedList(t,e){null==t.options.headingLevel&&TE.orderedList(t,e)},paragraph(t,e){null==t.options.headingLevel&&TE.paragraph(t,e)},hardBreak(t,e,n,r){null==t.options.headingLevel&&TE.hardBreak(t,e)},spacer(t,e){null==t.options.headingLevel&&TE.spacer(t,e)},table(t,e){null==t.options.headingLevel&&TE.table(t,e)}},OE={...TE,heading(t,e){t.options.headings[e.attrs.level]===e&&(t.options.headings[e.attrs.level]=null,t.options.writeDetails=Object.entries(t.options.headings).every(t=>{let[e,n]=t;return null===n})),null==t.options.headings[e.attrs.level-1]&&TE.heading(t,e)},blockquote(t,e){1==t.options.writeDetails&&TE.blockquote(t,e)},codeBlock(t,e){1==t.options.writeDetails&&TE.codeBlock(t,e)},bulletList(t,e){1==t.options.writeDetails&&TE.bulletList(t,e)},orderedList(t,e){1==t.options.writeDetails&&TE.orderedList(t,e)},paragraph(t,e){1==t.options.writeDetails&&TE.paragraph(t,e)},hardBreak(t,e,n,r){1==t.options.writeDetails&&TE.hardBreak(t,e)},spacer(t,e){1==t.options.writeDetails&&TE.spacer(t,e)},table(t,e){1==t.options.writeDetails&&TE.table(t,e)}},NE={em:{open:"*",close:"*",mixable:!0,expelEnclosingWhitespace:!0},italic:{open:"*",close:"*",mixable:!0,expelEnclosingWhitespace:!0},bold:{open:"**",close:"**",mixable:!0,expelEnclosingWhitespace:!0},strong:{open:"**",close:"**",mixable:!0,expelEnclosingWhitespace:!0},anchorMark:{open:()=>"",close:()=>"",mixable:!0,expelEnclosingWhitespace:!1},strike:{open:"",close:"",mixable:!0,expelEnclosingWhitespace:!1},underline:{open:"",close:"",mixable:!0,expelEnclosingWhitespace:!1},inlineHookMark:{open:"",close:"",mixable:!0,expelEnclosingWhitespace:!1},link:{open:(t,e,n,r)=>(t.inAutolink=function(t,e,n){if(t.attrs.title||!/^\w+:/.test(t.attrs.href))return!1;let r=e.child(n);return!(!r.isText||r.text!=t.attrs.href||r.marks[r.marks.length-1]!=t||n!=e.childCount-1&&t.isInSet(e.child(n+1).marks))}(e,n,r),t.inAutolink?"<":"["),close(t,e,n,r){let{inAutolink:o}=t;return t.inAutolink=void 0,o?">":"]("+(e.attrs.href?e.attrs.href.replace(/[\(\)"]/g,"\\$&"):"")+(e.attrs.title?` "${e.attrs.title.replace(/"/g,'\\"')}"`:"")+")"},mixable:!0},code:{open:(t,e,n,r)=>IE(n.child(r),-1),close:(t,e,n,r)=>IE(n.child(r-1),1),escape:!1}};function IE(t,e){let n,r=/`+/g,o=0;if(t.isText)for(;n=r.exec(t.text);)o=Math.max(o,n[0].length);let i=o>0&&e>0?" `":"`";for(let t=0;t<o;t++)i+="`";return o>0&&e<0&&(i+=" "),i}class LE{constructor(t,e,n,r,o,i,s){this.element=t,this.editable=n,this.titlePlaceholder=r,this.domScaleGetter=o,this.enableRightToLeft=i,this.enableTables=s,this.content="string"==typeof e?e?JSON.parse(e):null:e||null}}class RE{constructor(t,e){this.element=t,this.canShowGetter=e}}class BE{constructor(t,e){this.hookId=t,this.offset=e}getHookId(){return this.hookId||console.warn("[getHookId] hookId is not set"),this.hookId||""}getOffset(){return null==this.offset&&console.warn("[getOffset] offset is not set"),this.offset||0}}class $E{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.from=t,this.to=e,this.lineHeight=n,this.yoffset=r}getFrom(){return this.from}getTo(){return this.to}getLineHeight(){return this.lineHeight}getYOffset(){return this.yoffset}}class PE{constructor(t,e){this.from=t,this.to=e}setEmpty(){return this.to=this.from,this.isEmpty()}getFrom(){return null==this.from&&console.warn("[getFrom] from is not set"),this.from}getTo(){return null==this.to&&console.warn("[getTo] to is not set"),this.to}isEmpty(){return this.from==this.to}}class FE{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;this.contentOptions=t,this.bubbleMenuOptions=e,this.yjsProvider=n,this._createEditor(r),window.isEditable=()=>this.editor.isEditable}_createEditor(t){const e={element:this.contentOptions.element,extensions:[rE,oE,wg.configure({domScaleGetter:this.contentOptions.domScaleGetter}),Nx.configure({placeholder:this.contentOptions.titlePlaceholder}),...bx(this.contentOptions),rc,iC,Lx.configure({onlyOnShiftKey:!0,onPasteHandler:e=>{t.onPaste&&t.onPaste(e)},onTablePasteHandler:(e,n,r)=>{t.onTablePaste&&t.onTablePaste({hasTableNodes:r.hasTable,tablesSupported:!0===this.contentOptions.enableTables,rows:r.rows,cols:r.cols,cellSizes:r.cellSizes})}}),Px.configure({onLinkClick:e=>{t.onLinkClick&&t.onLinkClick(e)}}),Bx,nc.configure({className:"has-focus"}),eE.configure({element:this.bubbleMenuOptions.element,domScaleGetter:this.contentOptions.domScaleGetter,canShowGetter:this.bubbleMenuOptions.canShowGetter}),SC.configure({onMarkUpdate:e=>{t.onAnchorMarkUpdate&&t.onAnchorMarkUpdate(e)},onMarkDeletion:e=>{t.onAnchorMarkDeletion&&t.onAnchorMarkDeletion(e)},onMouseEnter:(e,n)=>{t.onAnchorMarkMouseEnter&&t.onAnchorMarkMouseEnter(e,n)},onMouseLeave:(e,n)=>{t.onAnchorMarkMouseLeave&&t.onAnchorMarkMouseLeave(e,n)},onSelectionEnter:(e,n)=>{t.onAnchorMarkSelectionEnter&&t.onAnchorMarkSelectionEnter(e,n)},onSelectionLeave:(e,n)=>{t.onAnchorMarkSelectionLeave&&t.onAnchorMarkSelectionLeave(e,n)}}),Ux.configure({onTransaction:e=>{t.onTransaction&&t.onTransaction(new AE(e))}}),Yx.configure({onTransaction:e=>{t.onTransaction&&t.onTransaction(new AE(e))}}),Zx,$x],content:this.yjsProvider?"":this.contentOptions.content||"",editable:this.contentOptions.editable||!0,autofocus:!1,editorProps:{clipboardTextParser:cC,transformPastedText:kx,transformPastedHTML:xx,attributes:{class:"text-editor-content-inner"}},onCreate:e=>{const n=t.onCreate;this.editor.view?(console.debug("TipTap : [onCreate] editor is already created"),n()):(console.debug("TipTap : [onCreate] waiting for editor to be created"),this.editor.on("create",t=>{let{editor:e}=t;console.debug("TipTap : [onCreate] editor is created"),n()}))},onFocus:e=>{t.onFocus()},onBlur:e=>{t.onBlur()},onUpdate:e=>{let{transaction:n}=e;t.onUpdate(new AE(n))},onSelectionUpdate:e=>{let{editor:n,transaction:r}=e;var o=this.getSelectionCoordinatePairs(!1);if(o&&o.length>0){const t=new CustomEvent("selectionUpdated",{detail:o});document.dispatchEvent(t)}t.onSelectionUpdate(new AE(r))},onTransaction:e=>{let{editor:n,transaction:r}=e;t.onTransaction(new AE(r))}};this.yjsProvider?e.extensions.push(ig.configure({document:this.yjsProvider.document})):e.extensions.push(Ix),this.editor=new cl(e)}destroy(){var t,e;null===(t=this.editor)||void 0===t||null===(e=t.destroy)||void 0===e||e.call(t),this.editor=null,this.bubbleMenuOptions=null}getDom(){return this.editor.view.dom}getTitle(){return function(t){if(!t)return"";const e=t.state.doc.nodeAt(0);return e&&e.type.name==Ox.name?e.textContent:""}(this.editor)}setTitle(t,e){this.editor.chain().setMeta("addToHistory",e).setTitle(t).run()}getTitleHookId(){return this.editor.state.doc.content.content[0].attrs.hookId}hasFocus(){return this.editor.isFocused}getContent(){return JSON.stringify(this.editor.getJSON())}initWithText(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};yx(this.editor,t,e,{...n,fromImport:!0},this.contentOptions)}setContent(t){if(!this.yjsProvider){var e={};if(t)try{e=JSON.parse(t)}catch(t){console.error("[setContent] Error while parsing content",t)}this.editor.chain().command(t=>{let{tr:e}=t;const n=e.curSelection,r=this.positionToRelative(n.$anchor.pos,e.doc),o=this.positionToRelative(n.$head.pos,e.doc);return e.setMeta("anchor",r),e.setMeta("head",o),!0}).setContent(e).command(t=>{let{tr:e}=t;const n=e.getMeta("anchor"),r=e.getMeta("head"),o=this.relativeToPosition(n.hookId,n.offset,e.doc)||0,i=this.relativeToPosition(r.hookId,r.offset,e.doc)||0;return e.setSelection(new he(e.doc.resolve(o),e.doc.resolve(i))),!0}).run()}}isEmptyAfterTitle(){try{const t=this.editor.state.doc;for(const e of t.content.content)if((!e||"title"!=e.type.name)&&e&&e.content&&e.content.size>0&&e.content.content)for(const t of e.content.content)if(t&&t.type&&t.type.isText&&t.text&&t.text.length>0)return!1}catch(t){console.error("[isEmptyAfterTitle] Error while checking if content is empty",t)}return console.debug("[isEmptyAfterTitle] Content is empty after title:",this.getText()),!0}getText(){return this.editor.state.doc.textContent}isSelectable(){return this.editor.isEditable}setSelectable(t){t||this.clearSelection()}isEditable(){return this.editor.isEditable}setEditable(t){this.editor.setEditable(t),t&&this.setSelectable(!0),this.editor.extensionManager.extensions.forEach(e=>{"title"===e.name&&(e.options.placeholder=t?this.contentOptions.titlePlaceholder:"")})}isEmpty(){return this.editor.isEmpty}focusStart(){return this.editor.commands.focus("start")}focusEnd(){return this.editor.commands.focus("end")}focusAt(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!this.isEditable())return this._focusEditor(null,e,n);switch(t){case"start":case"end":case Number.isInteger(t)&&t:return this._focusEditor(t,e,n);case"firstLine":return void function(t,e,n){if(!t)return!1;const r=t.state.doc.nodeAt(0);if(!r||r.type.name!=Ox.name)return!1;const o=t.state.doc.resolve(0+r.content.size),i=Math.min(o.after(1)+1,t.state.doc.content.size-1);t.chain().setMeta("addToHistory",n).focus(i,{scrollIntoView:e}).run()}(this.editor,{scrollIntoView:e},n);default:return this._focusEditor(null,e,n)}}_focusEditor(t,e,n){return this.editor.chain().setMeta("addToHistory",n).focus(t,{scrollIntoView:e}).run()}focus(){return this.editor.chain().focus().run()}blur(){return this.editor.chain().blur().run()}undo(){return this.editor.commands.undo()}canUndo(){return this.editor.can().undo()}getUndoDepth(){return this.yjsProvider?function(t){return sc.getState(t.state).undoManager.undoStack.length}(this.editor)||0:function(t){return function(t){let e=Yl.getState(t);return e?e.done.eventCount:0}(t.state)}(this.editor)||0}redo(){return this.editor.commands.redo()}canRedo(){return this.editor.can().redo()}getRedoDepth(){return this.yjsProvider?function(t){return sc.getState(t.state).undoManager.redoStack.length}(this.editor)||0:function(t){return function(t){let e=Yl.getState(t);return e?e.undone.eventCount:0}(t.state)}(this.editor)||0}bold(){this.editor.chain().focus().toggleBold().run()}isBold(){return this.editor.isActive("bold")}italic(){this.editor.chain().focus().toggleItalic().run()}isItalic(){return this.editor.isActive("italic")}strike(){this.editor.chain().focus().toggleStrike().run()}isStrike(){return this.editor.isActive("strike")}underline(){this.editor.chain().focus().toggleUnderline().run()}isUnderline(){return this.editor.isActive("underline")}heading1(){this.isCode()&&this.editor.chain().focus().toggleCode().run(),this.editor.chain().focus().toggleHeading({level:1}).run()}isHeading1(){return this.editor.isActive("heading",{level:1})}heading2(){this.isCode()&&this.editor.chain().focus().toggleCode().run(),this.editor.chain().focus().toggleHeading({level:2}).run()}isHeading2(){return this.editor.isActive("heading",{level:2})}heading3(){this.editor.chain().focus().toggleHeading({level:3}).run()}isHeading3(){return this.editor.isActive("heading",{level:3})}headingNone(){this.editor.isActive("heading")&&this.editor.chain().focus().toggleHeading().run()}isHeadingNone(){return!this.editor.isActive("heading")}bulletList(){this.editor.chain().focus().toggleBulletList().run()}isBulletList(){return this.editor.isActive("bulletList")}orderedList(){this.editor.chain().focus().toggleOrderedList().run()}isOrderedList(){return this.editor.isActive("orderedList")}taskList(){this.editor.chain().focus().toggleTaskList().run()}isTaskList(){return this.editor.isActive("taskList")}code(){this.editor.chain().focus().toggleCode().run()}isCode(){return this.editor.isActive("code")}codeBlock(){this.editor.chain().focus().toggleCodeBlock().run()}isCodeBlock(){return this.editor.isActive("codeBlock")}setAlignment(t){"justify"!==t&&"left"!==t&&"center"!==t&&"right"!==t||this.editor.chain().focus().setTextAlign(t).run()}getAlignment(){return this.isAlignment("justify")?"justify":this.isAlignment("left")?"left":this.isAlignment("center")?"center":this.isAlignment("right")?"right":void 0}isAlignment(t){return("justify"===t||"left"===t||"center"===t||"right"===t)&&this.editor.isActive({textAlign:t})}blockquote(){this.editor.chain().focus().toggleBlockquote().run()}isBlockquote(){return this.editor.isActive("blockquote")}isTitle(){return this.editor.isActive("title")}addImage(t){}isImage(){return!1}addLink(t){t&&this.editor.chain().focus().setLink({href:t}).run()}removeLink(){this.editor.chain().focus().unsetLink().run()}isLink(){return this.editor.isActive("link")}getPosition(){return this.editor.state.selection.anchor}getPositionAt(t,e){try{var n=this.editor.view.posAtCoords({left:t,top:e});return n?n.pos:null}catch(t){return console.error("[getPositionAt] Error while getting position at viewport coordinates",t),null}}getBlockPositionAt(t,e){try{var n=this.editor.view.posAtCoords({left:t,top:e});return n?-1!=n.inside?n.inside:n.pos:null}catch(t){return console.error("[getBlockPositionAt] Error while getting block position at viewport coordinates",t),null}}hasSelection(){return this.editor.state.selection.$anchor.pos!=this.editor.state.selection.$head.pos}getSelectionCoords(){return this.getViewportCoordsAt(this.getPosition())}getSelectionStartCoords(){const t=this.editor.state.selection;return null==t?null:this.getViewportCoordsAt(t.$from.pos)}getSelectionEndCoords(){const t=this.editor.state.selection;return null==t?null:this.getViewportCoordsAt(t.$to.pos)}isCharacterBlankAtPosition(t){try{return""===this.editor.state.doc.textBetween(t,t+1).trim()}catch(e){return console.warn(`[isCharacterBlankAtPosition] Error while checking if character is blank at position ${t} (doc size=${this.editor.state.doc.content.size})`,e),!1}}getTopOffset(t){var e=t.bottom-t.top;return e<20?0:e<26||e<36?2:e<96?6:void 0}getYOffsetForHookCreation(t){var e=t.bottom-t.top;return e<20?10:e<26?8:e<36?12:e<50?18:e<96?24:0}generateCoordinatePairs(t,e){const n=[];let r=this.getViewportCoordsAt(t),o=!this.isCharacterBlankAtPosition(t);for(let a=t+1;a<e;a++){let t=this.getViewportCoordsAt(a);o||(o=!this.isCharacterBlankAtPosition(a));const e=t.top-r.top;if(Math.abs(e)>8){if(o){let t=this.getViewportCoordsAt(a-1);var i=0,s=this.getYOffsetForHookCreation(r);let e=r.bottom-r.top>0?r.bottom-r.top:18;r.top=r.top+i,t.top=t.top+i,n.push(new $E(r,t,e,s))}o=!1,r=t}}let a=0;for(let t=e;t<e+200;t++){const e=this.getViewportCoordsAt(t).top-r.top;if(Math.abs(e)>8){a=e;break}}let l=this.getViewportCoordsAt(e);return i=0,a=r.bottom-r.top>0?r.bottom-r.top:18,s=this.getYOffsetForHookCreation(r),r.top=r.top+i,l.top=l.top+i,n.push(new $E(r,l,a,s)),n}getSelectionCoordinatePairs(){try{const t=this.editor.state.selection;return t?this.generateCoordinatePairs(t.$from.pos,t.$to.pos):null}catch(t){return console.error(t),null}}generateCoordinatePairsFromHooks(t,e){if(null==t||null==e)return[];const n=this.editor.state.doc,r=jx(n,t),o=jx(n,e);if(null===r||null===o)return console.error("Invalid hookIds provided."),[];const i=Math.min(r,o),s=Math.max(r,o);return this.generateCoordinatePairs(i,s+1)}getRangeText(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\n";return t.from==t.to?"":this.editor.state.doc.textBetween(Math.min(t.from,t.to),Math.max(t.from,t.to),e)||""}_getParentNodeForSubNodeId(t,e){const n=this.editor.state.doc,r=jx(n,t.parentId);if(null==r)return console.warn(`[${e}] Parent node not found for subNode ID:`,t.parentId),null;const o=n.nodeAt(r);return o?{parentNode:o,parentPos:r}:(console.warn(`[${e}] Parent node is null for subNode ID:`,t.parentId),null)}getNodeSize(t){const e=zx(t);if(e){const n=this._getParentNodeForSubNodeId(e,"getNodeSize");if(!n)return 0;const r=function(t,e,n){const r=Hx(t,e,n,"getChildSizeByIndex");return r?r.nodeSize:0}(n.parentNode,e.type,e.index);return 0===r&&console.warn("[getNodeSize] Child not found for subNode ID:",t,"type:",e.type,"index:",e.index),r}const n=Fx(this.editor,t);if(!n)return console.warn("[getNodeSize] Cannot find hookId: hookLocation is not found",t),0;if(!n.block||!n.block.nodeSize)return console.warn("[getNodeSize] Cannot find hookId: block or nodeSize is not found",t,n),0;const r=n.block.nodeSize||null;return null==r&&console.warn("[getNodeSize] Cannot find hookId",t),r||0}getRangeMarkdown(t,e,n){const r=this._clampPosition(Math.min(t.from,t.to)),o=this._clampPosition(Math.max(t.from,t.to));if(r==o)return"";const i=this.editor.state.doc.slice(r,o,!0).content;let s="";switch(e){case 1:s=function(t,e){return new EE(OE,NE,{skipEmptyBlocks:!0,maxSize:e}).serializeBefore(t)}(i,n);break;case 2:s=function(t,e){return new EE(DE,NE,{skipEmptyBlocks:!0,maxSize:e}).serializeAfter(t)}(i,n);break;default:s=function(t,e){return new EE(TE,NE,{maxSize:e}).serialize(t)}(i,n)}return s||""}getSelectionText(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\n";const e=this.editor.state.selection;return null==e?"":this.editor.state.doc.textBetween(e.$from.pos,e.$to.pos,t)||""}getViewportCoordsAt(t){const e=this.editor.view.coordsAtPos(this._clampPosition(t));return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}positionToRelative(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.editor.state.doc;const n=Vx(e,t);if(null==n)return new BE("",t);if(null==n.attrs.hookId)return new BE("",t);const r=this.relativeToPosition(n.attrs.hookId,0,e);return null==r?new BE("",t):new BE(n.attrs.hookId,t-r)}relativeToPosition(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.editor.state.doc;if(null==t||""==t)return this._clampPosition(e,n);const r=zx(t);if(r){const o=this._getParentNodeForSubNodeId(r,"relativeToPosition");if(!o)return null;const i=function(t,e,n,r){if(!Hx(t,n,r,"getChildPositionByIndex"))return null;let o=e+1;for(let e=0;e<r;e++)o+=t.content.child(e).nodeSize;return o}(o.parentNode,o.parentPos,r.type,r.index);return null==i?(console.warn("[relativeToPosition] Child not found for subNode ID:",t,"type:",r.type,"index:",r.index),null):this._clampPosition(i+e,n)}const o=jx(n,t);return null==o?null:this._clampPosition(o+e,n)}getSelectionRange(){const t=this.editor.state.selection;return new PE(t.$anchor.pos,t.$head.pos)}setSelectionRange(t){this.editor.commands.setTextSelection({from:t.from,to:t.to})}getNodeRange(t,e){const n=this.editor.state.doc.resolve(t);return-1==e&&(e=n.depth),new PE(n.start(e),n.end(e))}isBlockHook(){return this.editor.isActive("blockHook")}isInlineHook(){return this.editor.isActive("inlineHook")}addInlineHookMark(t,e,n){t=this._clampPosition(t),this.editor.chain().setInlineHookMark({editor:this.editor,position:t,id:e,nodeSearchForward:n}).run()}removeInlineHookMark(t){const e=this.getHookCoords(t);if(null==e)return null;const n=this._clampPosition(e.position);this.editor.chain().unsetInlineHookMark({position:n,nodeSearchForward:!0}).run()}isHookIdValid(t){return null!=t&&null!=Fx(this.editor,t)}isInlineHookMark(){return this.editor.isActive("inlineHookMark")}getHookCoords(t){const e=Fx(this.editor,t);return null==e?null:{...e}}getHookPosition(t){const e=Fx(this.editor,t);return null==e?null:e.position}getInlineHookIdAtPosition(t,e){return function(t,e,n){if(null==e)return null;try{const r=t.state.doc,o=Wx(t,e,!1,n);if(null==o||o<0)return console.warn("getInlineHookIdAtPosition: nodePos is "+(null==o?"null":"negative"),{nodePos:o,position:e,nodeSearchForward:n}),null;const i=r.nodeAt(o);if(i&&i.marks.length){let t=i.marks.find(t=>"inlineHook"===t.attrs.hookType);if(t)return t.attrs.hookId}}catch(t){console.error("getInlineHookIdAtPosition: try/catch error",t,{position:e,nodeSearchForward:n})}return null}(this.editor,this._clampPosition(t),e)}hasInlineHookWithId(t){return function(t,e){if(!t||!e)return!1;const n=[];t.descendants(t=>{n.push(...t.marks)});for(const t of n)if(t&&t.type&&"inlineHookMark"===t.type.name&&t.attrs.hookId===e)return!0;return!1}(this.editor.state.doc,t)}hasBlockHookWithId(t){return function(t,e){var n=!1;return t.descendants(t=>{t.attrs.hookId===e&&(n=!0)}),n}(this.editor.state.doc,t)}getBlockHookIdAtPosition(t){return function(t,e){if(null==e)return null;var n=Vx(t.state.doc,e);return console.assert(n,"node must exist"),n&&"blockHook"===n.attrs.hookType?n.attrs.hookId:null}(this.editor,this._clampPosition(t))}getAllSpacers(){return this.editor.commands.getAllSpacers()}insertSpacerAt(t,e){return this.editor.commands.insertSpacerAt(this._clampPosition(t),e)}removeSpacer(t){return this.editor.commands.removeSpacer(t)}updateSpacer(t,e,n,r){return this.editor.commands.updateSpacer(t,e,n,r)}syncSpacerHeight(t){return this.editor.commands.syncSpacerHeight(t)}getState(){return new vE(this.editor.state)}getView(){return new CE(this.editor.view)}expandContentToHeight(t){return this.editor.commands.expandContent(t)}replaceRangeContent(t,e,n){this.editor.chain().setMeta("addToHistory",n).insertContentAt(t,e).run()}insertBlankLines(t,e,n){const r=this.editor.state.doc.content.size,o=this.editor.state.doc.resolve(this._clampPosition(t)),i=Math.min(o.pos,this.editor.state.doc.content.size-1);return this.editor.commands.insertBlankLines(i,e,n),new PE(i,i+this.editor.state.doc.content.size-r)}deleteRange(t,e,n){return this.editor.commands.deleteRangeWithHistory(this._clampPosition(t),this._clampPosition(e),n)}getNodesBetween(t,e){const n=[];return this.editor.view.state.doc.nodesBetween(this._clampPosition(t),this._clampPosition(e),t=>{n.push(t)}),n.map(t=>new rC(t))}getBlockHookPosition(t){try{const{position:e}=Fx(this.editor,t);return null==e?null:this._clampPosition(e)}catch(t){return console.error("[getBlockHookPosition] Error while getting block hook position",t),null}}clearSlashCommand(t){return this.editor.commands.clearSlashCommand(t)}clearSelection(){var t=this.editor.state.selection.toJSON();if(null==t||t.head==t.anchor)return!1;var e=t.head;return!!e&&this.editor.commands.setTextSelection(e)}clearContent(t){this.editor.chain().setMeta("addToHistory",!1).clearContent(t).run()}positionAtEnd(){return le.atEnd(this.editor.state.doc).$from.pos}_clampPosition(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.editor.state.doc;return Math.min(Math.max(t,0),e.content.size-1)}redrawCommentHighlights(){let t=[];if(this.editor.state.doc.descendants(e=>{e.marks.some(t=>"inlineHookMark"===t.type.name)&&(t=[...t,...e.marks.map(t=>t.attrs.hookId)])}),t.length>0){const e=new CustomEvent("napkinEventMarksChanged",{detail:[...t]});t=[],document.dispatchEvent(e)}}addAnchorMark(t,e,n,r){let o=null;return this.editor.chain().addAnchorMark({startPosition:t,endPosition:e,type:n,entityId:r,onCreate:t=>{o=t}}).run(),o}removeAnchorMark(t){return this.editor.chain().removeAnchorMark({id:t}).run()}addAnchorMarkHighlight(t){this.editor.chain().addAnchorMarkHighlight({id:t}).run()}removeAnchorMarkHighlight(t){this.editor.chain().removeAnchorMarkHighlight({id:t}).run()}removeAllAnchorMarkHighlights(){this.editor.chain().removeAllAnchorMarkHighlights().run()}getAnchorMarkById(t){return function(t,e){const{state:n}=t,{doc:r}=n,o=n.schema.marks.anchorMark;let i=[],s=null,a=null;return r.descendants((t,n)=>{if(!t.isText||!t.marks)return!0;for(const r of t.marks)if(r.type===o&&r.attrs["data-anchor-id"]===e)return i.push(r),(null==s||n<s)&&(s=n),(null==a||n>a)&&(a=n+t.nodeSize),!1;return!0}),i.length>0&&s&&a?dC({marks:i,from:s,to:a}):null}(this.editor,t)}}class zE extends Nd{}class HE extends vp{}class jE extends yp{}function VE(t){return Lh(t)}},4881:(t,e,n)=>{var r=n(6258);t.exports=r},4899:(t,e,n)=>{t.exports=n(3836)},4901:t=>{var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},4909:(t,e,n)=>{var r=n(1436);t.exports=r},4913:(t,e,n)=>{var r=n(3724),o=n(5917),i=n(8686),s=n(8551),a=n(6969),l=TypeError,c=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",h="configurable",p="writable";e.f=r?i?function(t,e,n){if(s(t),e=a(e),s(n),"function"==typeof t&&"prototype"===e&&"value"in n&&p in n&&!n[p]){var r=u(t,e);r&&r[p]&&(t[e]=n.value,n={configurable:h in n?n[h]:r[h],enumerable:d in n?n[d]:r[d],writable:!1})}return c(t,e,n)}:c:function(t,e,n){if(s(t),e=a(e),s(n),o)try{return c(t,e,n)}catch(t){}if("get"in n||"set"in n)throw new l("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},5031:(t,e,n)=>{var r=n(7751),o=n(9504),i=n(8480),s=n(3717),a=n(8551),l=o([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(a(t)),n=s.f;return n?l(e,n(t)):e}},5044:(t,e,n)=>{var r=n(4644),o=n(4373),i=n(5854),s=n(6955),a=n(9565),l=n(9504),c=n(9039),u=r.aTypedArray,d=r.exportTypedArrayMethod,h=l("".slice);d("fill",function(t){var e=arguments.length;u(this);var n="Big"===h(s(this),0,3)?i(t):+t;return a(o,this,n,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)},c(function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t}))},5056:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},5072:t=>{var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var i={},s=[],a=0;a<t.length;a++){var l=t[a],c=r.base?l[0]+r.base:l[0],u=i[c]||0,d="".concat(c," ").concat(u);i[c]=u+1;var h=n(d),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)e[h].references++,e[h].updater(p);else{var f=o(p,r);r.byIndex=a,e.splice(a,0,{identifier:d,updater:f,references:1})}s.push(d)}return s}function o(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,o){var i=r(t=t||[],o=o||{});return function(t){t=t||[];for(var s=0;s<i.length;s++){var a=n(i[s]);e[a].references--}for(var l=r(t,o),c=0;c<i.length;c++){var u=n(i[c]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}i=l}}},5115:(t,e,n)=>{n(838)},5188:(t,e,n)=>{t.exports=n.p+"1a24fa9ae96a03e26599.svg"},5213:(t,e,n)=>{var r=n(4576),o=n(9039),i=r.RegExp,s=!o(function(){var t=!0;try{i(".","d")}catch(e){t=!1}var e={},n="",r=t?"dgimsy":"gimsy",o=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},s={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in t&&(s.hasIndices="d"),s)o(a,s[a]);return Object.getOwnPropertyDescriptor(i.prototype,"flags").get.call(e)!==r||n!==r});t.exports={correct:s}},5339:(t,e,n)=>{var r=n(4496);t.exports=r},5397:(t,e,n)=>{var r=n(7055),o=n(7750);t.exports=function(t){return r(o(t))}},5440:(t,e,n)=>{var r=n(8745),o=n(9565),i=n(9504),s=n(9228),a=n(9039),l=n(8551),c=n(4901),u=n(34),d=n(1291),h=n(8014),p=n(655),f=n(7750),g=n(7829),m=n(5966),y=n(2478),b=n(1034),v=n(6682),w=n(8227)("replace"),A=Math.max,k=Math.min,x=i([].concat),C=i([].push),S=i("".indexOf),E=i("".slice),M=function(t){return void 0===t?t:String(t)},_="$0"==="a".replace(/./,"$0"),T=!!/./[w]&&""===/./[w]("a","$0");s("replace",function(t,e,n){var i=T?"$":"$0";return[function(t,n){var r=f(this),i=u(t)?m(t,w):void 0;return i?o(i,t,r,n):o(e,p(r),t,n)},function(t,o){var s=l(this),a=p(t);if("string"==typeof o&&-1===S(o,i)&&-1===S(o,"$<")){var u=n(e,s,a,o);if(u.done)return u.value}var f=c(o);f||(o=p(o));var m,w=p(b(s)),_=-1!==S(w,"g");_&&(m=-1!==S(w,"u"),s.lastIndex=0);for(var T,D=[];null!==(T=v(s,a))&&(C(D,T),_);)""===p(T[0])&&(s.lastIndex=g(a,h(s.lastIndex),m));for(var O="",N=0,I=0;I<D.length;I++){for(var L,R=p((T=D[I])[0]),B=A(k(d(T.index),a.length),0),$=[],P=1;P<T.length;P++)C($,M(T[P]));var F=T.groups;if(f){var z=x([R],$,B,a);void 0!==F&&C(z,F),L=p(r(o,void 0,z))}else L=y(R,a,B,$,F,o);B>=N&&(O+=E(a,N,B)+L,N=B+R.length)}return O+E(a,N)}]},!!a(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})||!_||T)},5492:(t,e,n)=>{t.exports=n.p+"06eb96cda71f52bec39a.svg"},5610:(t,e,n)=>{var r=n(1291),o=Math.max,i=Math.min;t.exports=function(t,e){var n=r(t);return n<0?o(n+e,0):i(n,e)}},5745:(t,e,n)=>{var r=n(7629);t.exports=function(t,e){return r[t]||(r[t]=e||{})}},5818:(t,e,n)=>{n(7495),n(5440),n(9978);var r=n(7015);t.exports=r("String","replaceAll")},5854:(t,e,n)=>{var r=n(2777),o=TypeError;t.exports=function(t){var e=r(t,"number");if("number"==typeof e)throw new o("Can't convert number to bigint");return BigInt(e)}},5917:(t,e,n)=>{var r=n(3724),o=n(9039),i=n(4055);t.exports=!r&&!o(function(){return 7!==Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a})},5947:(t,e,n)=>{n(7978);var r=n(7506);t.exports=r},5966:(t,e,n)=>{var r=n(9306),o=n(4117);t.exports=function(t,e){var n=t[e];return o(n)?void 0:r(n)}},5973:(t,e,n)=>{t.exports=n.p+"9b8c9adfbc2cc3dee4c3.svg?v=2"},6080:(t,e,n)=>{var r=n(7476),o=n(9306),i=n(616),s=r(r.bind);t.exports=function(t,e){return o(t),void 0===e?t:i?s(t,e):function(){return t.apply(e,arguments)}}},6119:(t,e,n)=>{var r=n(5745),o=n(3392),i=r("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},6198:(t,e,n)=>{var r=n(8014);t.exports=function(t){return r(t.length)}},6241:(t,e,n)=>{t.exports=n.p+"f1a1a0dacd463952e219.svg"},6258:(t,e,n)=>{var r=n(2323);t.exports=r},6287:(t,e,n)=>{n.d(e,{A:()=>Et});var r=n(1354),o=n.n(r),i=n(6314),s=n.n(i),a=n(4417),l=n.n(a),c=new URL(n(5188),n.b),u=new URL(n(4340),n.b),d=new URL(n(8507),n.b),h=new URL(n(1443),n.b),p=new URL(n(2404),n.b),f=new URL(n(1204),n.b),g=new URL(n(3523),n.b),m=new URL(n(443),n.b),y=new URL(n(3556),n.b),b=new URL(n(5492),n.b),v=new URL(n(8881),n.b),w=new URL(n(7693),n.b),A=new URL(n(3229),n.b),k=new URL(n(3758),n.b),x=new URL(n(3859),n.b),C=new URL(n(7963),n.b),S=new URL(n(1261),n.b),E=new URL(n(5973),n.b),M=new URL(n(798),n.b),_=new URL(n(1890),n.b),T=new URL(n(7589),n.b),D=new URL(n(8145),n.b),O=new URL(n(6241),n.b),N=new URL(n(8157),n.b),I=new URL(n(850),n.b),L=new URL(n(4029),n.b),R=new URL(n(644),n.b),B=new URL(n(8019),n.b),$=new URL(n(3115),n.b),P=new URL(n(6941),n.b),F=new URL(n(6745),n.b),z=new URL(n(8138),n.b),H=new URL(n(4654),n.b),j=new URL(n(2274),n.b),V=new URL(n(8502),n.b),q=s()(o());q.push([t.id,"@import url(https://fonts.googleapis.com/css2?family=Inconsolata:wght@400&display=swap);"]);var U=l()(c),W=l()(u),J=l()(d),K=l()(h),G=l()(p),Y=l()(f),Z=l()(g),Q=l()(m),X=l()(y),tt=l()(b),et=l()(v),nt=l()(w),rt=l()(A),ot=l()(k),it=l()(x),st=l()(C),at=l()(S),lt=l()(E),ct=l()(M),ut=l()(_),dt=l()(T),ht=l()(D),pt=l()(O),ft=l()(N),gt=l()(I),mt=l()(L),yt=l()(R),bt=l()(B),vt=l()($),wt=l()(P),At=l()(F),kt=l()(z),xt=l()(H),Ct=l()(j),St=l()(V);q.push([t.id,`span[data-name=anchor-mark] .anchor-highlighted-syncWithText{background-color:rgba(26,198,255,.2)}.text-editor-menu{height:32px;box-sizing:border-box;border-radius:16px;position:relative;box-shadow:0px 0px 8px 0px rgba(0,0,0,.25);border:1px solid;background-color:#484848;border-color:#555}.night .text-editor-menu{background-color:#e6e6e6;border-color:#c8c8c8}.text-editor-menu{opacity:0;transform-origin:center bottom;transform:scale(0.25);transition:opacity .25s,transform .25s ease-out,background-color .5s,border-color .5s}.text-editor-menu.active{opacity:1;transform:scale(1)}.text-editor-menu.active .border .items_holder>div{opacity:1}.text-editor-menu:before{content:"";display:block;position:absolute;border:1px solid;border-width:0 1px 1px 0;background-color:inherit;border-color:inherit;width:8px;height:8px;left:50%;bottom:0;border-top-left-radius:10px;transform:translate(-4px, 5px) rotate(45deg)}.text-editor-menu .menu-section{margin:-1px;padding:0 3px;height:inherit;display:flex;align-items:center;cursor:pointer}.text-editor-menu .menu-section .menu-item{position:relative}.text-editor-menu .menu-section .menu-item button:first-child{margin-left:0px}.text-editor-menu .menu-section .menu-item .sub-menu-holder{position:absolute;top:-60px;left:-54px;display:block;height:calc(100% + 36px);opacity:0;pointer-events:none;transform-origin:center bottom;transform:scale(0.5);transition:opacity .2s ease-out,transform .2s ease-out}.text-editor-menu .menu-section .menu-item .sub-menu-holder.active{opacity:1;pointer-events:all;transform:scale(1)}.text-editor-menu .menu-section .menu-item .sub-menu-holder .sub-menu-container{display:flex;padding:12px;gap:10px;border-radius:16px;background-color:#484848;border-color:#555;color:#fff}.night .text-editor-menu .menu-section .menu-item .sub-menu-holder .sub-menu-container{background-color:#e6e6e6;border-color:#c8c8c8;color:#000}.text-editor-menu .menu-section .menu-item .sub-menu-holder .sub-menu-container::before{content:"";display:block;position:absolute;border:1px solid;border-width:0 1px 1px 0;background-color:inherit;border-color:inherit;width:8px;height:8px;left:50%;bottom:13px;border-top-left-radius:10px;transform:translate(-4px, 5px) rotate(45deg)}.text-editor-menu .menu-section .menu-item .sub-menu-holder .sub-menu-container .text-align-option{height:20px;width:20px;opacity:.42;transform:scale(1);transition:opacity .2s,transform .2s ease-in}.text-editor-menu .menu-section .menu-item .sub-menu-holder .sub-menu-container .text-align-option:hover{opacity:.6;transform:scale(1.25);transition:opacity .2s,transform .2s ease-out}.text-editor-menu .menu-section .menu-item .sub-menu-holder .sub-menu-container .text-align-option.selected{opacity:1;cursor:default;transform:none}.text-editor-menu button{width:28px;height:20px;padding:0px 8px;cursor:pointer;background:none;display:block;opacity:.42;transform:scale(1);transition:opacity .2s,transform .2s ease-in}.text-editor-menu button:hover{opacity:.6;transform:scale(1.25);transition:opacity .2s,transform .2s ease-out}.text-editor-menu button.active,.text-editor-menu button.active:hover{opacity:1}.text-editor-menu button.disabled{opacity:.15}.text-editor-menu button.hidden{display:none}.text-editor-menu button:first-child{margin-left:9px}.text-editor-menu button:last-child{margin-right:9px}.text-editor-menu button.circle{width:26px;height:26px}.text-editor-menu button.circle:first-child{margin-left:0px}.text-editor-menu button.circle{margin-right:-2px}.text-editor-menu button.circle:last-child{margin-right:0px}.text-editor-menu button.circle{border-radius:13px}.text-editor-menu .icon.format_bold{background:center center no-repeat url(${U})}.night .text-editor-menu .icon.format_bold{background:center center no-repeat url(${W})}.text-editor-menu .icon.format_italic{background:center center no-repeat url(${J})}.night .text-editor-menu .icon.format_italic{background:center center no-repeat url(${K})}.text-editor-menu .icon.format_strikethrough{background:center center no-repeat url(${G})}.night .text-editor-menu .icon.format_strikethrough{background:center center no-repeat url(${Y})}.text-editor-menu .icon.format_underlined{background:center center no-repeat url(${Z})}.night .text-editor-menu .icon.format_underlined{background:center center no-repeat url(${Q})}.text-editor-menu .icon.format_heading_1{background:center center no-repeat url(${X})}.night .text-editor-menu .icon.format_heading_1{background:center center no-repeat url(${tt})}.text-editor-menu .icon.format_heading_2{background:center center no-repeat url(${et})}.night .text-editor-menu .icon.format_heading_2{background:center center no-repeat url(${nt})}.text-editor-menu .icon.format_list_bulleted{background:center center no-repeat url(${rt})}.night .text-editor-menu .icon.format_list_bulleted{background:center center no-repeat url(${ot})}.text-editor-menu .icon.format_list_numbered{background:center center no-repeat url(${it})}.night .text-editor-menu .icon.format_list_numbered{background:center center no-repeat url(${st})}.text-editor-menu .icon.format_quote{background:center center no-repeat url(${at})}.night .text-editor-menu .icon.format_quote{background:center center no-repeat url(${lt})}.text-editor-menu .icon.format_code{background:center center no-repeat url(${ct})}.night .text-editor-menu .icon.format_code{background:center center no-repeat url(${ut})}.text-editor-menu .icon.format_codeblock{background:center center no-repeat url(${dt})}.night .text-editor-menu .icon.format_codeblock{background:center center no-repeat url(${ht})}.text-editor-menu .icon.insert_link{background:center center no-repeat url(${pt})}.night .text-editor-menu .icon.insert_link{background:center center no-repeat url(${ft})}.text-editor-menu .icon.add_comment{background:center center no-repeat url(${gt})}.night .text-editor-menu .icon.add_comment{background-image:url(${mt})}.text-editor-menu .icon.spark{background:center center no-repeat url(${yt})}.text-editor-menu .icon.justify{background:center center no-repeat url(${bt})}.night .text-editor-menu .icon.justify{background:center center no-repeat url(${vt})}.text-editor-menu .icon.right{background:center center no-repeat url(${wt})}.night .text-editor-menu .icon.right{background:center center no-repeat url(${At})}.text-editor-menu .icon.center{background:center center no-repeat url(${kt})}.night .text-editor-menu .icon.center{background:center center no-repeat url(${xt})}.text-editor-menu .icon.left{background:center center no-repeat url(${Ct})}.night .text-editor-menu .icon.left{background:center center no-repeat url(${St})}.text-editor-link-url{border:1px solid #555}.night .text-editor-link-url{border:1px solid #c8c8c8}.text-editor-link-url{transition:background-color .5s,border-color .5s;width:300px;border-radius:8px;padding:4px 8px;font-size:14px;line-height:20px}.text-editor-content-inner p.title{font-size:34px;line-height:48px;font-weight:500;padding:24px 0}.text-editor-content-inner p.title.is-empty::before{content:attr(data-placeholder);float:left;color:#ced4da;pointer-events:none;height:0;opacity:0;animation-name:fadeIn;animation-duration:1s;animation-iteration-count:1;animation-fill-mode:forwards}@keyframes fadeIn{from{opacity:0;transform:translate(-4px, 0)}to{opacity:1;transform:translate(0, 0)}}.text-editor-content-inner p.has-placeholder::before{content:attr(data-placeholder);float:left;color:#ddd;pointer-events:none;height:0;margin-left:2px;opacity:0;animation-name:fadeIn;animation-delay:.5s;animation-duration:1s;animation-iteration-count:1;animation-fill-mode:forwards}@keyframes fadeIn{from{opacity:0;transform:translate(-4px, 0)}to{opacity:1;transform:translate(0, 0)}}.text-editor-content-inner p.spacer{display:block;width:100%;height:200px;transition:height .2s}.text-editor-content-inner .tableWrapper{position:relative;overflow:hidden}.page-layout-v2 .text-editor-content-inner .tableWrapper{width:calc(100% + var(--line-height)*210/24 - 24px)}.text-editor-content-inner .tableWrapper .tableScrollContainer{position:relative;overflow-x:auto;overflow-y:visible;scrollbar-width:none;-ms-overflow-style:none}.text-editor-content-inner .tableWrapper .tableScrollContainer::-webkit-scrollbar{display:none}.text-editor-content-inner .tableWrapper .customScrollbarTrack{position:absolute;bottom:0px;left:0px;right:0px;height:12px;display:block;background:rgba(0,0,0,.05);border-radius:6px;cursor:pointer}.text-editor-content-inner .tableWrapper .customScrollbarTrack .customScrollbarThumb{position:absolute;top:2px;left:0px;width:753.909px;height:8px;background:rgba(0,0,0,.3);border-radius:4px;transition:background .2s;cursor:grab}.text-editor-content-inner table{border-collapse:collapse;margin:0;overflow:hidden;background:#fff}.night .text-editor-content-inner table{background:#2c2c2c}.text-editor-content-inner table td,.text-editor-content-inner table th{border:1px solid #aaa;box-sizing:border-box;min-width:1em;padding:12px 8px 11px 8px;position:relative;vertical-align:top}.text-editor-content-inner table td>*,.text-editor-content-inner table th>*{margin-bottom:0}.night .text-editor-content-inner table td,.text-editor-content-inner table th{border-color:#666}.text-editor-content-inner table th{font-weight:bold;text-align:left}.text-editor-content-inner table .selectedCell:after{content:"";left:0;right:0;top:0;bottom:0;pointer-events:none;position:absolute;z-index:2}.text-editor-content-inner .tableWrapper{margin:1.5rem 0;overflow-x:auto}.text-editor-content-inner.resize-cursor{cursor:ew-resize;cursor:col-resize}.text-editor-content{min-height:inherit;min-width:inherit;--line-height: 24px}.text-editor-content .text-editor-content-inner{min-height:inherit;min-width:inherit;padding:calc(var(--line-height)*60/24) calc(var(--line-height)*150/24) calc(var(--line-height)*256/24) calc(var(--line-height)*234/24)}.page-layout-v2 .text-editor-content .text-editor-content-inner{padding:calc(var(--line-height)*60/24) calc(var(--line-height)*210/24) calc(var(--line-height)*256/24) calc(var(--line-height)*210/24)}.text-editor-content .text-editor-content-inner{box-sizing:border-box;color:#222}.night .text-editor-content .text-editor-content-inner{color:#ccc}.text-editor-content .text-editor-content-inner{transition:color .5s;font-size:calc(var(--line-height)*2/3);font-weight:400;font-family:geomanist;letter-spacing:.02em;line-height:var(--line-height)}.text-editor-content .text-editor-content-inner *,.text-editor-content .text-editor-content-inner *:after,.text-editor-content .text-editor-content-inner *:before{box-sizing:inherit}.text-editor-content .text-editor-content-inner p,.text-editor-content .text-editor-content-inner h1,.text-editor-content .text-editor-content-inner h2,.text-editor-content .text-editor-content-inner h3,.text-editor-content .text-editor-content-inner h4,.text-editor-content .text-editor-content-inner h5,.text-editor-content .text-editor-content-inner h6,.text-editor-content .text-editor-content-inner code,.text-editor-content .text-editor-content-inner pre,.text-editor-content .text-editor-content-inner img{min-width:1px}.text-editor-content .text-editor-content-inner b,.text-editor-content .text-editor-content-inner strong{font-weight:600;line-height:1em}.text-editor-content .text-editor-content-inner p{margin-top:0}.text-editor-content .text-editor-content-inner h1,.text-editor-content .text-editor-content-inner h2,.text-editor-content .text-editor-content-inner h3,.text-editor-content .text-editor-content-inner h4,.text-editor-content .text-editor-content-inner h5,.text-editor-content .text-editor-content-inner h6{font-weight:500;margin-top:0;color:#000;transition:color .5s}.night .text-editor-content .text-editor-content-inner h1,.night .text-editor-content .text-editor-content-inner h2,.night .text-editor-content .text-editor-content-inner h3,.night .text-editor-content .text-editor-content-inner h4,.night .text-editor-content .text-editor-content-inner h5,.night .text-editor-content .text-editor-content-inner h6{color:#fff}.text-editor-content .text-editor-content-inner h1{font-size:calc(var(--line-height)*28/24);line-height:var(--line-height);padding:calc(var(--line-height)*3/2) 0 calc(var(--line-height)/2)}.text-editor-content .text-editor-content-inner h2{font-size:1.375em;line-height:var(--line-height);padding:calc(var(--line-height)*18/24) 0 calc(var(--line-height)/4)}.text-editor-content .text-editor-content-inner h3{font-size:1.25em;line-height:var(--line-height)}.text-editor-content .text-editor-content-inner h4,.text-editor-content .text-editor-content-inner h5,.text-editor-content .text-editor-content-inner h6{font-size:1em;line-height:var(--line-height);font-weight:500}.text-editor-content .text-editor-content-inner dl,.text-editor-content .text-editor-content-inner ol,.text-editor-content .text-editor-content-inner ul{list-style:none;margin-top:0;padding-left:0}.text-editor-content .text-editor-content-inner dl,.text-editor-content .text-editor-content-inner ol,.text-editor-content .text-editor-content-inner ul{margin-left:calc(var(--line-height)*2)}.text-editor-content .text-editor-content-inner dl[dir=rtl],.text-editor-content .text-editor-content-inner ol[dir=rtl],.text-editor-content .text-editor-content-inner ul[dir=rtl]{margin-left:0;margin-right:calc(var(--line-height)*2)}.text-editor-content .text-editor-content-inner ol{list-style:decimal}.text-editor-content .text-editor-content-inner ul{list-style:initial}.text-editor-content .text-editor-content-inner blockquote{padding:calc(var(--line-height)/6) 0}.text-editor-content .text-editor-content-inner blockquote>*{border-left:calc(var(--line-height)/6) solid;border-left-color:hsla(0,0%,40%,.2509803922)}.night .text-editor-content .text-editor-content-inner blockquote>*{border-left-color:#666}.text-editor-content .text-editor-content-inner blockquote>*{transition:border-left-color .5s;padding:0 var(--line-height)}.text-editor-content .text-editor-content-inner blockquote>*:first-child{padding-top:calc(var(--line-height)/3)}.text-editor-content .text-editor-content-inner blockquote>*:last-child{padding-bottom:calc(var(--line-height)/3)}.text-editor-content .text-editor-content-inner blockquote>*[dir=rtl]{border-left:0;border-right:calc(var(--line-height)/6) solid;border-right-color:hsla(0,0%,40%,.2509803922)}.night .text-editor-content .text-editor-content-inner blockquote>*[dir=rtl]{border-right-color:#666}.text-editor-content .text-editor-content-inner blockquote>*[dir=rtl]{transition:border-right-color .5s}.text-editor-content .text-editor-content-inner code{background-color:rgba(209,217,225,.2509803922)}.night .text-editor-content .text-editor-content-inner code{background-color:#272727}.text-editor-content .text-editor-content-inner code{transition:background-color .5s;border-radius:calc(var(--line-height)/6);font-family:"Inconsolata",monospace;font-size:calc(var(--line-height)/3*2);margin:0 calc(var(--line-height)/6);padding:calc(var(--line-height)/12) calc(var(--line-height)/3);vertical-align:bottom;letter-spacing:normal;white-space:pre-wrap}.text-editor-content .text-editor-content-inner pre{overflow-y:hidden;padding:calc(var(--line-height)/2) 0}.text-editor-content .text-editor-content-inner pre>code{display:block;background:unset;border-radius:0;margin:0;background-color:rgba(209,217,225,.2509803922)}.night .text-editor-content .text-editor-content-inner pre>code{background-color:#272727}.text-editor-content .text-editor-content-inner pre>code{border-left:calc(var(--line-height)/6) solid;border-left-color:#5e00a2}.night .text-editor-content .text-editor-content-inner pre>code{border-left-color:#cd6afb}.text-editor-content .text-editor-content-inner pre>code{transition:border-left-color .5s,background-color .5s;padding:calc(var(--line-height)/2) calc(var(--line-height)*5/6);height:initial;line-height:var(--line-height);min-width:fit-content;letter-spacing:normal;white-space:pre-wrap}.text-editor-content .text-editor-content-inner pre[dir=rtl]>code{border-left:0;border-right:calc(var(--line-height)/6) solid;border-right-color:#5e00a2}.night .text-editor-content .text-editor-content-inner pre[dir=rtl]>code{border-right-color:#cd6afb}.text-editor-content .text-editor-content-inner pre[dir=rtl]>code{transition:border-right-color .5s}.text-editor-content .text-editor-content-inner img{max-width:100%}.text-editor-content .text-editor-content-inner a{color:#5e00a2}.night .text-editor-content .text-editor-content-inner a{color:#cd6afb}.text-editor-content .text-editor-content-inner a{transition:color .5s;text-decoration:none;height:initial;line-height:1em}.text-editor-content .text-editor-content-inner a:focus,.text-editor-content .text-editor-content-inner a:hover{color:#4e2f64;transition:color .5s;cursor:pointer}.night .text-editor-content .text-editor-content-inner a:focus,.night .text-editor-content .text-editor-content-inner a:hover{color:#b192bf}@media print{.text-editor-content .text-editor-content-inner .is-empty{visibility:hidden !important}}.text-editor-content .text-editor-content-inner .title{color:#000}.night .text-editor-content .text-editor-content-inner .title{color:#fff}.text-editor-content .text-editor-content-inner .title{transition:color .5s}.text-editor-content.text-as-lines p:not(.title){font-family:"Flow Rounded";letter-spacing:-0.045em;color:#aaa}.night .text-editor-content.text-as-lines p:not(.title){color:#666}.text-editor-content.text-as-lines p:not(.title){transition:color .5s}`,"",{version:3,sources:["webpack://./lib/src/tiptap-extension-anchor-mark/anchorMark.scss","webpack://./lib/src/tiptap-extension-menu/menu.scss","webpack://./lib/src/tiptap-extension-title/title.scss","webpack://./lib/src/tiptap-extension-paragraph/paragraph.scss","webpack://./lib/src/tiptap-extension-spacer/spacer.scss","webpack://./lib/src/tiptap-extension-table/table.scss","webpack://./lib/src/tiptap/tiptap.scss"],names:[],mappings:"AACE,6DACE,oCAAA,CC4CJ,kBACE,WAfY,CAgBZ,qBAAA,CACA,kBAAA,CACA,iBAAA,CACA,0CAdgB,CAehB,gBAAA,CAGA,wBAf0B,CAgB1B,iBAfsB,CAkBb,yBACP,wBAjB0B,CAkB1B,oBAjBsB,CAE1B,kBAmBE,SAAA,CACA,8BAAA,CACA,qBAAA,CACA,qFACE,CAKF,yBACE,SAAA,CACA,kBAAA,CAGI,mDACE,SAAA,CAMR,yBACE,UAAA,CACA,aAAA,CACA,iBAAA,CACA,gBAAA,CACA,wBAAA,CACA,wBAAA,CACA,oBAAA,CACA,SAAA,CACA,UAAA,CACA,QAAA,CACA,QAAA,CACA,2BAAA,CACA,4CAAA,CAGF,gCACE,WAAA,CACA,aAAA,CACA,cAAA,CACA,YAAA,CACA,kBAAA,CACA,cAAA,CAEA,2CACE,iBAAA,CAEE,8DACE,eAAA,CAGJ,4DACE,iBAAA,CACA,SAAA,CACA,UAAA,CACA,aAAA,CACA,wBAAA,CAEA,SAAA,CACA,mBAAA,CACA,8BAAA,CACA,oBAAA,CACA,sDAAA,CACA,mEACE,SAAA,CACA,kBAAA,CACA,kBAAA,CAGF,gFACE,YAAA,CACA,YAAA,CACA,QAAA,CACA,kBAAA,CAGA,wBAtGkB,CAuGlB,iBAtGc,CAuGd,UAAA,CAGS,uFACP,wBAzGkB,CA0GlB,oBAzGc,CA0Gd,UAAA,CAGF,wFACE,UAAA,CACA,aAAA,CACA,iBAAA,CACA,gBAAA,CACA,wBAAA,CACA,wBAAA,CACA,oBAAA,CACA,SAAA,CACA,UAAA,CACA,QAAA,CACA,WAAA,CACA,2BAAA,CACA,4CAAA,CAGF,mGACE,WAAA,CACA,UAAA,CACA,WAjJW,CAkJX,kBAAA,CACA,4CAAA,CAGA,yGACE,UAtJO,CAuJP,qBAAA,CACA,6CAAA,CAGF,4GACE,SA3JW,CA4JX,cAAA,CACA,cAAA,CAOZ,yBACE,UAAA,CACA,WAAA,CACA,eAAA,CACA,cAAA,CAEA,eAAA,CACA,aAAA,CAEA,WA/KmB,CAgLnB,kBAAA,CACA,4CAAA,CAGA,+BACE,UApLe,CAqLf,qBAAA,CACA,6CAAA,CAIF,sEAEE,SA3LmB,CA6LrB,kCACE,WAjMkB,CAmMpB,gCACE,YAAA,CAGF,qCACE,eAAA,CAEF,oCACE,gBAAA,CAGF,gCACE,UAAA,CACA,WAAA,CAEA,4CACE,eAAA,CALJ,gCAOE,iBAAA,CACA,2CACE,gBAAA,CATJ,gCAYE,kBAAA,CAKF,oCACE,0EAAA,CAGS,2CACP,0EAAA,CAKJ,sCACE,0EAAA,CAGS,6CACP,0EAAA,CAKJ,6CACE,0EAAA,CAGS,oDACP,0EAAA,CAKJ,0CACE,0EAAA,CAGS,iDACP,0EAAA,CAKJ,yCACE,0EAAA,CAGS,gDACP,0EAAA,CAKJ,yCACE,2EAAA,CAGS,gDACP,2EAAA,CAKJ,6CACE,2EAAA,CAGS,oDACP,2EAAA,CAKJ,6CACE,2EAAA,CAGS,oDACP,2EAAA,CAKJ,qCACE,2EAAA,CAGS,4CACP,2EAAA,CAKJ,oCACE,2EAAA,CAGS,2CACP,2EAAA,CAKJ,yCACE,2EAAA,CAGS,gDACP,2EAAA,CAKJ,oCACE,2EAAA,CAGS,2CACP,2EAAA,CAKJ,oCACE,2EAAA,CAGS,2CACP,yDAAA,CAIJ,8BACE,2EAAA,CAKF,gCACE,2EAAA,CAGS,uCACP,2EAAA,CAKJ,8BACE,2EAAA,CAGS,qCACP,2EAAA,CAKJ,+BACE,2EAAA,CAGS,sCACP,2EAAA,CAKJ,6BACE,2EAAA,CAGS,oCACP,2EAAA,CAOR,sBAEE,qBAAA,CAGS,6BACP,wBAAA,CANJ,sBASE,gDAAA,CAGA,WAAA,CACA,iBAAA,CACA,eAAA,CACA,cAAA,CACA,gBAAA,CCvbA,mCACE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,cAAA,CAEA,oDACE,8BAAA,CACA,UAAA,CACA,aAAA,CACA,mBAAA,CACA,QAAA,CACA,SAAA,CACA,qBAAA,CACA,qBAAA,CACA,2BAAA,CACA,4BAAA,CAGF,kBACE,KACE,SAAA,CACA,4BAAA,CAEF,GACE,SAAA,CACA,yBAAA,CAAA,CCzBJ,qDACE,8BAAA,CACA,UAAA,CACA,UAAA,CACA,mBAAA,CACA,QAAA,CACA,eAAA,CACA,SAAA,CACA,qBAAA,CACA,mBAAA,CACA,qBAAA,CACA,2BAAA,CACA,4BAAA,CAGF,kBACE,KACE,SAAA,CACA,4BAAA,CAEF,GACE,SAAA,CACA,yBAAA,CAAA,CCzBN,oCACE,aAAA,CACA,UAAA,CACA,YAAA,CACA,qBAAA,CCMF,yCACE,iBAAA,CACA,eAAA,CAES,yDACP,mDAAA,CAGF,+DACE,iBAAA,CACA,eAAA,CACA,kBAAA,CACA,oBAAA,CACA,uBAAA,CAEA,kFACE,YAAA,CAKJ,+DACE,iBAAA,CACA,UAAA,CACA,QAAA,CACA,SAAA,CACA,WAAA,CACA,aAAA,CACA,0BAAA,CACA,iBAAA,CACA,cAAA,CAEA,qFACE,iBAAA,CACA,OAAA,CACA,QAAA,CACA,eAAA,CACA,UAAA,CACA,yBAAA,CACA,iBAAA,CACA,yBAAA,CACA,WAAA,CAKN,iCACE,wBAAA,CACA,QAAA,CACA,eAAA,CACA,eA1DqB,CA4DZ,wCACP,kBA1DqB,CA6DvB,wEAEE,qBAAA,CACA,qBAAA,CACA,aAAA,CACA,yBAAA,CACA,iBAAA,CACA,kBAAA,CAEA,4EACE,eAAA,CAGO,+EACP,iBA1Ea,CA8EjB,oCAEE,gBAAA,CACA,eAAA,CAGF,qDAEE,UAAA,CACA,MAAA,CAAA,OAAA,CAAA,KAAA,CAAA,QAAA,CACA,mBAAA,CACA,iBAAA,CACA,SAAA,CAcJ,yCACE,eAAA,CACA,eAAA,CAGF,yCACE,gBAAA,CACA,iBAAA,CC7GJ,qBACE,kBAAA,CACA,iBAAA,CACA,mBAAA,CA8BA,gDAEE,kBAAA,CACA,iBAAA,CACA,sIAAA,CAIS,gEACP,sIAAA,CATJ,gDAiBE,qBAAA,CAGA,UArCkB,CAsCT,uDACP,UA/BkB,CAStB,gDAwBE,oBAAA,CAEA,sCAAA,CAGA,eAAA,CACA,qBAAA,CACA,oBAAA,CACA,8BAAA,CAMA,mKAGE,kBAAA,CAMF,igBAUE,aAAA,CAGF,yGAEE,eAAA,CACA,eAAA,CAGF,kDACE,YAAA,CAGF,kTAME,eAAA,CACA,YAAA,CACA,UAhGgB,CAiGhB,oBAAA,CAGA,4VAME,UAlGgB,CAsGpB,mDACE,wCAAA,CACA,8BAAA,CACA,iEAAA,CAGF,mDACE,iBAAA,CACA,8BAAA,CACA,mEAAA,CAGF,mDACE,gBAAA,CACA,8BAAA,CAGF,yJAGE,aAAA,CACA,8BAAA,CACA,eAAA,CAKF,yJAGE,eAAA,CACA,YAAA,CACA,cAAA,CAGF,yJAGE,sCAAA,CAEA,oLACE,aAAA,CACA,uCAAA,CAIJ,mDACE,kBAAA,CAGF,mDACE,kBAAA,CAMF,2DACE,oCAAA,CAEA,6DACE,4CAAA,CACA,4CAvKiB,CAwKR,oEACP,sBAjKiB,CA6JrB,6DAME,gCAAA,CAEA,4BAAA,CAEA,yEACE,sCAAA,CAGF,wEACE,yCAAA,CAGF,sEACE,aAAA,CACA,6CAAA,CACA,6CA1Le,CA2LN,6EACP,uBApLe,CA+KnB,sEAOE,iCAAA,CAQN,qDACE,8CAxMiB,CAyMR,4DACP,wBAlMiB,CA+LrB,qDAKE,+BAAA,CAEA,wCAAA,CACA,mCAAA,CACA,sCAAA,CACA,mCAAA,CACA,8DAAA,CACA,qBAAA,CACA,qBAAA,CACA,oBAAA,CAGF,oDACE,iBAAA,CACA,oCAAA,CAEA,yDACE,aAAA,CACA,gBAAA,CACA,eAAA,CACA,QAAA,CAEA,8CAlOe,CAmON,gEACP,wBA5Ne,CAoNnB,yDAWE,4CAAA,CACA,yBA1Oc,CA2OL,gEACP,yBApOc,CAsNlB,yDAgBE,qDAAA,CAGA,+DAAA,CACA,cAAA,CACA,8BAAA,CACA,qBAAA,CACA,qBAAA,CACA,oBAAA,CAIA,kEACE,aAAA,CACA,6CAAA,CACA,0BA7PY,CA8PH,yEACP,0BAvPY,CAkPhB,kEAOE,iCAAA,CAON,oDACE,cAAA,CAKF,kDACE,aA/QgB,CAgRP,yDACP,aAzQgB,CAsQpB,kDAKE,oBAAA,CAEA,oBAAA,CACA,cAAA,CACA,eAAA,CAEA,gHAEE,aA1RgB,CA2RhB,oBAAA,CACA,cAAA,CAGA,8HAEE,aAzRgB,CAiStB,aACE,0DACE,4BAAA,CAAA,CAIJ,uDACE,UAnTgB,CAoTP,8DACP,UA7SgB,CA0SpB,uDAKE,oBAAA,CAKF,iDACE,0BAAA,CACA,uBAAA,CACA,UAzTa,CA0TJ,wDACP,UAnTa,CA8SjB,iDAOE,oBAAA",sourcesContent:["span[data-name='anchor-mark'] {\n  .anchor-highlighted-syncWithText {\n    background-color: rgba(26, 198, 255, 0.2);\n  }\n}\n","$extension-menu-path: '../tiptap-extension-menu';\n\n// UI 2022\n\n$base-color: #666666;\n$background-color: #f7f7f7;\n$page-color: #fff;\n$border-color: #eee;\n$comment-focus-background-color: rgb(244, 224, 0, 0.1);\n$pause-color: #34b8ea;\n$play-color: #34b8ea;\n$stop-color: #ae0056;\n$new-color: #f13f3f;\n$comment-unread-color: #f13f3fbf;\n$recording-color: #cd6afb;\n$recording-background-color: #cd6afb1a;\n$editing-color: #808080;\n\n// UI 2023\n\n$comment-color: #fadd00;\n$spark-color: #1ac6ff;\n\n$theme-transition-duration: 0.5s;\n\n// Bubble menu\n$menu-disabled-opacity: 0.15;\n$menu-enabled-opacity: 0.42;\n$menu-hover-opacity: 0.6;\n$menu-activated-opacity: 1;\n$menu-hover-scale: 1.25;\n$menu-hover-transition-duration: 0.2s;\n$menu-height: 32px;\n$menu-side-padding: 12px;\n$menu-gap: 8px;\n$menu-inner-gap: 4px;\n$menu-group-gap: 12px;\n$menu-box-shadow: 0px 0px 8px 0px rgba(0, 0, 0, 0.25);\n$menu-circle-size: 26px;\n\n$day-menu-background-color: #484848;\n$day-menu-border-color: #555;\n\n$night-menu-background-color: #e6e6e6;\n$night-menu-border-color: #c8c8c8;\n\n.text-editor-menu {\n  height: $menu-height;\n  box-sizing: border-box;\n  border-radius: calc($menu-height / 2);\n  position: relative;\n  box-shadow: $menu-box-shadow;\n  border: 1px solid;\n\n  // Day Mode\n  background-color: $day-menu-background-color;\n  border-color: $day-menu-border-color;\n\n  // Night Mode\n  @at-root .night #{&} {\n    background-color: $night-menu-background-color;\n    border-color: $night-menu-border-color;\n  }\n\n  // intro animation\n  opacity: 0;\n  transform-origin: center bottom;\n  transform: scale(0.25);\n  transition: // intro animation\n    opacity 0.25s, transform 0.25s ease-out,\n    // light/Night Mode\n    background-color $theme-transition-duration,\n    border-color $theme-transition-duration;\n\n  &.active {\n    opacity: 1;\n    transform: scale(1);\n    & .border {\n      & .items_holder {\n        & > div {\n          opacity: 1;\n        }\n      }\n    }\n  }\n\n  &:before {\n    content: '';\n    display: block;\n    position: absolute;\n    border: 1px solid;\n    border-width: 0 1px 1px 0;\n    background-color: inherit; // follow parent transition\n    border-color: inherit; // follow parent transition\n    width: 8px;\n    height: 8px;\n    left: 50%;\n    bottom: 0;\n    border-top-left-radius: 10px; // to not covert the content inside\n    transform: translate(-4px, 5px) rotate(45deg);\n  }\n\n  .menu-section {\n    margin: -1px; // to counteract the border\n    padding: 0 3px;\n    height: inherit;\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n\n    & .menu-item {\n      position: relative;\n      button {\n        &:first-child {\n          margin-left: 0px;\n        }\n      }\n      & .sub-menu-holder {\n        position: absolute;\n        top: -60px;\n        left: -54px;\n        display: block;\n        height: calc(100% + 36px);\n        // inactive\n        opacity: 0;\n        pointer-events: none;\n        transform-origin: center bottom;\n        transform: scale(0.5);\n        transition: opacity 0.2s ease-out, transform 0.2s ease-out; // delay\n        &.active {\n          opacity: 1;\n          pointer-events: all;\n          transform: scale(1);\n        }\n\n        & .sub-menu-container {\n          display: flex;\n          padding: 12px;\n          gap: 10px;\n          border-radius: 16px;\n\n          // Day Mode\n          background-color: $day-menu-background-color;\n          border-color: $day-menu-border-color;\n          color: white;\n\n          // Night Mode\n          @at-root .night #{&} {\n            background-color: $night-menu-background-color;\n            border-color: $night-menu-border-color;\n            color: black;\n          }\n\n          &::before {\n            content: '';\n            display: block;\n            position: absolute;\n            border: 1px solid;\n            border-width: 0 1px 1px 0;\n            background-color: inherit; // follow parent transition\n            border-color: inherit; // follow parent transition\n            width: 8px;\n            height: 8px;\n            left: 50%;\n            bottom: 13px;\n            border-top-left-radius: 10px; // to not covert the content inside\n            transform: translate(-4px, 5px) rotate(45deg);\n          }\n\n          & .text-align-option {\n            height: 20px;\n            width: 20px;\n            opacity: $menu-enabled-opacity;\n            transform: scale(1);\n            transition: opacity $menu-hover-transition-duration,\n              transform $menu-hover-transition-duration ease-in;\n\n            &:hover {\n              opacity: $menu-hover-opacity;\n              transform: scale($menu-hover-scale);\n              transition: opacity $menu-hover-transition-duration,\n                transform $menu-hover-transition-duration ease-out;\n            }\n            &.selected {\n              opacity: $menu-activated-opacity;\n              cursor: default;\n              transform: none;\n            }\n          }\n        }\n      }\n    }\n  }\n  button {\n    width: 28px;\n    height: 20px;\n    padding: 0px 8px;\n    cursor: pointer;\n\n    background: none;\n    display: block;\n\n    opacity: $menu-enabled-opacity;\n    transform: scale(1);\n    transition: opacity $menu-hover-transition-duration,\n      transform $menu-hover-transition-duration ease-in;\n\n    &:hover {\n      opacity: $menu-hover-opacity;\n      transform: scale($menu-hover-scale);\n      transition: opacity $menu-hover-transition-duration,\n        transform $menu-hover-transition-duration ease-out;\n    }\n\n    &.active,\n    &.active:hover {\n      opacity: $menu-activated-opacity;\n    }\n    &.disabled {\n      opacity: $menu-disabled-opacity;\n    }\n    &.hidden {\n      display: none;\n    }\n\n    &:first-child {\n      margin-left: 9px;\n    }\n    &:last-child {\n      margin-right: 9px;\n    }\n\n    &.circle {\n      width: 26px;\n      height: 26px;\n\n      &:first-child {\n        margin-left: 0px;\n      }\n      margin-right: -2px; // to artificially reduce the gap between the circles\n      &:last-child {\n        margin-right: 0px;\n      }\n\n      border-radius: calc($menu-circle-size / 2);\n    }\n  }\n\n  .icon {\n    &.format_bold {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/bold-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/bold-20px.svg);\n      }\n    }\n\n    &.format_italic {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/italic-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/italic-20px.svg);\n      }\n    }\n\n    &.format_strikethrough {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/strikethrough-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/strikethrough-20px.svg);\n      }\n    }\n\n    &.format_underlined {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/underlined-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/underlined-20px.svg);\n      }\n    }\n\n    &.format_heading_1 {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/h1-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/h1-20px.svg);\n      }\n    }\n\n    &.format_heading_2 {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/h2-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/h2-20px.svg);\n      }\n    }\n\n    &.format_list_bulleted {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/bulleted-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/bulleted-20px.svg);\n      }\n    }\n\n    &.format_list_numbered {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/numbered-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/numbered-20px.svg);\n      }\n    }\n\n    &.format_quote {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/quote-20px-w.svg?v=2);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/quote-20px.svg?v=2);\n      }\n    }\n\n    &.format_code {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/code-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/code-20px.svg);\n      }\n    }\n\n    &.format_codeblock {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/codeblock-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/codeblock-20px.svg);\n      }\n    }\n\n    &.insert_link {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/link2-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/link2-20px.svg);\n      }\n    }\n\n    &.add_comment {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/add-comment-button-20px-nb.svg);\n\n      @at-root .night #{&} {\n        background-image: url(#{$extension-menu-path}/icons/add-comment-button-20px-nb-d.svg);\n      }\n    }\n\n    &.spark {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/spark-26px.svg);\n    }\n\n    // Text-align\n    &.justify {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/align-justify-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/align-justify-20px.svg);\n      }\n    }\n\n    &.right {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/align-right-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/align-right-20px.svg);\n      }\n    }\n\n    &.center {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/align-center-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/align-center-20px.svg);\n      }\n    }\n\n    &.left {\n      background: center center no-repeat\n        url(#{$extension-menu-path}/icons/align-left-20px-w.svg);\n\n      @at-root .night #{&} {\n        background: center center no-repeat\n          url(#{$extension-menu-path}/icons/align-left-20px.svg);\n      }\n    }\n  }\n}\n\n.text-editor-link-url {\n  // Day Mode\n  border: 1px solid $day-menu-border-color;\n\n  // Night Mode\n  @at-root .night #{&} {\n    border: 1px solid $night-menu-border-color;\n  }\n\n  transition: background-color $theme-transition-duration,\n    border-color $theme-transition-duration;\n\n  width: 300px;\n  border-radius: 8px;\n  padding: 4px 8px;\n  font-size: 14px;\n  line-height: 20px;\n}\n",".text-editor-content-inner {\n  // title\n\n  p.title {\n    font-size: 34px;\n    line-height: 48px;\n    font-weight: 500;\n    padding: 24px 0;\n\n    &.is-empty::before {\n      content: attr(data-placeholder);\n      float: left;\n      color: #ced4da;\n      pointer-events: none;\n      height: 0;\n      opacity: 0;\n      animation-name: fadeIn;\n      animation-duration: 1s;\n      animation-iteration-count: 1;\n      animation-fill-mode: forwards;\n    }\n\n    @keyframes fadeIn {\n      from {\n        opacity: 0;\n        transform: translate(-4px, 0);\n      }\n      to {\n        opacity: 1;\n        transform: translate(0, 0);\n      }\n    }\n  }\n}\n",".text-editor-content-inner {\n  // paragraph\n\n  p {\n    &.has-placeholder::before {\n      content: attr(data-placeholder);\n      float: left;\n      color: #ddd;\n      pointer-events: none;\n      height: 0;\n      margin-left: 2px;\n      opacity: 0;\n      animation-name: fadeIn;\n      animation-delay: 0.5s;\n      animation-duration: 1s;\n      animation-iteration-count: 1;\n      animation-fill-mode: forwards;\n    }\n\n    @keyframes fadeIn {\n      from {\n        opacity: 0;\n        transform: translate(-4px, 0);\n      }\n      to {\n        opacity: 1;\n        transform: translate(0, 0);\n      }\n    }\n  }\n}\n",".text-editor-content-inner {\n  p.spacer {\n    display: block;\n    width: 100%;\n    height: 200px;\n    transition: height 0.2s;\n  }\n}\n",'  // Color\n  // \n  // day\n  $day-color-background: #ffffff;\n  $day-color-line: #aaaaaa;\n  // night\n  $night-color-background: #2c2c2c;\n  $night-color-line: #666666;\n\n.text-editor-content-inner {\n\n  .tableWrapper {\n    position: relative;\n    overflow: hidden;\n    \n    @at-root .page-layout-v2 #{&} {\n      width: calc(100% + calc(var(--line-height) * 210 / 24) - 24px);\n    }\n\n    .tableScrollContainer {\n      position: relative;\n      overflow-x: auto;\n      overflow-y: visible;\n      scrollbar-width: none;\n      -ms-overflow-style: none;\n\n      &::-webkit-scrollbar {\n        display: none;\n      }\n\n    }\n\n    .customScrollbarTrack {\n      position: absolute;\n      bottom: 0px;\n      left: 0px;\n      right: 0px;\n      height: 12px;\n      display: block;\n      background: rgba(0, 0, 0, 0.05);\n      border-radius: 6px;\n      cursor: pointer;\n\n      .customScrollbarThumb {\n        position: absolute;\n        top: 2px;\n        left: 0px;\n        width: 753.909px;\n        height: 8px;\n        background: rgba(0, 0, 0, 0.3);\n        border-radius: 4px;\n        transition: background 0.2s;\n        cursor: grab;\n      }\n    }\n  }\n\n  table {\n    border-collapse: collapse;\n    margin: 0;\n    overflow: hidden;\n    background: $day-color-background;\n\n    @at-root .night #{&} {\n      background: $night-color-background;\n    }\n\n    td,\n    th {\n      border: 1px solid  $day-color-line;\n      box-sizing: border-box;\n      min-width: 1em;\n      padding: 12px 8px 11px 8px;\n      position: relative;\n      vertical-align: top;\n\n      > * {\n        margin-bottom: 0;\n      }\n\n      @at-root .night #{&} {\n        border-color: $night-color-line;\n      }\n    }\n\n    th {\n      // background-color: #3d25140d;\n      font-weight: bold;\n      text-align: left;\n    }\n\n    .selectedCell:after {\n      // background: #3d251414;\n      content: "";\n      left: 0; right: 0; top: 0; bottom: 0;\n      pointer-events: none;\n      position: absolute;\n      z-index: 2;\n    }\n\n    // .column-resize-handle {\n    //   background-color: #3d25141f;\n    //   bottom: -2px;\n    //   pointer-events: none;\n    //   position: absolute;\n    //   right: -2px;\n    //   top: 0;\n    //   width: 4px;\n    // }\n  }\n\n  .tableWrapper {\n    margin: 1.5rem 0;\n    overflow-x: auto;\n  }\n\n  &.resize-cursor {\n    cursor: ew-resize;\n    cursor: col-resize;\n  }\n}\n',"@use '../tiptap-extension-anchor-mark/anchorMark';\n@use '../tiptap-extension-menu/menu';\n@use '../tiptap-extension-title/title';\n@use '../tiptap-extension-paragraph/paragraph';\n@use '../tiptap-extension-spacer/spacer';\n@use '../tiptap-extension-table/table';\n\n@import url('https://fonts.googleapis.com/css2?family=Inconsolata:wght@400&display=swap');\n\n.text-editor-content {\n  min-height: inherit;\n  min-width: inherit;\n  --line-height: 24px;\n\n  // This is removed because it creates a regression in read-only mode, it becomes impossible to select tiptap text\n  // Prevent annoying text selection on safari\n  // -webkit-user-select: none;\n  // user-select: none;\n\n  // Inspired by https://milligram.io\n\n  // Color\n  // \n  // day\n  $day-color-heading: #000000 !default;\n  $day-color-initial: #222222 !default;\n  $day-color-primary: #5e00a2 !default;\n  $day-color-secondary: #4e2f64 !default;\n  $day-color-tertiary: #d1d9e140 !default;\n  $day-color-quaternary: #66666640 !default;\n  $day-color-line: #aaaaaa !default;\n  // night\n  $night-color-heading: #ffffff !default;\n  $night-color-initial: #cccccc !default;\n  $night-color-primary: #cd6afb !default;\n  $night-color-secondary: #b192bf !default;\n  $night-color-tertiary: #272727 !default;\n  $night-color-quaternary: #666666 !default;\n  $night-color-line: #666666 !default;\n\n  $theme-transition-duration: 0.5s;\n\n  .text-editor-content-inner {\n    // migrated from \"web/scss/components/_block.scss\"\n    min-height: inherit;\n    min-width: inherit;\n    padding: calc(var(--line-height) * 60 / 24)\n      calc(var(--line-height) * 150 / 24) calc(var(--line-height) * 256 / 24)\n      calc(var(--line-height) * 234 / 24); // carefully chosen to align to the 12x12 grid\n\n    @at-root .page-layout-v2 #{&} {\n      padding: calc(var(--line-height) * 60 / 24)\n        calc(var(--line-height) * 210 / 24) calc(var(--line-height) * 256 / 24)\n        calc(var(--line-height) * 210 / 24); // carefully chosen to align to the 12x12 grid\n    }\n\n    // The base font-size is set at 62.5% for having the convenience\n    // of sizing rems in a way that is similar to using px: 1.6rem = 16px\n\n    box-sizing: border-box;\n\n    // Default body styles\n    color: $day-color-initial;\n    @at-root .night #{&} {\n      color: $night-color-initial;\n    }\n    transition: color $theme-transition-duration;\n\n    font-size: calc(\n      var(--line-height) * 2 / 3\n    ); // Currently ems cause chrome bug misinterpreting rems on body element\n    font-weight: 400;\n    font-family: geomanist;\n    letter-spacing: 0.02em;\n    line-height: var(--line-height);\n\n    // Base\n    // \n    // Set box-sizing globally to handle padding and border widths\n\n    *,\n    *:after,\n    *:before {\n      box-sizing: inherit;\n    }\n\n    // Typography\n    // \n\n    p,\n    h1,\n    h2,\n    h3,\n    h4,\n    h5,\n    h6,\n    code,\n    pre,\n    img {\n      min-width: 1px;\n    }\n\n    b,\n    strong {\n      font-weight: 600;\n      line-height: 1em;\n    }\n\n    p {\n      margin-top: 0;\n    }\n\n    h1,\n    h2,\n    h3,\n    h4,\n    h5,\n    h6 {\n      font-weight: 500;\n      margin-top: 0;\n      color: $day-color-heading;\n      transition: color $theme-transition-duration;\n    }\n    @at-root .night #{&} {\n      h1,\n      h2,\n      h3,\n      h4,\n      h5,\n      h6 {\n        color: $night-color-heading;\n      }\n    }\n\n    h1 {\n      font-size: calc(var(--line-height) * 28 / 24);\n      line-height: var(--line-height);\n      padding: calc(var(--line-height) * 3 / 2) 0 calc(var(--line-height) / 2);\n    }\n\n    h2 {\n      font-size: 1.375em;\n      line-height: var(--line-height);\n      padding: calc(var(--line-height) * 18 / 24) 0 calc(var(--line-height) / 4);\n    }\n\n    h3 {\n      font-size: 1.25em;\n      line-height: var(--line-height);\n    }\n\n    h4,\n    h5,\n    h6 {\n      font-size: 1em;\n      line-height: var(--line-height);\n      font-weight: 500;\n    }\n\n    // List\n    // \n    dl,\n    ol,\n    ul {\n      list-style: none;\n      margin-top: 0;\n      padding-left: 0;\n    }\n\n    dl,\n    ol,\n    ul {\n      margin-left: calc(var(--line-height) * 2);\n\n      &[dir='rtl'] {\n        margin-left: 0;\n        margin-right: calc(var(--line-height) * 2);\n      }\n    }\n\n    ol {\n      list-style: decimal;\n    }\n\n    ul {\n      list-style: initial;\n    }\n\n    // Blockquote\n    // \n    // /!\\ Do not use margin in this file, it will break the line multiple because of margin collapsing\n    blockquote {\n      padding: calc(var(--line-height) / 6) 0;\n\n      & > * {\n        border-left: calc(var(--line-height) / 6) solid;\n        border-left-color: $day-color-quaternary;\n        @at-root .night #{&} {\n          border-left-color: $night-color-quaternary;\n        }\n        transition: border-left-color $theme-transition-duration;\n\n        padding: 0 var(--line-height);\n\n        &:first-child {\n          padding-top: calc(var(--line-height) / 3);\n        }\n\n        &:last-child {\n          padding-bottom: calc(var(--line-height) / 3);\n        }\n\n        &[dir='rtl'] {\n          border-left: 0;\n          border-right: calc(var(--line-height) / 6) solid;\n          border-right-color: $day-color-quaternary;\n          @at-root .night #{&} {\n            border-right-color: $night-color-quaternary;\n          }\n          transition: border-right-color $theme-transition-duration;\n        }\n      }\n    }\n\n    // Code\n    // \n    // /!\\ Do not use margin in this file, it will break the line multiple because of margin collapsing\n    code {\n      background-color: $day-color-tertiary;\n      @at-root .night #{&} {\n        background-color: $night-color-tertiary;\n      }\n      transition: background-color $theme-transition-duration;\n\n      border-radius: calc(var(--line-height) / 6);\n      font-family: 'Inconsolata', monospace;\n      font-size: calc(var(--line-height) / 3 * 2); // 16px\n      margin: 0 calc(var(--line-height) / 6);\n      padding: calc(var(--line-height) / 12) calc(var(--line-height) / 3);\n      vertical-align: bottom;\n      letter-spacing: normal;\n      white-space: pre-wrap; // wrapping long lines\n    }\n\n    pre {\n      overflow-y: hidden;\n      padding: calc(var(--line-height) / 2) 0;\n\n      & > code {\n        display: block;\n        background: unset;\n        border-radius: 0;\n        margin: 0;\n\n        background-color: $day-color-tertiary;\n        @at-root .night #{&} {\n          background-color: $night-color-tertiary;\n        }\n\n        border-left: calc(var(--line-height) / 6) solid;\n        border-left-color: $day-color-primary;\n        @at-root .night #{&} {\n          border-left-color: $night-color-primary;\n        }\n        transition: border-left-color $theme-transition-duration,\n          background-color $theme-transition-duration;\n\n        padding: calc(var(--line-height) / 2) calc(var(--line-height) * 5 / 6);\n        height: initial;\n        line-height: var(--line-height);\n        min-width: fit-content;\n        letter-spacing: normal;\n        white-space: pre-wrap; // wrapping long lines\n      }\n\n      &[dir='rtl'] {\n        & > code {\n          border-left: 0;\n          border-right: calc(var(--line-height) / 6) solid;\n          border-right-color: $day-color-primary;\n          @at-root .night #{&} {\n            border-right-color: $night-color-primary;\n          }\n          transition: border-right-color $theme-transition-duration;\n        }\n      }\n    }\n\n    // Image\n    // \n    img {\n      max-width: 100%;\n    }\n\n    // Link\n    // \n    a {\n      color: $day-color-primary;\n      @at-root .night #{&} {\n        color: $night-color-primary;\n      }\n      transition: color $theme-transition-duration;\n\n      text-decoration: none;\n      height: initial;\n      line-height: 1em;\n\n      &:focus,\n      &:hover {\n        color: $day-color-secondary;\n        transition: color $theme-transition-duration;\n        cursor: pointer;\n      }\n      @at-root .night #{&} {\n        &:focus,\n        &:hover {\n          color: $night-color-secondary;\n        }\n      }\n    }\n\n    // Spacing\n    // \n\n    @media print {\n      & .is-empty {\n        visibility: hidden !important;\n      }\n    }\n\n    .title {\n      color: $day-color-heading;\n      @at-root .night #{&} {\n        color: $night-color-heading;\n      }\n      transition: color $theme-transition-duration;\n    }\n  }\n\n  &.text-as-lines {\n    p:not(.title) {\n      font-family: 'Flow Rounded';\n      letter-spacing: -0.045em;\n      color: $day-color-line;\n      @at-root .night #{&} {\n        color: $night-color-line;\n      }\n      transition: color $theme-transition-duration;\n    }\n  }\n}\n"],sourceRoot:""}]);const Et=q},6314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n}).join("")},e.i=function(t,n,r,o,i){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);r&&s[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),e.push(u))}},e}},6395:t=>{t.exports=!1},6449:(t,e,n)=>{var r=n(6518),o=n(259),i=n(8981),s=n(6198),a=n(1291),l=n(1469);r({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=i(this),n=s(e),r=l(e,0);return r.length=o(r,e,e,n,0,void 0===t?1:a(t)),r}})},6469:(t,e,n)=>{var r=n(8227),o=n(2360),i=n(4913).f,s=r("unscopables"),a=Array.prototype;void 0===a[s]&&i(a,s,{configurable:!0,value:o(null)}),t.exports=function(t){a[s][t]=!0}},6501:(t,e,n)=>{var r=n(4552);t.exports=r},6518:(t,e,n)=>{var r=n(4576),o=n(7347).f,i=n(6699),s=n(6840),a=n(9433),l=n(7740),c=n(2796);t.exports=function(t,e){var n,u,d,h,p,f=t.target,g=t.global,m=t.stat;if(n=g?r:m?r[f]||a(f,{}):r[f]&&r[f].prototype)for(u in e){if(h=e[u],d=t.dontCallGetSet?(p=o(n,u))&&p.value:n[u],!c(g?u:f+(m?".":"#")+u,t.forced)&&void 0!==d){if(typeof h==typeof d)continue;l(h,d)}(t.sham||d&&d.sham)&&i(h,"sham",!0),s(n,u,h,t)}}},6682:(t,e,n)=>{var r=n(9565),o=n(8551),i=n(4901),s=n(2195),a=n(7323),l=TypeError;t.exports=function(t,e){var n=t.exec;if(i(n)){var c=r(n,t,e);return null!==c&&o(c),c}if("RegExp"===s(t))return r(a,t,e);throw new l("RegExp#exec called on incompatible receiver")}},6699:(t,e,n)=>{var r=n(3724),o=n(4913),i=n(6980);t.exports=r?function(t,e,n){return o.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},6706:(t,e,n)=>{var r=n(9504),o=n(9306);t.exports=function(t,e,n){try{return r(o(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(t){}}},6745:(t,e,n)=>{t.exports=n.p+"9f813345d7f51dc3d55a.svg"},6801:(t,e,n)=>{var r=n(3724),o=n(8686),i=n(4913),s=n(8551),a=n(5397),l=n(1072);e.f=r&&!o?Object.defineProperties:function(t,e){s(t);for(var n,r=a(e),o=l(e),c=o.length,u=0;c>u;)i.f(t,n=o[u++],r[n]);return t}},6823:t=>{var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},6837:t=>{var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},6840:(t,e,n)=>{var r=n(4901),o=n(4913),i=n(283),s=n(9433);t.exports=function(t,e,n,a){a||(a={});var l=a.enumerable,c=void 0!==a.name?a.name:e;if(r(n)&&i(n,c,a),a.global)l?t[e]=n:s(e,n);else{try{a.unsafe?t[e]&&(l=!0):delete t[e]}catch(t){}l?t[e]=n:o.f(t,e,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},6941:(t,e,n)=>{t.exports=n.p+"31e74ca2ec883b7ea1f0.svg"},6955:(t,e,n)=>{var r=n(2140),o=n(4901),i=n(2195),s=n(8227)("toStringTag"),a=Object,l="Arguments"===i(function(){return arguments}());t.exports=r?i:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=a(t),s))?n:l?i(e):"Object"===(r=i(e))&&o(e.callee)?"Arguments":r}},6969:(t,e,n)=>{var r=n(2777),o=n(757);t.exports=function(t){var e=r(t,"string");return o(e)?e:e+""}},6980:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},7015:(t,e,n)=>{var r=n(4576),o=n(9504);t.exports=function(t,e){return o(r[t].prototype[e])}},7040:(t,e,n)=>{var r=n(4495);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7055:(t,e,n)=>{var r=n(9504),o=n(9039),i=n(2195),s=Object,a=r("".split);t.exports=o(function(){return!s("z").propertyIsEnumerable(0)})?function(t){return"String"===i(t)?a(t,""):s(t)}:s},7086:(t,e,n)=>{var r=n(6501);t.exports=r},7323:(t,e,n)=>{var r,o,i=n(9565),s=n(9504),a=n(655),l=n(7979),c=n(8429),u=n(5745),d=n(2360),h=n(1181).get,p=n(3635),f=n(8814),g=u("native-string-replace",String.prototype.replace),m=RegExp.prototype.exec,y=m,b=s("".charAt),v=s("".indexOf),w=s("".replace),A=s("".slice),k=(o=/b*/g,i(m,r=/a/,"a"),i(m,o,"a"),0!==r.lastIndex||0!==o.lastIndex),x=c.BROKEN_CARET,C=void 0!==/()??/.exec("")[1];(k||C||x||p||f)&&(y=function(t){var e,n,r,o,s,c,u,p=this,f=h(p),S=a(t),E=f.raw;if(E)return E.lastIndex=p.lastIndex,e=i(y,E,S),p.lastIndex=E.lastIndex,e;var M=f.groups,_=x&&p.sticky,T=i(l,p),D=p.source,O=0,N=S;if(_&&(T=w(T,"y",""),-1===v(T,"g")&&(T+="g"),N=A(S,p.lastIndex),p.lastIndex>0&&(!p.multiline||p.multiline&&"\n"!==b(S,p.lastIndex-1))&&(D="(?: "+D+")",N=" "+N,O++),n=new RegExp("^(?:"+D+")",T)),C&&(n=new RegExp("^"+D+"$(?!\\s)",T)),k&&(r=p.lastIndex),o=i(m,_?n:p,N),_?o?(o.input=A(o.input,O),o[0]=A(o[0],O),o.index=p.lastIndex,p.lastIndex+=o[0].length):p.lastIndex=0:k&&o&&(p.lastIndex=p.global?o.index+o[0].length:r),C&&o&&o.length>1&&i(g,o[0],n,function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(o[s]=void 0)}),o&&M)for(o.groups=c=d(null),s=0;s<M.length;s++)c[(u=M[s])[0]]=o[u[1]];return o}),t.exports=y},7347:(t,e,n)=>{var r=n(3724),o=n(9565),i=n(8773),s=n(6980),a=n(5397),l=n(6969),c=n(9297),u=n(5917),d=Object.getOwnPropertyDescriptor;e.f=r?d:function(t,e){if(t=a(t),e=l(e),u)try{return d(t,e)}catch(t){}if(c(t,e))return s(!o(i.f,t,e),t[e])}},7357:(t,e,n)=>{var r=n(6518),o=n(9504),i=n(7750),s=n(1291),a=n(655),l=n(9039),c=o("".charAt);r({target:"String",proto:!0,forced:l(function(){return"\ud842"!=="".at(-2)})},{at:function(t){var e=a(i(this)),n=e.length,r=s(t),o=r>=0?r:n+r;return o<0||o>=n?void 0:c(e,o)}})},7433:(t,e,n)=>{var r=n(4376),o=n(3517),i=n(34),s=n(8227)("species"),a=Array;t.exports=function(t){var e;return r(t)&&(e=t.constructor,(o(e)&&(e===a||r(e.prototype))||i(e)&&null===(e=e[s]))&&(e=void 0)),void 0===e?a:e}},7476:(t,e,n)=>{var r=n(2195),o=n(9504);t.exports=function(t){if("Function"===r(t))return o(t)}},7495:(t,e,n)=>{var r=n(6518),o=n(7323);r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},7506:(t,e,n)=>{t.exports=n(1949)},7589:(t,e,n)=>{t.exports=n.p+"66787406989292dbd39c.svg"},7629:(t,e,n)=>{var r=n(6395),o=n(4576),i=n(9433),s="__core-js_shared__",a=t.exports=o[s]||i(s,{});(a.versions||(a.versions=[])).push({version:"3.46.0",mode:r?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.46.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7659:t=>{var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},7680:(t,e,n)=>{var r=n(9504);t.exports=r([].slice)},7693:(t,e,n)=>{t.exports=n.p+"d46386eff5ea0bf3d5a4.svg"},7740:(t,e,n)=>{var r=n(9297),o=n(5031),i=n(7347),s=n(4913);t.exports=function(t,e,n){for(var a=o(e),l=s.f,c=i.f,u=0;u<a.length;u++){var d=a[u];r(t,d)||n&&r(n,d)||l(t,d,c(e,d))}}},7750:(t,e,n)=>{var r=n(4117),o=TypeError;t.exports=function(t){if(r(t))throw new o("Can't call method on "+t);return t}},7751:(t,e,n)=>{var r=n(4576),o=n(4901);t.exports=function(t,e){return arguments.length<2?(n=r[t],o(n)?n:void 0):r[t]&&r[t][e];var n}},7811:t=>{t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},7825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},7829:(t,e,n)=>{var r=n(8183).charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},7963:(t,e,n)=>{t.exports=n.p+"d3301dfbb4b45107348b.svg"},7978:(t,e,n)=>{n(3451)},7979:(t,e,n)=>{var r=n(8551);t.exports=function(){var t=r(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},8014:(t,e,n)=>{var r=n(1291),o=Math.min;t.exports=function(t){var e=r(t);return e>0?o(e,9007199254740991):0}},8019:(t,e,n)=>{t.exports=n.p+"829edbd55f1a81efd8c1.svg"},8107:(t,e,n)=>{var r=n(6518),o=n(8981),i=n(6198),s=n(1291),a=n(6469);r({target:"Array",proto:!0},{at:function(t){var e=o(this),n=i(e),r=s(t),a=r>=0?r:n+r;return a<0||a>=n?void 0:e[a]}}),a("at")},8138:(t,e,n)=>{t.exports=n.p+"1aae246c0a027c4ee763.svg"},8145:(t,e,n)=>{t.exports=n.p+"2ba179eedac67a08fdf1.svg"},8157:(t,e,n)=>{t.exports=n.p+"0a294d9700f975b70816.svg"},8183:(t,e,n)=>{var r=n(9504),o=n(1291),i=n(655),s=n(7750),a=r("".charAt),l=r("".charCodeAt),c=r("".slice),u=function(t){return function(e,n){var r,u,d=i(s(e)),h=o(n),p=d.length;return h<0||h>=p?t?"":void 0:(r=l(d,h))<55296||r>56319||h+1===p||(u=l(d,h+1))<56320||u>57343?t?a(d,h):r:t?c(d,h,h+2):u-56320+(r-55296<<10)+65536}};t.exports={codeAt:u(!1),charAt:u(!0)}},8217:(t,e,n)=>{var r=n(4170);t.exports=r},8227:(t,e,n)=>{var r=n(4576),o=n(5745),i=n(9297),s=n(3392),a=n(4495),l=n(7040),c=r.Symbol,u=o("wks"),d=l?c.for||c:c&&c.withoutSetter||s;t.exports=function(t){return i(u,t)||(u[t]=a&&i(c,t)?c[t]:d("Symbol."+t)),u[t]}},8229:(t,e,n)=>{var r=n(9590),o=RangeError;t.exports=function(t,e){var n=r(t);if(n%e)throw new o("Wrong offset");return n}},8347:(t,e,n)=>{n(6518)({target:"Object",stat:!0},{hasOwn:n(9297)})},8350:(t,e,n)=>{var r=n(6518),o=n(259),i=n(9306),s=n(8981),a=n(6198),l=n(1469);r({target:"Array",proto:!0},{flatMap:function(t){var e,n=s(this),r=a(n);return i(t),(e=l(n,0)).length=o(e,n,n,r,0,1,t,arguments.length>1?arguments[1]:void 0),e}})},8429:(t,e,n)=>{var r=n(9039),o=n(4576).RegExp,i=r(function(){var t=o("a","y");return t.lastIndex=2,null!==t.exec("abcd")}),s=i||r(function(){return!o("a","y").sticky}),a=i||r(function(){var t=o("^r","gy");return t.lastIndex=2,null!==t.exec("str")});t.exports={BROKEN_CARET:a,MISSED_STICKY:s,UNSUPPORTED_Y:i}},8480:(t,e,n)=>{var r=n(1828),o=n(8727).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},8502:(t,e,n)=>{t.exports=n.p+"fc631ecd368d550a0637.svg"},8507:(t,e,n)=>{t.exports=n.p+"a2607123a62f53c8bd0c.svg"},8551:(t,e,n)=>{var r=n(34),o=String,i=TypeError;t.exports=function(t){if(r(t))return t;throw new i(o(t)+" is not an object")}},8622:(t,e,n)=>{var r=n(4576),o=n(4901),i=r.WeakMap;t.exports=o(i)&&/native code/.test(String(i))},8686:(t,e,n)=>{var r=n(3724),o=n(9039);t.exports=r&&o(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},8727:t=>{t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8745:(t,e,n)=>{var r=n(616),o=Function.prototype,i=o.apply,s=o.call;t.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(i):function(){return s.apply(i,arguments)})},8773:(t,e)=>{var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);e.f=o?function(t){var e=r(this,t);return!!e&&e.enumerable}:n},8814:(t,e,n)=>{var r=n(9039),o=n(4576).RegExp;t.exports=r(function(){var t=o("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})},8845:(t,e,n)=>{var r=n(4576),o=n(9565),i=n(4644),s=n(6198),a=n(8229),l=n(8981),c=n(9039),u=r.RangeError,d=r.Int8Array,h=d&&d.prototype,p=h&&h.set,f=i.aTypedArray,g=i.exportTypedArrayMethod,m=!c(function(){var t=new Uint8ClampedArray(2);return o(p,t,{length:1,0:3},1),3!==t[1]}),y=m&&i.NATIVE_ARRAY_BUFFER_VIEWS&&c(function(){var t=new d(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]});g("set",function(t){f(this);var e=a(arguments.length>1?arguments[1]:void 0,1),n=l(t);if(m)return o(p,this,n,e);var r=this.length,i=s(n),c=0;if(i+e>r)throw new u("Wrong length");for(;c<i;)this[e+c]=n[c++]},!m||y)},8881:(t,e,n)=>{t.exports=n.p+"d2005c90b9aa808d0e78.svg"},8981:(t,e,n)=>{var r=n(7750),o=Object;t.exports=function(t){return o(r(t))}},9039:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},9167:(t,e,n)=>{var r=n(4576);t.exports=r},9228:(t,e,n)=>{n(7495);var r=n(9565),o=n(6840),i=n(7323),s=n(9039),a=n(8227),l=n(6699),c=a("species"),u=RegExp.prototype;t.exports=function(t,e,n,d){var h=a(t),p=!s(function(){var e={};return e[h]=function(){return 7},7!==""[t](e)}),f=p&&!s(function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return e=!0,null},n[h](""),!e});if(!p||!f||n){var g=/./[h],m=e(h,""[t],function(t,e,n,o,s){var a=e.exec;return a===i||a===u.exec?p&&!s?{done:!0,value:r(g,e,n,o)}:{done:!0,value:r(t,n,e,o)}:{done:!1}});o(String.prototype,t,m[0]),o(u,h,m[1])}d&&l(u[h],"sham",!0)}},9297:(t,e,n)=>{var r=n(9504),o=n(8981),i=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return i(o(t),e)}},9306:(t,e,n)=>{var r=n(4901),o=n(6823),i=TypeError;t.exports=function(t){if(r(t))return t;throw new i(o(t)+" is not a function")}},9433:(t,e,n)=>{var r=n(4576),o=Object.defineProperty;t.exports=function(t,e){try{o(r,t,{value:e,configurable:!0,writable:!0})}catch(n){r[t]=e}return e}},9497:(t,e,n)=>{n(8107);var r=n(7015);t.exports=r("Array","at")},9504:(t,e,n)=>{var r=n(616),o=Function.prototype,i=o.call,s=r&&o.bind.bind(i,i);t.exports=r?s:function(t){return function(){return i.apply(t,arguments)}}},9519:(t,e,n)=>{var r,o,i=n(4576),s=n(2839),a=i.process,l=i.Deno,c=a&&a.versions||l&&l.version,u=c&&c.v8;u&&(o=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(o=+r[1]),t.exports=o},9565:(t,e,n)=>{var r=n(616),o=Function.prototype.call;t.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},9590:(t,e,n)=>{var r=n(1291),o=RangeError;t.exports=function(t){var e=r(t);if(e<0)throw new o("The argument can't be less than 0");return e}},9617:(t,e,n)=>{var r=n(5397),o=n(5610),i=n(6198),s=function(t){return function(e,n,s){var a=r(e),l=i(a);if(0===l)return!t&&-1;var c,u=o(s,l);if(t&&n!=n){for(;l>u;)if((c=a[u++])!=c)return!0}else for(;l>u;u++)if((t||u in a)&&a[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},9951:(t,e,n)=>{n(8347);var r=n(9167);t.exports=r.Object.hasOwn},9978:(t,e,n)=>{var r=n(6518),o=n(9565),i=n(9504),s=n(7750),a=n(4901),l=n(34),c=n(788),u=n(655),d=n(5966),h=n(1034),p=n(2478),f=n(8227),g=n(6395),m=f("replace"),y=TypeError,b=i("".indexOf),v=i("".replace),w=i("".slice),A=Math.max;r({target:"String",proto:!0},{replaceAll:function(t,e){var n,r,i,f,k,x,C,S,E,M,_=s(this),T=0,D="";if(l(t)){if((n=c(t))&&(r=u(s(h(t))),!~b(r,"g")))throw new y("`.replaceAll` does not allow non-global regexes");if(i=d(t,m))return o(i,t,_,e);if(g&&n)return v(u(_),t,e)}for(f=u(_),k=u(t),(x=a(e))||(e=u(e)),C=k.length,S=A(1,C),E=b(f,k);-1!==E;)M=x?u(e(k,E,f)):p(k,f,E,[],void 0,e),D+=w(f,T,E)+M,T=E+C,E=E+S>f.length?-1:b(f,k,E+S);return T<f.length&&(D+=w(f,T)),D}})}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={id:r,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t+"../"})(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,n.nc=void 0,n(1478),n(5947),n(5339),n(4909),n(4212),n(8217),n(4881),n(7086);var r=n(4671);tiptap=r})();
//# sourceMappingURL=tiptap.bundle.js.map?t=eebad9b69