(()=>{"use strict";var e={34:(e,t,n)=>{var r=n(4901);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},283:(e,t,n)=>{var r=n(9504),s=n(9039),o=n(4901),i=n(9297),a=n(3724),c=n(350).CONFIGURABLE,l=n(3706),u=n(1181),d=u.enforce,p=u.get,h=String,f=Object.defineProperty,m=r("".slice),g=r("".replace),y=r([].join),v=a&&!s(function(){return 8!==f(function(){},"length",{value:8}).length}),b=String(String).split("String"),_=e.exports=function(e,t,n){"Symbol("===m(h(t),0,7)&&(t="["+g(h(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!i(e,"name")||c&&e.name!==t)&&(a?f(e,"name",{value:t,configurable:!0}):e.name=t),v&&n&&i(n,"arity")&&e.length!==n.arity&&f(e,"length",{value:n.arity});try{n&&i(n,"constructor")&&n.constructor?a&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=d(e);return i(r,"source")||(r.source=y(b,"string"==typeof t?t:"")),e};Function.prototype.toString=_(function(){return o(this)&&p(this).source||l(this)},"toString")},350:(e,t,n)=>{var r=n(3724),s=n(9297),o=Function.prototype,i=r&&Object.getOwnPropertyDescriptor,a=s(o,"name"),c=a&&"something"===function(){}.name,l=a&&(!r||r&&i(o,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:l}},373:(e,t,n)=>{var r=n(4576),s=n(7476),o=n(9039),i=n(9306),a=n(4488),c=n(4644),l=n(3709),u=n(3763),d=n(9519),p=n(3607),h=c.aTypedArray,f=c.exportTypedArrayMethod,m=r.Uint16Array,g=m&&s(m.prototype.sort),y=!(!g||o(function(){g(new m(2),null)})&&o(function(){g(new m(2),{})})),v=!!g&&!o(function(){if(d)return d<74;if(l)return l<67;if(u)return!0;if(p)return p<602;var e,t,n=new m(516),r=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(g(n,function(e,t){return(e/4|0)-(t/4|0)}),e=0;e<516;e++)if(n[e]!==r[e])return!0});f("sort",function(e){return void 0!==e&&i(e),v?g(this,e):a(h(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))},!v||y)},397:(e,t,n)=>{var r=n(7751);e.exports=r("document","documentElement")},421:e=>{e.exports={}},616:(e,t,n)=>{var r=n(9039);e.exports=!r(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})},741:e=>{var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},757:(e,t,n)=>{var r=n(7751),s=n(4901),o=n(1625),i=n(7040),a=Object;e.exports=i?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return s(t)&&o(t.prototype,a(e))}},1072:(e,t,n)=>{var r=n(1828),s=n(8727);e.exports=Object.keys||function(e){return r(e,s)}},1181:(e,t,n)=>{var r,s,o,i=n(8622),a=n(4576),c=n(34),l=n(6699),u=n(9297),d=n(7629),p=n(6119),h=n(421),f="Object already initialized",m=a.TypeError,g=a.WeakMap;if(i||d.state){var y=d.state||(d.state=new g);y.get=y.get,y.has=y.has,y.set=y.set,r=function(e,t){if(y.has(e))throw new m(f);return t.facade=e,y.set(e,t),t},s=function(e){return y.get(e)||{}},o=function(e){return y.has(e)}}else{var v=p("state");h[v]=!0,r=function(e,t){if(u(e,v))throw new m(f);return t.facade=e,l(e,v,t),t},s=function(e){return u(e,v)?e[v]:{}},o=function(e){return u(e,v)}}e.exports={set:r,get:s,has:o,enforce:function(e){return o(e)?s(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=s(t)).type!==e)throw new m("Incompatible receiver, "+e+" required");return n}}}},1291:(e,t,n)=>{var r=n(741);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},1625:(e,t,n)=>{var r=n(9504);e.exports=r({}.isPrototypeOf)},1828:(e,t,n)=>{var r=n(9504),s=n(9297),o=n(5397),i=n(9617).indexOf,a=n(421),c=r([].push);e.exports=function(e,t){var n,r=o(e),l=0,u=[];for(n in r)!s(a,n)&&s(r,n)&&c(u,n);for(;t.length>l;)s(r,n=t[l++])&&(~i(u,n)||c(u,n));return u}},2106:(e,t,n)=>{var r=n(283),s=n(4913);e.exports=function(e,t,n){return n.get&&r(n.get,t,{getter:!0}),n.set&&r(n.set,t,{setter:!0}),s.f(e,t,n)}},2140:(e,t,n)=>{var r={};r[n(8227)("toStringTag")]="z",e.exports="[object z]"===String(r)},2195:(e,t,n)=>{var r=n(9504),s=r({}.toString),o=r("".slice);e.exports=function(e){return o(s(e),8,-1)}},2211:(e,t,n)=>{var r=n(9039);e.exports=!r(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})},2360:(e,t,n)=>{var r,s=n(8551),o=n(6801),i=n(8727),a=n(421),c=n(397),l=n(4055),u=n(6119),d="prototype",p="script",h=u("IE_PROTO"),f=function(){},m=function(e){return"<"+p+">"+e+"</"+p+">"},g=function(e){e.write(m("")),e.close();var t=e.parentWindow.Object;return e=null,t},y=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;y="undefined"!=typeof document?document.domain&&r?g(r):(t=l("iframe"),n="java"+p+":",t.style.display="none",c.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(m("document.F=Object")),e.close(),e.F):g(r);for(var s=i.length;s--;)delete y[d][i[s]];return y()};a[h]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(f[d]=s(e),n=new f,f[d]=null,n[h]=e):n=y(),void 0===t?n:o.f(n,t)}},2777:(e,t,n)=>{var r=n(9565),s=n(34),o=n(757),i=n(5966),a=n(4270),c=n(8227),l=TypeError,u=c("toPrimitive");e.exports=function(e,t){if(!s(e)||o(e))return e;var n,c=i(e,u);if(c){if(void 0===t&&(t="default"),n=r(c,e,t),!s(n)||o(n))return n;throw new l("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},2787:(e,t,n)=>{var r=n(9297),s=n(4901),o=n(8981),i=n(6119),a=n(2211),c=i("IE_PROTO"),l=Object,u=l.prototype;e.exports=a?l.getPrototypeOf:function(e){var t=o(e);if(r(t,c))return t[c];var n=t.constructor;return s(n)&&t instanceof n?n.prototype:t instanceof l?u:null}},2796:(e,t,n)=>{var r=n(9039),s=n(4901),o=/#|\.prototype\./,i=function(e,t){var n=c[a(e)];return n===u||n!==l&&(s(t)?r(t):!!t)},a=i.normalize=function(e){return String(e).replace(o,".").toLowerCase()},c=i.data={},l=i.NATIVE="N",u=i.POLYFILL="P";e.exports=i},2839:(e,t,n)=>{var r=n(4576).navigator,s=r&&r.userAgent;e.exports=s?String(s):""},2967:(e,t,n)=>{var r=n(6706),s=n(34),o=n(7750),i=n(3506);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return o(n),i(r),s(n)?(t?e(n,r):n.__proto__=r,n):n}}():void 0)},3392:(e,t,n)=>{var r=n(9504),s=0,o=Math.random(),i=r(1.1.toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+i(++s+o,36)}},3506:(e,t,n)=>{var r=n(3925),s=String,o=TypeError;e.exports=function(e){if(r(e))return e;throw new o("Can't set "+s(e)+" as a prototype")}},3607:(e,t,n)=>{var r=n(2839).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},3706:(e,t,n)=>{var r=n(9504),s=n(4901),o=n(7629),i=r(Function.toString);s(o.inspectSource)||(o.inspectSource=function(e){return i(e)}),e.exports=o.inspectSource},3709:(e,t,n)=>{var r=n(2839).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},3717:(e,t)=>{t.f=Object.getOwnPropertySymbols},3724:(e,t,n)=>{var r=n(9039);e.exports=!r(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},3763:(e,t,n)=>{var r=n(2839);e.exports=/MSIE|Trident/.test(r)},3925:(e,t,n)=>{var r=n(34);e.exports=function(e){return r(e)||null===e}},4055:(e,t,n)=>{var r=n(4576),s=n(34),o=r.document,i=s(o)&&s(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},4117:e=>{e.exports=function(e){return null==e}},4270:(e,t,n)=>{var r=n(9565),s=n(4901),o=n(34),i=TypeError;e.exports=function(e,t){var n,a;if("string"===t&&s(n=e.toString)&&!o(a=r(n,e)))return a;if(s(n=e.valueOf)&&!o(a=r(n,e)))return a;if("string"!==t&&s(n=e.toString)&&!o(a=r(n,e)))return a;throw new i("Can't convert object to primitive value")}},4373:(e,t,n)=>{var r=n(8981),s=n(5610),o=n(6198);e.exports=function(e){for(var t=r(this),n=o(t),i=arguments.length,a=s(i>1?arguments[1]:void 0,n),c=i>2?arguments[2]:void 0,l=void 0===c?n:s(c,n);l>a;)t[a++]=e;return t}},4423:(e,t,n)=>{var r=n(6518),s=n(9617).includes,o=n(9039),i=n(6469);r({target:"Array",proto:!0,forced:o(function(){return!Array(1).includes()})},{includes:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),i("includes")},4488:(e,t,n)=>{var r=n(7680),s=Math.floor,o=function(e,t){var n=e.length;if(n<8)for(var i,a,c=1;c<n;){for(a=c,i=e[c];a&&t(e[a-1],i)>0;)e[a]=e[--a];a!==c++&&(e[a]=i)}else for(var l=s(n/2),u=o(r(e,0,l),t),d=o(r(e,l),t),p=u.length,h=d.length,f=0,m=0;f<p||m<h;)e[f+m]=f<p&&m<h?t(u[f],d[m])<=0?u[f++]:d[m++]:f<p?u[f++]:d[m++];return e};e.exports=o},4495:(e,t,n)=>{var r=n(9519),s=n(9039),o=n(4576).String;e.exports=!!Object.getOwnPropertySymbols&&!s(function(){var e=Symbol("symbol detection");return!o(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41})},4576:function(e,t,n){var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},4644:(e,t,n)=>{var r,s,o,i=n(7811),a=n(3724),c=n(4576),l=n(4901),u=n(34),d=n(9297),p=n(6955),h=n(6823),f=n(6699),m=n(6840),g=n(2106),y=n(1625),v=n(2787),b=n(2967),_=n(8227),S=n(3392),w=n(1181),k=w.enforce,x=w.get,T=c.Int8Array,E=T&&T.prototype,I=c.Uint8ClampedArray,C=I&&I.prototype,M=T&&v(T),R=E&&v(E),O=Object.prototype,A=c.TypeError,N=_("toStringTag"),D=S("TYPED_ARRAY_TAG"),L="TypedArrayConstructor",P=i&&!!b&&"Opera"!==p(c.opera),F=!1,j={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},$={BigInt64Array:8,BigUint64Array:8},B=function(e){var t=v(e);if(u(t)){var n=x(t);return n&&d(n,L)?n[L]:B(t)}},U=function(e){if(!u(e))return!1;var t=p(e);return d(j,t)||d($,t)};for(r in j)(o=(s=c[r])&&s.prototype)?k(o)[L]=s:P=!1;for(r in $)(o=(s=c[r])&&s.prototype)&&(k(o)[L]=s);if((!P||!l(M)||M===Function.prototype)&&(M=function(){throw new A("Incorrect invocation")},P))for(r in j)c[r]&&b(c[r],M);if((!P||!R||R===O)&&(R=M.prototype,P))for(r in j)c[r]&&b(c[r].prototype,R);if(P&&v(C)!==R&&b(C,R),a&&!d(R,N))for(r in F=!0,g(R,N,{configurable:!0,get:function(){return u(this)?this[D]:void 0}}),j)c[r]&&f(c[r],D,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:P,TYPED_ARRAY_TAG:F&&D,aTypedArray:function(e){if(U(e))return e;throw new A("Target is not a typed array")},aTypedArrayConstructor:function(e){if(l(e)&&(!b||y(M,e)))return e;throw new A(h(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,r){if(a){if(n)for(var s in j){var o=c[s];if(o&&d(o.prototype,e))try{delete o.prototype[e]}catch(n){try{o.prototype[e]=t}catch(e){}}}R[e]&&!n||m(R,e,n?t:P&&E[e]||t,r)}},exportTypedArrayStaticMethod:function(e,t,n){var r,s;if(a){if(b){if(n)for(r in j)if((s=c[r])&&d(s,e))try{delete s[e]}catch(e){}if(M[e]&&!n)return;try{return m(M,e,n?t:P&&M[e]||t)}catch(e){}}for(r in j)!(s=c[r])||s[e]&&!n||m(s,e,t)}},getTypedArrayConstructor:B,isView:function(e){if(!u(e))return!1;var t=p(e);return"DataView"===t||d(j,t)||d($,t)},isTypedArray:U,TypedArray:M,TypedArrayPrototype:R}},4901:e=>{var t="object"==typeof document&&document.all;e.exports=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},4913:(e,t,n)=>{var r=n(3724),s=n(5917),o=n(8686),i=n(8551),a=n(6969),c=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",p="configurable",h="writable";t.f=r?o?function(e,t,n){if(i(e),t=a(t),i(n),"function"==typeof e&&"prototype"===t&&"value"in n&&h in n&&!n[h]){var r=u(e,t);r&&r[h]&&(e[t]=n.value,n={configurable:p in n?n[p]:r[p],enumerable:d in n?n[d]:r[d],writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(i(e),t=a(t),i(n),s)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},5031:(e,t,n)=>{var r=n(7751),s=n(9504),o=n(8480),i=n(3717),a=n(8551),c=s([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(a(e)),n=i.f;return n?c(t,n(e)):t}},5044:(e,t,n)=>{var r=n(4644),s=n(4373),o=n(5854),i=n(6955),a=n(9565),c=n(9504),l=n(9039),u=r.aTypedArray,d=r.exportTypedArrayMethod,p=c("".slice),h=l(function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),1!==e});d("fill",function(e){var t=arguments.length;u(this);var n="Big"===p(i(this),0,3)?o(e):+e;return a(s,this,n,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)},h)},5213:(e,t,n)=>{var r=n(4576),s=n(9039),o=r.RegExp,i=!s(function(){var e=!0;try{o(".","d")}catch(t){e=!1}var t={},n="",r=e?"dgimsy":"gimsy",s=function(e,r){Object.defineProperty(t,e,{get:function(){return n+=r,!0}})},i={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in e&&(i.hasIndices="d"),i)s(a,i[a]);return Object.getOwnPropertyDescriptor(o.prototype,"flags").get.call(t)!==r||n!==r});e.exports={correct:i}},5397:(e,t,n)=>{var r=n(7055),s=n(7750);e.exports=function(e){return r(s(e))}},5610:(e,t,n)=>{var r=n(1291),s=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?s(n+t,0):o(n,t)}},5745:(e,t,n)=>{var r=n(7629);e.exports=function(e,t){return r[e]||(r[e]=t||{})}},5854:(e,t,n)=>{var r=n(2777),s=TypeError;e.exports=function(e){var t=r(e,"number");if("number"==typeof t)throw new s("Can't convert number to bigint");return BigInt(t)}},5917:(e,t,n)=>{var r=n(3724),s=n(9039),o=n(4055);e.exports=!r&&!s(function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})},5966:(e,t,n)=>{var r=n(9306),s=n(4117);e.exports=function(e,t){var n=e[t];return s(n)?void 0:r(n)}},6119:(e,t,n)=>{var r=n(5745),s=n(3392),o=r("keys");e.exports=function(e){return o[e]||(o[e]=s(e))}},6198:(e,t,n)=>{var r=n(8014);e.exports=function(e){return r(e.length)}},6395:e=>{e.exports=!1},6469:(e,t,n)=>{var r=n(8227),s=n(2360),o=n(4913).f,i=r("unscopables"),a=Array.prototype;void 0===a[i]&&o(a,i,{configurable:!0,value:s(null)}),e.exports=function(e){a[i][e]=!0}},6518:(e,t,n)=>{var r=n(4576),s=n(7347).f,o=n(6699),i=n(6840),a=n(9433),c=n(7740),l=n(2796);e.exports=function(e,t){var n,u,d,p,h,f=e.target,m=e.global,g=e.stat;if(n=m?r:g?r[f]||a(f,{}):r[f]&&r[f].prototype)for(u in t){if(p=t[u],d=e.dontCallGetSet?(h=s(n,u))&&h.value:n[u],!l(m?u:f+(g?".":"#")+u,e.forced)&&void 0!==d){if(typeof p==typeof d)continue;c(p,d)}(e.sham||d&&d.sham)&&o(p,"sham",!0),i(n,u,p,e)}}},6699:(e,t,n)=>{var r=n(3724),s=n(4913),o=n(6980);e.exports=r?function(e,t,n){return s.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},6706:(e,t,n)=>{var r=n(9504),s=n(9306);e.exports=function(e,t,n){try{return r(s(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}}},6801:(e,t,n)=>{var r=n(3724),s=n(8686),o=n(4913),i=n(8551),a=n(5397),c=n(1072);t.f=r&&!s?Object.defineProperties:function(e,t){i(e);for(var n,r=a(t),s=c(t),l=s.length,u=0;l>u;)o.f(e,n=s[u++],r[n]);return e}},6823:e=>{var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},6840:(e,t,n)=>{var r=n(4901),s=n(4913),o=n(283),i=n(9433);e.exports=function(e,t,n,a){a||(a={});var c=a.enumerable,l=void 0!==a.name?a.name:t;if(r(n)&&o(n,l,a),a.global)c?e[t]=n:i(t,n);else{try{a.unsafe?e[t]&&(c=!0):delete e[t]}catch(e){}c?e[t]=n:s.f(e,t,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},6955:(e,t,n)=>{var r=n(2140),s=n(4901),o=n(2195),i=n(8227)("toStringTag"),a=Object,c="Arguments"===o(function(){return arguments}());e.exports=r?o:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=a(e),i))?n:c?o(t):"Object"===(r=o(t))&&s(t.callee)?"Arguments":r}},6969:(e,t,n)=>{var r=n(2777),s=n(757);e.exports=function(e){var t=r(e,"string");return s(t)?t:t+""}},6980:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},7040:(e,t,n)=>{var r=n(4495);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7055:(e,t,n)=>{var r=n(9504),s=n(9039),o=n(2195),i=Object,a=r("".split);e.exports=s(function(){return!i("z").propertyIsEnumerable(0)})?function(e){return"String"===o(e)?a(e,""):i(e)}:i},7347:(e,t,n)=>{var r=n(3724),s=n(9565),o=n(8773),i=n(6980),a=n(5397),c=n(6969),l=n(9297),u=n(5917),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=a(e),t=c(t),u)try{return d(e,t)}catch(e){}if(l(e,t))return i(!s(o.f,e,t),e[t])}},7476:(e,t,n)=>{var r=n(2195),s=n(9504);e.exports=function(e){if("Function"===r(e))return s(e)}},7629:(e,t,n)=>{var r=n(6395),s=n(4576),o=n(9433),i="__core-js_shared__",a=e.exports=s[i]||o(i,{});(a.versions||(a.versions=[])).push({version:"3.47.0",mode:r?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7680:(e,t,n)=>{var r=n(9504);e.exports=r([].slice)},7740:(e,t,n)=>{var r=n(9297),s=n(5031),o=n(7347),i=n(4913);e.exports=function(e,t,n){for(var a=s(t),c=i.f,l=o.f,u=0;u<a.length;u++){var d=a[u];r(e,d)||n&&r(n,d)||c(e,d,l(t,d))}}},7750:(e,t,n)=>{var r=n(4117),s=TypeError;e.exports=function(e){if(r(e))throw new s("Can't call method on "+e);return e}},7751:(e,t,n)=>{var r=n(4576),s=n(4901);e.exports=function(e,t){return arguments.length<2?(n=r[e],s(n)?n:void 0):r[e]&&r[e][t];var n}},7811:e=>{e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},7979:(e,t,n)=>{var r=n(8551);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},8014:(e,t,n)=>{var r=n(1291),s=Math.min;e.exports=function(e){var t=r(e);return t>0?s(t,9007199254740991):0}},8227:(e,t,n)=>{var r=n(4576),s=n(5745),o=n(9297),i=n(3392),a=n(4495),c=n(7040),l=r.Symbol,u=s("wks"),d=c?l.for||l:l&&l.withoutSetter||i;e.exports=function(e){return o(u,e)||(u[e]=a&&o(l,e)?l[e]:d("Symbol."+e)),u[e]}},8229:(e,t,n)=>{var r=n(9590),s=RangeError;e.exports=function(e,t){var n=r(e);if(n%t)throw new s("Wrong offset");return n}},8480:(e,t,n)=>{var r=n(1828),s=n(8727).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,s)}},8551:(e,t,n)=>{var r=n(34),s=String,o=TypeError;e.exports=function(e){if(r(e))return e;throw new o(s(e)+" is not an object")}},8622:(e,t,n)=>{var r=n(4576),s=n(4901),o=r.WeakMap;e.exports=s(o)&&/native code/.test(String(o))},8686:(e,t,n)=>{var r=n(3724),s=n(9039);e.exports=r&&s(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},8727:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8773:(e,t)=>{var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,s=r&&!n.call({1:2},1);t.f=s?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},8845:(e,t,n)=>{var r=n(4576),s=n(9565),o=n(4644),i=n(6198),a=n(8229),c=n(8981),l=n(9039),u=r.RangeError,d=r.Int8Array,p=d&&d.prototype,h=p&&p.set,f=o.aTypedArray,m=o.exportTypedArrayMethod,g=!l(function(){var e=new Uint8ClampedArray(2);return s(h,e,{length:1,0:3},1),3!==e[1]}),y=g&&o.NATIVE_ARRAY_BUFFER_VIEWS&&l(function(){var e=new d(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]});m("set",function(e){f(this);var t=a(arguments.length>1?arguments[1]:void 0,1),n=c(e);if(g)return s(h,this,n,t);var r=this.length,o=i(n),l=0;if(o+t>r)throw new u("Wrong length");for(;l<o;)this[t+l]=n[l++]},!g||y)},8981:(e,t,n)=>{var r=n(7750),s=Object;e.exports=function(e){return s(r(e))}},9039:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},9297:(e,t,n)=>{var r=n(9504),s=n(8981),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(s(e),t)}},9306:(e,t,n)=>{var r=n(4901),s=n(6823),o=TypeError;e.exports=function(e){if(r(e))return e;throw new o(s(e)+" is not a function")}},9433:(e,t,n)=>{var r=n(4576),s=Object.defineProperty;e.exports=function(e,t){try{s(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},9479:(e,t,n)=>{var r=n(3724),s=n(2106),o=n(5213),i=n(7979);r&&!o.correct&&(s(RegExp.prototype,"flags",{configurable:!0,get:i}),o.correct=!0)},9504:(e,t,n)=>{var r=n(616),s=Function.prototype,o=s.call,i=r&&s.bind.bind(o,o);e.exports=r?i:function(e){return function(){return o.apply(e,arguments)}}},9519:(e,t,n)=>{var r,s,o=n(4576),i=n(2839),a=o.process,c=o.Deno,l=a&&a.versions||c&&c.version,u=l&&l.v8;u&&(s=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!s&&i&&(!(r=i.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=i.match(/Chrome\/(\d+)/))&&(s=+r[1]),e.exports=s},9565:(e,t,n)=>{var r=n(616),s=Function.prototype.call;e.exports=r?s.bind(s):function(){return s.apply(s,arguments)}},9590:(e,t,n)=>{var r=n(1291),s=RangeError;e.exports=function(e){var t=r(e);if(t<0)throw new s("The argument can't be less than 0");return t}},9617:(e,t,n)=>{var r=n(5397),s=n(5610),o=n(6198),i=function(e){return function(t,n,i){var a=r(t),c=o(a);if(0===c)return!e&&-1;var l,u=s(i,c);if(e&&n!=n){for(;c>u;)if((l=a[u++])!=l)return!0}else for(;c>u;u++)if((e||u in a)&&a[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:i(!0),indexOf:i(!1)}}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};n.r(r),n.d(r,{debug:()=>oy,error:()=>cy,fatal:()=>ly,fmt:()=>ny,info:()=>iy,trace:()=>sy,warn:()=>ay});var s={};n.r(s),n.d(s,{count:()=>dy,distribution:()=>hy,gauge:()=>py});var o={};n.r(o),n.d(o,{BrowserClient:()=>Es,MULTIPLEXED_TRANSPORT_EXTRA_KEY:()=>jf,OpenFeatureIntegrationHook:()=>Pv,SDK_VERSION:()=>a,SEMANTIC_ATTRIBUTE_SENTRY_OP:()=>_t,SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN:()=>St,SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE:()=>vt,SEMANTIC_ATTRIBUTE_SENTRY_SOURCE:()=>yt,Scope:()=>Ie,WINDOW:()=>Ss,addBreadcrumb:()=>qs,addEventProcessor:()=>gs,addIntegration:()=>We,breadcrumbsIntegration:()=>fo,browserApiErrorsIntegration:()=>go,browserProfilingIntegration:()=>tl,browserSessionIntegration:()=>_o,browserTracingIntegration:()=>_c,buildLaunchDarklyFlagUsedHandler:()=>Kp,captureConsoleIntegration:()=>Uf,captureEvent:()=>ss,captureException:()=>ns,captureFeedback:()=>Gp,captureMessage:()=>rs,captureSession:()=>_s,chromeStackLineParser:()=>zo,close:()=>hs,consoleLoggingIntegration:()=>Wf,contextLinesIntegration:()=>zy,continueTrace:()=>ki,createConsolaReporter:()=>Jf,createLangChainCallbackHandler:()=>Ym,createTransport:()=>gr,createUserFeedbackEnvelope:()=>Ry,dedupeIntegration:()=>tt,defaultRequestInstrumentationOptions:()=>gc,defaultStackLineParsers:()=>Zo,defaultStackParser:()=>ei,diagnoseSdkConnectivity:()=>Hv,endSession:()=>vs,eventFiltersIntegration:()=>Ke,eventFromException:()=>Yr,eventFromMessage:()=>Qr,exceptionFromError:()=>qr,extraErrorDataIntegration:()=>Qm,featureFlagsIntegration:()=>eg,feedbackAsyncIntegration:()=>Pf,feedbackIntegration:()=>Ff,feedbackSyncIntegration:()=>Ff,flush:()=>ps,forceLoad:()=>ui,functionToStringIntegration:()=>et,geckoStackLineParser:()=>Vo,getActiveSpan:()=>hn,getClient:()=>$e,getCurrentScope:()=>De,getDefaultIntegrations:()=>ci,getFeedback:()=>lh,getGlobalScope:()=>Pe,getIsolationScope:()=>Le,getReplay:()=>Bp,getRootSpan:()=>pn,getSpanDescendants:()=>dn,getSpanStatusFromHttpCode:()=>$t,getTraceData:()=>oc,globalHandlersIntegration:()=>Io,graphqlClientIntegration:()=>Jy,growthbookIntegration:()=>Bv,httpClientIntegration:()=>Ly,httpContextIntegration:()=>Ao,inboundFiltersIntegration:()=>Ge,init:()=>li,instrumentAnthropicAiClient:()=>hg,instrumentGoogleGenAIClient:()=>kg,instrumentLangGraph:()=>Cg,instrumentOpenAiClient:()=>zg,instrumentOutgoingRequests:()=>yc,instrumentSupabaseClient:()=>Zg,isEnabled:()=>ms,isInitialized:()=>fs,lastEventId:()=>ds,launchDarklyIntegration:()=>Jp,lazyLoadIntegration:()=>Lf,linkedErrorsIntegration:()=>Fo,logger:()=>r,makeBrowserOfflineTransport:()=>Nv,makeFetchTransport:()=>ai,makeMultiplexedTransport:()=>Bf,metrics:()=>s,moduleMetadataIntegration:()=>vy,onLoad:()=>di,openFeatureIntegration:()=>Lv,opera10StackLineParser:()=>Xo,opera11StackLineParser:()=>Qo,parameterize:()=>ty,registerSpanErrorInstrumentation:()=>Pi,registerWebWorker:()=>Wv,replayCanvasIntegration:()=>xv,replayIntegration:()=>Fp,reportPageLoaded:()=>Tv,reportingObserverIntegration:()=>Dy,rewriteFramesIntegration:()=>wy,sendFeedback:()=>eh,setActiveSpanInBrowser:()=>Ev,setContext:()=>os,setCurrentClient:()=>ot,setExtra:()=>as,setExtras:()=>is,setHttpStatus:()=>Bt,setMeasurement:()=>hi,setTag:()=>ls,setTags:()=>cs,setUser:()=>us,showReportDialog:()=>Oy,spanToBaggageHeader:()=>Sn,spanToJSON:()=>sn,spanToTraceHeader:()=>en,spotlightBrowserIntegration:()=>Dv,startBrowserTracingNavigationSpan:()=>wc,startBrowserTracingPageLoadSpan:()=>Sc,startInactiveSpan:()=>wi,startNewTrace:()=>Ei,startSession:()=>ys,startSpan:()=>_i,startSpanManual:()=>Si,statsigIntegration:()=>Uv,supabaseIntegration:()=>ey,suppressTracing:()=>Ti,thirdPartyErrorFilterIntegration:()=>ky,uiProfiler:()=>My,unleashIntegration:()=>Fv,updateSpanName:()=>mn,webWorkerIntegration:()=>zv,winjsStackLineParser:()=>Ko,withActiveSpan:()=>xi,withIsolationScope:()=>je,withScope:()=>Fe,zodErrorsIntegration:()=>Cy}),n(4423);const i="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,a="10.30.0",c=globalThis;function l(){return u(c),c}function u(e){const t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||a,t[a]=t[a]||{}}function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c;const r=n.__SENTRY__=n.__SENTRY__||{},s=r[a]=r[a]||{};return s[e]||(s[e]=t())}n(9479);const p=Object.prototype.toString;function h(e){switch(p.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return k(e,Error)}}function f(e,t){return p.call(e)===`[object ${t}]`}function m(e){return f(e,"ErrorEvent")}function g(e){return f(e,"DOMError")}function y(e){return f(e,"String")}function v(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function b(e){return null===e||v(e)||"object"!=typeof e&&"function"!=typeof e}function _(e){return f(e,"Object")}function S(e){return"undefined"!=typeof Event&&k(e,Event)}function w(e){return Boolean((null==e?void 0:e.then)&&"function"==typeof e.then)}function k(e,t){try{return e instanceof t}catch{return!1}}function x(e){return!("object"!=typeof e||null===e||!(e.__isVue||e._isVue||e.__v_isVNode))}function T(e){return"undefined"!=typeof Request&&k(e,Request)}const E=c,I=80;function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return"<unknown>";try{let n=e;const r=5,s=[];let o=0,i=0;const a=" > ",c=a.length;let l;const u=Array.isArray(t)?t:t.keyAttrs,d=!Array.isArray(t)&&t.maxStringLength||I;for(;n&&o++<r&&(l=M(n,u),!("html"===l||o>1&&i+s.length*c+l.length>=d));)s.push(l),i+=l.length,n=n.parentNode;return s.reverse().join(a)}catch{return"<unknown>"}}function M(e,t){const n=e,r=[];if(null==n||!n.tagName)return"";if(E.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const s=null!=t&&t.length?t.filter(e=>n.getAttribute(e)).map(e=>[e,n.getAttribute(e)]):null;if(null!=s&&s.length)s.forEach(e=>{r.push(`[${e[0]}="${e[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const e=n.className;if(e&&y(e)){const t=e.split(/\s+/);for(const e of t)r.push(`.${e}`)}}const o=["aria-label","type","name","title","alt"];for(const e of o){const t=n.getAttribute(e);t&&r.push(`[${e}="${t}"]`)}return r.join("")}function R(){try{return E.document.location.href}catch{return""}}function O(e){if(!E.HTMLElement)return null;let t=e;for(let e=0;e<5;e++){if(!t)return null;if(t instanceof HTMLElement){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}t=t.parentNode}return null}const A=["debug","info","warn","error","log","assert","trace"],N={};function D(e){if(!("console"in c))return e();const t=c.console,n={},r=Object.keys(N);r.forEach(e=>{const r=N[e];n[e]=t[e],t[e]=r});try{return e()}finally{r.forEach(e=>{t[e]=n[e]})}}function L(){return F().enabled}function P(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i&&L()&&D(()=>{c.console[e](`Sentry Logger [${e}]:`,...n)})}function F(){return i?d("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const j={enable:function(){F().enabled=!0},disable:function(){F().enabled=!1},isEnabled:L,log:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];P("log",...t)},warn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];P("warn",...t)},error:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];P("error",...t)}};function $(e,t,n){if(!(t in e))return;const r=e[t];if("function"!=typeof r)return;const s=n(r);"function"==typeof s&&U(s,r);try{e[t]=s}catch{i&&j.log(`Failed to replace method "${t}" in object`,e)}}function B(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch{i&&j.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function U(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,B(e,"__sentry_original__",t)}catch{}}function H(e){return e.__sentry_original__}function z(e){if(h(e))return{message:e.message,name:e.name,stack:e.stack,...W(e)};if(S(e)){const t={type:e.type,target:q(e.target),currentTarget:q(e.currentTarget),...W(e)};return"undefined"!=typeof CustomEvent&&k(e,CustomEvent)&&(t.detail=e.detail),t}return e}function q(e){try{return"undefined"!=typeof Element&&k(e,Element)?C(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function W(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}const V=50,J="?",K=/\(error: (.*)\)/,G=/captureMessage|captureException/;function X(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.sort((e,t)=>e[0]-t[0]).map(e=>e[1]);return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=[],o=e.split("\n");for(let e=t;e<o.length;e++){let t=o[e];t.length>1024&&(t=t.slice(0,1024));const i=K.test(t)?t.replace(K,"$1"):t;if(!i.match(/\S*Error: /)){for(const e of r){const t=e(i);if(t){s.push(t);break}}if(s.length>=V+n)break}}return function(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(Y(t).function||"")&&t.pop(),t.reverse(),G.test(Y(t).function||"")&&(t.pop(),G.test(Y(t).function||"")&&t.pop()),t.slice(0,V).map(e=>({...e,filename:e.filename||Y(t).filename,function:e.function||J}))}(s.slice(n))}}function Y(e){return e[e.length-1]||{}}const Q="<anonymous>";function Z(e){try{return e&&"function"==typeof e&&e.name||Q}catch{return Q}}function ee(e){const t=e.exception;if(t){const e=[];try{return t.values.forEach(t=>{t.stacktrace.frames&&e.push(...t.stacktrace.frames)}),e}catch{return}}}function te(e){return"__v_isVNode"in e&&e.__v_isVNode?"[VueVNode]":"[VueViewModel]"}function ne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function re(e,t){let n=e;const r=n.length;if(r<=150)return n;t>r&&(t=r);let s=Math.max(t-60,0);s<5&&(s=0);let o=Math.min(s+140,r);return o>r-5&&(o=r),o===r&&(s=Math.max(o-140,0)),n=n.slice(s,o),s>0&&(n=`'{snip} ${n}`),o<r&&(n+=" {snip}"),n}function se(e,t){if(!Array.isArray(e))return"";const n=[];for(let t=0;t<e.length;t++){const r=e[t];try{x(r)?n.push(te(r)):n.push(String(r))}catch{n.push("[value cannot be serialized]")}}return n.join(t)}function oe(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!!y(e)&&(f(t,"RegExp")?t.test(e):!!y(t)&&(n?e===t:e.includes(t)))}function ie(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).some(n=>oe(e,n,t))}let ae;function ce(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){const e=c;return e.crypto||e.msCrypto}();try{if(null!=e&&e.randomUUID)return e.randomUUID().replace(/-/g,"")}catch{}return ae||(ae=[1e7]+1e3+4e3+8e3+1e11),ae.replace(/[018]/g,e=>(e^(16*Math.random()&15)>>e/4).toString(16))}function le(e){var t;return null===(t=e.exception)||void 0===t||null===(t=t.values)||void 0===t?void 0:t[0]}function ue(e){const{message:t,event_id:n}=e;if(t)return t;const r=le(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function de(e,t,n){const r=e.exception=e.exception||{},s=r.values=r.values||[],o=s[0]=s[0]||{};o.value||(o.value=t||""),o.type||(o.type=n||"Error")}function pe(e,t){const n=le(e);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...t},t&&"data"in t){const e={...null==r?void 0:r.data,...t.data};n.mechanism.data=e}}function he(e){if(function(e){try{return e.__sentry_captured__}catch{}}(e))return!0;try{B(e,"__sentry_captured__",!0)}catch{}return!1}const fe=1e3;function me(){return Date.now()/fe}let ge,ye;function ve(){const e=ge??(ge=function(){const{performance:e}=c;if(null==e||!e.now||!e.timeOrigin)return me;const t=e.timeOrigin;return()=>(t+e.now())/fe}());return e()}function be(){return ye||(ye=function(){var e;const{performance:t}=c;if(null==t||!t.now)return[void 0,"none"];const n=36e5,r=t.now(),s=Date.now(),o=t.timeOrigin?Math.abs(t.timeOrigin+r-s):n,i=o<n,a=null===(e=t.timing)||void 0===e?void 0:e.navigationStart,l="number"==typeof a?Math.abs(a+r-s):n;return i||l<n?o<=l?[t.timeOrigin,"timeOrigin"]:[a,"navigationStart"]:[s,"dateNow"]}()),ye[0]}function _e(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||ve(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:ce()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}function Se(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(!t||"object"!=typeof t||n<=0)return t;if(e&&0===Object.keys(t).length)return e;const r={...e};for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=Se(r[e],t[e],n-1));return r}function we(){return ce()}function ke(){return ce().substring(16)}const xe="_sentrySpan";function Te(e,t){t?B(e,xe,t):delete e[xe]}function Ee(e){return e[xe]}class Ie{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._attributes={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:we(),sampleRand:Math.random()}}clone(){const e=new Ie;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._attributes={...this._attributes},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,Te(e,Ee(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&_e(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this.setTags({[e]:t})}setAttributes(e){return this._attributes={...this._attributes,...e},this._notifyScopeListeners(),this}setAttribute(e,t){return this.setAttributes({[e]:t})}removeAttribute(e){return e in this._attributes&&(delete this._attributes[e],this._notifyScopeListeners()),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t="function"==typeof e?e(this):e,n=t instanceof Ie?t.getScopeData():_(t)?e:void 0,{tags:r,attributes:s,extra:o,user:i,contexts:a,level:c,fingerprint:l=[],propagationContext:u}=n||{};return this._tags={...this._tags,...r},this._attributes={...this._attributes,...s},this._extra={...this._extra,...o},this._contexts={...this._contexts,...a},i&&Object.keys(i).length&&(this._user=i),c&&(this._level=c),l.length&&(this._fingerprint=l),u&&(this._propagationContext=u),this}clear(){return this._breadcrumbs=[],this._tags={},this._attributes={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,Te(this,void 0),this._attachments=[],this.setPropagationContext({traceId:we(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const r={timestamp:me(),...e,message:e.message?ne(e.message,2048):e.message};var s;return this._breadcrumbs.push(r),this._breadcrumbs.length>n&&(this._breadcrumbs=this._breadcrumbs.slice(-n),null===(s=this._client)||void 0===s||s.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,attributes:this._attributes,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Ee(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=Se(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=(null==t?void 0:t.event_id)||ce();if(!this._client)return i&&j.warn("No client configured on scope - will not capture exception!"),n;const r=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:r,...t,event_id:n},this),n}captureMessage(e,t,n){const r=(null==n?void 0:n.event_id)||ce();if(!this._client)return i&&j.warn("No client configured on scope - will not capture message!"),r;const s=(null==n?void 0:n.syntheticException)??new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:s,...n,event_id:r},this),r}captureEvent(e,t){const n=(null==t?void 0:t.event_id)||ce();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):(i&&j.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}class Ce{constructor(e,t){let n,r;n=e||new Ie,r=t||new Ie,this._stack=[{scope:n}],this._isolationScope=r}withScope(e){const t=this._pushScope();let n;try{n=e(t)}catch(e){throw this._popScope(),e}return w(n)?n.then(e=>(this._popScope(),e),e=>{throw this._popScope(),e}):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1||!this._stack.pop())}}function Me(){const e=u(l());return e.stack=e.stack||new Ce(d("defaultCurrentScope",()=>new Ie),d("defaultIsolationScope",()=>new Ie))}function Re(e){return Me().withScope(e)}function Oe(e,t){const n=Me();return n.withScope(()=>(n.getStackTop().scope=e,t(e)))}function Ae(e){return Me().withScope(()=>e(Me().getIsolationScope()))}function Ne(e){const t=u(e);return t.acs?t.acs:{withIsolationScope:Ae,withScope:Re,withSetScope:Oe,withSetIsolationScope:(e,t)=>Ae(t),getCurrentScope:()=>Me().getScope(),getIsolationScope:()=>Me().getIsolationScope()}}function De(){return Ne(l()).getCurrentScope()}function Le(){return Ne(l()).getIsolationScope()}function Pe(){return d("globalScope",()=>new Ie)}function Fe(){const e=Ne(l());for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(2===n.length){const[t,r]=n;return t?e.withSetScope(t,r):e.withScope(r)}return e.withScope(n[0])}function je(){const e=Ne(l());for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(2===n.length){const[t,r]=n;return t?e.withSetIsolationScope(t,r):e.withIsolationScope(r)}return e.withIsolationScope(n[0])}function $e(){return De().getClient()}function Be(e){const t=e.getPropagationContext(),{traceId:n,parentSpanId:r,propagationSpanId:s}=t,o={trace_id:n,span_id:s||ke()};return r&&(o.parent_span_id=r),o}const Ue=[];function He(e){const t=e.defaultIntegrations||[],n=e.integrations;let r;if(t.forEach(e=>{e.isDefaultInstance=!0}),Array.isArray(n))r=[...t,...n];else if("function"==typeof n){const e=n(t);r=Array.isArray(e)?e:[e]}else r=t;return function(e){const t={};return e.forEach(e=>{const{name:n}=e,r=t[n];r&&!r.isDefaultInstance&&e.isDefaultInstance||(t[n]=e)}),Object.values(t)}(r)}function ze(e,t){for(const n of t)null!=n&&n.afterAllSetup&&n.afterAllSetup(e)}function qe(e,t,n){if(n[t.name])i&&j.log(`Integration skipped because it was already installed: ${t.name}`);else{if(n[t.name]=t,Ue.includes(t.name)||"function"!=typeof t.setupOnce||(t.setupOnce(),Ue.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),"function"==typeof t.preprocessEvent){const n=t.preprocessEvent.bind(t);e.on("preprocessEvent",(t,r)=>n(t,r,e))}if("function"==typeof t.processEvent){const n=t.processEvent.bind(t),r=Object.assign((t,r)=>n(t,r,e),{id:t.name});e.addEventProcessor(r)}i&&j.log(`Integration installed: ${t.name}`)}}function We(e){const t=$e();t?t.addIntegration(e):i&&j.warn(`Cannot add integration "${e.name}" because no SDK Client is available.`)}function Ve(e){const t=[];e.message&&t.push(e.message);try{const n=e.exception.values[e.exception.values.length-1];null!=n&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`))}catch{}return t}const Je=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,'can\'t redefine non-configurable property "solana"',"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],Ke=function(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:"EventFilters",setup(n){const r=n.getOptions();e=Xe(t,r)},processEvent(n,r,s){if(!e){const n=s.getOptions();e=Xe(t,n)}return function(e,t){if(e.type){if("transaction"===e.type&&function(e,t){if(null==t||!t.length)return!1;const n=e.transaction;return!!n&&ie(n,t)}(e,t.ignoreTransactions))return i&&j.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${ue(e)}`),!0}else{if(function(e,t){return!(null==t||!t.length)&&Ve(e).some(e=>ie(e,t))}(e,t.ignoreErrors))return i&&j.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${ue(e)}`),!0;if(function(e){var t;return!(null===(t=e.exception)||void 0===t||null===(t=t.values)||void 0===t||!t.length)&&(!e.message&&!e.exception.values.some(e=>e.stacktrace||e.type&&"Error"!==e.type||e.value))}(e))return i&&j.warn(`Event dropped due to not having an error message, error type or stacktrace.\nEvent: ${ue(e)}`),!0;if(function(e,t){if(null==t||!t.length)return!1;const n=Ye(e);return!!n&&ie(n,t)}(e,t.denyUrls))return i&&j.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${ue(e)}.\nUrl: ${Ye(e)}`),!0;if(!function(e,t){if(null==t||!t.length)return!0;const n=Ye(e);return!n||ie(n,t)}(e,t.allowUrls))return i&&j.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${ue(e)}.\nUrl: ${Ye(e)}`),!0}return!1}(n,e)?null:n}}},Ge=function(){return{...Ke(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),name:"InboundFilters"}};function Xe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:Je],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]]}}function Ye(e){try{var t,n;const r=[...(null===(t=e.exception)||void 0===t?void 0:t.values)??[]].reverse().find(e=>{var t,n;return void 0===(null===(t=e.mechanism)||void 0===t?void 0:t.parent_id)&&(null===(n=e.stacktrace)||void 0===n||null===(n=n.frames)||void 0===n?void 0:n.length)}),s=null==r||null===(n=r.stacktrace)||void 0===n?void 0:n.frames;return s?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(s):null}catch{return i&&j.error(`Cannot extract url for event ${ue(e)}`),null}}let Qe;const Ze=new WeakMap,et=()=>({name:"FunctionToString",setupOnce(){Qe=Function.prototype.toString;try{Function.prototype.toString=function(){const e=H(this),t=Ze.has($e())&&void 0!==e?e:this;for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return Qe.apply(t,r)}}catch{}},setup(e){Ze.set(e,!0)}}),tt=()=>{let e;return{name:"Dedupe",processEvent(t){if(t.type)return t;try{if(function(e,t){return!!t&&(!!function(e,t){const n=e.message,r=t.message;return!(!n&&!r)&&(!(n&&!r||!n&&r)&&(n===r&&(!!rt(e,t)&&!!nt(e,t))))}(e,t)||!!function(e,t){const n=st(t),r=st(e);return!(!n||!r)&&(n.type===r.type&&n.value===r.value&&(!!rt(e,t)&&!!nt(e,t)))}(e,t))}(t,e))return i&&j.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return e=t}}};function nt(e,t){let n=ee(e),r=ee(t);if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++){const t=r[e],s=n[e];if(t.filename!==s.filename||t.lineno!==s.lineno||t.colno!==s.colno||t.function!==s.function)return!1}return!0}function rt(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return!(n.join("")!==r.join(""))}catch{return!1}}function st(e){var t;return null===(t=e.exception)||void 0===t||null===(t=t.values)||void 0===t?void 0:t[0]}function ot(e){De().setClient(e)}const it=/^o(\d+)\./,at=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function ct(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{host:n,path:r,pass:s,port:o,projectId:i,protocol:a,publicKey:c}=e;return`${a}://${c}${t&&s?`:${s}`:""}@${n}${o?`:${o}`:""}/${r?`${r}/`:r}${i}`}function lt(e){const t=at.exec(e);if(!t)return void D(()=>{console.error(`Invalid Sentry Dsn: ${e}`)});const[n,r,s="",o="",i="",a=""]=t.slice(1);let c="",l=a;const u=l.split("/");if(u.length>1&&(c=u.slice(0,-1).join("/"),l=u.pop()),l){const e=l.match(/^\d+/);e&&(l=e[0])}return ut({host:o,pass:s,path:c,projectId:l,port:i,protocol:n,publicKey:r})}function ut(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function dt(e){const t=e.getOptions(),{host:n}=e.getDsn()||{};let r;return t.orgId?r=String(t.orgId):n&&(r=function(e){const t=e.match(it);return null==t?void 0:t[1]}(n)),r}function pt(e){const t="string"==typeof e?lt(e):ut(e);if(t&&function(e){if(!i)return!0;const{port:t,projectId:n,protocol:r}=e;return!(["protocol","publicKey","host","projectId"].find(t=>!e[t]&&(j.error(`Invalid Sentry Dsn: ${t} missing`),!0))||(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(r)?t&&isNaN(parseInt(t,10))&&(j.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):(j.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),1):(j.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(t))return t}const ht="7";function ft(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function mt(e,t,n){return t||`${function(e){return`${ft(e)}${e.projectId}/envelope/`}(e)}?${function(e,t){const n={sentry_version:ht};return e.publicKey&&(n.sentry_key=e.publicKey),t&&(n.sentry_client=`${t.name}/${t.version}`),new URLSearchParams(n).toString()}(e,n)}`}const gt="production",yt="sentry.source",vt="sentry.sample_rate",bt="sentry.previous_trace_sample_rate",_t="sentry.op",St="sentry.origin",wt="sentry.idle_span_finish_reason",kt="sentry.measurement_unit",xt="sentry.measurement_value",Tt="sentry.custom_span_name",Et="sentry.profile_id",It="sentry.exclusive_time",Ct="sentry.link.type",Mt="sentry-",Rt=/^sentry-/,Ot=8192;function At(e){const t=function(e){if(e&&(y(e)||Array.isArray(e)))return Array.isArray(e)?e.reduce((e,t)=>{const n=Dt(t);return Object.entries(n).forEach(t=>{let[n,r]=t;e[n]=r}),e},{}):Dt(e)}(e);if(!t)return;const n=Object.entries(t).reduce((e,t)=>{let[n,r]=t;return n.match(Rt)&&(e[n.slice(Mt.length)]=r),e},{});return Object.keys(n).length>0?n:void 0}function Nt(e){if(e)return function(e){if(0!==Object.keys(e).length)return Object.entries(e).reduce((e,t,n)=>{let[r,s]=t;const o=`${encodeURIComponent(r)}=${encodeURIComponent(s)}`,a=0===n?o:`${e},${o}`;return a.length>Ot?(i&&j.warn(`Not adding key: ${r} with val: ${s} to baggage header due to exceeding baggage size limits.`),e):a},"")}(Object.entries(e).reduce((e,t)=>{let[n,r]=t;return r&&(e[`${Mt}${n}`]=r),e},{}))}function Dt(e){return e.split(",").map(e=>{const t=e.indexOf("=");return-1===t?[]:[e.slice(0,t),e.slice(t+1)].map(e=>{try{return decodeURIComponent(e.trim())}catch{return}})}).reduce((e,t)=>{let[n,r]=t;return n&&r&&(e[n]=r),e},{})}function Lt(e){var t;if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const n=e||(null===(t=$e())||void 0===t?void 0:t.getOptions());return!(!n||null==n.tracesSampleRate&&!n.tracesSampler)}const Pt=0,Ft=1,jt=2;function $t(e){if(e<400&&e>=100)return{code:Ft};if(e>=400&&e<500)switch(e){case 401:return{code:jt,message:"unauthenticated"};case 403:return{code:jt,message:"permission_denied"};case 404:return{code:jt,message:"not_found"};case 409:return{code:jt,message:"already_exists"};case 413:return{code:jt,message:"failed_precondition"};case 429:return{code:jt,message:"resource_exhausted"};case 499:return{code:jt,message:"cancelled"};default:return{code:jt,message:"invalid_argument"}}if(e>=500&&e<600)switch(e){case 501:return{code:jt,message:"unimplemented"};case 503:return{code:jt,message:"unavailable"};case 504:return{code:jt,message:"deadline_exceeded"};default:return{code:jt,message:"internal_error"}}return{code:jt,message:"internal_error"}}function Bt(e,t){e.setAttribute("http.response.status_code",t);const n=$t(t);"unknown_error"!==n.message&&e.setStatus(n)}const Ut="_sentryScope",Ht="_sentryIsolationScope";function zt(e){if(e){if("object"==typeof e&&"deref"in e&&"function"==typeof e.deref)try{return e.deref()}catch{return}return e}}function qt(e){const t=e;return{scope:t[Ut],isolationScope:zt(t[Ht])}}function Wt(e){if("boolean"==typeof e)return Number(e);const t="string"==typeof e?parseFloat(e):e;return"number"!=typeof t||isNaN(t)||t<0||t>1?void 0:t}const Vt=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function Jt(e,t){const n=function(e){if(!e)return;const t=e.match(Vt);if(!t)return;let n;return"1"===t[3]?n=!0:"0"===t[3]&&(n=!1),{traceId:t[1],parentSampled:n,parentSpanId:t[2]}}(e),r=At(t);if(null==n||!n.traceId)return{traceId:we(),sampleRand:Math.random()};const s=function(e,t){const n=Wt(null==t?void 0:t.sample_rand);if(void 0!==n)return n;const r=Wt(null==t?void 0:t.sample_rate);return r&&void 0!==(null==e?void 0:e.parentSampled)?e.parentSampled?Math.random()*r:r+Math.random()*(1-r):Math.random()}(n,r);r&&(r.sample_rand=s.toString());const{traceId:o,parentSpanId:i,parentSampled:a}=n;return{traceId:o,parentSpanId:i,sampled:a,dsc:r||{},sampleRand:s}}function Kt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ke(),n=arguments.length>2?arguments[2]:void 0,r="";return void 0!==n&&(r=n?"-1":"-0"),`${e}-${t}${r}`}function Gt(){return`00-${arguments.length>0&&void 0!==arguments[0]?arguments[0]:we()}-${arguments.length>1&&void 0!==arguments[1]?arguments[1]:ke()}-${(arguments.length>2?arguments[2]:void 0)?"01":"00"}`}const Xt=1;let Yt=!1;function Qt(e){const{spanId:t,traceId:n}=e.spanContext(),{data:r,op:s,parent_span_id:o,status:i,origin:a,links:c}=sn(e);return{parent_span_id:o,span_id:t,trace_id:n,data:r,op:s,status:i,origin:a,links:c}}function Zt(e){const{spanId:t,traceId:n,isRemote:r}=e.spanContext(),s=r?t:sn(e).parent_span_id,o=qt(e).scope;return{parent_span_id:s,span_id:r?(null==o?void 0:o.getPropagationContext().propagationSpanId)||ke():t,trace_id:n}}function en(e){const{traceId:t,spanId:n}=e.spanContext();return Kt(t,n,on(e))}function tn(e){return e&&e.length>0?e.map(e=>{let{context:{spanId:t,traceId:n,traceFlags:r,...s},attributes:o}=e;return{span_id:t,trace_id:n,sampled:r===Xt,attributes:o,...s}}):void 0}function nn(e){return"number"==typeof e?rn(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?rn(e.getTime()):ve()}function rn(e){return e>9999999999?e/1e3:e}function sn(e){if(function(e){return"function"==typeof e.getSpanJSON}(e))return e.getSpanJSON();const{spanId:t,traceId:n}=e.spanContext();if(function(e){const t=e;return!!(t.attributes&&t.startTime&&t.name&&t.endTime&&t.status)}(e)){var r;const{attributes:s,startTime:o,name:i,endTime:a,status:c,links:l}=e;return{span_id:t,trace_id:n,data:s,description:i,parent_span_id:"parentSpanId"in e?e.parentSpanId:"parentSpanContext"in e?null===(r=e.parentSpanContext)||void 0===r?void 0:r.spanId:void 0,start_timestamp:nn(o),timestamp:nn(a)||void 0,status:an(c),op:s[_t],origin:s[St],links:tn(l)}}return{span_id:t,trace_id:n,start_timestamp:0,data:{}}}function on(e){const{traceFlags:t}=e.spanContext();return t===Xt}function an(e){if(e&&e.code!==Pt)return e.code===Ft?"ok":e.message||"internal_error"}const cn="_sentryChildSpans",ln="_sentryRootSpan";function un(e,t){const n=e[ln]||e;B(t,ln,n),e[cn]?e[cn].add(t):B(e,cn,new Set([t]))}function dn(e){const t=new Set;return function e(n){if(!t.has(n)&&on(n)){t.add(n);const r=n[cn]?Array.from(n[cn]):[];for(const t of r)e(t)}}(e),Array.from(t)}function pn(e){return e[ln]||e}function hn(){const e=Ne(l());return e.getActiveSpan?e.getActiveSpan():Ee(De())}function fn(){Yt||(D(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly or use `ignoreSpans`.")}),Yt=!0)}function mn(e,t){e.updateName(t),e.setAttributes({[yt]:"custom",[Tt]:t})}const gn="_frozenDsc";function yn(e,t){B(e,gn,t)}function vn(e,t){const n=t.getOptions(),{publicKey:r}=t.getDsn()||{},s={environment:n.environment||gt,release:n.release,public_key:r,trace_id:e,org_id:dt(t)};return t.emit("createDsc",s),s}function bn(e,t){const n=t.getPropagationContext();return n.dsc||vn(n.traceId,e)}function _n(e){const t=$e();if(!t)return{};const n=pn(e),r=sn(n),s=r.data,o=n.spanContext().traceState,i=(null==o?void 0:o.get("sentry.sample_rate"))??s[vt]??s[bt];function a(e){return"number"!=typeof i&&"string"!=typeof i||(e.sample_rate=`${i}`),e}const c=n[gn];if(c)return a(c);const l=null==o?void 0:o.get("sentry.dsc"),u=l&&At(l);if(u)return a(u);const d=vn(e.spanContext().traceId,t),p=s[yt],h=r.description;var f;return"url"!==p&&h&&(d.transaction=h),Lt()&&(d.sampled=String(on(n)),d.sample_rand=(null==o?void 0:o.get("sentry.sample_rand"))??(null===(f=qt(n).scope)||void 0===f?void 0:f.getPropagationContext().sampleRand.toString())),a(d),t.emit("createDsc",d,n),d}function Sn(e){return Nt(_n(e))}function wn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;try{return xn("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function kn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:102400;const r=wn(e,t);return s=r,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(s))>n?kn(e,t-1,n):r;var s}function xn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){const e=new WeakSet;return[function(t){return!!e.has(t)||(e.add(t),!1)},function(t){e.delete(t)}]}();const[o,i]=s;if(null==t||["boolean","string"].includes(typeof t)||"number"==typeof t&&Number.isFinite(t))return t;const a=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if(x(t))return te(t);if(_(n=t)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n)return"[SyntheticEvent]";if("number"==typeof t&&!Number.isFinite(t))return`[${t}]`;if("function"==typeof t)return`[Function: ${Z(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const r=function(e){const t=Object.getPrototypeOf(e);return null!=t&&t.constructor?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(e){return`**non-serializable** (${e})`}var n}(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const c="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:n;if(0===c)return a.replace("object ","");if(o(t))return"[Circular ~]";const l=t;if(l&&"function"==typeof l.toJSON)try{return xn("",l.toJSON(),c-1,r,s)}catch{}const u=Array.isArray(t)?[]:{};let d=0;const p=z(t);for(const e in p){if(!Object.prototype.hasOwnProperty.call(p,e))continue;if(d>=r){u[e]="[MaxProperties ~]";break}const t=p[e];u[e]=xn(e,t,c-1,r,s),d++}return i(t),u}function Tn(e){return[e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]]}function En(e,t){const[n,r]=e;return[n,[...r,t]]}function In(e,t){const n=e[1];for(const e of n)if(t(e,e[0].type))return!0;return!1}function Cn(e,t){return In(e,(e,n)=>t.includes(n))}function Mn(e){const t=u(c);return t.encodePolyfill?t.encodePolyfill(e):(new TextEncoder).encode(e)}function Rn(e){const[t,n]=e;let r=JSON.stringify(t);function s(e){"string"==typeof r?r="string"==typeof e?r+e:[Mn(r),e]:r.push("string"==typeof e?Mn(e):e)}for(const e of n){const[t,n]=e;if(s(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)s(n);else{let e;try{e=JSON.stringify(n)}catch{e=JSON.stringify(wn(n))}s(e)}}return"string"==typeof r?r:function(e){const t=e.reduce((e,t)=>e+t.length,0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(t,r),r+=t.length;return n}(r)}function On(e){return[{type:"span"},e]}function An(e){const t="string"==typeof e.data?Mn(e.data):e.data;return[{type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType},t]}n(5044),n(8845),n(373);const Nn={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item",metric:"metric",trace_metric:"metric"};function Dn(e){return Nn[e]}function Ln(e){if(null==e||!e.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function Pn(e,t,n,r){var s;const o=null===(s=e.sdkProcessingMetadata)||void 0===s?void 0:s.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:ct(r)},...o&&{trace:o}}}function Fn(e){j.log(`Ignoring span ${e.op} - ${e.description} because it matches \`ignoreSpans\`.`)}function jn(e,t){if(null==t||!t.length||!e.description)return!1;for(const n of t){if(Bn(n)){if(oe(e.description,n))return i&&Fn(e),!0;continue}if(!n.name&&!n.op)continue;const t=!n.name||oe(e.description,n.name),r=!n.op||e.op&&oe(e.op,n.op);if(t&&r)return i&&Fn(e),!0}return!1}function $n(e,t){const n=t.parent_span_id,r=t.span_id;if(n)for(const t of e)t.parent_span_id===r&&(t.parent_span_id=n)}function Bn(e){return"string"==typeof e||e instanceof RegExp}function Un(e,t){const{extra:n,tags:r,user:s,contexts:o,level:i,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:l,eventProcessors:u,attachments:d,propagationContext:p,transactionName:h,span:f}=t;Hn(e,"extra",n),Hn(e,"tags",r),Hn(e,"user",s),Hn(e,"contexts",o),e.sdkProcessingMetadata=Se(e.sdkProcessingMetadata,a,2),i&&(e.level=i),h&&(e.transactionName=h),f&&(e.span=f),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),l.length&&(e.fingerprint=[...e.fingerprint,...l]),u.length&&(e.eventProcessors=[...e.eventProcessors,...u]),d.length&&(e.attachments=[...e.attachments,...d]),e.propagationContext={...e.propagationContext,...p}}function Hn(e,t,n){e[t]=Se(e[t],n,1)}function zn(e,t){return t?Fe(t,()=>{const n=hn(),r=n?Zt(n):Be(t);return[n?_n(n):bn(e,t),r]}):[void 0,void 0]}const qn={trace:1,debug:5,info:9,warn:13,error:17,fatal:21},Wn=100;function Vn(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];!n||e[t]&&!r||(e[t]=n)}function Jn(e,t){const n=Yn(),r=Xn(e);void 0===r?n.set(e,[t]):r.length>=Wn?(Gn(e,r),n.set(e,[t])):n.set(e,[...r,t])}function Kn(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:De(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jn;const s=(null==n?void 0:n.getClient())??$e();if(!s)return void(i&&j.warn("No client available to capture log."));const{release:o,environment:a,enableLogs:c=!1,beforeSendLog:l}=s.getOptions();if(!c)return void(i&&j.warn("logging option not enabled, log will not be captured."));const[,u]=zn(s,n),d={...e.attributes},{user:{id:p,email:h,username:f}}=function(e){const t=Pe().getScopeData();return Un(t,Le().getScopeData()),Un(t,e.getScopeData()),t}(n);Vn(d,"user.id",p,!1),Vn(d,"user.email",h,!1),Vn(d,"user.name",f,!1),Vn(d,"sentry.release",o),Vn(d,"sentry.environment",a);const{name:m,version:g}=(null===(t=s.getSdkMetadata())||void 0===t?void 0:t.sdk)??{};Vn(d,"sentry.sdk.name",m),Vn(d,"sentry.sdk.version",g);const y=s.getIntegrationByName("Replay"),b=null==y?void 0:y.getReplayId(!0);Vn(d,"sentry.replay_id",b),b&&"buffer"===(null==y?void 0:y.getRecordingMode())&&Vn(d,"sentry._internal.replay_is_buffering",!0);const _=e.message;if(v(_)){const{__sentry_template_string__:e,__sentry_template_values__:t=[]}=_;null!=t&&t.length&&(d["sentry.message.template"]=e),t.forEach((e,t)=>{d[`sentry.message.parameter.${t}`]=e})}const S=Ee(n);Vn(d,"sentry.trace.parent_span_id",null==S?void 0:S.spanContext().spanId);const w={...e,attributes:d};s.emit("beforeCaptureLog",w);const k=l?D(()=>l(w)):w;if(!k)return s.recordDroppedEvent("before_send","log_item",1),void(i&&j.warn("beforeSendLog returned null, log will not be captured."));const{level:x,message:T,attributes:E={},severityNumber:I}=k;r(s,{timestamp:ve(),level:x,body:T,trace_id:null==u?void 0:u.trace_id,severity_number:I??qn[x],attributes:Object.keys(E).reduce((e,t)=>(e[t]=function(e){switch(typeof e){case"number":return Number.isInteger(e)?{value:e,type:"integer"}:{value:e,type:"double"};case"boolean":return{value:e,type:"boolean"};case"string":return{value:e,type:"string"};default:{let t="";try{t=JSON.stringify(e)??""}catch{}return{value:t,type:"string"}}}}(E[t]),e),{})}),s.emit("afterCaptureLog",k)}function Gn(e,t){const n=t??Xn(e)??[];if(0===n.length)return;const r=e.getOptions(),s=function(e,t,n,r){const s={};return null!=t&&t.sdk&&(s.sdk={name:t.sdk.name,version:t.sdk.version}),n&&r&&(s.dsn=ct(r)),Tn(s,[(o=e,[{type:"log",item_count:o.length,content_type:"application/vnd.sentry.items.log+json"},{items:o}])]);var o}(n,r._metadata,r.tunnel,e.getDsn());Yn().set(e,[]),e.emit("flushLogs"),e.sendEnvelope(s)}function Xn(e){return Yn().get(e)}function Yn(){return d("clientToLogBufferMap",()=>new WeakMap)}const Qn=1e3;function Zn(e){switch(typeof e){case"number":return Number.isInteger(e)?{value:e,type:"integer"}:{value:e,type:"double"};case"boolean":return{value:e,type:"boolean"};case"string":return{value:e,type:"string"};default:{let t="";try{t=JSON.stringify(e)??""}catch{}return{value:t,type:"string"}}}}function er(e,t,n){!n||arguments.length>3&&void 0!==arguments[3]&&!arguments[3]&&t in e||(e[t]=n)}function tr(e,t){const n=or(),r=sr(e);void 0===r?n.set(e,[t]):r.length>=Qn?(rr(e,r),n.set(e,[t])):n.set(e,[...r,t])}function nr(e,t){const n=(null==t?void 0:t.scope)??De(),r=(null==t?void 0:t.captureSerializedMetric)??tr,s=(null==n?void 0:n.getClient())??$e();if(!s)return void(i&&j.warn("No client available to capture metric."));const{_experiments:o,enableMetrics:a,beforeSendMetric:c}=s.getOptions();if(!(a??(null==o?void 0:o.enableMetrics)??1))return void(i&&j.warn("metrics option not enabled, metric will not be captured."));const l=function(e,t,n){var r;const{release:s,environment:o}=t.getOptions(),i={...e.attributes},{user:{id:a,email:c,username:l}}=function(e){const t=Pe().getScopeData();return Un(t,Le().getScopeData()),Un(t,e.getScopeData()),t}(n);er(i,"user.id",a,!1),er(i,"user.email",c,!1),er(i,"user.name",l,!1),er(i,"sentry.release",s),er(i,"sentry.environment",o);const{name:u,version:d}=(null===(r=t.getSdkMetadata())||void 0===r?void 0:r.sdk)??{};er(i,"sentry.sdk.name",u),er(i,"sentry.sdk.version",d);const p=t.getIntegrationByName("Replay"),h=null==p?void 0:p.getReplayId(!0);return er(i,"sentry.replay_id",h),h&&"buffer"===(null==p?void 0:p.getRecordingMode())&&er(i,"sentry._internal.replay_is_buffering",!0),{...e,attributes:i}}(e,s,n);s.emit("processMetric",l);const u=c||(null==o?void 0:o.beforeSendMetric),d=u?u(l):l;if(!d)return void(i&&j.log("`beforeSendMetric` returned `null`, will not send metric."));const p=function(e,t,n){const r={};for(const t in e.attributes)void 0!==e.attributes[t]&&(r[t]=Zn(e.attributes[t]));const[,s]=zn(t,n),o=Ee(n),i=o?o.spanContext().traceId:null==s?void 0:s.trace_id,a=o?o.spanContext().spanId:void 0;return{timestamp:ve(),trace_id:i??"",span_id:a,name:e.name,type:e.type,unit:e.unit,value:e.value,attributes:r}}(d,s,n);i&&j.log("[Metric]",p),r(s,p),s.emit("afterCaptureMetric",d)}function rr(e,t){const n=t??sr(e)??[];if(0===n.length)return;const r=e.getOptions(),s=function(e,t,n,r){const s={};return null!=t&&t.sdk&&(s.sdk={name:t.sdk.name,version:t.sdk.version}),n&&r&&(s.dsn=ct(r)),Tn(s,[(o=e,[{type:"trace_metric",item_count:o.length,content_type:"application/vnd.sentry.items.trace-metric+json"},{items:o}])]);var o}(n,r._metadata,r.tunnel,e.getDsn());or().set(e,[]),e.emit("flushMetrics"),e.sendEnvelope(s)}function sr(e){return or().get(e)}function or(){return d("clientToMetricBufferMap",()=>new WeakMap)}function ir(e){return new cr(t=>{t(e)})}function ar(e){return new cr((t,n)=>{n(e)})}class cr{constructor(e){this._state=0,this._handlers=[],this._runExecutor(e)}then(e,t){return new cr((n,r)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){r(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){r(e)}else r(e)}]),this._executeHandlers()})}catch(e){return this.then(e=>e,e)}finally(e){return new cr((t,n)=>{let r,s;return this.then(t=>{s=!1,r=t,e&&e()},t=>{s=!0,r=t,e&&e()}).then(()=>{s?n(r):t(r)})})}_executeHandlers(){if(0===this._state)return;const e=this._handlers.slice();this._handlers=[],e.forEach(e=>{e[0]||(1===this._state&&e[1](this._value),2===this._state&&e[2](this._value),e[0]=!0)})}_runExecutor(e){const t=(e,t)=>{0===this._state&&(w(t)?t.then(n,r):(this._state=e,this._value=t,this._executeHandlers()))},n=e=>{t(1,e)},r=e=>{t(2,e)};try{e(n,r)}catch(e){r(e)}}}const lr=Symbol.for("SentryBufferFullError");function ur(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;const t=new Set;function n(e){t.delete(e)}return{get $(){return Array.from(t)},add:function(r){if(!(t.size<e))return ar(lr);const s=r();return t.add(s),s.then(()=>n(s),()=>n(s)),s},drain:function(e){if(!t.size)return ir(!0);const n=Promise.allSettled(Array.from(t)).then(()=>!0);if(!e)return n;const r=[n,new Promise(t=>setTimeout(()=>t(!1),e))];return Promise.race(r)}}}const dr=6e4;function pr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const r=Date.parse(`${e}`);return isNaN(r)?dr:r-t}function hr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();return function(e,t){return e[t]||e.all||0}(e,t)>n}function fr(e,t){let{statusCode:n,headers:r}=t,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();const o={...e},i=null==r?void 0:r["x-sentry-rate-limits"],a=null==r?void 0:r["retry-after"];if(i)for(const e of i.trim().split(",")){const[t,n,,,r]=e.split(":",5),i=parseInt(t,10),a=1e3*(isNaN(i)?60:i);if(n)for(const e of n.split(";"))"metric_bucket"===e&&r&&!r.split(";").includes("custom")||(o[e]=s+a);else o.all=s+a}else a?o.all=s+pr(a,s):429===n&&(o.all=s+6e4);return o}const mr=64;function gr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ur(e.bufferSize||mr),r={};return{send:function(s){const o=[];if(In(s,(t,n)=>{const s=Dn(n);hr(r,s)?e.recordDroppedEvent("ratelimit_backoff",s):o.push(t)}),0===o.length)return Promise.resolve({});const a=Tn(s[0],o),c=t=>{In(a,(n,r)=>{e.recordDroppedEvent(t,Dn(r))})};return n.add(()=>t({body:Rn(a)}).then(e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&i&&j.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),r=fr(r,e),e),e=>{throw c("network_error"),i&&j.error("Encountered error running transport request:",e),e})).then(e=>e,e=>{if(e===lr)return i&&j.error("Skipped sending event because buffer is full."),c("queue_overflow"),Promise.resolve({});throw e})},flush:e=>n.drain(e)}}function yr(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;try{const s=vr(t,n,e,r);return w(s)?s:ir(s)}catch(e){return ar(e)}}function vr(e,t,n,r){const s=n[r];if(!e||!s)return e;const o=s({...e},t);return i&&null===o&&j.log(`Event processor "${s.id||"?"}" dropped event`),w(o)?o.then(e=>vr(e,t,n,r+1)):vr(o,t,n,r+1)}let br,_r,Sr,wr;function kr(e){const t=c._sentryDebugIds,n=c._debugIds;if(!t&&!n)return{};const r=t?Object.keys(t):[],s=n?Object.keys(n):[];if(wr&&r.length===_r&&s.length===Sr)return wr;_r=r.length,Sr=s.length,wr={},br||(br={});const o=(t,n)=>{for(const s of t){var r;const t=n[s],o=null===(r=br)||void 0===r?void 0:r[s];if(o&&wr&&t)wr[o[0]]=t,br&&(br[s]=[o[0],t]);else if(t){const n=e(s);for(let e=n.length-1;e>=0;e--){const r=n[e],o=null==r?void 0:r.filename;if(o&&wr&&br){wr[o]=t,br[s]=[o,t];break}}}}};return t&&o(r,t),n&&o(s,n),wr}function xr(e,t,n,r,s,o){const{normalizeDepth:i=3,normalizeMaxBreadth:a=1e3}=e,c={...t,event_id:t.event_id||n.event_id||ce(),timestamp:t.timestamp||me()},l=n.integrations||e.integrations.map(e=>e.name);!function(e,t){const{environment:n,release:r,dist:s,maxValueLength:o}=t;e.environment=e.environment||n||gt,!e.release&&r&&(e.release=r),!e.dist&&s&&(e.dist=s);const i=e.request;var a;null!=i&&i.url&&o&&(i.url=ne(i.url,o)),o&&(null===(a=e.exception)||void 0===a||null===(a=a.values)||void 0===a||a.forEach(e=>{e.value&&(e.value=ne(e.value,o))}))}(c,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(c,l),s&&s.emit("applyFrameMetadata",t),void 0===t.type&&function(e,t){var n;const r=kr(t);null===(n=e.exception)||void 0===n||null===(n=n.values)||void 0===n||n.forEach(e=>{var t;null===(t=e.stacktrace)||void 0===t||null===(t=t.frames)||void 0===t||t.forEach(e=>{e.filename&&(e.debug_id=r[e.filename])})})}(c,e.stackParser);const u=function(e,t){if(!t)return e;const n=e?e.clone():new Ie;return n.update(t),n}(r,n.captureContext);n.mechanism&&pe(c,n.mechanism);const d=s?s.getEventProcessors():[],p=Pe().getScopeData();o&&Un(p,o.getScopeData()),u&&Un(p,u.getScopeData());const h=[...n.attachments||[],...p.attachments];return h.length&&(n.attachments=h),function(e,t){const{fingerprint:n,span:r,breadcrumbs:s,sdkProcessingMetadata:o}=t;!function(e,t){const{extra:n,tags:r,user:s,contexts:o,level:i,transactionName:a}=t;Object.keys(n).length&&(e.extra={...n,...e.extra}),Object.keys(r).length&&(e.tags={...r,...e.tags}),Object.keys(s).length&&(e.user={...s,...e.user}),Object.keys(o).length&&(e.contexts={...o,...e.contexts}),i&&(e.level=i),a&&"transaction"!==e.type&&(e.transaction=a)}(e,t),r&&function(e,t){e.contexts={trace:Zt(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:_n(t),...e.sdkProcessingMetadata};const n=sn(pn(t)).description;n&&!e.transaction&&"transaction"===e.type&&(e.transaction=n)}(e,r),function(e,t){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint.length||delete e.fingerprint}(e,n),function(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}(e,s),function(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}(e,o)}(c,p),yr([...d,...p.eventProcessors],c,n).then(e=>(e&&function(e){var t;const n={};if(null===(t=e.exception)||void 0===t||null===(t=t.values)||void 0===t||t.forEach(e=>{var t;null===(t=e.stacktrace)||void 0===t||null===(t=t.frames)||void 0===t||t.forEach(e=>{e.debug_id&&(e.abs_path?n[e.abs_path]=e.debug_id:e.filename&&(n[e.filename]=e.debug_id),delete e.debug_id)})}),0===Object.keys(n).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const r=e.debug_meta.images;Object.entries(n).forEach(e=>{let[t,n]=e;r.push({type:"sourcemap",code_file:t,debug_id:n})})}(e),"number"==typeof i&&i>0?function(e,t,n){var r,s;if(!e)return null;const o={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(e=>({...e,...e.data&&{data:wn(e.data,t,n)}}))},...e.user&&{user:wn(e.user,t,n)},...e.contexts&&{contexts:wn(e.contexts,t,n)},...e.extra&&{extra:wn(e.extra,t,n)}};return null!==(r=e.contexts)&&void 0!==r&&r.trace&&o.contexts&&(o.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(o.contexts.trace.data=wn(e.contexts.trace.data,t,n))),e.spans&&(o.spans=e.spans.map(e=>({...e,...e.data&&{data:wn(e.data,t,n)}}))),null!==(s=e.contexts)&&void 0!==s&&s.flags&&o.contexts&&(o.contexts.flags=wn(e.contexts.flags,3,n)),o}(e,i,a):e))}const Tr=["user","level","extra","contexts","tags","fingerprint","propagationContext"],Er="Not capturing exception because it's already been captured.",Ir="Discarded session because of missing or non-string release",Cr=Symbol.for("SentryInternalError"),Mr=Symbol.for("SentryDoNotSendEventError");function Rr(e){return{message:e,[Cr]:!0}}function Or(e){return{message:e,[Mr]:!0}}function Ar(e){return!!e&&"object"==typeof e&&Cr in e}function Nr(e){return!!e&&"object"==typeof e&&Mr in e}function Dr(e,t,n,r,s){let o,i=0,a=!1;e.on(n,()=>{i=0,clearTimeout(o),a=!1}),e.on(t,t=>{i+=r(t),i>=8e5?s(e):a||(a=!0,o=setTimeout(()=>{s(e)},5e3))}),e.on("flush",()=>{s(e)})}class Lr{constructor(e){var t,n,r;if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],this._promiseBuffer=ur((null===(t=e.transportOptions)||void 0===t?void 0:t.bufferSize)??mr),e.dsn?this._dsn=pt(e.dsn):i&&j.warn("No DSN provided, client will not send events."),this._dsn){const t=mt(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}this._options.enableLogs=this._options.enableLogs??(null===(n=this._options._experiments)||void 0===n?void 0:n.enableLogs),this._options.enableLogs&&Dr(this,"afterCaptureLog","flushLogs",Br,Gn),(this._options.enableMetrics??(null===(r=this._options._experiments)||void 0===r?void 0:r.enableMetrics)??1)&&Dr(this,"afterCaptureMetric","flushMetrics",$r,rr)}captureException(e,t,n){const r=ce();if(he(e))return i&&j.log(Er),r;const s={event_id:r,...t};return this._process(()=>this.eventFromException(e,s).then(e=>this._captureEvent(e,s,n)).then(e=>e),"error"),s.event_id}captureMessage(e,t,n,r){const s={event_id:ce(),...n},o=v(e)?e:String(e),i=b(e),a=i?this.eventFromMessage(o,t,s):this.eventFromException(e,s);return this._process(()=>a.then(e=>this._captureEvent(e,s,r)),i?"unknown":"error"),s.event_id}captureEvent(e,t,n){const r=ce();if(null!=t&&t.originalException&&he(t.originalException))return i&&j.log(Er),r;const s={event_id:r,...t},o=e.sdkProcessingMetadata||{},a=o.capturedSpanScope,c=o.capturedSpanIsolationScope,l=Pr(e.type);return this._process(()=>this._captureEvent(e,s,a||n,c),l),s.event_id}captureSession(e){this.sendSession(e),_e(e,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}async flush(e){const t=this._transport;if(!t)return!0;this.emit("flush");const n=await this._isClientDoneProcessing(e),r=await t.flush(e);return n&&r}async close(e){const t=await this.flush(e);return this.getOptions().enabled=!1,this.emit("close"),t}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(e=>{let{name:t}=e;return t.startsWith("Spotlight")}))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const t=this._integrations[e.name];qe(this,e,this._integrations),t||ze(this,[e])}sendEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.emit("beforeSendEvent",e,t);let n=function(e,t,n,r){const s=Ln(n),o=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){var n,r,s,o;if(!t)return e;const i=e.sdk||{};e.sdk={...i,name:i.name||t.name,version:i.version||t.version,integrations:[...(null===(n=e.sdk)||void 0===n?void 0:n.integrations)||[],...t.integrations||[]],packages:[...(null===(r=e.sdk)||void 0===r?void 0:r.packages)||[],...t.packages||[]],settings:null!==(s=e.sdk)&&void 0!==s&&s.settings||t.settings?{...null===(o=e.sdk)||void 0===o?void 0:o.settings,...t.settings}:void 0}}(e,null==n?void 0:n.sdk);const i=Pn(e,s,r,t);return delete e.sdkProcessingMetadata,Tn(i,[[{type:o},e]])}(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=En(n,An(e));this.sendEnvelope(n).then(t=>this.emit("afterSendEvent",e,t))}sendSession(e){const{release:t,environment:n=gt}=this._options;if("aggregates"in e){const r=e.attrs||{};if(!r.release&&!t)return void(i&&j.warn(Ir));r.release=r.release||t,r.environment=r.environment||n,e.attrs=r}else{if(!e.release&&!t)return void(i&&j.warn(Ir));e.release=e.release||t,e.environment=e.environment||n}this.emit("beforeSendSession",e);const r=function(e,t,n,r){const s=Ln(n);return Tn({sent_at:(new Date).toISOString(),...s&&{sdk:s},...!!r&&t&&{dsn:ct(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(r)}recordDroppedEvent(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this._options.sendClientReports){const r=`${e}:${t}`;i&&j.log(`Recording outcome: "${r}"${n>1?` (${n} times)`:""}`),this._outcomes[r]=(this._outcomes[r]||0)+n}}on(e,t){const n=this._hooks[e]=this._hooks[e]||new Set,r=function(){return t(...arguments)};return n.add(r),()=>{n.delete(r)}}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=this._hooks[e];s&&s.forEach(e=>e(...n))}async sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)try{return await this._transport.send(e)}catch(e){return i&&j.error("Error while sending envelope:",e),{}}return i&&j.error("Transport disabled"),{}}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(e,t){const n={};return t.forEach(t=>{t&&qe(e,t,n)}),n}(this,e),ze(this,e)}_updateSessionFromEvent(e,t){var n;let r="fatal"===t.level,s=!1;const o=null===(n=t.exception)||void 0===n?void 0:n.values;if(o){s=!0,r=!1;for(const e of o){var i;if(!1===(null===(i=e.mechanism)||void 0===i?void 0:i.handled)){r=!0;break}}}const a="ok"===e.status;(a&&0===e.errors||a&&r)&&(_e(e,{...r&&{status:"crashed"},errors:e.errors||Number(s||r)}),this.captureSession(e))}async _isClientDoneProcessing(e){let t=0;for(;!e||t<e;){if(await new Promise(e=>setTimeout(e,1)),!this._numProcessing)return!0;t++}return!1}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n,r){const s=this.getOptions(),o=Object.keys(this._integrations);return!t.integrations&&null!=o&&o.length&&(t.integrations=o),this.emit("preprocessEvent",e,t),e.type||r.setLastEventId(e.event_id||t.event_id),xr(s,e,t,n,this,r).then(e=>{if(null===e)return e;this.emit("postprocessEvent",e,t),e.contexts={trace:Be(n),...e.contexts};const r=bn(this,n);return e.sdkProcessingMetadata={dynamicSamplingContext:r,...e.sdkProcessingMetadata},e})}_captureEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:De(),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Le();return i&&Fr(e)&&j.log(`Captured error event \`${Ve(e)[0]||"<unknown>"}\``),this._processEvent(e,t,n,r).then(e=>e.event_id,e=>{i&&(Nr(e)?j.log(e.message):Ar(e)?j.warn(e.message):j.warn(e))})}_processEvent(e,t,n,r){const s=this.getOptions(),{sampleRate:o}=s,i=jr(e),a=Fr(e),c=`before send for type \`${e.type||"error"}\``,l=void 0===o?void 0:Wt(o);if(a&&"number"==typeof l&&Math.random()>l)return this.recordDroppedEvent("sample_rate","error"),ar(Or(`Discarding event because it's not included in the random sample (sampling rate = ${o})`));const u=Pr(e.type);return this._prepareEvent(e,t,n,r).then(e=>{if(null===e)throw this.recordDroppedEvent("event_processor",u),Or("An event processor returned `null`, will not send event.");if(t.data&&!0===t.data.__sentry__)return e;const n=function(e,t,n,r){const{beforeSend:s,beforeSendTransaction:o,beforeSendSpan:i,ignoreSpans:a}=t;let c=n;if(Fr(c)&&s)return s(c,r);if(jr(c)){if(i||a){const t=function(e){var t;const{trace_id:n,parent_span_id:r,span_id:s,status:o,origin:i,data:a,op:c}=(null===(t=e.contexts)||void 0===t?void 0:t.trace)??{};return{data:a??{},description:e.transaction,op:c,parent_span_id:r,span_id:s??"",start_timestamp:e.start_timestamp??0,status:o,timestamp:e.timestamp,trace_id:n??"",origin:i,profile_id:null==a?void 0:a[Et],exclusive_time:null==a?void 0:a[It],measurements:e.measurements,is_segment:!0}}(c);if(null!=a&&a.length&&jn(t,a))return null;if(i){const e=i(t);e?c=Se(n,{type:"transaction",timestamp:(l=e).timestamp,start_timestamp:l.start_timestamp,transaction:l.description,contexts:{trace:{trace_id:l.trace_id,span_id:l.span_id,parent_span_id:l.parent_span_id,op:l.op,status:l.status,origin:l.origin,data:{...l.data,...l.profile_id&&{[Et]:l.profile_id},...l.exclusive_time&&{[It]:l.exclusive_time}}}},measurements:l.measurements}):fn()}if(c.spans){const t=[],n=c.spans;for(const e of n)if(null!=a&&a.length&&jn(e,a))$n(n,e);else if(i){const n=i(e);n?t.push(n):(fn(),t.push(e))}else t.push(e);const r=c.spans.length-t.length;r&&e.recordDroppedEvent("before_send","span",r),c.spans=t}}if(o){if(c.spans){const e=c.spans.length;c.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:e}}return o(c,r)}}var l;return c}(this,s,e,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if(w(e))return e.then(e=>{if(!_(e)&&null!==e)throw Rr(n);return e},e=>{throw Rr(`${t} rejected with ${e}`)});if(!_(e)&&null!==e)throw Rr(n);return e}(n,c)}).then(s=>{if(null===s){if(this.recordDroppedEvent("before_send",u),i){const t=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",t)}throw Or(`${c} returned \`null\`, will not send event.`)}const o=n.getSession()||r.getSession();if(a&&o&&this._updateSessionFromEvent(o,s),i){var l;const e=((null===(l=s.sdkProcessingMetadata)||void 0===l?void 0:l.spanCountBeforeProcessing)||0)-(s.spans?s.spans.length:0);e>0&&this.recordDroppedEvent("before_send","span",e)}const d=s.transaction_info;if(i&&d&&s.transaction!==e.transaction){const e="custom";s.transaction_info={...d,source:e}}return this.sendEvent(s,t),s}).then(null,e=>{if(Nr(e)||Ar(e))throw e;throw this.captureException(e,{mechanism:{handled:!1,type:"internal"},data:{__sentry__:!0},originalException:e}),Rr(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)})}_process(e,t){this._numProcessing++,this._promiseBuffer.add(e).then(e=>(this._numProcessing--,e),e=>(this._numProcessing--,e===lr&&this.recordDroppedEvent("queue_overflow",t),e))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(e=>{let[t,n]=e;const[r,s]=t.split(":");return{reason:r,category:s,quantity:n}})}_flushOutcomes(){i&&j.log("Flushing outcomes...");const e=this._clearOutcomes();if(0===e.length)return void(i&&j.log("No outcomes to send"));if(!this._dsn)return void(i&&j.log("No dsn provided, will not send outcomes"));i&&j.log("Sending outcomes:",e);const t=(n=e,Tn((r=this._options.tunnel&&ct(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:me(),discarded_events:n}]]));var n,r;this.sendEnvelope(t)}}function Pr(e){return"replay_event"===e?"replay":e||"error"}function Fr(e){return void 0===e.type}function jr(e){return"transaction"===e.type}function $r(e){let t=0;return e.name&&(t+=2*e.name.length),t+=8,t+Ur(e.attributes)}function Br(e){let t=0;return e.message&&(t+=2*e.message.length),t+Ur(e.attributes)}function Ur(e){if(!e)return 0;let t=0;return Object.values(e).forEach(e=>{Array.isArray(e)?t+=e.length*Hr(e[0]):b(e)?t+=Hr(e):t+=100}),t}function Hr(e){return"string"==typeof e?2*e.length:"number"==typeof e?8:"boolean"==typeof e?4:0}function zr(e){var t;"aggregates"in e?void 0===(null===(t=e.attrs)||void 0===t?void 0:t.ip_address)&&(e.attrs={...e.attrs,ip_address:"{{auto}}"}):void 0===e.ipAddress&&(e.ipAddress="{{auto}}")}function qr(e,t){const n=Vr(e,t),r={type:Gr(t),value:Xr(t)};return n.length&&(r.stacktrace={frames:n}),void 0===r.type&&""===r.value&&(r.value="Unrecoverable error caught"),r}function Wr(e,t){return{exception:{values:[qr(e,t)]}}}function Vr(e,t){const n=t.stacktrace||t.stack||"",r=function(e){return e&&Jr.test(e.message)?1:0}(t),s=function(e){return"number"==typeof e.framesToPop?e.framesToPop:0}(t);try{return e(n,r,s)}catch{}return[]}const Jr=/Minified React error #\d+;/i;function Kr(e){return"undefined"!=typeof WebAssembly&&void 0!==WebAssembly.Exception&&e instanceof WebAssembly.Exception}function Gr(e){const t=null==e?void 0:e.name;return!t&&Kr(e)?e.message&&Array.isArray(e.message)&&2==e.message.length?e.message[0]:"WebAssembly.Exception":t}function Xr(e){const t=null==e?void 0:e.message;return Kr(e)?Array.isArray(e.message)&&2==e.message.length?e.message[1]:"wasm exception":t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function Yr(e,t,n,r){const s=Zr(e,t,(null==n?void 0:n.syntheticException)||void 0,r);return pe(s),s.level="error",null!=n&&n.event_id&&(s.event_id=n.event_id),ir(s)}function Qr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info",r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;const o=es(e,t,(null==r?void 0:r.syntheticException)||void 0,s);return o.level=n,null!=r&&r.event_id&&(o.event_id=r.event_id),ir(o)}function Zr(e,t,n,r,s){let o;if(m(t)&&t.error)return Wr(e,t.error);if(g(t)||f(t,"DOMException")){const s=t;if("stack"in t)o=Wr(e,t);else{const t=s.name||(g(s)?"DOMError":"DOMException"),i=s.message?`${t}: ${s.message}`:t;o=es(e,i,n,r),de(o,i)}return"code"in s&&(o.tags={...o.tags,"DOMException.code":`${s.code}`}),o}return h(t)?Wr(e,t):_(t)||S(t)?(o=function(e,t,n,r){const s=$e(),o=null==s?void 0:s.getOptions().normalizeDepth,i=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}}(t),a={__serialized__:kn(t,o)};if(i)return{exception:{values:[qr(e,i)]},extra:a};const c={exception:{values:[{type:S(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:ts(t,{isUnhandledRejection:r})}]},extra:a};if(n){const t=Vr(e,n);t.length&&(c.exception.values[0].stacktrace={frames:t})}return c}(e,t,n,s),pe(o,{synthetic:!0}),o):(o=es(e,t,n,r),de(o,`${t}`,void 0),pe(o,{synthetic:!0}),o)}function es(e,t,n,r){const s={};if(r&&n){const r=Vr(e,n);r.length&&(s.exception={values:[{value:t,stacktrace:{frames:r}}]}),pe(s,{synthetic:!0})}if(v(t)){const{__sentry_template_string__:e,__sentry_template_values__:n}=t;return s.logentry={message:e,params:n},s}return s.message=t,s}function ts(e,t){let{isUnhandledRejection:n}=t;const r=function(e){const t=Object.keys(z(e));return t.sort(),t[0]?t.join(", "):"[object has no keys]"}(e),s=n?"promise rejection":"exception";return m(e)?`Event \`ErrorEvent\` captured as ${s} with message \`${e.message}\``:S(e)?`Event \`${function(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}(e)}\` (type=${e.type}) captured as ${s}`:`Object captured as ${s} with keys: ${r}`}function ns(e,t){return De().captureException(e,function(e){if(e)return function(e){return e instanceof Ie||"function"==typeof e}(e)||function(e){return Object.keys(e).some(e=>Tr.includes(e))}(e)?{captureContext:e}:e}(t))}function rs(e,t){const n="string"==typeof t?t:void 0,r="string"!=typeof t?{captureContext:t}:void 0;return De().captureMessage(e,n,r)}function ss(e,t){return De().captureEvent(e,t)}function os(e,t){Le().setContext(e,t)}function is(e){Le().setExtras(e)}function as(e,t){Le().setExtra(e,t)}function cs(e){Le().setTags(e)}function ls(e,t){Le().setTag(e,t)}function us(e){Le().setUser(e)}function ds(){return Le().lastEventId()}async function ps(e){const t=$e();return t?t.flush(e):(i&&j.warn("Cannot flush events. No client defined."),Promise.resolve(!1))}async function hs(e){const t=$e();return t?t.close(e):(i&&j.warn("Cannot flush events and disable SDK. No client defined."),Promise.resolve(!1))}function fs(){return!!$e()}function ms(){const e=$e();return!1!==(null==e?void 0:e.getOptions().enabled)&&!(null==e||!e.getTransport())}function gs(e){Le().addEventProcessor(e)}function ys(e){const t=Le(),n=De(),{userAgent:r}=c.navigator||{},s=function(e){const t=ve(),n={sid:ce(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(e){return{sid:`${e.sid}`,init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"==typeof e.did||"string"==typeof e.did?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}}}(n)};return e&&_e(n,e),n}({user:n.getUser()||t.getUser(),...r&&{userAgent:r},...e}),o=t.getSession();return"ok"===(null==o?void 0:o.status)&&_e(o,{status:"exited"}),vs(),t.setSession(s),s}function vs(){const e=Le(),t=De().getSession()||e.getSession();t&&function(e){let t={};"ok"===e.status&&(t={status:"exited"}),_e(e,t)}(t),bs(),e.setSession()}function bs(){const e=Le(),t=$e(),n=e.getSession();n&&t&&t.captureSession(n)}function _s(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?vs():bs()}const Ss=c;let ws=0;function ks(){return ws>0}function xs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!function(e){return"function"==typeof e}(e))return e;try{const t=e.__sentry_wrapped__;if(t)return"function"==typeof t?t:e;if(H(e))return e}catch{return e}const n=function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];try{const n=r.map(e=>xs(e,t));return e.apply(this,n)}catch(e){throw ws++,setTimeout(()=>{ws--}),Fe(n=>{n.addEventProcessor(e=>(t.mechanism&&(de(e,void 0,void 0),pe(e,t.mechanism)),e.extra={...e.extra,arguments:r},e)),ns(e)}),e}};try{for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}catch{}U(n,e),B(e,"__sentry_wrapped__",n);try{Object.getOwnPropertyDescriptor(n,"name").configurable&&Object.defineProperty(n,"name",{get:()=>e.name})}catch{}return n}function Ts(){const e=R(),{referrer:t}=Ss.document||{},{userAgent:n}=Ss.navigator||{};return{url:e,headers:{...t&&{Referer:t},...n&&{"User-Agent":n}}}}class Es extends Lr{constructor(e){var t;const n=(r=e,{release:"string"==typeof __SENTRY_RELEASE__?__SENTRY_RELEASE__:null===(s=Ss.SENTRY_RELEASE)||void 0===s?void 0:s.id,sendClientReports:!0,parentSpanIsAlwaysRootSpan:!0,...r});var r,s;!function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[t],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"npm";const s=e._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${t}`,packages:n.map(e=>({name:`${r}:@sentry/${e}`,version:a})),version:a}),e._metadata=s}(n,"browser",["browser"],Ss.SENTRY_SDK_SOURCE||"npm"),null!==(t=n._metadata)&&void 0!==t&&t.sdk&&(n._metadata.sdk.settings={infer_ip:n.sendDefaultPii?"auto":"never",...n._metadata.sdk.settings}),super(n);const{sendDefaultPii:o,sendClientReports:i,enableLogs:c,_experiments:l,enableMetrics:u}=this._options,d=u??(null==l?void 0:l.enableMetrics)??!0;Ss.document&&(i||c||d)&&Ss.document.addEventListener("visibilitychange",()=>{"hidden"===Ss.document.visibilityState&&(i&&this._flushOutcomes(),c&&Gn(this),d&&rr(this))}),o&&this.on("beforeSendSession",zr)}eventFromException(e,t){return Yr(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2?arguments[2]:void 0;return Qr(this._options.stackParser,e,t,n,this._options.attachStacktrace)}_prepareEvent(e,t,n,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n,r)}}const Is={},Cs={};function Ms(e,t){Is[e]=Is[e]||[],Is[e].push(t)}function Rs(e,t){if(!Cs[e]){Cs[e]=!0;try{t()}catch(t){i&&j.error(`Error while instrumenting ${e}`,t)}}}function Os(e,t){const n=e&&Is[e];if(n)for(const r of n)try{r(t)}catch(t){i&&j.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${Z(r)}\nError:`,t)}}function As(e){const t="console";Ms(t,e),Rs(t,Ns)}function Ns(){"console"in c&&A.forEach(function(e){e in c.console&&$(c.console,e,function(t){return N[e]=t,function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Os("console",{args:n,level:e});const s=N[e];null==s||s.apply(c.console,n)}})})}const Ds=c;function Ls(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function Ps(){if("string"==typeof EdgeRuntime)return!0;if(!function(){if(!("fetch"in Ds))return!1;try{return new Headers,new Request("data:,"),new Response,!0}catch{return!1}}())return!1;if(Ls(Ds.fetch))return!0;let e=!1;const t=Ds.document;if(t&&"function"==typeof t.createElement)try{var n;const r=t.createElement("iframe");r.hidden=!0,t.head.appendChild(r),null!==(n=r.contentWindow)&&void 0!==n&&n.fetch&&(e=Ls(r.contentWindow.fetch)),t.head.removeChild(r)}catch(e){i&&j.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return e}function Fs(e,t){const n="fetch";Ms(n,e),Rs(n,()=>js(void 0,t))}function js(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&!Ps()||$(c,"fetch",function(t){return function(){const n=new Error;for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];const{method:i,url:a}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){const[t,n]=e;return{url:Us(t),method:Bs(n,"method")?String(n.method).toUpperCase():T(t)&&Bs(t,"method")?String(t.method).toUpperCase():"GET"}}const t=e[0];return{url:Us(t),method:Bs(t,"method")?String(t.method).toUpperCase():"GET"}}(s),l={args:s,fetchData:{method:i,url:a},startTimestamp:1e3*ve(),virtualError:n,headers:Hs(s)};return e||Os("fetch",{...l}),t.apply(c,s).then(async t=>(e?e(t):Os("fetch",{...l,endTimestamp:1e3*ve(),response:t}),t),e=>{if(Os("fetch",{...l,endTimestamp:1e3*ve(),error:e}),h(e)&&void 0===e.stack&&(e.stack=n.stack,B(e,"framesToPop",1)),e instanceof TypeError&&("Failed to fetch"===e.message||"Load failed"===e.message||"NetworkError when attempting to fetch resource."===e.message))try{const t=new URL(l.fetchData.url);e.message=`${e.message} (${t.host})`}catch{}throw e})}})}function $s(e){let t;try{t=e.clone()}catch{return}!async function(e,t){if(null!=e&&e.body){const n=e.body,r=n.getReader(),s=setTimeout(()=>{n.cancel().then(null,()=>{})},9e4);let o=!0;for(;o;){let e;try{e=setTimeout(()=>{n.cancel().then(null,()=>{})},5e3);const{done:s}=await r.read();clearTimeout(e),s&&(t(),o=!1)}catch{o=!1}finally{clearTimeout(e)}}clearTimeout(s),r.releaseLock(),n.cancel().then(null,()=>{})}}(t,()=>{Os("fetch-body-resolved",{endTimestamp:1e3*ve(),response:e})})}function Bs(e,t){return!!e&&"object"==typeof e&&!!e[t]}function Us(e){return"string"==typeof e?e:e?Bs(e,"url")?e.url:e.toString?e.toString():"":""}function Hs(e){const[t,n]=e;try{if("object"==typeof n&&null!==n&&"headers"in n&&n.headers)return new Headers(n.headers);if(T(t))return new Headers(t.headers)}catch{}}const zs=100;function qs(e,t){const n=$e(),r=Le();if(!n)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:o=zs}=n.getOptions();if(o<=0)return;const i={timestamp:me(),...e},a=s?D(()=>s(i,t)):i;null!==a&&(n.emit&&n.emit("beforeAddBreadcrumb",a,t),r.addBreadcrumb(a,o))}function Ws(e){return"warn"===e?"warning":["fatal","error","warning","log","info","debug"].includes(e)?e:"log"}function Vs(e){return void 0===e?void 0:e>=400&&e<500?"warning":e>=500?"error":void 0}const Js="thismessage:/";function Ks(e){return"isRelative"in e}function Gs(e,t){const n=e.indexOf("://")<=0&&0!==e.indexOf("//"),r=t??(n?Js:void 0);try{if("canParse"in URL&&!URL.canParse(e,r))return;const t=new URL(e,r);return n?{isRelative:n,pathname:t.pathname,search:t.search,hash:t.hash}:t}catch{}}function Xs(e){if(Ks(e))return e.pathname;const t=new URL(e);return t.search="",t.hash="",["80","443"].includes(t.port)&&(t.port=""),t.password&&(t.password="%filtered%"),t.username&&(t.username="%filtered%"),t.toString()}function Ys(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:r,relative:t[5]+n+r}}function Qs(e){return e.split(/[?#]/,1)[0]}const Zs=c;let eo,to,no;function ro(e){Ms("dom",e),Rs("dom",so)}function so(){if(!Zs.document)return;const e=Os.bind(null,"dom"),t=oo(e,!0);Zs.document.addEventListener("click",t,!1),Zs.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(t=>{const n=Zs,r=n[t]?.prototype;r?.hasOwnProperty?.("addEventListener")&&($(r,"addEventListener",function(t){return function(n,r,s){if("click"===n||"keypress"==n)try{const r=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},o=r[n]=r[n]||{refCount:0};if(!o.handler){const r=oo(e);o.handler=r,t.call(this,n,r,s)}o.refCount++}catch{}return t.call(this,n,r,s)}}),$(r,"removeEventListener",function(e){return function(t,n,r){if("click"===t||"keypress"==t)try{const n=this.__sentry_instrumentation_handlers__||{},s=n[t];s&&(s.refCount--,s.refCount<=0&&(e.call(this,t,s.handler,r),s.handler=void 0,delete n[t]),0===Object.keys(n).length&&delete this.__sentry_instrumentation_handlers__)}catch{}return e.call(this,t,n,r)}}))})}function oo(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const r=function(e){try{return e.target}catch{return null}}(n);if(function(e,t){return"keypress"===e&&(!t?.tagName||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!t.isContentEditable)}(n.type,r))return;B(n,"_sentryCaptured",!0),r&&!r._sentryId&&B(r,"_sentryId",ce());const s="keypress"===n.type?"input":n.type;(function(e){if(e.type!==to)return!1;try{if(!e.target||e.target._sentryId!==no)return!1}catch{}return!0})(n)||(e({event:n,name:s,global:t}),to=n.type,no=r?r._sentryId:void 0),clearTimeout(eo),eo=Zs.setTimeout(()=>{no=void 0,to=void 0},1e3)}}const io="__sentry_xhr_v3__";function ao(e){Ms("xhr",e),Rs("xhr",co)}function co(){if(!Zs.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;e.open=new Proxy(e.open,{apply(e,t,n){const r=new Error,s=1e3*ve(),o=y(n[0])?n[0].toUpperCase():void 0,i=function(e){if(y(e))return e;try{return e.toString()}catch{}}(n[1]);if(!o||!i)return e.apply(t,n);t[io]={method:o,url:i,request_headers:{}},"POST"===o&&i.match(/sentry_key/)&&(t.__sentry_own_request__=!0);const a=()=>{const e=t[io];if(e&&4===t.readyState){try{e.status_code=t.status}catch{}Os("xhr",{endTimestamp:1e3*ve(),startTimestamp:s,xhr:t,virtualError:r})}};return"onreadystatechange"in t&&"function"==typeof t.onreadystatechange?t.onreadystatechange=new Proxy(t.onreadystatechange,{apply:(e,t,n)=>(a(),e.apply(t,n))}):t.addEventListener("readystatechange",a),t.setRequestHeader=new Proxy(t.setRequestHeader,{apply(e,t,n){const[r,s]=n,o=t[io];return o&&y(r)&&y(s)&&(o.request_headers[r.toLowerCase()]=s),e.apply(t,n)}}),e.apply(t,n)}}),e.send=new Proxy(e.send,{apply(e,t,n){const r=t[io];return r?(void 0!==n[0]&&(r.body=n[0]),Os("xhr",{startTimestamp:1e3*ve(),xhr:t}),e.apply(t,n)):e.apply(t,n)}})}let lo;function uo(e){const t="history";Ms(t,e),Rs(t,po)}function po(){function e(e){return function(...t){const n=t.length>2?t[2]:void 0;if(n){const r=lo,s=function(e){try{return new URL(e,Zs.location.origin).toString()}catch{return e}}(String(n));if(lo=s,r===s)return e.apply(this,t);Os("history",{from:r,to:s})}return e.apply(this,t)}}Zs.addEventListener("popstate",()=>{const e=Zs.location.href,t=lo;lo=e,t!==e&&Os("history",{from:t,to:e})}),"history"in Ds&&Ds.history&&($(Zs.history,"pushState",e),$(Zs.history,"replaceState",e))}const ho="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,fo=function(){const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}};return{name:"Breadcrumbs",setup(t){e.console&&As(function(e){return function(t){if($e()!==e)return;const n={category:"console",data:{arguments:t.args,logger:"console"},level:Ws(t.level),message:se(t.args," ")};if("assert"===t.level){if(!1!==t.args[0])return;n.message=`Assertion failed: ${se(t.args.slice(1)," ")||"console.assert"}`,n.data.arguments=t.args.slice(1)}qs(n,{input:t.args,level:t.level})}}(t)),e.dom&&ro(function(e,t){return function(n){if($e()!==e)return;let r,s,o="object"==typeof t?t.serializeAttribute:void 0,i="object"==typeof t&&"number"==typeof t.maxStringLength?t.maxStringLength:void 0;i&&i>1024&&(ho&&j.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${i} was configured. Sentry will use 1024 instead.`),i=1024),"string"==typeof o&&(o=[o]);try{const e=n.event,t=function(e){return!!e&&!!e.target}(e)?e.target:e;r=C(t,{keyAttrs:o,maxStringLength:i}),s=O(t)}catch{r="<unknown>"}if(0===r.length)return;const a={category:`ui.${n.name}`,message:r};s&&(a.data={"ui.component_name":s}),qs(a,{event:n.event,name:n.name,global:n.global})}}(t,e.dom)),e.xhr&&ao(function(e){return function(t){if($e()!==e)return;const{startTimestamp:n,endTimestamp:r}=t,s=t.xhr[io];if(!n||!r||!s)return;const{method:o,url:i,status_code:a,body:c}=s,l={method:o,url:i,status_code:a},u={xhr:t.xhr,input:c,startTimestamp:n,endTimestamp:r},d={category:"xhr",data:l,type:"http",level:Vs(a)};e.emit("beforeOutgoingRequestBreadcrumb",d,u),qs(d,u)}}(t)),e.fetch&&Fs(function(e){return function(t){if($e()!==e)return;const{startTimestamp:n,endTimestamp:r}=t;if(r&&(!t.fetchData.url.match(/sentry_key/)||"POST"!==t.fetchData.method))if(t.fetchData.method,t.fetchData.url,t.error){const s=t.fetchData,o={data:t.error,input:t.args,startTimestamp:n,endTimestamp:r},i={category:"fetch",data:s,level:"error",type:"http"};e.emit("beforeOutgoingRequestBreadcrumb",i,o),qs(i,o)}else{const s=t.response,o={...t.fetchData,status_code:null==s?void 0:s.status};t.fetchData.request_body_size,t.fetchData.response_body_size,null==s||s.status;const i={input:t.args,response:s,startTimestamp:n,endTimestamp:r},a={category:"fetch",data:o,type:"http",level:Vs(o.status_code)};e.emit("beforeOutgoingRequestBreadcrumb",a,i),qs(a,i)}}}(t)),e.history&&uo(function(e){return function(t){var n;if($e()!==e)return;let r=t.from,s=t.to;const o=Ys(Ss.location.href);let i=r?Ys(r):void 0;const a=Ys(s);null!==(n=i)&&void 0!==n&&n.path||(i=o),o.protocol===a.protocol&&o.host===a.host&&(s=a.relative),o.protocol===i.protocol&&o.host===i.host&&(r=i.relative),qs({category:"navigation",data:{from:r,to:s}})}}(t)),e.sentry&&t.on("beforeSendEvent",function(e){return function(t){$e()===e&&qs({category:"sentry."+("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:ue(t)},{event:t})}}(t))}}},mo=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],go=function(){const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,unregisterOriginalCallbacks:!1,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}};return{name:"BrowserApiErrors",setupOnce(){e.setTimeout&&$(Ss,"setTimeout",yo),e.setInterval&&$(Ss,"setInterval",yo),e.requestAnimationFrame&&$(Ss,"requestAnimationFrame",vo),e.XMLHttpRequest&&"XMLHttpRequest"in Ss&&$(XMLHttpRequest.prototype,"send",bo);const t=e.eventTarget;t&&(Array.isArray(t)?t:mo).forEach(t=>function(e,t){var n,r;const s=null===(n=Ss[e])||void 0===n?void 0:n.prototype;null!=s&&null!==(r=s.hasOwnProperty)&&void 0!==r&&r.call(s,"addEventListener")&&($(s,"addEventListener",function(n){return function(r,s,o){try{"function"==typeof s.handleEvent&&(s.handleEvent=xs(s.handleEvent,{mechanism:{data:{handler:Z(s),target:e},handled:!1,type:"auto.browser.browserapierrors.handleEvent"}}))}catch{}return t.unregisterOriginalCallbacks&&function(e,t,n){e&&"object"==typeof e&&"removeEventListener"in e&&"function"==typeof e.removeEventListener&&e.removeEventListener(t,n)}(this,r,s),n.apply(this,[r,xs(s,{mechanism:{data:{handler:Z(s),target:e},handled:!1,type:"auto.browser.browserapierrors.addEventListener"}}),o])}}),$(s,"removeEventListener",function(e){return function(t,n,r){try{const s=n.__sentry_wrapped__;s&&e.call(this,t,s,r)}catch{}return e.call(this,t,n,r)}}))}(t,e))}}};function yo(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const s=n[0];return n[0]=xs(s,{mechanism:{handled:!1,type:`auto.browser.browserapierrors.${Z(e)}`}}),e.apply(this,n)}}function vo(e){return function(t){return e.apply(this,[xs(t,{mechanism:{data:{handler:Z(e)},handled:!1,type:"auto.browser.browserapierrors.requestAnimationFrame"}})])}}function bo(e){return function(){const t=this;["onload","onerror","onprogress","onreadystatechange"].forEach(e=>{e in t&&"function"==typeof t[e]&&$(t,e,function(t){const n={mechanism:{data:{handler:Z(t)},handled:!1,type:`auto.browser.browserapierrors.xhr.${e}`}},r=H(t);return r&&(n.mechanism.data.handler=Z(r)),xs(t,n)})});for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e.apply(this,r)}}const _o=()=>({name:"BrowserSession",setupOnce(){void 0!==Ss.document?(ys({ignoreDuration:!0}),_s(),uo(e=>{let{from:t,to:n}=e;void 0!==t&&t!==n&&(ys({ignoreDuration:!0}),_s())})):ho&&j.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}});let So=null;function wo(e){const t="error";Ms(t,e),Rs(t,ko)}function ko(){So=c.onerror,c.onerror=function(e,t,n,r,s){return Os("error",{column:r,error:s,line:n,msg:e,url:t}),!!So&&So.apply(this,arguments)},c.onerror.__SENTRY_INSTRUMENTED__=!0}let xo=null;function To(e){const t="unhandledrejection";Ms(t,e),Rs(t,Eo)}function Eo(){xo=c.onunhandledrejection,c.onunhandledrejection=function(e){return Os("unhandledrejection",e),!xo||xo.apply(this,arguments)},c.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const Io=function(){const e={onerror:!0,onunhandledrejection:!0,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(t){e.onerror&&(function(e){wo(t=>{const{stackParser:n,attachStacktrace:r}=Oo();if($e()!==e||ks())return;const{msg:s,url:o,line:i,column:a,error:c}=t,l=function(e,t,n,r){const s=e.exception=e.exception||{},o=s.values=s.values||[],i=o[0]=o[0]||{},a=i.stacktrace=i.stacktrace||{},c=a.frames=a.frames||[],l=r,u=n,d=function(e){if(y(e)&&0!==e.length){if(e.startsWith("data:")){const t=e.match(/^data:([^;]+)/);return`<data:${t?t[1]:"text/javascript"}${e.includes("base64,")?",base64":""}>`}return e}}(t)??R();return 0===c.length&&c.push({colno:l,filename:d,function:J,in_app:!0,lineno:u}),e}(Zr(n,c||s,void 0,r,!1),o,i,a);l.level="error",ss(l,{originalException:c,mechanism:{handled:!1,type:"auto.browser.global_handlers.onerror"}})})}(t),Ro("onerror")),e.onunhandledrejection&&(function(e){To(t=>{const{stackParser:n,attachStacktrace:r}=Oo();if($e()!==e||ks())return;const s=Co(t),o=b(s)?Mo(s):Zr(n,s,void 0,r,!0);o.level="error",ss(o,{originalException:s,mechanism:{handled:!1,type:"auto.browser.global_handlers.onunhandledrejection"}})})}(t),Ro("onunhandledrejection"))}}};function Co(e){if(b(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}function Mo(e){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(e)}`}]}}}function Ro(e){ho&&j.log(`Global Handler attached: ${e}`)}function Oo(){const e=$e();return(null==e?void 0:e.getOptions())||{stackParser:()=>[],attachStacktrace:!1}}const Ao=()=>({name:"HttpContext",preprocessEvent(e){var t;if(!Ss.navigator&&!Ss.location&&!Ss.document)return;const n=Ts(),r={...n.headers,...null===(t=e.request)||void 0===t?void 0:t.headers};e.request={...n,...e.request,headers:r}}});function No(e,t,n,r,s,o){var i;if(null===(i=s.exception)||void 0===i||!i.values||!o||!k(o.originalException,Error))return;const a=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;a&&(s.exception.values=Do(e,t,r,o.originalException,n,s.exception.values,a,0))}function Do(e,t,n,r,s,o,i,a){if(o.length>=n+1)return o;let c=[...o];if(k(r[s],Error)){Lo(i,a);const o=e(t,r[s]),l=c.length;Po(o,s,l,a),c=Do(e,t,n,r[s],s,[o,...c],o,l)}return Array.isArray(r.errors)&&r.errors.forEach((r,o)=>{if(k(r,Error)){Lo(i,a);const l=e(t,r),u=c.length;Po(l,`errors[${o}]`,u,a),c=Do(e,t,n,r,s,[l,...c],l,u)}}),c}function Lo(e,t){e.mechanism={handled:!0,type:"auto.core.linked_errors",...e.mechanism,..."AggregateError"===e.type&&{is_exception_group:!0},exception_id:t}}function Po(e,t,n,r){e.mechanism={handled:!0,...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:r}}const Fo=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.limit||5,n=e.key||"cause";return{name:"LinkedErrors",preprocessEvent(e,r,s){No(qr,s.getOptions().stackParser,n,t,e,r)}}};function jo(e,t,n,r){const s={filename:e,function:"<anonymous>"===t?J:t,in_app:!0};return void 0!==n&&(s.lineno=n),void 0!==r&&(s.colno=r),s}const $o=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Bo=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Uo=/\((\S*)(?::(\d+))(?::(\d+))\)/,Ho=/at (.+?) ?\(data:(.+?),/,zo=[30,e=>{const t=e.match(Ho);if(t)return{filename:`<data:${t[2]}>`,function:t[1]};const n=$o.exec(e);if(n){const[,e,t,r]=n;return jo(e,J,+t,+r)}const r=Bo.exec(e);if(r){if(r[2]&&0===r[2].indexOf("eval")){const e=Uo.exec(r[2]);e&&(r[2]=e[1],r[3]=e[2],r[4]=e[3])}const[e,t]=ti(r[1]||J,r[2]);return jo(t,e,r[3]?+r[3]:void 0,r[4]?+r[4]:void 0)}}],qo=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Wo=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Vo=[50,e=>{const t=qo.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const e=Wo.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],n=t[1]||J;return[n,e]=ti(n,e),jo(e,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}],Jo=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,Ko=[40,e=>{const t=Jo.exec(e);return t?jo(t[2],t[1]||J,+t[3],t[4]?+t[4]:void 0):void 0}],Go=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,Xo=[10,e=>{const t=Go.exec(e);return t?jo(t[2],t[3]||J,+t[1]):void 0}],Yo=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\(.*\))? in (.*):\s*$/i,Qo=[20,e=>{const t=Yo.exec(e);return t?jo(t[5],t[3]||t[4]||J,+t[1],+t[2]):void 0}],Zo=[zo,Vo],ei=X(...Zo),ti=(e,t)=>{const n=-1!==e.indexOf("safari-extension"),r=-1!==e.indexOf("safari-web-extension");return n||r?[-1!==e.indexOf("@")?e.split("@")[0]:J,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]},ni="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,ri={};function si(e){const t=ri[e];if(t)return t;let n=Zs[e];if(Ls(n))return ri[e]=n.bind(Zs);const r=Zs.document;if(r&&"function"==typeof r.createElement)try{const t=r.createElement("iframe");t.hidden=!0,r.head.appendChild(t);const s=t.contentWindow;s?.[e]&&(n=s[e]),r.head.removeChild(t)}catch(t){ni&&j.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,t)}return n?ri[e]=n.bind(Zs):n}function oi(...e){return si("setTimeout")(...e)}const ii=40;function ai(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:si("fetch"),n=0,r=0;return gr(e,async function(s){const o=s.body.length;n+=o,r++;const i={body:s.body,method:"POST",referrerPolicy:"strict-origin",headers:e.headers,keepalive:n<=6e4&&r<15,...e.fetchOptions};try{const n=await t(e.url,i);return{statusCode:n.status,headers:{"x-sentry-rate-limits":n.headers.get("X-Sentry-Rate-Limits"),"retry-after":n.headers.get("Retry-After")}}}catch(e){throw ri.fetch=void 0,e}finally{n-=o,r--}},ur(e.bufferSize||ii))}function ci(e){return[Ge(),et(),go(),fo(),Io(),Fo(),tt(),Ao(),_o()]}function li(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=!e.skipBrowserExtensionCheck&&!!function(){var e;if(void 0===Ss.window)return!1;const t=Ss;if(t.nw)return!1;const n=t.chrome||t.browser;if(null==n||null===(e=n.runtime)||void 0===e||!e.id)return!1;const r=R();return!(Ss===Ss.top&&["chrome-extension","moz-extension","ms-browser-extension","safari-web-extension"].some(e=>r.startsWith(`${e}://`)))}()&&(ho&&D(()=>{console.error("[Sentry] You cannot use Sentry.init() in a browser extension, see: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")}),!0);let n=null==e.defaultIntegrations?ci():e.defaultIntegrations;const r={...e,enabled:!t&&e.enabled,stackParser:(s=e.stackParser||ei,Array.isArray(s)?X(...s):s),integrations:He({integrations:e.integrations,defaultIntegrations:n}),transport:e.transport||ai};var s;return function(e,t){!0===t.debug&&(i?j.enable():D(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),De().update(t.initialScope);const n=new e(t);return ot(n),n.init(),n}(Es,r)}function ui(){}function di(e){e()}class pi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._traceId=e.traceId||we(),this._spanId=e.spanId||ke()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:0}}end(e){}setAttribute(e,t){return this}setAttributes(e){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}addEvent(e,t,n){return this}addLink(e){return this}addLinks(e){return this}recordException(e,t){}}function hi(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:hn();const s=r&&pn(r);s&&(i&&j.log(`[Measurement] Setting measurement on root span: ${e} = ${t} ${n}`),s.addEvent(e,{[xt]:t,[kt]:n}))}function fi(e){if(!e||0===e.length)return;const t={};return e.forEach(e=>{const n=e.attributes||{},r=n[kt],s=n[xt];"string"==typeof r&&"number"==typeof s&&(t[e.name]={value:s,unit:r})}),t}class mi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._traceId=e.traceId||we(),this._spanId=e.spanId||ke(),this._startTime=e.startTimestamp||ve(),this._links=e.links,this._attributes={},this.setAttributes({[St]:"manual",[_t]:e.op,...e.attributes}),this._name=e.name,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.endTimestamp&&(this._endTime=e.endTimestamp),this._events=[],this._isStandaloneSpan=e.isStandalone,this._endTime&&this._onSpanEnded()}addLink(e){return this._links?this._links.push(e):this._links=[e],this}addLinks(e){return this._links?this._links.push(...e):this._links=e,this}recordException(e,t){}spanContext(){const{_spanId:e,_traceId:t,_sampled:n}=this;return{spanId:e,traceId:t,traceFlags:n?Xt:0}}setAttribute(e,t){return void 0===t?delete this._attributes[e]:this._attributes[e]=t,this}setAttributes(e){return Object.keys(e).forEach(t=>this.setAttribute(t,e[t])),this}updateStartTime(e){this._startTime=nn(e)}setStatus(e){return this._status=e,this}updateName(e){return this._name=e,this.setAttribute(yt,"custom"),this}end(e){this._endTime||(this._endTime=nn(e),function(e){if(!i)return;const{description:t="< unknown name >",op:n="< unknown op >"}=sn(e),{spanId:r}=e.spanContext(),s=`[Tracing] Finishing "${n}" ${pn(e)===e?"root ":""}span "${t}" with ID ${r}`;j.log(s)}(this),this._onSpanEnded())}getSpanJSON(){return{data:this._attributes,description:this._name,op:this._attributes[_t],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:an(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[St],profile_id:this._attributes[Et],exclusive_time:this._attributes[It],measurements:fi(this._events),is_segment:this._isStandaloneSpan&&pn(this)===this||void 0,segment_id:this._isStandaloneSpan?pn(this).spanContext().spanId:void 0,links:tn(this._links)}}isRecording(){return!this._endTime&&!!this._sampled}addEvent(e,t,n){i&&j.log("[Tracing] Adding an event to span:",e);const r=gi(t)?t:n||ve(),s=gi(t)?{}:t||{},o={name:e,time:nn(r),attributes:s};return this._events.push(o),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const e=$e();if(e&&e.emit("spanEnd",this),!this._isStandaloneSpan&&this!==pn(this))return;if(this._isStandaloneSpan)return void(this._sampled?function(e){const t=$e();if(!t)return;const n=e[1];n&&0!==n.length?t.sendEnvelope(e):t.recordDroppedEvent("before_send","span")}(function(e,t){const n=_n(e[0]),r=null==t?void 0:t.getDsn(),s=null==t?void 0:t.getOptions().tunnel,o={sent_at:(new Date).toISOString(),...function(e){return!!e.trace_id&&!!e.public_key}(n)&&{trace:n},...!!s&&r&&{dsn:ct(r)}},{beforeSendSpan:i,ignoreSpans:a}=(null==t?void 0:t.getOptions())||{},c=null!=a&&a.length?e.filter(e=>!jn(sn(e),a)):e,l=e.length-c.length;l&&(null==t||t.recordDroppedEvent("before_send","span",l));const u=i?e=>{const t=sn(e);return i(t)||(fn(),t)}:sn,d=[];for(const e of c){const t=u(e);t&&d.push(On(t))}return Tn(o,d)}([this],e)):(i&&j.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","span")));const t=this._convertSpanToTransaction();t&&(qt(this).scope||De()).captureEvent(t)}_convertSpanToTransaction(){var e;if(!yi(sn(this)))return;this._name||(i&&j.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:t,isolationScope:n}=qt(this),r=null==t||null===(e=t.getScopeData().sdkProcessingMetadata)||void 0===e?void 0:e.normalizedRequest;if(!0!==this._sampled)return;const s=dn(this).filter(e=>e!==this&&!function(e){return e instanceof mi&&e.isStandaloneSpan()}(e)).map(e=>sn(e)).filter(yi),o=this._attributes[yt];delete this._attributes[Tt],s.forEach(e=>{delete e.data[Tt]});const a={contexts:{trace:Qt(this)},spans:s.length>1e3?s.sort((e,t)=>e.start_timestamp-t.start_timestamp).slice(0,1e3):s,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:t,capturedSpanIsolationScope:n,dynamicSamplingContext:_n(this)},request:r,...o&&{transaction_info:{source:o}}},c=fi(this._events);return c&&Object.keys(c).length&&(i&&j.log("[Measurements] Adding measurements to transaction event",JSON.stringify(c,void 0,2)),a.measurements=c),a}}function gi(e){return e&&"number"==typeof e||e instanceof Date||Array.isArray(e)}function yi(e){return!!(e.start_timestamp&&e.timestamp&&e.span_id&&e.trace_id)}function vi(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{};try{n=e()}catch(e){throw t(e),r(),e}return function(e,t,n,r){return w(e)?e.then(e=>(n(),r(e),e),e=>{throw t(e),n(),e}):(n(),r(e),e)}(n,t,r,s)}const bi="__SENTRY_SUPPRESS_TRACING__";function _i(e,t){const n=Mi();if(n.startSpan)return n.startSpan(e,t);const r=Ci(e),{forceTransaction:s,parentSpan:o,scope:i}=e;return Fe(null==i?void 0:i.clone(),()=>Ai(o)(()=>{const n=De(),i=Oi(n,o),a=e.onlyIfParent&&!i?new pi:Ii({parentSpan:i,spanArguments:r,forceTransaction:s,scope:n});return Te(n,a),vi(()=>t(a),()=>{const{status:e}=sn(a);!a.isRecording()||e&&"ok"!==e||a.setStatus({code:jt,message:"internal_error"})},()=>{a.end()})}))}function Si(e,t){const n=Mi();if(n.startSpanManual)return n.startSpanManual(e,t);const r=Ci(e),{forceTransaction:s,parentSpan:o,scope:i}=e;return Fe(null==i?void 0:i.clone(),()=>Ai(o)(()=>{const n=De(),i=Oi(n,o),a=e.onlyIfParent&&!i?new pi:Ii({parentSpan:i,spanArguments:r,forceTransaction:s,scope:n});return Te(n,a),vi(()=>t(a,()=>a.end()),()=>{const{status:e}=sn(a);!a.isRecording()||e&&"ok"!==e||a.setStatus({code:jt,message:"internal_error"})})}))}function wi(e){const t=Mi();if(t.startInactiveSpan)return t.startInactiveSpan(e);const n=Ci(e),{forceTransaction:r,parentSpan:s}=e;return(e.scope?t=>Fe(e.scope,t):void 0!==s?e=>xi(s,e):e=>e())(()=>{const t=De(),o=Oi(t,s);return e.onlyIfParent&&!o?new pi:Ii({parentSpan:o,spanArguments:n,forceTransaction:r,scope:t})})}const ki=(e,t)=>{const n=Ne(l());if(n.continueTrace)return n.continueTrace(e,t);const{sentryTrace:r,baggage:s}=e,o=$e(),i=At(s);return o&&!function(e,t){const n=dt(e);return t&&n&&t!==n?(j.log(`Won't continue trace because org IDs don't match (incoming baggage: ${t}, SDK options: ${n})`),!1):!e.getOptions().strictTraceContinuation||!(t&&!n||!t&&n)||(j.log(`Starting a new trace because strict trace continuation is enabled but one org ID is missing (incoming baggage: ${t}, Sentry client: ${n})`),!1)}(o,null==i?void 0:i.org_id)?Ei(t):Fe(e=>{const n=Jt(r,s);return e.setPropagationContext(n),Te(e,void 0),t()})};function xi(e,t){const n=Mi();return n.withActiveSpan?n.withActiveSpan(e,t):Fe(n=>(Te(n,e||void 0),t(n)))}function Ti(e){const t=Mi();return t.suppressTracing?t.suppressTracing(e):Fe(t=>{t.setSDKProcessingMetadata({[bi]:!0});const n=e();return t.setSDKProcessingMetadata({[bi]:void 0}),n})}function Ei(e){return Fe(t=>(t.setPropagationContext({traceId:we(),sampleRand:Math.random()}),i&&j.log(`Starting a new trace with id ${t.getPropagationContext().traceId}`),xi(null,e)))}function Ii(e){let{parentSpan:t,spanArguments:n,forceTransaction:r,scope:s}=e;if(!Lt()){const e=new pi;return!r&&t||yn(e,{sampled:"false",sample_rate:"0",transaction:n.name,..._n(e)}),e}const o=Le();let a;if(t&&!r)a=function(e,t,n){const{spanId:r,traceId:s}=e.spanContext(),o=!t.getScopeData().sdkProcessingMetadata[bi]&&on(e),i=o?new mi({...n,parentSpanId:r,traceId:s,sampled:o}):new pi({traceId:s});un(e,i);const a=$e();return a&&(a.emit("spanStart",i),n.endTimestamp&&a.emit("spanEnd",i)),i}(t,s,n),un(t,a);else if(t){const e=_n(t),{traceId:r,spanId:o}=t.spanContext(),i=on(t);a=Ri({traceId:r,parentSpanId:o,...n},s,i),yn(a,e)}else{const{traceId:e,dsc:t,parentSpanId:r,sampled:i}={...o.getPropagationContext(),...s.getPropagationContext()};a=Ri({traceId:e,parentSpanId:r,...n},s,i),t&&yn(a,t)}return function(e){if(!i)return;const{description:t="< unknown name >",op:n="< unknown op >",parent_span_id:r}=sn(e),{spanId:s}=e.spanContext(),o=on(e),a=pn(e),c=a===e,l=`[Tracing] Starting ${o?"sampled":"unsampled"} ${c?"root ":""}span`,u=[`op: ${n}`,`name: ${t}`,`ID: ${s}`];if(r&&u.push(`parent ID: ${r}`),!c){const{op:e,description:t}=sn(a);u.push(`root ID: ${a.spanContext().spanId}`),e&&u.push(`root op: ${e}`),t&&u.push(`root description: ${t}`)}j.log(`${l}\n  ${u.join("\n  ")}`)}(a),function(e,t,n){e&&(B(e,Ht,function(e){try{const t=c.WeakRef;if("function"==typeof t)return new t(e)}catch{}return e}(n)),B(e,Ut,t))}(a,s,o),a}function Ci(e){const t={isStandalone:(e.experimental||{}).standalone,...e};if(e.startTime){const n={...t};return n.startTimestamp=nn(e.startTime),delete n.startTime,n}return t}function Mi(){return Ne(l())}function Ri(e,t,n){var r;const s=$e(),o=(null==s?void 0:s.getOptions())||{},{name:a=""}=e,c={spanAttributes:{...e.attributes},spanName:a,parentSampled:n};null==s||s.emit("beforeSampling",c,{decision:!1});const l=c.parentSampled??n,u=c.spanAttributes,d=t.getPropagationContext(),[p,h,f]=t.getScopeData().sdkProcessingMetadata[bi]?[!1]:function(e,t,n){if(!Lt(e))return[!1];let r,s;"function"==typeof e.tracesSampler?(s=e.tracesSampler({...t,inheritOrSampleWith:e=>"number"==typeof t.parentSampleRate?t.parentSampleRate:"boolean"==typeof t.parentSampled?Number(t.parentSampled):e}),r=!0):void 0!==t.parentSampled?s=t.parentSampled:void 0!==e.tracesSampleRate&&(s=e.tracesSampleRate,r=!0);const o=Wt(s);if(void 0===o)return i&&j.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(s)} of type ${JSON.stringify(typeof s)}.`),[!1];if(!o)return i&&j.log("[Tracing] Discarding transaction because "+("function"==typeof e.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),[!1,o,r];const a=n<o;return a||i&&j.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`),[a,o,r]}(o,{name:a,parentSampled:l,attributes:u,parentSampleRate:Wt(null===(r=d.dsc)||void 0===r?void 0:r.sample_rate)},d.sampleRand),m=new mi({...e,attributes:{[yt]:"custom",[vt]:void 0!==h&&f?h:void 0,...u},sampled:p});return!p&&s&&(i&&j.log("[Tracing] Discarding root span because its trace was not chosen to be sampled."),s.recordDroppedEvent("sample_rate","transaction")),s&&s.emit("spanStart",m),m}function Oi(e,t){if(t)return t;if(null===t)return;const n=Ee(e);if(!n)return;const r=$e();return(r?r.getOptions():{}).parentSpanIsAlwaysRootSpan?pn(n):n}function Ai(e){return void 0!==e?t=>xi(e,t):e=>e()}const Ni={idleTimeout:1e3,finalTimeout:3e4,childSpanTimeout:15e3};function Di(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new Map;let r,s=!1,o="externalFinish",a=!t.disableAutoFinish;const c=[],{idleTimeout:l=Ni.idleTimeout,finalTimeout:u=Ni.finalTimeout,childSpanTimeout:d=Ni.childSpanTimeout,beforeSpanEnd:p,trimIdleSpanEndTimestamp:h=!0}=t,f=$e();if(!f||!Lt()){const e=new pi;return yn(e,{sample_rate:"0",sampled:"false",..._n(e)}),e}const m=De(),g=hn(),y=function(e){const t=wi(e);return Te(De(),t),i&&j.log("[Tracing] Started span is an idle span"),t}(e);function v(){r&&(clearTimeout(r),r=void 0)}function b(e){v(),r=setTimeout(()=>{!s&&0===n.size&&a&&(o="idleTimeout",y.end(e))},l)}function _(e){r=setTimeout(()=>{!s&&a&&(o="heartbeatFailed",y.end(e))},d)}function S(e){s=!0,n.clear(),c.forEach(e=>e()),Te(m,g);const t=sn(y),{start_timestamp:r}=t;if(!r)return;t.data[wt]||y.setAttribute(wt,o);const a=t.status;a&&"unknown"!==a||y.setStatus({code:Ft}),j.log(`[Tracing] Idle span "${t.op}" finished`);const d=dn(y).filter(e=>e!==y);let p=0;d.forEach(t=>{t.isRecording()&&(t.setStatus({code:jt,message:"cancelled"}),t.end(e),i&&j.log("[Tracing] Cancelling span since span ended early",JSON.stringify(t,void 0,2)));const n=sn(t),{timestamp:r=0,start_timestamp:s=0}=n,o=s<=e,a=r-s<=(u+l)/1e3;if(i){const e=JSON.stringify(t,void 0,2);o?a||j.log("[Tracing] Discarding span since it finished after idle span final timeout",e):j.log("[Tracing] Discarding span since it happened after idle span was finished",e)}a&&o||(function(e,t){e[cn]&&e[cn].delete(t)}(y,t),p++)}),p>0&&y.setAttribute("sentry.idle_span_discarded_spans",p)}return y.end=new Proxy(y.end,{apply(e,t,n){if(p&&p(y),t instanceof pi)return;const[r,...s]=n,o=nn(r||ve()),i=dn(y).filter(e=>e!==y),a=sn(y);if(!i.length||!h)return S(o),Reflect.apply(e,t,[o,...s]);const c=f.getOptions().ignoreSpans,l=null==i?void 0:i.reduce((e,t)=>{const n=sn(t);return n.timestamp?c&&jn(n,c)?e:e?Math.max(e,n.timestamp):n.timestamp:e},void 0),d=a.start_timestamp,m=Math.min(d?d+u/1e3:1/0,Math.max(d||-1/0,Math.min(o,l||1/0)));return S(m),Reflect.apply(e,t,[m,...s])}}),c.push(f.on("spanStart",e=>{var t;s||e===y||sn(e).timestamp||e instanceof mi&&e.isStandaloneSpan()||dn(y).includes(e)&&(t=e.spanContext().spanId,v(),n.set(t,!0),_(ve()+d/1e3))})),c.push(f.on("spanEnd",e=>{var t;s||(t=e.spanContext().spanId,n.has(t)&&n.delete(t),0===n.size&&b(ve()+l/1e3))})),c.push(f.on("idleSpanEnableAutoFinish",e=>{e===y&&(a=!0,b(),n.size&&_())})),t.disableAutoFinish||b(),setTimeout(()=>{s||(y.setStatus({code:jt,message:"deadline_exceeded"}),o="finalTimeout",y.end())},u),y}let Li=!1;function Pi(){function e(){const e=hn(),t=e&&pn(e);if(t){const e="internal_error";i&&j.log(`[Tracing] Root span: ${e} -> Global error occurred`),t.setStatus({code:jt,message:e})}}Li||(e.tag="sentry_tracingErrorCallback",Li=!0,wo(e),To(e))}const Fi=(e,t,n,r)=>{let s,o;return i=>{t.value>=0&&(i||r)&&(o=t.value-(s??0),(o||void 0===s)&&(s=t.value,t.delta=o,t.rating=((e,t)=>e>t[1]?"poor":e>t[0]?"needs-improvement":"good")(t.value,n),e(t)))}},ji=(e=!0)=>{const t=Zs.performance?.getEntriesByType?.("navigation")[0];if(!e||t&&t.responseStart>0&&t.responseStart<performance.now())return t},$i=()=>{const e=ji();return e?.activationStart??0};function Bi(e,t,n){Zs.document&&Zs.addEventListener(e,t,n)}function Ui(e,t,n){Zs.document&&Zs.removeEventListener(e,t,n)}let Hi=-1;const zi=new Set,qi=e=>{if(function(e){return"pagehide"===e.type||"hidden"===Zs.document?.visibilityState}(e)&&Hi>-1){if("visibilitychange"===e.type||"pagehide"===e.type)for(const e of zi)e();isFinite(Hi)||(Hi="visibilitychange"===e.type?e.timeStamp:0,Ui("prerenderingchange",qi,!0))}},Wi=()=>{if(Zs.document&&Hi<0){const e=$i(),t=Zs.document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter(t=>"hidden"===t.name&&t.startTime>e)[0]?.startTime;Hi=t??("hidden"!==Zs.document?.visibilityState||Zs.document?.prerendering?1/0:0),Bi("visibilitychange",qi,!0),Bi("pagehide",qi,!0),Bi("prerenderingchange",qi,!0)}return{get firstHiddenTime(){return Hi},onHidden(e){zi.add(e)}}},Vi=(e,t=-1)=>{const n=ji();let r="navigate";return n&&(Zs.document?.prerendering||$i()>0?r="prerender":Zs.document?.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},Ji=new WeakMap;function Ki(e,t){return Ji.get(e)||Ji.set(e,new t),Ji.get(e)}class Gi{constructor(){Gi.prototype.__init.call(this),Gi.prototype.__init2.call(this)}__init(){this._sessionValue=0}__init2(){this._sessionEntries=[]}_processEntry(e){if(e.hadRecentInput)return;const t=this._sessionEntries[0],n=this._sessionEntries[this._sessionEntries.length-1];this._sessionValue&&t&&n&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(this._sessionValue+=e.value,this._sessionEntries.push(e)):(this._sessionValue=e.value,this._sessionEntries=[e]),this._onAfterProcessingUnexpectedShift?.(e)}}const Xi=(e,t,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const r=new PerformanceObserver(e=>{Promise.resolve().then(()=>{t(e.getEntries())})});return r.observe({type:e,buffered:!0,...n}),r}}catch{}},Yi=e=>{let t=!1;return()=>{t||(e(),t=!0)}},Qi=e=>{Zs.document?.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},Zi=[1800,3e3],ea=[.1,.25];let ta=0,na=1/0,ra=0;const sa=e=>{e.forEach(e=>{e.interactionId&&(na=Math.min(na,e.interactionId),ra=Math.max(ra,e.interactionId),ta=ra?(ra-na)/7+1:0)})};let oa;const ia=()=>oa?ta:performance.interactionCount||0,aa=()=>{"interactionCount"in performance||oa||(oa=Xi("event",sa,{type:"event",buffered:!0,durationThreshold:0}))};let ca=0;class la{constructor(){la.prototype.__init.call(this),la.prototype.__init2.call(this)}__init(){this._longestInteractionList=[]}__init2(){this._longestInteractionMap=new Map}_resetInteractions(){ca=ia(),this._longestInteractionList.length=0,this._longestInteractionMap.clear()}_estimateP98LongestInteraction(){const e=Math.min(this._longestInteractionList.length-1,Math.floor((ia()-ca)/50));return this._longestInteractionList[e]}_processEntry(e){if(this._onBeforeProcessingEntry?.(e),!e.interactionId&&"first-input"!==e.entryType)return;const t=this._longestInteractionList.at(-1);let n=this._longestInteractionMap.get(e.interactionId);if(n||this._longestInteractionList.length<10||e.duration>t._latency){if(n?e.duration>n._latency?(n.entries=[e],n._latency=e.duration):e.duration===n._latency&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],_latency:e.duration},this._longestInteractionMap.set(n.id,n),this._longestInteractionList.push(n)),this._longestInteractionList.sort((e,t)=>t._latency-e._latency),this._longestInteractionList.length>10){const e=this._longestInteractionList.splice(10);for(const t of e)this._longestInteractionMap.delete(t.id)}this._onAfterProcessingINPCandidate?.(n)}}}const ua=e=>{const t=t=>{"pagehide"!==t.type&&"hidden"!==Zs.document?.visibilityState||e(t)};Bi("visibilitychange",t,!0),Bi("pagehide",t,!0)},da=e=>{const t=Zs.requestIdleCallback||Zs.setTimeout;"hidden"===Zs.document?.visibilityState?e():(Bi("visibilitychange",e=Yi(e),{once:!0,capture:!0}),t(()=>{e(),Ui("visibilitychange",e,{capture:!0})}),ua(e))},pa=[200,500];class ha{_processEntry(e){this._onBeforeProcessingEntry?.(e)}}const fa=[2500,4e3],ma=[800,1800],ga=e=>{Zs.document?.prerendering?Qi(()=>ga(e)):"complete"!==Zs.document?.readyState?addEventListener("load",()=>ga(e),!0):setTimeout(e)},ya={},va={};let ba,_a,Sa,wa;function ka(e,t=!1){return Aa("cls",e,Ca,ba,t)}function xa(e,t=!1){return Aa("lcp",e,Ma,_a,t)}function Ta(e){return Aa("inp",e,Oa,wa)}function Ea(e,t){return Na(e,t),va[e]||(function(e){const t={};"event"===e&&(t.durationThreshold=0),Xi(e,t=>{Ia(e,{entries:t})},t)}(e),va[e]=!0),Da(e,t)}function Ia(e,t){const n=ya[e];if(n?.length)for(const r of n)try{r(t)}catch(t){ni&&j.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${Z(r)}\nError:`,t)}}function Ca(){return((e,t={})=>{((e,t={})=>{Qi(()=>{const n=Wi(),r=Vi("FCP");let s;const o=Xi("paint",e=>{for(const t of e)"first-contentful-paint"===t.name&&(o.disconnect(),t.startTime<n.firstHiddenTime&&(r.value=Math.max(t.startTime-$i(),0),r.entries.push(t),s(!0)))});o&&(s=Fi(e,r,Zi,t.reportAllChanges))})})(Yi(()=>{const n=Vi("CLS",0);let r;const s=Wi(),o=Ki(t,Gi),i=e=>{for(const t of e)o._processEntry(t);o._sessionValue>n.value&&(n.value=o._sessionValue,n.entries=o._sessionEntries,r())},a=Xi("layout-shift",i);a&&(r=Fi(e,n,ea,t.reportAllChanges),s.onHidden(()=>{i(a.takeRecords()),r(!0)}),Zs?.setTimeout?.(r))}))})(e=>{Ia("cls",{metric:e}),ba=e},{reportAllChanges:!0})}function Ma(){return((e,t={})=>{Qi(()=>{const n=Wi(),r=Vi("LCP");let s;const o=Ki(t,ha),i=e=>{t.reportAllChanges||(e=e.slice(-1));for(const t of e)o._processEntry(t),t.startTime<n.firstHiddenTime&&(r.value=Math.max(t.startTime-$i(),0),r.entries=[t],s())},a=Xi("largest-contentful-paint",i);if(a){s=Fi(e,r,fa,t.reportAllChanges);const n=Yi(()=>{i(a.takeRecords()),a.disconnect(),s(!0)}),o=e=>{e.isTrusted&&(da(n),Ui(e.type,o,{capture:!0}))};for(const e of["keydown","click","visibilitychange"])Bi(e,o,{capture:!0})}})})(e=>{Ia("lcp",{metric:e}),_a=e},{reportAllChanges:!0})}function Ra(){return((e,t={})=>{const n=Vi("TTFB"),r=Fi(e,n,ma,t.reportAllChanges);ga(()=>{const e=ji();e&&(n.value=Math.max(e.responseStart-$i(),0),n.entries=[e],r(!0))})})(e=>{Ia("ttfb",{metric:e}),Sa=e})}function Oa(){return((e,t={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const n=Wi();Qi(()=>{aa();const r=Vi("INP");let s;const o=Ki(t,la),i=e=>{da(()=>{for(const t of e)o._processEntry(t);const t=o._estimateP98LongestInteraction();t&&t._latency!==r.value&&(r.value=t._latency,r.entries=t.entries,s())})},a=Xi("event",i,{durationThreshold:t.durationThreshold??40});s=Fi(e,r,pa,t.reportAllChanges),a&&(a.observe({type:"first-input",buffered:!0}),n.onHidden(()=>{i(a.takeRecords()),s(!0)}))})})(e=>{Ia("inp",{metric:e}),wa=e})}function Aa(e,t,n,r,s=!1){let o;return Na(e,t),va[e]||(o=n(),va[e]=!0),r&&t({metric:r}),Da(e,t,s?o:void 0)}function Na(e,t){ya[e]=ya[e]||[],ya[e].push(t)}function Da(e,t,n){return()=>{n&&n();const r=ya[e];if(!r)return;const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}function La(e){return"number"==typeof e&&isFinite(e)}function Pa(e,t,n,{...r}){const s=sn(e).start_timestamp;return s&&s>t&&"function"==typeof e.updateStartTime&&e.updateStartTime(t),xi(e,()=>{const e=wi({startTime:t,...r});return e&&e.end(n),e})}function Fa(e){const t=$e();if(!t)return;const{name:n,transaction:r,attributes:s,startTime:o}=e,{release:i,environment:a,sendDefaultPii:c}=t.getOptions(),l=t.getIntegrationByName("Replay"),u=l?.getReplayId(),d=De(),p=d.getUser(),h=void 0!==p?p.email||p.id||p.ip_address:void 0;let f;try{f=d.getScopeData().contexts.profile.profile_id}catch{}return wi({name:n,attributes:{release:i,environment:a,user:h||void 0,profile_id:f||void 0,replay_id:u||void 0,transaction:r,"user_agent.original":Zs.navigator?.userAgent,"client.address":c?"{{auto}}":void 0,...s},startTime:o,experimental:{standalone:!0}})}function ja(){return Zs.addEventListener&&Zs.performance}function $a(e){return e/1e3}function Ba(e){try{return PerformanceObserver.supportedEntryTypes.includes(e)}catch{return!1}}function Ua(e,t){let n,r=!1;function s(e){!r&&n&&t(e,n),r=!0}ua(()=>{s("pagehide")});const o=e.on("beforeStartNavigationSpan",(e,t)=>{t?.isRedirect||(s("navigation"),o(),i())}),i=e.on("afterStartPageLoadSpan",e=>{n=e.spanContext().spanId,i()})}function Ha(e){return e?((be()||performance.timeOrigin)+e)/1e3:e}function za(e){const t={};if(null!=e.nextHopProtocol){const{name:n,version:r}=function(e){let t="unknown",n="unknown",r="";for(const s of e){if("/"===s){[t,n]=e.split("/");break}if(!isNaN(Number(s))){t="h"===r?"http":r,n=e.split(r)[1];break}r+=s}return r===e&&(t=r),{name:t,version:n}}(e.nextHopProtocol);t["network.protocol.version"]=r,t["network.protocol.name"]=n}return be()||ja()?.timeOrigin?(n={...t,"http.request.redirect_start":Ha(e.redirectStart),"http.request.redirect_end":Ha(e.redirectEnd),"http.request.worker_start":Ha(e.workerStart),"http.request.fetch_start":Ha(e.fetchStart),"http.request.domain_lookup_start":Ha(e.domainLookupStart),"http.request.domain_lookup_end":Ha(e.domainLookupEnd),"http.request.connect_start":Ha(e.connectStart),"http.request.secure_connection_start":Ha(e.secureConnectionStart),"http.request.connection_end":Ha(e.connectEnd),"http.request.request_start":Ha(e.requestStart),"http.request.response_start":Ha(e.responseStart),"http.request.response_end":Ha(e.responseEnd),"http.request.time_to_first_byte":null!=e.responseStart?e.responseStart/1e3:void 0},Object.fromEntries(Object.entries(n).filter(([,e])=>null!=e))):t;var n}let qa,Wa,Va=0,Ja={};function Ka({recordClsStandaloneSpans:e,recordLcpStandaloneSpans:t,client:n}){const r=ja();if(r&&be()){r.mark&&Zs.performance.mark("sentry-tracing-init");const s=t?function(e){let t,n=0;if(!Ba("largest-contentful-paint"))return;const r=xa(({metric:e})=>{const r=e.entries[e.entries.length-1];r&&(n=e.value,t=r)},!0);Ua(e,(e,s)=>{!function(e,t,n,r){ni&&j.log(`Sending LCP span (${e})`);const s=$a((be()||0)+(t?.startTime||0)),o=De().getScopeData().transactionName,i=t?C(t.element):"Largest contentful paint",a={[St]:"auto.http.browser.lcp",[_t]:"ui.webvital.lcp",[It]:0,"sentry.pageload.span_id":n,"sentry.report_event":r};t&&(t.element&&(a["lcp.element"]=C(t.element)),t.id&&(a["lcp.id"]=t.id),t.url&&(a["lcp.url"]=t.url),null!=t.loadTime&&(a["lcp.loadTime"]=t.loadTime),null!=t.renderTime&&(a["lcp.renderTime"]=t.renderTime),null!=t.size&&(a["lcp.size"]=t.size));const c=Fa({name:i,transaction:o,attributes:a,startTime:s});c&&(c.addEvent("lcp",{[kt]:"millisecond",[xt]:e}),c.end(s))}(n,t,s,e),r()})}(n):xa(({metric:e})=>{const t=e.entries[e.entries.length-1];t&&(Ja.lcp={value:e.value,unit:"millisecond"},qa=t)},!0),o=Aa("ttfb",({metric:e})=>{e.entries[e.entries.length-1]&&(Ja.ttfb={value:e.value,unit:"millisecond"})},Ra,Sa),i=e?function(e){let t,n=0;if(!Ba("layout-shift"))return;const r=ka(({metric:e})=>{const r=e.entries[e.entries.length-1];r&&(n=e.value,t=r)},!0);Ua(e,(e,s)=>{!function(e,t,n,r){ni&&j.log(`Sending CLS span (${e})`);const s=t?$a((be()||0)+t.startTime):ve(),o=De().getScopeData().transactionName,i=t?C(t.sources[0]?.node):"Layout shift",a={[St]:"auto.http.browser.cls",[_t]:"ui.webvital.cls",[It]:0,"sentry.pageload.span_id":n,"sentry.report_event":r};t?.sources&&t.sources.forEach((e,t)=>{a[`cls.source.${t+1}`]=C(e.node)});const c=Fa({name:i,transaction:o,attributes:a,startTime:s});c&&(c.addEvent("cls",{[kt]:"",[xt]:e}),c.end(s))}(n,t,s,e),r()})}(n):ka(({metric:e})=>{const t=e.entries[e.entries.length-1];t&&(Ja.cls={value:e.value,unit:""},Wa=t)},!0);return()=>{s?.(),o(),i?.()}}return()=>{}}function Ga(e,t,n,r,s=n){const o=function(e){return"secureConnection"===e?"connectEnd":"fetch"===e?"domainLookupStart":`${e}End`}(n),i=t[o],a=t[`${n}Start`];a&&i&&Pa(e,r+$a(a),r+$a(i),{op:`browser.${s}`,name:t.name,attributes:{[St]:"auto.ui.browser.metrics",..."redirect"===n&&null!=t.redirectCount?{"http.redirect_count":t.redirectCount}:{}}})}function Xa(){return"undefined"!=typeof window&&(!(("undefined"==typeof __SENTRY_BROWSER_BUNDLE__||!__SENTRY_BROWSER_BUNDLE__)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))||function(){const e=c.process;return"renderer"===(null==e?void 0:e.type)}())}const Ya=[],Qa=new Map,Za=new Map;const ec={click:"click",pointerdown:"click",pointerup:"click",mousedown:"click",mouseup:"click",touchstart:"click",touchend:"click",mouseover:"hover",mouseout:"hover",mouseenter:"hover",mouseleave:"hover",pointerover:"hover",pointerout:"hover",pointerenter:"hover",pointerleave:"hover",dragstart:"drag",dragend:"drag",drag:"drag",dragenter:"drag",dragleave:"drag",dragover:"drag",drop:"drag",keydown:"press",keyup:"press",keypress:"press",input:"press"},tc=({metric:e})=>{if(null==e.value)return;const t=$a(e.value);if(t>60)return;const n=e.entries.find(t=>t.duration===e.value&&ec[t.name]);if(!n)return;const{interactionId:r}=n,s=ec[n.name],o=$a(be()+n.startTime),i=hn(),a=i?pn(i):void 0,c=null!=r?Qa.get(r):void 0,l=c?.span||a,u=l?sn(l).description:De().getScopeData().transactionName,d=Fa({name:c?.elementName||C(n.target),transaction:u,attributes:{[St]:"auto.http.browser.inp",[_t]:`ui.interaction.${s}`,[It]:n.duration},startTime:o});d&&(d.addEvent("inp",{[kt]:"millisecond",[xt]:e.value}),d.end(o+t))};const nc=({entries:e})=>{const t=hn(),n=t?pn(t):void 0,r=n?sn(n).description:De().getScopeData().transactionName;e.forEach(e=>{const t=e;if(!t.identifier)return;const n=t.name,s=t.renderTime,o=t.loadTime,[i,a]=o?[$a(o),"load-time"]:s?[$a(s),"render-time"]:[ve(),"entry-emission"],c="image-paint"===n?$a(Math.max(0,(s??0)-(o??0))):0,l={[St]:"auto.ui.browser.elementtiming",[_t]:"ui.elementtiming",[yt]:"component","sentry.span_start_time_source":a,"sentry.transaction_name":r,"element.id":t.id,"element.type":t.element?.tagName?.toLowerCase()||"unknown","element.size":t.naturalWidth&&t.naturalHeight?`${t.naturalWidth}x${t.naturalHeight}`:void 0,"element.render_time":s,"element.load_time":o,"element.url":t.url||void 0,"element.identifier":t.identifier,"element.paint_type":n};_i({name:`element[${t.identifier}]`,attributes:l,startTime:i,onlyIfParent:!0},e=>{e.end(i+c)})})},rc="sentry_previous_trace";function sc(e){return 1===e.traceFlags}function oc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.client||$e();if(!ms()||!t)return{};const n=Ne(l());if(n.getTraceData)return n.getTraceData(e);const r=e.scope||De(),s=e.span||hn(),o=s?en(s):function(e){const{traceId:t,sampled:n,propagationSpanId:r}=e.getPropagationContext();return Kt(t,r,n)}(r),i=Nt(s?_n(s):bn(t,r));if(!Vt.test(o))return j.warn("Invalid sentry-trace data. Cannot generate trace data"),{};const a={"sentry-trace":o,baggage:i};if(e.propagateTraceparent){const e=s?function(e){const{traceId:t,spanId:n}=e.spanContext();return Gt(t,n,on(e))}(s):function(e){const{traceId:t,sampled:n,propagationSpanId:r}=e.getPropagationContext();return Gt(t,r,n)}(r);e&&(a.traceparent=e)}return a}function ic(e){return e.split(",").some(e=>e.trim().startsWith(Mt))}function ac(e,t,n,r){const s={url:e,type:"fetch","http.method":n,[St]:r,[_t]:"http.client"};return t&&(Ks(t)||(s["http.url"]=t.href,s["server.address"]=t.host),t.search&&(s["http.query"]=t.search),t.hash&&(s["http.fragment"]=t.hash)),s}function cc(e){return new URLSearchParams(e).toString()}function lc(e,t=j){try{if("string"==typeof e)return[e];if(e instanceof URLSearchParams)return[e.toString()];if(e instanceof FormData)return[cc(e)];if(!e)return[void 0]}catch(n){return ni&&t.error(n,"Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return ni&&t.log("Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}function uc(e=[]){if(2===e.length&&"object"==typeof e[1])return e[1].body}function dc(e){let t;try{t=e.getAllResponseHeaders()}catch(t){return ni&&j.error(t,"Failed to get xhr response headers",e),{}}return t?t.split("\r\n").reduce((e,t)=>{const[n,r]=t.split(": ");return r&&(e[n.toLowerCase()]=r),e},{}):{}}function pc(e){try{return new URL(e,Ss.location.origin).href}catch{return}}function hc(e){try{return new Headers(e)}catch{return}}const fc=new WeakMap,mc=new Map,gc={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,trackFetchStreamPerformance:!1};function yc(e,t){const{traceFetch:n,traceXHR:r,trackFetchStreamPerformance:s,shouldCreateSpanForRequest:o,enableHTTPTimings:i,tracePropagationTargets:a,onRequestSpanStart:c,onRequestSpanEnd:l}={...gc,...t},u="function"==typeof o?o:e=>!0,d=e=>function(e,t){const n=R();if(n){let r,s;try{r=new URL(e,n),s=new URL(n).origin}catch{return!1}const o=r.origin===s;return t?ie(r.toString(),t)||o&&ie(r.pathname,t):o}{const n=!!e.match(/^\/(?!\/)/);return t?ie(e,t):n}}(e,a),p={},h=e.getOptions().propagateTraceparent;n&&(e.addEventProcessor(e=>("transaction"===e.type&&e.spans&&e.spans.forEach(e=>{if("http.client"===e.op){const t=mc.get(e.span_id);t&&(e.timestamp=t/1e3,mc.delete(e.span_id))}}),e)),s&&function(){const e="fetch-body-resolved";Ms(e,e=>{if(e.response){const t=fc.get(e.response);t&&e.endTimestamp&&mc.set(t,e.endTimestamp)}}),Rs(e,()=>js($s))}(),Fs(e=>{const t=function(e,t,n,r,s){if(!e.fetchData)return;const{method:o,url:i}=e.fetchData,a=Lt()&&t(i);if(e.endTimestamp&&a){const t=e.fetchData.__span;if(!t)return;const n=r[t];return void(n&&(function(e,t){if(t.response){var n;Bt(e,t.response.status);const r=null===(n=t.response)||void 0===n||null===(n=n.headers)||void 0===n?void 0:n.get("content-length");if(r){const t=parseInt(r);t>0&&e.setAttribute("http.response_content_length",t)}}else t.error&&e.setStatus({code:jt,message:"internal_error"});e.end()}(n,e),function(e,t,n){var r;const s="object"==typeof n&&null!==n?n.onRequestSpanEnd:void 0;null==s||s(e,{headers:null===(r=t.response)||void 0===r?void 0:r.headers,error:t.error})}(n,e,s),delete r[t]))}const{spanOrigin:c="auto.http.browser",propagateTraceparent:l=!1}="object"==typeof s?s:{spanOrigin:s},u=!!hn(),d=a&&u?wi(function(e,t,n){const r=Gs(e);return{name:r?`${t} ${Xs(r)}`:t,attributes:ac(e,r,t,n)}}(i,o,c)):new pi;if(e.fetchData.__span=d.spanContext().spanId,r[d.spanContext().spanId]=d,n(e.fetchData.url)){const t=e.args[0],n=e.args[1]||{},r=function(e,t,n,r){const s=oc({span:n,propagateTraceparent:r}),o=s["sentry-trace"],i=s.baggage,a=s.traceparent;if(!o)return;const c=t.headers||(T(e)?e.headers:void 0);if(c){if(function(e){return"undefined"!=typeof Headers&&k(e,Headers)}(c)){const e=new Headers(c);if(e.get("sentry-trace")||e.set("sentry-trace",o),r&&a&&!e.get("traceparent")&&e.set("traceparent",a),i){const t=e.get("baggage");t?ic(t)||e.set("baggage",`${t},${i}`):e.set("baggage",i)}return e}if(Array.isArray(c)){const e=[...c];c.find(e=>"sentry-trace"===e[0])||e.push(["sentry-trace",o]),r&&a&&!c.find(e=>"traceparent"===e[0])&&e.push(["traceparent",a]);const t=c.find(e=>"baggage"===e[0]&&ic(e[1]));return i&&!t&&e.push(["baggage",i]),e}{const e="sentry-trace"in c?c["sentry-trace"]:void 0,t="traceparent"in c?c.traceparent:void 0,n="baggage"in c?c.baggage:void 0,s=n?Array.isArray(n)?[...n]:[n]:[],l=n&&(Array.isArray(n)?n.find(e=>ic(e)):ic(n));i&&!l&&s.push(i);const u={...c,"sentry-trace":e??o,baggage:s.length>0?s.join(","):void 0};return r&&a&&!t&&(u.traceparent=a),u}}return{...s}}(t,n,Lt()&&u?d:void 0,l);r&&(e.args[1]=n,n.headers=r)}const p=$e();if(p){const t={input:e.args,response:e.response,startTimestamp:e.startTimestamp,endTimestamp:e.endTimestamp};p.emit("beforeOutgoingRequestSpan",d,t)}return d}(e,u,d,p,{propagateTraceparent:h,onRequestSpanEnd:l});if(e.response&&e.fetchData.__span&&fc.set(e.response,e.fetchData.__span),t){const n=pc(e.fetchData.url),r=n?Ys(n).host:void 0;t.setAttributes({"http.url":n,"server.address":r}),i&&vc(t),null==c||c(t,{headers:e.headers})}})),r&&ao(e=>{const t=function(e,t,n,r,s,o){const i=e.xhr,a=null==i?void 0:i[io];if(!i||i.__sentry_own_request__||!a)return;const{url:c,method:l}=a,u=Lt()&&t(c);if(e.endTimestamp&&u){const t=i.__sentry_xhr_span_id__;if(!t)return;const n=r[t];return void(n&&void 0!==a.status_code&&(Bt(n,a.status_code),n.end(),null==o||o(n,{headers:hc(dc(i)),error:e.error}),delete r[t]))}const d=pc(c),p=Ys(d||c),h=Qs(c),f=!!hn(),m=u&&f?wi({name:`${l} ${h}`,attributes:{url:c,type:"xhr","http.method":l,"http.url":d,"server.address":null==p?void 0:p.host,[St]:"auto.http.browser",[_t]:"http.client",...(null==p?void 0:p.search)&&{"http.query":null==p?void 0:p.search},...(null==p?void 0:p.hash)&&{"http.fragment":null==p?void 0:p.hash}}}):new pi;i.__sentry_xhr_span_id__=m.spanContext().spanId,r[i.__sentry_xhr_span_id__]=m,n(c)&&function(e,t,n){const{"sentry-trace":r,baggage:s,traceparent:o}=oc({span:t,propagateTraceparent:n});r&&function(e,t,n,r){var s;const o=null===(s=e.__sentry_xhr_v3__)||void 0===s?void 0:s.request_headers;if((null==o||!o["sentry-trace"])&&e.setRequestHeader)try{if(e.setRequestHeader("sentry-trace",t),!r||null!=o&&o.traceparent||e.setRequestHeader("traceparent",r),n){const t=null==o?void 0:o.baggage;t&&t.split(",").some(e=>e.trim().startsWith("sentry-"))||e.setRequestHeader("baggage",n)}}catch{}}(e,r,s,o)}(i,Lt()&&f?m:void 0,s);const g=$e();return g&&g.emit("beforeOutgoingRequestSpan",m,e),m}(e,u,d,p,h,l);var n;t&&(i&&vc(t),null==c||c(t,{headers:hc(null===(n=e.xhr.__sentry_xhr_v3__)||void 0===n?void 0:n.request_headers)}))})}function vc(e){const{url:t}=sn(e).data;if(!t||"string"!=typeof t)return;const n=Ea("resource",r=>{let{entries:s}=r;s.forEach(r=>{(function(e){return"resource"===e.entryType&&"initiatorType"in e&&"string"==typeof e.nextHopProtocol&&("fetch"===e.initiatorType||"xmlhttprequest"===e.initiatorType)})(r)&&r.name.endsWith(t)&&(e.setAttributes(za(r)),setTimeout(n))})})}const bc={...Ni,instrumentNavigation:!0,instrumentPageLoad:!0,markBackgroundSpan:!0,enableLongTask:!0,enableLongAnimationFrame:!0,enableInp:!0,enableElementTiming:!0,ignoreResourceSpans:[],ignorePerformanceApiSpans:[],detectRedirects:!0,linkPreviousTrace:"in-memory",consistentTraceSampling:!1,enableReportPageLoaded:!1,_experiments:{},...gc},_c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={name:void 0,source:void 0},n=Ss.document,{enableInp:r,enableElementTiming:s,enableLongTask:o,enableLongAnimationFrame:i,_experiments:{enableInteractions:a,enableStandaloneClsSpans:l,enableStandaloneLcpSpans:u},beforeStartSpan:d,idleTimeout:p,finalTimeout:h,childSpanTimeout:f,markBackgroundSpan:m,traceFetch:g,traceXHR:y,trackFetchStreamPerformance:v,shouldCreateSpanForRequest:_,enableHTTPTimings:S,ignoreResourceSpans:w,ignorePerformanceApiSpans:k,instrumentPageLoad:x,instrumentNavigation:T,detectRedirects:E,linkPreviousTrace:I,consistentTraceSampling:M,enableReportPageLoaded:A,onRequestSpanStart:N,onRequestSpanEnd:D}={...bc,...e};let L,P,F;function $(e,r){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o="pageload"===r.op,i=r.name,a=d?d(r):r,c=a.attributes||{};if(i!==a.name&&(c[yt]="custom",a.attributes=c),!s){const e=me();return void wi({...a,startTime:e}).end(e)}t.name=a.name,t.source=c[yt];const m=Di(a,{idleTimeout:p,finalTimeout:h,childSpanTimeout:f,disableAutoFinish:o,beforeSpanEnd:t=>{var n;null===(n=L)||void 0===n||n(),function(e,t){const n=ja(),r=be();if(!n?.getEntries||!r)return;const s=$a(r),o=n.getEntries(),{op:i,start_timestamp:a}=sn(e);o.slice(Va).forEach(n=>{const r=$a(n.startTime),o=$a(Math.max(0,n.duration));if(!("navigation"===i&&a&&s+r<a))switch(n.entryType){case"navigation":!function(e,t,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(r=>{Ga(e,t,r,n)}),Ga(e,t,"secureConnection",n,"TLS/SSL"),Ga(e,t,"fetch",n,"cache"),Ga(e,t,"domainLookup",n,"DNS"),function(e,t,n){const r=n+$a(t.requestStart),s=n+$a(t.responseEnd),o=n+$a(t.responseStart);t.responseEnd&&(Pa(e,r,s,{op:"browser.request",name:t.name,attributes:{[St]:"auto.ui.browser.metrics"}}),Pa(e,o,s,{op:"browser.response",name:t.name,attributes:{[St]:"auto.ui.browser.metrics"}}))}(e,t,n)}(e,n,s);break;case"mark":case"paint":case"measure":{!function(e,t,n,r,s,o){if(function(e){if("measure"===e?.entryType)try{return"Components â"===e.detail.devtools.track}catch{return}}(t))return;if(["mark","measure"].includes(t.entryType)&&ie(t.name,o))return;const i=ji(!1),a=$a(i?i.requestStart:0),c=s+Math.max(n,a),l=s+n,u=l+r,d={[St]:"auto.resource.browser.metrics"};c!==l&&(d["sentry.browser.measure_happened_before_request"]=!0,d["sentry.browser.measure_start_time"]=c),function(e,t){try{const n=t.detail;if(!n)return;if("object"==typeof n){for(const[t,r]of Object.entries(n))if(r&&b(r))e[`sentry.browser.measure.detail.${t}`]=r;else if(void 0!==r)try{e[`sentry.browser.measure.detail.${t}`]=JSON.stringify(r)}catch{}return}if(b(n))return void(e["sentry.browser.measure.detail"]=n);try{e["sentry.browser.measure.detail"]=JSON.stringify(n)}catch{}}catch{}}(d,t),c<=u&&Pa(e,c,u,{name:t.name,op:t.entryType,attributes:d})}(e,n,r,o,s,t.ignorePerformanceApiSpans);const i=Wi(),a=n.startTime<i.firstHiddenTime;"first-paint"===n.name&&a&&(Ja.fp={value:n.startTime,unit:"millisecond"}),"first-contentful-paint"===n.name&&a&&(Ja.fcp={value:n.startTime,unit:"millisecond"});break}case"resource":!function(e,t,n,r,s,o,i){if("xmlhttprequest"===t.initiatorType||"fetch"===t.initiatorType)return;const a=t.initiatorType?`resource.${t.initiatorType}`:"resource.other";if(i?.includes(a))return;const c={[St]:"auto.resource.browser.metrics"},l=Ys(n);l.protocol&&(c["url.scheme"]=l.protocol.split(":").pop()),l.host&&(c["server.address"]=l.host),c["url.same_origin"]=n.includes(Zs.location.origin),function(e,t){[["responseStatus","http.response.status_code"],["transferSize","http.response_transfer_size"],["encodedBodySize","http.response_content_length"],["decodedBodySize","http.decoded_response_content_length"],["renderBlockingStatus","resource.render_blocking_status"],["deliveryType","http.response_delivery_type"]].forEach(([n,r])=>{const s=e[n];null!=s&&("number"==typeof s&&s<2147483647||"string"==typeof s)&&(t[r]=s)})}(t,c);const u={...c,...za(t)},d=o+r;Pa(e,d,d+s,{name:n.replace(Zs.location.origin,""),op:a,attributes:u})}(e,n,n.name,r,o,s,t.ignoreResourceSpans)}}),Va=Math.max(o.length-1,0),function(e){const t=Zs.navigator;if(!t)return;const n=t.connection;n&&(n.effectiveType&&e.setAttribute("effectiveConnectionType",n.effectiveType),n.type&&e.setAttribute("connectionType",n.type),La(n.rtt)&&(Ja["connection.rtt"]={value:n.rtt,unit:"millisecond"})),La(t.deviceMemory)&&e.setAttribute("deviceMemory",`${t.deviceMemory} GB`),La(t.hardwareConcurrency)&&e.setAttribute("hardwareConcurrency",String(t.hardwareConcurrency))}(e),"pageload"===i&&(function(e){const t=ji(!1);if(!t)return;const{responseStart:n,requestStart:r}=t;r<=n&&(e["ttfb.requestTime"]={value:n-r,unit:"millisecond"})}(Ja),t.recordClsOnPageloadSpan||delete Ja.cls,t.recordLcpOnPageloadSpan||delete Ja.lcp,Object.entries(Ja).forEach(([e,t])=>{hi(e,t.value,t.unit)}),e.setAttribute("performance.timeOrigin",s),e.setAttribute("performance.activationStart",$i()),function(e,t){qa&&t.recordLcpOnPageloadSpan&&(qa.element&&e.setAttribute("lcp.element",C(qa.element)),qa.id&&e.setAttribute("lcp.id",qa.id),qa.url&&e.setAttribute("lcp.url",qa.url.trim().slice(0,200)),null!=qa.loadTime&&e.setAttribute("lcp.loadTime",qa.loadTime),null!=qa.renderTime&&e.setAttribute("lcp.renderTime",qa.renderTime),e.setAttribute("lcp.size",qa.size)),Wa?.sources&&t.recordClsOnPageloadSpan&&Wa.sources.forEach((t,n)=>e.setAttribute(`cls.source.${n+1}`,C(t.node)))}(e,t)),qa=void 0,Wa=void 0,Ja={}}(t,{recordClsOnPageloadSpan:!l,recordLcpOnPageloadSpan:!u,ignoreResourceSpans:w,ignorePerformanceApiSpans:k}),Ec(e,void 0);const r=De(),s=r.getPropagationContext();r.setPropagationContext({...s,traceId:m.spanContext().traceId,sampled:on(m),dsc:_n(t)}),o&&(F=void 0)},trimIdleSpanEndTimestamp:!A});function g(){n&&["interactive","complete"].includes(n.readyState)&&e.emit("idleSpanEnableAutoFinish",m)}o&&A&&(F=m),Ec(e,m),o&&!A&&n&&(n.addEventListener("readystatechange",()=>{g()}),g())}return{name:"BrowserTracing",setup(e){if(Pi(),L=Ka({recordClsStandaloneSpans:l||!1,recordLcpStandaloneSpans:u||!1,client:e}),r&&function(){if(ja()&&be()){const e=Ta(tc);return()=>{e()}}}(),s&&ja()&&be()&&Ea("element",nc),i&&c.PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("long-animation-frame")?new PerformanceObserver(e=>{const t=hn();if(t)for(const n of e.getEntries()){if(!n.scripts[0])continue;const e=$a(be()+n.startTime),{start_timestamp:r,op:s}=sn(t);if("navigation"===s&&r&&e<r)continue;const o=$a(n.duration),i={[St]:"auto.ui.browser.metrics"},a=n.scripts[0],{invoker:c,invokerType:l,sourceURL:u,sourceFunctionName:d,sourceCharPosition:p}=a;i["browser.script.invoker"]=c,i["browser.script.invoker_type"]=l,u&&(i["code.filepath"]=u),d&&(i["code.function"]=d),-1!==p&&(i["browser.script.source_char_position"]=p),Pa(t,e,e+o,{name:"Main UI thread blocked",op:"ui.long-animation-frame",attributes:i})}}).observe({type:"long-animation-frame",buffered:!0}):o&&Ea("longtask",({entries:e})=>{const t=hn();if(!t)return;const{op:n,start_timestamp:r}=sn(t);for(const s of e){const e=$a(be()+s.startTime),o=$a(s.duration);"navigation"===n&&r&&e<r||Pa(t,e,e+o,{name:"Main UI thread blocked",op:"ui.long-task",attributes:{[St]:"auto.ui.browser.metrics"}})}}),a&&Ea("event",({entries:e})=>{const t=hn();if(t)for(const n of e)if("click"===n.name){const e=$a(be()+n.startTime),r=$a(n.duration),s={name:C(n.target),op:`ui.interaction.${n.name}`,startTime:e,attributes:{[St]:"auto.ui.browser.metrics"}},o=O(n.target);o&&(s.attributes["ui.component_name"]=o),Pa(t,e,e+r,s)}}),E&&n){const e=()=>{P=ve()};addEventListener("click",e,{capture:!0}),addEventListener("keydown",e,{capture:!0,passive:!0})}function t(){const t=Tc(e);t&&!sn(t).timestamp&&(ho&&j.log(`[Tracing] Finishing current active span with op: ${sn(t).op}`),t.setAttribute(wt,"cancelled"),t.end())}e.on("startNavigationSpan",(n,r)=>{if($e()!==e)return;if(null!=r&&r.isRedirect)return ho&&j.warn("[Tracing] Detected redirect, navigation span will not be the root span, but a child span."),void $(e,{op:"navigation.redirect",...n},!1);P=void 0,t(),Le().setPropagationContext({traceId:we(),sampleRand:Math.random(),propagationSpanId:Lt()?void 0:ke()});const s=De();s.setPropagationContext({traceId:we(),sampleRand:Math.random(),propagationSpanId:Lt()?void 0:ke()}),s.setSDKProcessingMetadata({normalizedRequest:void 0}),$(e,{op:"navigation",...n,parentSpan:null,forceTransaction:!0})}),e.on("startPageLoadSpan",function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if($e()!==e)return;t();const s=Jt(r.sentryTrace||kc("sentry-trace"),r.baggage||kc("baggage")),o=De();o.setPropagationContext(s),Lt()||(o.getPropagationContext().propagationSpanId=ke()),o.setSDKProcessingMetadata({normalizedRequest:Ts()}),$(e,{op:"pageload",...n})}),e.on("endPageloadSpan",()=>{A&&F&&(F.setAttribute(wt,"reportPageLoaded"),F.end())})},afterAllSetup(e){let n=R();if("off"!==I&&function(e,t){let{linkPreviousTrace:n,consistentTraceSampling:r}=t;const s="session-storage"===n;let o=s?function(){try{var e;const t=null===(e=Ss.sessionStorage)||void 0===e?void 0:e.getItem(rc);return JSON.parse(t)}catch{return}}():void 0;e.on("spanStart",e=>{if(pn(e)!==e)return;const t=De().getPropagationContext();o=function(e,t,n){const r=sn(t),s={spanContext:t.spanContext(),startTimestamp:r.start_timestamp,sampleRate:function(){try{var e,t;return Number(null===(e=n.dsc)||void 0===e?void 0:e.sample_rate)??Number(null===(t=r.data)||void 0===t?void 0:t[vt])}catch{return 0}}(),sampleRand:n.sampleRand};if(!e)return s;const o=e.spanContext;return o.traceId===r.trace_id?e:(Date.now()/1e3-e.startTimestamp<=3600&&(ho&&j.log(`Adding previous_trace ${o} link to span ${{op:r.op,...t.spanContext()}}`),t.addLink({context:o,attributes:{[Ct]:"previous_trace"}}),t.setAttribute("sentry.previous_trace",`${o.traceId}-${o.spanId}-${sc(o)?1:0}`)),s)}(o,e,t),s&&function(e){try{Ss.sessionStorage.setItem(rc,JSON.stringify(e))}catch(e){ho&&j.warn("Could not store previous trace in sessionStorage",e)}}(o)});let i=!0;r&&e.on("beforeSampling",e=>{if(!o)return;const t=De(),n=t.getPropagationContext();i&&n.parentSpanId?i=!1:(t.setPropagationContext({...n,dsc:{...n.dsc,sample_rate:String(o.sampleRate),sampled:String(sc(o.spanContext))},sampleRand:o.sampleRand}),e.parentSampled=sc(o.spanContext),e.parentSampleRate=o.sampleRate,e.spanAttributes={...e.spanAttributes,[bt]:o.sampleRate})})}(e,{linkPreviousTrace:I,consistentTraceSampling:M}),Ss.location){if(x){const t=be();Sc(e,{name:Ss.location.pathname,startTime:t?t/1e3:void 0,attributes:{[yt]:"url",[St]:"auto.pageload.browser"}})}T&&uo(t=>{var r;let{to:s,from:o}=t;if(void 0===o&&-1!==(null===(r=n)||void 0===r?void 0:r.indexOf(s)))return void(n=void 0);n=void 0;const i=Gs(s),a=Tc(e),c=a&&E&&function(e,t){const n=sn(e),r=me();return!(r-n.start_timestamp>Ic)&&!(t&&r-t<=Ic)}(a,P);wc(e,{name:(null==i?void 0:i.pathname)||Ss.location.pathname,attributes:{[yt]:"url",[St]:"auto.navigation.browser"}},{url:s,isRedirect:c})})}m&&(Ss.document?Ss.document.addEventListener("visibilitychange",()=>{const e=hn();if(!e)return;const t=pn(e);if(Ss.document.hidden&&t){const e="cancelled",{op:n,status:r}=sn(t);ho&&j.log(`[Tracing] Transaction: ${e} -> since tab moved to the background, op: ${n}`),r||t.setStatus({code:jt,message:e}),t.setAttribute("sentry.cancellation_reason","document.hidden"),t.end()}}):ho&&j.warn("[Tracing] Could not set up background tab detection due to lack of global document")),a&&function(e,t,n,r,s){let o;Ss.document&&addEventListener("click",()=>{const i="ui.action.click",a=Tc(e);if(a){const e=sn(a).op;if(["navigation","pageload"].includes(e))return void(ho&&j.warn(`[Tracing] Did not create ${i} span because a pageload or navigation span is in progress.`))}o&&(o.setAttribute(wt,"interactionInterrupted"),o.end(),o=void 0),s.name?o=Di({name:s.name,op:i,attributes:{[yt]:s.source||"url"}},{idleTimeout:t,finalTimeout:n,childSpanTimeout:r}):ho&&j.warn(`[Tracing] Did not create ${i} transaction because _latestRouteName is missing.`)},{capture:!0})}(e,p,h,f,t),r&&function(){const e=Object.keys(ec);function t(e){const t=e.target;if(!t)return;const n=C(t),r=Math.round(e.timeStamp);if(Za.set(r,n),Za.size>50){const e=Za.keys().next().value;void 0!==e&&Za.delete(e)}}Xa()&&e.forEach(e=>{Zs.addEventListener(e,t,{capture:!0,passive:!0})});const n=({entries:e})=>{const t=hn(),n=t&&pn(t);e.forEach(e=>{if(!function(e){return"duration"in e}(e))return;const t=e.interactionId;if(null==t)return;if(Qa.has(t))return;const r=e.target?C(e.target):function(e){const t=Math.round(e.startTime);let n=Za.get(t);if(!n)for(let e=-5;e<=5;e++){const r=Za.get(t+e);if(r){n=r;break}}return n||"<unknown>"}(e);if(Ya.length>10){const e=Ya.shift();Qa.delete(e)}Ya.push(t),Qa.set(t,{span:n,elementName:r})})};Ea("event",n),Ea("first-input",n)}(),yc(e,{traceFetch:g,traceXHR:y,trackFetchStreamPerformance:v,tracePropagationTargets:e.getOptions().tracePropagationTargets,shouldCreateSpanForRequest:_,enableHTTPTimings:S,onRequestSpanStart:N,onRequestSpanEnd:D})}}};function Sc(e,t,n){e.emit("startPageLoadSpan",t,n),De().setTransactionName(t.name);const r=Tc(e);return r&&e.emit("afterStartPageLoadSpan",r),r}function wc(e,t,n){const{url:r,isRedirect:s}=n||{};e.emit("beforeStartNavigationSpan",t,{isRedirect:s}),e.emit("startNavigationSpan",t,{isRedirect:s});const o=De();return o.setTransactionName(t.name),r&&!s&&o.setSDKProcessingMetadata({normalizedRequest:{...Ts(),url:r}}),Tc(e)}function kc(e){const t=Ss.document,n=null==t?void 0:t.querySelector(`meta[name=${e}]`);return(null==n?void 0:n.getAttribute("content"))||void 0}const xc="_sentry_idleSpan";function Tc(e){return e[xc]}function Ec(e,t){B(e,xc,t)}const Ic=1.5;var Cc;const Mc=1e6,Rc="window"in c&&c.window===c&&"undefined"==typeof importScripts,Oc=String(0),Ac=Rc?"main":"worker",Nc=Ss.navigator;let Dc="",Lc="",Pc="",Fc=(null==Nc?void 0:Nc.userAgent)||"",jc="";const $c=(null==Nc?void 0:Nc.language)||(null==Nc||null===(Cc=Nc.languages)||void 0===Cc?void 0:Cc[0])||"",Bc=null==Nc?void 0:Nc.userAgentData;var Uc;function Hc(e,t,n,r){if("transaction"!==r.type)throw new TypeError("Profiling events may only be attached to transactions, this should never occur.");if(null==n)throw new TypeError(`Cannot construct profiling event envelope without a valid profile. Got ${n} instead.`);const s=function(e){var t;const n=null===(t=e.contexts)||void 0===t||null===(t=t.trace)||void 0===t?void 0:t.trace_id;return"string"==typeof n&&32!==n.length&&ho&&j.log(`[Profiling] Invalid traceId: ${n} on profiled event`),"string"!=typeof n?"":n}(r),o=function(e){return!("thread_metadata"in e)}(c=n)?function(e){let t,n=0;const r={samples:[],stacks:[],frames:[],thread_metadata:{[Oc]:{name:Ac}}},s=e.samples[0];if(!s)return r;const o=s.timestamp,i=be(),a="number"==typeof performance.timeOrigin?performance.timeOrigin:i||0,c=a-(i||a);return e.samples.forEach((s,i)=>{if(void 0===s.stackId)return void 0===t&&(t=n,r.stacks[t]=[],n++),void(r.samples[i]={elapsed_since_start_ns:((s.timestamp+c-o)*Mc).toFixed(0),stack_id:t,thread_id:Oc});let a=e.stacks[s.stackId];const l=[];for(;a;){l.push(a.frameId);const t=e.frames[a.frameId];t&&void 0===r.frames[a.frameId]&&(r.frames[a.frameId]={function:t.name,abs_path:"number"==typeof t.resourceId?e.resources[t.resourceId]:void 0,lineno:t.line,colno:t.column}),a=void 0===a.parentId?void 0:e.stacks[a.parentId]}const u={elapsed_since_start_ns:((s.timestamp+c-o)*Mc).toFixed(0),stack_id:n,thread_id:Oc};r.stacks[n]=l,r.samples[i]=u,n++}),r}(c):c,i=t||("number"==typeof r.start_timestamp?1e3*r.start_timestamp:1e3*ve()),a="number"==typeof r.timestamp?1e3*r.timestamp:1e3*ve();var c;return{event_id:e,timestamp:new Date(i).toISOString(),platform:"javascript",version:"1",release:r.release||"",environment:r.environment||gt,runtime:{name:"javascript",version:Ss.navigator.userAgent},os:{name:Dc,version:Lc,build_number:Fc},device:{locale:$c,model:jc,manufacturer:Fc,architecture:Pc,is_emulator:!1},debug_meta:{images:qc(n.resources)},profile:o,transactions:[{name:r.transaction||"",id:r.event_id||ce(),trace_id:s,active_thread_id:Oc,relative_start_ns:"0",relative_end_ns:(1e6*(a-i)).toFixed(0)}]}}function zc(e){return"pageload"===sn(e).op}function qc(e){const t=$e(),n=null==t?void 0:t.getOptions(),r=null==n?void 0:n.stackParser;return r?function(e,t){const n=kr(e);if(!n)return[];const r=[];for(const e of t)e&&n[e]&&r.push({type:"sourcemap",code_file:e,debug_id:n[e]});return r}(r,e):[]}function Wc(e){return"number"!=typeof e&&"boolean"!=typeof e||"number"==typeof e&&isNaN(e)?(ho&&j.warn(`[Profiling] Invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`),!1):!0===e||!1===e||!(e<0||e>1)||(ho&&j.warn(`[Profiling] Invalid sample rate. Sample rate must be between 0 and 1. Got ${e}.`),!1)}"object"==typeof(Uc=Bc)&&null!==Uc&&"getHighEntropyValues"in Uc&&Bc.getHighEntropyValues(["architecture","model","platform","platformVersion","fullVersionList"]).then(e=>{var t;if(Dc=e.platform||"",Pc=e.architecture||"",jc=e.model||"",Lc=e.platformVersion||"",null!==(t=e.fullVersionList)&&void 0!==t&&t.length){const t=e.fullVersionList[e.fullVersionList.length-1];Fc=`${t.brand} ${t.version}`}}).catch(e=>{});let Vc=!1;function Jc(){const e=Ss.Profiler;if("function"!=typeof e)return void(ho&&j.log("[Profiling] Profiling is not supported by this browser, Profiler interface missing on window object."));const t=Math.floor(3e3);try{return new e({sampleInterval:10,maxBufferSize:t})}catch(e){ho&&(j.log("[Profiling] Failed to initialize the Profiling constructor, this is likely due to a missing 'Document-Policy': 'js-profiling' header."),j.log("[Profiling] Disabling profiling for current user session.")),Vc=!0}}function Kc(e){if(Vc)return ho&&j.log("[Profiling] Profiling has been disabled for the duration of the current user session."),!1;if(!e.isRecording())return ho&&j.log("[Profiling] Discarding profile because root span was not sampled."),!1;const t=$e(),n=null==t?void 0:t.getOptions();if(!n)return ho&&j.log("[Profiling] Profiling disabled, no options found."),!1;const r=n.profilesSampleRate;return Wc(r)?r?!!(!0===r||Math.random()<r)||(ho&&j.log(`[Profiling] Discarding profile because it's not included in the random sample (sampling rate = ${Number(r)})`),!1):(ho&&j.log("[Profiling] Discarding profile because a negative sampling decision was inherited or profileSampleRate is set to 0"),!1):(ho&&j.warn("[Profiling] Discarding profile because of invalid sample rate."),!1)}function Gc(e){return void 0!==e.profilesSampleRate}function Xc(e,t,n,r){return function(e){return e.samples.length<2?(ho&&j.log("[Profiling] Discarding profile because it contains less than 2 samples"),!1):!!e.frames.length||(ho&&j.log("[Profiling] Discarding profile because it contains no frames"),!1)}(n)?Hc(e,t,n,r):null}const Yc=new Map;function Qc(e){const t=Yc.get(e);return t&&Yc.delete(e),t}function Zc(e){let t;zc(e)&&(t=1e3*ve());const n=Jc();if(!n)return;ho&&j.log(`[Profiling] started profiling span: ${sn(e).description}`);const r=ce();let s=null;async function o(){if(e&&n){if(!s)return n.stop().then(t=>{i&&(Ss.clearTimeout(i),i=void 0),ho&&j.log(`[Profiling] stopped profiling of span: ${sn(e).description}`),t?(s=t,function(e,t){if(Yc.set(e,t),Yc.size>30){const e=Yc.keys().next().value;void 0!==e&&Yc.delete(e)}}(r,t)):ho&&j.log(`[Profiling] profiler returned null profile for: ${sn(e).description}`,"this may indicate an overlapping span or a call to stopProfiling with a profile title that was never started")}).catch(e=>{ho&&j.log("[Profiling] error while stopping profiler:",e)});ho&&j.log("[Profiling] profile for:",sn(e).description,"already exists, returning early")}}De().setContext("profile",{profile_id:r,start_timestamp:t});let i=Ss.setTimeout(()=>{ho&&j.log("[Profiling] max profile duration elapsed, stopping profiling for:",sn(e).description),o()},3e4);const a=e.end.bind(e);e.end=function(){return e?(o().then(()=>{a()},()=>{a()}),e):a()}}class el{constructor(){this._client=void 0,this._profiler=void 0,this._chunkTimer=void 0,this._profilerId=void 0,this._isRunning=!1,this._sessionSampled=!1,this._lifecycleMode=void 0,this._activeRootSpanIds=new Set,this._rootSpanTimeouts=new Map}initialize(e){const t=e.getOptions().profileLifecycle,n=function(e){if(Vc)return ho&&j.log("[Profiling] Profiling has been disabled for the duration of the current user session as the JS Profiler could not be started."),!1;if("trace"!==e.profileLifecycle&&"manual"!==e.profileLifecycle)return ho&&j.warn("[Profiling] Session not sampled. Invalid `profileLifecycle` option."),!1;const t=e.profileSessionSampleRate;return Wc(t)?t?Math.random()<=t:(ho&&j.log("[Profiling] Discarding profile because profileSessionSampleRate is not defined or set to 0"),!1):(ho&&j.warn("[Profiling] Discarding profile because of invalid profileSessionSampleRate."),!1)}(e.getOptions());ho&&j.log(`[Profiling] Initializing profiler (lifecycle='${t}').`),n||ho&&j.log("[Profiling] Session not sampled. Skipping lifecycle profiler initialization."),this._profilerId=ce(),this._client=e,this._sessionSampled=n,this._lifecycleMode=t,"trace"===t&&this._setupTraceLifecycleListeners(e)}start(){"trace"!==this._lifecycleMode?this._isRunning?ho&&j.warn("[Profiling] Profile session is already running, `uiProfiler.start()` is a no-op."):this._sessionSampled?this._beginProfiling():ho&&j.warn("[Profiling] Session is not sampled, `uiProfiler.start()` is a no-op."):ho&&j.warn('[Profiling] `profileLifecycle` is set to "trace". Calls to `uiProfiler.start()` are ignored in trace mode.')}stop(){"trace"!==this._lifecycleMode?this._isRunning?this._endProfiling():ho&&j.warn("[Profiling] Profiler is not running, `uiProfiler.stop()` is a no-op."):ho&&j.warn('[Profiling] `profileLifecycle` is set to "trace". Calls to `uiProfiler.stop()` are ignored in trace mode.')}notifyRootSpanActive(e){if("trace"!==this._lifecycleMode||!this._sessionSampled)return;const t=e.spanContext().spanId;if(!t||this._activeRootSpanIds.has(t))return;this._registerTraceRootSpan(t);const n=this._activeRootSpanIds.size;1===n&&(ho&&j.log("[Profiling] Detected already active root span during setup. Active root spans now:",n),this._beginProfiling())}_beginProfiling(){if(!this._isRunning){if(this._isRunning=!0,ho&&j.log("[Profiling] Started profiling with profiler ID:",this._profilerId),Pe().setContext("profile",{profiler_id:this._profilerId}),this._startProfilerInstance(),!this._profiler)return ho&&j.log("[Profiling] Failed to start JS Profiler; stopping."),void this._resetProfilerInfo();this._startPeriodicChunking()}}_endProfiling(){this._isRunning&&(this._isRunning=!1,this._chunkTimer&&(clearTimeout(this._chunkTimer),this._chunkTimer=void 0),this._clearAllRootSpanTimeouts(),this._collectCurrentChunk().catch(e=>{ho&&j.error("[Profiling] Failed to collect current profile chunk on `stop()`:",e)}),"manual"===this._lifecycleMode&&Pe().setContext("profile",{}))}_setupTraceLifecycleListeners(e){e.on("spanStart",e=>{if(!this._sessionSampled)return void(ho&&j.log("[Profiling] Session not sampled because of negative sampling decision."));if(e!==pn(e))return;if(!e.isRecording())return void(ho&&j.log("[Profiling] Discarding profile because root span was not sampled."));const t=e.spanContext().spanId;if(!t||this._activeRootSpanIds.has(t))return;this._registerTraceRootSpan(t);const n=this._activeRootSpanIds.size;1===n&&(ho&&j.log(`[Profiling] Root span ${t} started. Profiling active while there are active root spans (count=${n}).`),this._beginProfiling())}),e.on("spanEnd",e=>{if(!this._sessionSampled)return;const t=e.spanContext().spanId;if(!t||!this._activeRootSpanIds.has(t))return;this._activeRootSpanIds.delete(t);const n=this._activeRootSpanIds.size;ho&&j.log(`[Profiling] Root span with ID ${t} ended. Will continue profiling for as long as there are active root spans (currently: ${n}).`),0===n&&(this._collectCurrentChunk().catch(e=>{ho&&j.error("[Profiling] Failed to collect current profile chunk on last `spanEnd`:",e)}),this._endProfiling())})}_resetProfilerInfo(){this._isRunning=!1,Pe().setContext("profile",{})}_clearAllRootSpanTimeouts(){this._rootSpanTimeouts.forEach(e=>clearTimeout(e)),this._rootSpanTimeouts.clear()}_registerTraceRootSpan(e){this._activeRootSpanIds.add(e);const t=setTimeout(()=>this._onRootSpanTimeout(e),3e5);this._rootSpanTimeouts.set(e,t)}_startProfilerInstance(){var e;if(!1===(null===(e=this._profiler)||void 0===e?void 0:e.stopped))return;const t=Jc();t?this._profiler=t:ho&&j.log("[Profiling] Failed to start JS Profiler.")}_startPeriodicChunking(){this._isRunning&&(this._chunkTimer=setTimeout(()=>{if(this._collectCurrentChunk().catch(e=>{ho&&j.error("[Profiling] Failed to collect current profile chunk during periodic chunking:",e)}),this._isRunning){if(this._startProfilerInstance(),!this._profiler)return void this._resetProfilerInfo();this._startPeriodicChunking()}},6e4))}_onRootSpanTimeout(e){this._rootSpanTimeouts.has(e)&&(this._rootSpanTimeouts.delete(e),this._activeRootSpanIds.has(e)&&(ho&&j.log(`[Profiling] Reached 5-minute timeout for root span ${e}. You likely started a manual root span that never called \`.end()\`.`),this._activeRootSpanIds.delete(e),0===this._activeRootSpanIds.size&&this._endProfiling()))}async _collectCurrentChunk(){const e=this._profiler;if(this._profiler=void 0,e)try{const t=function(e,t,n){var r;if(null==e)throw new TypeError(`Cannot construct profiling event envelope without a valid profile. Got ${e} instead.`);const s=function(e){const t=[];for(let n=0;n<e.frames.length;n++){const r=e.frames[n];r&&(t[n]={function:r.name,abs_path:"number"==typeof r.resourceId?e.resources[r.resourceId]:void 0,lineno:r.line,colno:r.column})}const n=[];for(let t=0;t<e.stacks.length;t++){const r=e.stacks[t];if(!r)continue;const s=[];let o=r;for(;o;)s.push(o.frameId),o=void 0===o.parentId?void 0:e.stacks[o.parentId];n[t]=s}const r=be(),s="number"==typeof performance.timeOrigin?performance.timeOrigin:r||0,o=s-(r||s),i=[];for(let t=0;t<e.samples.length;t++){const n=e.samples[t];if(!n)continue;const r=(s+(n.timestamp-o))/1e3;i[t]={stack_id:n.stackId??0,thread_id:Oc,timestamp:r}}return{frames:t,stacks:n,samples:i,thread_metadata:{[Oc]:{name:Ac}}}}(e),o=t.getOptions(),i=null===(r=t.getSdkMetadata)||void 0===r||null===(r=r.call(t))||void 0===r?void 0:r.sdk;return{chunk_id:ce(),client_sdk:{name:(null==i?void 0:i.name)??"sentry.javascript.browser",version:(null==i?void 0:i.version)??"0.0.0"},profiler_id:n||ce(),platform:"javascript",version:"2",release:o.release??"",environment:o.environment??"production",debug_meta:{images:qc(e.resources)},profile:s}}(await e.stop(),this._client,this._profilerId),n=function(e){try{if(!e||"object"!=typeof e)return{reason:"chunk is not an object"};const t=e=>"string"==typeof e&&/^[a-f0-9]{32}$/.test(e);if(!t(e.profiler_id))return{reason:"missing or invalid profiler_id"};if(!t(e.chunk_id))return{reason:"missing or invalid chunk_id"};if(!e.client_sdk)return{reason:"missing client_sdk metadata"};const n=e.profile;return n?Array.isArray(n.frames)&&n.frames.length?Array.isArray(n.stacks)&&n.stacks.length?Array.isArray(n.samples)&&n.samples.length?{valid:!0}:{reason:"profile has no samples"}:{reason:"profile has no stacks"}:{reason:"profile has no frames"}:{reason:"missing profile data"}}catch(e){return{reason:`unknown validation error: ${e}`}}}(t);if("reason"in n)return void(ho&&j.log("[Profiling] Discarding invalid profile chunk (this is probably a bug in the SDK):",n.reason));this._sendProfileChunk(t),ho&&j.log("[Profiling] Collected browser profile chunk.")}catch(e){ho&&j.log("[Profiling] Error while stopping JS Profiler for chunk:",e)}}_sendProfileChunk(e){var t;const n=this._client,r=Ln(null===(t=n.getSdkMetadata)||void 0===t?void 0:t.call(n)),s=n.getDsn(),o=n.getOptions().tunnel,i=Tn({event_id:ce(),sent_at:(new Date).toISOString(),...r&&{sdk:r},...!!o&&s&&{dsn:ct(s)}},[[{type:"profile_chunk"},e]]);n.sendEnvelope(i).then(null,e=>{ho&&j.error("Error while sending profile chunk envelope:",e)})}}const tl=()=>({name:"BrowserProfiling",setup(e){const t=e.getOptions(),n=new el;if(Gc(t)||t.profileLifecycle||(t.profileLifecycle="manual"),Gc(t)&&!t.profilesSampleRate)return void(ho&&j.log("[Profiling] Profiling disabled, no profiling options found."));const r=hn(),s=r&&pn(r);if(Gc(t)&&void 0!==t.profileSessionSampleRate&&ho&&j.warn("[Profiling] Both legacy profiling (`profilesSampleRate`) and UI profiling settings are defined. `profileSessionSampleRate` has no effect when legacy profiling is enabled."),Gc(t))s&&zc(s)&&Kc(s)&&Zc(s),e.on("spanStart",e=>{e===pn(e)&&Kc(e)&&Zc(e)}),e.on("beforeEnvelope",e=>{if(!Yc.size)return;const t=function(e){const t=[];return In(e,(e,n)=>{if("transaction"===n)for(let n=1;n<e.length;n++){var r;const s=e[n];null!=s&&null!==(r=s.contexts)&&void 0!==r&&null!==(r=r.profile)&&void 0!==r&&r.profile_id&&t.push(e[n])}}),t}(e);if(!t.length)return;const n=[];for(const e of t){var r,s;const t=null==e?void 0:e.contexts,o=null==t||null===(r=t.profile)||void 0===r?void 0:r.profile_id,i=null==t||null===(s=t.profile)||void 0===s?void 0:s.start_timestamp;if("string"!=typeof o){ho&&j.log("[Profiling] cannot find profile for a span without a profile context");continue}if(!o){ho&&j.log("[Profiling] cannot find profile for a span without a profile context");continue}null!=t&&t.profile&&delete t.profile;const a=Qc(o);if(!a){ho&&j.log(`[Profiling] Could not retrieve profile for span: ${o}`);continue}const c=Xc(o,i,a,e);c&&n.push(c)}!function(e,t){if(!t.length)return e;for(const n of t)e[1].push([{type:"profile"},n])}(e,n)});else{const r=t.profileLifecycle;if(e.on("startUIProfiler",()=>n.start()),e.on("stopUIProfiler",()=>n.stop()),"manual"===r)n.initialize(e);else if("trace"===r){if(!Lt(t))return void(ho&&j.warn("[Profiling] `profileLifecycle` is 'trace' but tracing is disabled. Set a `tracesSampleRate` or `tracesSampler` to enable span tracing."));n.initialize(e),s&&n.notifyRootSpanActive(s),Ss.setTimeout(()=>{const e=hn(),t=e&&pn(e);t&&n.notifyRootSpanActive(t)},0)}}},processEvent:e=>function(e){var t,n,r,s;return null!=e&&null!==(t=e.contexts)&&void 0!==t&&t.profile&&e.contexts?(e.contexts.trace={...(null===(n=e.contexts)||void 0===n?void 0:n.trace)??{},data:{...(null===(r=e.contexts)||void 0===r||null===(r=r.trace)||void 0===r?void 0:r.data)??{},"thread.id":Oc,"thread.name":Ac}},null===(s=e.spans)||void 0===s||s.forEach(e=>{e.data={...e.data||{},"thread.id":Oc,"thread.name":Ac}}),e):e}(e)});function nl(e,t){const n=null==t?void 0:t.getDsn(),r=null==t?void 0:t.getOptions().tunnel;return function(e,t){const n=Gs(e);return!(!n||Ks(n))&&(!!t&&n.host.includes(t.host)&&/(^|&|\?)sentry_key=/.test(n.search))}(e,n)||function(e,t){return!!t&&rl(e)===rl(t)}(e,r)}function rl(e){return"/"===e[e.length-1]?e.slice(0,-1):e}const sl=c,ol="sentryReplaySession",il="Unable to send Replay",al=15e4,cl=5e3,ll=2e7;var ul=Object.defineProperty,dl=(e,t,n)=>((e,t,n)=>t in e?ul(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n),pl=(e=>(e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment",e))(pl||{});function hl(e){const t=e?.host;return Boolean(t?.shadowRoot===e)}function fl(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function ml(e){try{const n=e.rules||e.cssRules;return n?((t=Array.from(n,gl).join("")).includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),t):null}catch(e){return null}var t}function gl(e){let t;if(function(e){return"styleSheet"in e}(e))try{t=ml(e.styleSheet)||function(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const n=["@import",`url(${JSON.stringify(e.href)})`];return""===e.layerName?n.push("layer"):e.layerName&&n.push(`layer(${e.layerName})`),e.supportsText&&n.push(`supports(${e.supportsText})`),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}(e)}catch(e){}else if(function(e){return"selectorText"in e}(e)){let t=e.cssText;const n=e.selectorText.includes(":"),r="string"==typeof e.style.all&&e.style.all;if(r&&(t=function(e){let t="";for(let n=0;n<e.style.length;n++){const r=e.style,s=r[n],o=r.getPropertyPriority(s);t+=`${s}:${r.getPropertyValue(s)}${o?" !important":""};`}return`${e.selectorText} { ${t} }`}(e)),n&&(t=t.replace(/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm,"$1\\$2")),n||r)return t}return t||e.cssText}class yl{constructor(){dl(this,"idNodeMap",new Map),dl(this,"nodeMetaMap",new WeakMap)}getId(e){if(!e)return-1;const t=this.getMeta(e)?.id;return t??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(e=>this.removeNodeFromMap(e))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)}replace(e,t){const n=this.getNode(e);if(n){const e=this.nodeMetaMap.get(n);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function vl({maskInputOptions:e,tagName:t,type:n}){return"OPTION"===t&&(t="SELECT"),Boolean(e[t.toLowerCase()]||n&&e[n]||"password"===n||"INPUT"===t&&!n&&e.text)}function bl({isMasked:e,element:t,value:n,maskInputFn:r}){let s=n||"";return e?(r&&(s=r(s,t)),"*".repeat(s.length)):s}function _l(e){return e.toLowerCase()}function Sl(e){return e.toUpperCase()}const wl="__rrweb_original__";function kl(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?_l(t):null}function xl(e,t,n){return"INPUT"!==t||"radio"!==n&&"checkbox"!==n?e.value:e.getAttribute("value")||""}function Tl(e,t){let n;try{n=new URL(e,t??window.location.href)}catch(e){return null}const r=n.pathname.match(/\.([0-9a-z]+)(?:$)/i);return r?.[1]??null}const El={};function Il(e){const t=El[e];if(t)return t;const n=window.document;let r=window[e];if(n&&"function"==typeof n.createElement)try{const t=n.createElement("iframe");t.hidden=!0,n.head.appendChild(t);const s=t.contentWindow;s&&s[e]&&(r=s[e]),n.head.removeChild(t)}catch(e){}return El[e]=r.bind(window)}function Cl(...e){return Il("setTimeout")(...e)}function Ml(...e){return Il("clearTimeout")(...e)}function Rl(e){try{return e.contentDocument}catch(e){}}let Ol=1;const Al=new RegExp("[^a-z0-9-_:]");function Nl(){return Ol++}let Dl,Ll;const Pl=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Fl=/^(?:[a-z+]+:)?\/\//i,jl=/^www\..*/i,$l=/^(data:)([^,]*),(.*)/i;function Bl(e,t){return(e||"").replace(Pl,(e,n,r,s,o,i)=>{const a=r||o||i,c=n||s||"";if(!a)return e;if(Fl.test(a)||jl.test(a))return`url(${c}${a}${c})`;if($l.test(a))return`url(${c}${a}${c})`;if("/"===a[0])return`url(${c}${function(e){let t="";return t=e.indexOf("//")>-1?e.split("/").slice(0,3).join("/"):e.split("/")[0],t=t.split("?")[0],t}(t)+a}${c})`;const l=t.split("/"),u=a.split("/");l.pop();for(const e of u)"."!==e&&(".."===e?l.pop():l.push(e));return`url(${c}${l.join("/")}${c})`})}const Ul=/^[^ \t\n\r\u000c]+/,Hl=/^[, \t\n\r\u000c]+/,zl=new WeakMap;function ql(e,t){return t&&""!==t.trim()?Wl(e,t):t}function Wl(e,t){let n=zl.get(e);if(n||(n=e.createElement("a"),zl.set(e,n)),t){if(t.startsWith("blob:")||t.startsWith("data:"))return t}else t="";return n.setAttribute("href",t),n.href}function Vl(e,t,n,r,s,o,i){if(!r)return r;if("src"===n||"href"===n&&("use"!==t||"#"!==r[0]))return ql(e,r);if("xlink:href"===n&&"#"!==r[0])return ql(e,r);if("background"===n&&("table"===t||"td"===t||"th"===t))return ql(e,r);if("srcset"===n)return function(e,t){if(""===t.trim())return t;let n=0;function r(e){let r;const s=e.exec(t.substring(n));return s?(r=s[0],n+=r.length,r):""}const s=[];for(;r(Hl),!(n>=t.length);){let o=r(Ul);if(","===o.slice(-1))o=ql(e,o.substring(0,o.length-1)),s.push(o);else{let r="";o=ql(e,o);let i=!1;for(;;){const e=t.charAt(n);if(""===e){s.push((o+r).trim());break}if(i)")"===e&&(i=!1);else{if(","===e){n+=1,s.push((o+r).trim());break}"("===e&&(i=!0)}r+=e,n+=1}}}return s.join(", ")}(e,r);if("style"===n){let t=Bl(r,Wl(e));return i&&i.size>0&&(t=function(e,t){if(!e||0===t.size)return e;try{const n=e.split(";"),r=[];for(let e of n){if(e=e.trim(),!e)continue;const n=e.indexOf(":");if(-1===n){r.push(e);continue}const s=e.slice(0,n).trim();t.has(s)||r.push(e)}return r.join("; ")+(r.length>0&&e.endsWith(";")?";":"")}catch(t){return console.warn("Error filtering CSS properties:",t),e}}(t,i)),t}return"object"===t&&"data"===n?ql(e,r):"function"==typeof o?o(n,r,s):r}function Jl(e,t,n){return("video"===e||"audio"===e)&&"autoplay"===t}function Kl(e,t,n=1/0,r=0){return e?e.nodeType!==e.ELEMENT_NODE||r>n?-1:t(e)?r:Kl(e.parentNode,t,n,r+1):-1}function Gl(e,t){return n=>{const r=n;if(null===r)return!1;try{if(e)if("string"==typeof e){if(r.matches(`.${e}`))return!0}else if(function(e,t){for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}return!1}(r,e))return!0;return!(!t||!r.matches(t))}catch{return!1}}}function Xl(e,t,n,r,s,o){try{const i=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===i)return!1;if("INPUT"===i.tagName){const e=i.getAttribute("autocomplete");if(["current-password","new-password","cc-number","cc-exp","cc-exp-month","cc-exp-year","cc-csc"].includes(e))return!0}let a=-1,c=-1;if(o){if(c=Kl(i,Gl(r,s)),c<0)return!0;a=Kl(i,Gl(t,n),c>=0?c:1/0)}else{if(a=Kl(i,Gl(t,n)),a<0)return!1;c=Kl(i,Gl(r,s),a>=0?a:1/0)}return a>=0?!(c>=0)||a<=c:!(c>=0||!o)}catch(e){}return!!o}function Yl(e){return null==e?"":e.toLowerCase()}function Ql(e,t){const{doc:n,mirror:r,blockClass:s,blockSelector:o,unblockSelector:i,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:p=!1,inlineStylesheet:h=!0,maskInputOptions:f={},maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:v,dataURLOptions:b={},inlineImages:_=!1,recordCanvas:S=!1,onSerialize:w,onIframeLoad:k,iframeLoadTimeout:x=5e3,onBlockedImageLoad:T,onStylesheetLoad:E,stylesheetLoadTimeout:I=5e3,keepIframeSrcFn:C=()=>!1,newlyAddedElement:M=!1,ignoreCSSAttributes:R}=t;let{preserveWhiteSpace:O=!0}=t;const A=function(e,t){const{doc:n,mirror:r,blockClass:s,blockSelector:o,unblockSelector:i,maskAllText:a,maskAttributeFn:c,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:p,inlineStylesheet:h,maskInputOptions:f={},maskTextFn:m,maskInputFn:g,dataURLOptions:y={},inlineImages:v,recordCanvas:b,keepIframeSrcFn:_,newlyAddedElement:S=!1,ignoreCSSAttributes:w}=t,k=function(e,t){if(!t.hasNode(e))return;const n=t.getId(e);return 1===n?void 0:n}(n,r);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:pl.Document,childNodes:[],compatMode:e.compatMode}:{type:pl.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:pl.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:k};case e.ELEMENT_NODE:return function(e,t){const{doc:n,blockClass:r,blockSelector:s,unblockSelector:o,inlineStylesheet:i,maskInputOptions:a={},maskAttributeFn:c,maskInputFn:l,dataURLOptions:u={},inlineImages:d,recordCanvas:p,keepIframeSrcFn:h,newlyAddedElement:f=!1,rootId:m,maskTextClass:g,unmaskTextClass:y,maskTextSelector:v,unmaskTextSelector:b,ignoreCSSAttributes:_}=t,S=function(e,t,n,r){try{if(r&&e.matches(r))return!1;if("string"==typeof t){if(e.classList.contains(t))return!0}else for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}if(n)return e.matches(n)}catch(e){}return!1}(e,r,s,o),w=function(e){if(e instanceof HTMLFormElement)return"form";const t=_l(e.tagName);return Al.test(t)?"div":t}(e);let k={};const x=e.attributes.length;for(let t=0;t<x;t++){const r=e.attributes[t];r.name&&!Jl(w,r.name,r.value)&&(k[r.name]=Vl(n,w,_l(r.name),r.value,e,c,_))}if("link"===w&&i){const t=Array.from(n.styleSheets).find(t=>t.href===e.href);let r=null;t&&(r=ml(t)),r&&(k.rel=null,k.href=null,k.crossorigin=null,k._cssText=Bl(r,t.href))}if("style"===w&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const t=ml(e.sheet);t&&(k._cssText=Bl(t,Wl(n)))}if("input"===w||"textarea"===w||"select"===w||"option"===w){const t=e,n=kl(t),r=xl(t,Sl(w),n),s=t.checked;if("submit"!==n&&"button"!==n&&r){const e=Xl(t,g,v,y,b,vl({type:n,tagName:Sl(w),maskInputOptions:a}));k.value=bl({isMasked:e,element:t,value:r,maskInputFn:l})}s&&(k.checked=s)}if("option"===w&&(e.selected&&!a.select?k.selected=!0:delete k.selected),"canvas"===w&&p)if("2d"===e.__context)(function(e){const t=e.getContext("2d");if(!t)return!0;for(let n=0;n<e.width;n+=50)for(let r=0;r<e.height;r+=50){const s=t.getImageData,o=wl in s?s[wl]:s;if(new Uint32Array(o.call(t,n,r,Math.min(50,e.width-n),Math.min(50,e.height-r)).data.buffer).some(e=>0!==e))return!1}return!0})(e)||(k.rr_dataURL=e.toDataURL(u.type,u.quality));else if(!("__context"in e)){const t=e.toDataURL(u.type,u.quality),r=n.createElement("canvas");r.width=e.width,r.height=e.height,t!==r.toDataURL(u.type,u.quality)&&(k.rr_dataURL=t)}if("img"===w&&d){Dl||(Dl=n.createElement("canvas"),Ll=Dl.getContext("2d"));const t=e,r=t.currentSrc||t.getAttribute("src")||"<unknown-src>",s=t.crossOrigin,o=()=>{t.removeEventListener("load",o);try{Dl.width=t.naturalWidth,Dl.height=t.naturalHeight,Ll.drawImage(t,0,0),k.rr_dataURL=Dl.toDataURL(u.type,u.quality)}catch(e){if("anonymous"!==t.crossOrigin)return t.crossOrigin="anonymous",void(t.complete&&0!==t.naturalWidth?o():t.addEventListener("load",o));console.warn(`Cannot inline img src=${r}! Error: ${e}`)}"anonymous"===t.crossOrigin&&(s?k.crossOrigin=s:t.removeAttribute("crossorigin"))};t.complete&&0!==t.naturalWidth?o():t.addEventListener("load",o)}if("audio"!==w&&"video"!==w||(k.rr_mediaState=e.paused?"paused":"played",k.rr_mediaCurrentTime=e.currentTime),f||(e.scrollLeft&&(k.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(k.rr_scrollTop=e.scrollTop)),S){const{width:t,height:n}=e.getBoundingClientRect();k={class:k.class,rr_width:`${t}px`,rr_height:`${n}px`}}let T;"iframe"!==w||h(k.src)||(S||Rl(e)||(k.rr_src=k.src),delete k.src);try{customElements.get(w)&&(T=!0)}catch(e){}return{type:pl.Element,tagName:w,attributes:k,childNodes:[],isSVG:(E=e,Boolean("svg"===E.tagName||E.ownerSVGElement)||void 0),needBlock:S,rootId:m,isCustom:T};var E}(e,{doc:n,blockClass:s,blockSelector:o,unblockSelector:i,inlineStylesheet:h,maskAttributeFn:c,maskInputOptions:f,maskInputFn:g,dataURLOptions:y,inlineImages:v,recordCanvas:b,keepIframeSrcFn:_,newlyAddedElement:S,rootId:k,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:p,ignoreCSSAttributes:w});case e.TEXT_NODE:return function(e,t){const{maskAllText:n,maskTextClass:r,unmaskTextClass:s,maskTextSelector:o,unmaskTextSelector:i,maskTextFn:a,maskInputOptions:c,maskInputFn:l,rootId:u}=t,d=e.parentNode&&e.parentNode.tagName;let p=e.textContent;const h="STYLE"===d||void 0,f="SCRIPT"===d||void 0,m="TEXTAREA"===d||void 0;if(h&&p){try{e.nextSibling||e.previousSibling||e.parentNode.sheet?.cssRules&&(p=ml(e.parentNode.sheet))}catch(t){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${t}`,e)}p=Bl(p,Wl(t.doc))}f&&(p="SCRIPT_PLACEHOLDER");const g=Xl(e,r,o,s,i,n);return h||f||m||!p||!g||(p=a?a(p,e.parentElement):p.replace(/[\S]/g,"*")),m&&p&&(c.textarea||g)&&(p=l?l(p,e.parentNode):p.replace(/[\S]/g,"*")),"OPTION"===d&&p&&(p=bl({isMasked:Xl(e,r,o,s,i,vl({type:null,tagName:d,maskInputOptions:c})),element:e,value:p,maskInputFn:l})),{type:pl.Text,textContent:p||"",isStyle:h,rootId:u}}(e,{doc:n,maskAllText:a,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:p,maskTextFn:m,maskInputOptions:f,maskInputFn:g,rootId:k});case e.CDATA_SECTION_NODE:return{type:pl.CDATA,textContent:"",rootId:k};case e.COMMENT_NODE:return{type:pl.Comment,textContent:e.textContent||"",rootId:k};default:return!1}}(e,{doc:n,mirror:r,blockClass:s,blockSelector:o,maskAllText:a,unblockSelector:i,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,dataURLOptions:b,inlineImages:_,recordCanvas:S,keepIframeSrcFn:C,newlyAddedElement:M,ignoreCSSAttributes:R});if(!A)return console.warn(e,"not serialized"),null;let N;N=r.hasNode(e)?r.getId(e):!function(e,t){if(t.comment&&e.type===pl.Comment)return!0;if(e.type===pl.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&("preload"===e.attributes.rel||"modulepreload"===e.attributes.rel)||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&"js"===Tl(e.attributes.href)))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(Yl(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===Yl(e.attributes.name)||"icon"===Yl(e.attributes.rel)||"apple-touch-icon"===Yl(e.attributes.rel)||"shortcut icon"===Yl(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&Yl(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(Yl(e.attributes.property).match(/^(og|twitter|fb):/)||Yl(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===Yl(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===Yl(e.attributes.name)||"googlebot"===Yl(e.attributes.name)||"bingbot"===Yl(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===Yl(e.attributes.name)||"generator"===Yl(e.attributes.name)||"framework"===Yl(e.attributes.name)||"publisher"===Yl(e.attributes.name)||"progid"===Yl(e.attributes.name)||Yl(e.attributes.property).match(/^article:/)||Yl(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===Yl(e.attributes.name)||"yandex-verification"===Yl(e.attributes.name)||"csrf-token"===Yl(e.attributes.name)||"p:domain_verify"===Yl(e.attributes.name)||"verify-v1"===Yl(e.attributes.name)||"verification"===Yl(e.attributes.name)||"shopify-checkout-api-token"===Yl(e.attributes.name)))return!0}}return!1}(A,v)&&(O||A.type!==pl.Text||A.isStyle||A.textContent.replace(/^\s+|\s+$/gm,"").length)?Nl():-2;const D=Object.assign(A,{id:N});if(r.add(e,D),-2===N)return null;w&&w(e);let L=!p;if(D.type===pl.Element){L=L&&!D.needBlock;const t=e.shadowRoot;t&&fl(t)&&(D.isShadowHost=!0)}if((D.type===pl.Document||D.type===pl.Element)&&L){v.headWhitespace&&D.type===pl.Element&&"head"===D.tagName&&(O=!1);const t={doc:n,mirror:r,blockClass:s,blockSelector:o,maskAllText:a,unblockSelector:i,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:p,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:v,dataURLOptions:b,inlineImages:_,recordCanvas:S,preserveWhiteSpace:O,onSerialize:w,onIframeLoad:k,iframeLoadTimeout:x,onBlockedImageLoad:T,onStylesheetLoad:E,stylesheetLoadTimeout:I,keepIframeSrcFn:C,ignoreCSSAttributes:R},M=e.childNodes?Array.from(e.childNodes):[];for(const e of M){const n=Ql(e,t);n&&D.childNodes.push(n)}if(function(e){return e.nodeType===e.ELEMENT_NODE}(e)&&e.shadowRoot)for(const n of Array.from(e.shadowRoot.childNodes)){const r=Ql(n,t);r&&(fl(e.shadowRoot)&&(r.isShadow=!0),D.childNodes.push(r))}}if(e.parentNode&&hl(e.parentNode)&&fl(e.parentNode)&&(D.isShadow=!0),D.type!==pl.Element||"iframe"!==D.tagName||D.needBlock||function(e,t,n){const r=e.contentWindow;if(!r)return;let s,o=!1;try{s=r.document.readyState}catch(e){return}if("complete"!==s){const r=Cl(()=>{o||(t(),o=!0)},n);return void e.addEventListener("load",()=>{Ml(r),o=!0,t()})}const i="about:blank";if(r.location.href!==i||e.src===i||""===e.src)return Cl(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}(e,()=>{const t=Rl(e);if(t&&k){const n=Ql(t,{doc:t,mirror:r,blockClass:s,blockSelector:o,unblockSelector:i,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:v,dataURLOptions:b,inlineImages:_,recordCanvas:S,preserveWhiteSpace:O,onSerialize:w,onIframeLoad:k,iframeLoadTimeout:x,onStylesheetLoad:E,stylesheetLoadTimeout:I,keepIframeSrcFn:C,ignoreCSSAttributes:R});n&&k(e,n)}},x),D.type===pl.Element&&"img"===D.tagName&&!e.complete&&D.needBlock){const t=e,n=()=>{if(t.isConnected&&!t.complete&&T)try{const e=t.getBoundingClientRect();e.width>0&&e.height>0&&T(t,D,e)}catch(e){}t.removeEventListener("load",n)};t.isConnected&&t.addEventListener("load",n)}return D.type===pl.Element&&"link"===D.tagName&&"string"==typeof D.attributes.rel&&("stylesheet"===D.attributes.rel||"preload"===D.attributes.rel&&"string"==typeof D.attributes.href&&"css"===Tl(D.attributes.href))&&function(e,t,n){let r,s=!1;try{r=e.sheet}catch(e){return}if(r)return;const o=Cl(()=>{s||(t(),s=!0)},n);e.addEventListener("load",()=>{Ml(o),s=!0,t()})}(e,()=>{if(E){const t=Ql(e,{doc:n,mirror:r,blockClass:s,blockSelector:o,unblockSelector:i,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:v,dataURLOptions:b,inlineImages:_,recordCanvas:S,preserveWhiteSpace:O,onSerialize:w,onIframeLoad:k,iframeLoadTimeout:x,onStylesheetLoad:E,stylesheetLoadTimeout:I,keepIframeSrcFn:C,ignoreCSSAttributes:R});t&&E(e,t)}},I),D.type===pl.Element&&delete D.needBlock,D}function Zl(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}const eu="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let tu={map:{},getId:()=>(console.error(eu),-1),getNode:()=>(console.error(eu),null),removeNodeFromMap(){console.error(eu)},has:()=>(console.error(eu),!1),reset(){console.error(eu)}};function nu(e,t,n={}){let r=null,s=0;return function(...o){const i=Date.now();s||!1!==n.leading||(s=i);const a=t-(i-s),c=this;a<=0||a>t?(r&&(function(...e){Su("clearTimeout")(...e)}(r),r=null),s=i,e.apply(c,o)):r||!1===n.trailing||(r=wu(()=>{s=!1===n.leading?0:Date.now(),r=null,e.apply(c,o)},a))}}function ru(e,t,n,r,s=window){const o=s.Object.getOwnPropertyDescriptor(e,t);return s.Object.defineProperty(e,t,r?n:{set(e){wu(()=>{n.set.call(this,e)},0),o&&o.set&&o.set.call(this,e)}}),()=>ru(e,t,o||{},!0)}function su(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],s=n(r);return"function"==typeof s&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=s,()=>{e[t]=r}}catch{return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(tu=new Proxy(tu,{get:(e,t,n)=>("map"===t&&console.error(eu),Reflect.get(e,t,n))}));let ou=Date.now;function iu(e){const t=e.document;return{left:t.scrollingElement?t.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:t?.documentElement.scrollLeft||t?.body?.parentElement?.scrollLeft||t?.body?.scrollLeft||0,top:t.scrollingElement?t.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:t?.documentElement.scrollTop||t?.body?.parentElement?.scrollTop||t?.body?.scrollTop||0}}function au(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function cu(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function lu(e){if(!e)return null;try{return e.nodeType===e.ELEMENT_NODE?e:e.parentElement}catch(e){return null}}function uu(e,t,n,r,s){if(!e)return!1;const o=lu(e);if(!o)return!1;const i=Gl(t,n);if(!s){const e=r&&o.matches(r);return i(o)&&!e}const a=Kl(o,i);let c=-1;return!(a<0)&&(r&&(c=Kl(o,Gl(null,r))),a>-1&&c<0||a<c)}function du(e,t){return-2===t.getId(e)}function pu(e,t){if(hl(e))return!1;const n=t.getId(e);return!t.has(n)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||pu(e.parentNode,t))}function hu(e){return Boolean(e.changedTouches)}function fu(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function mu(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function gu(e){return Boolean(e?.shadowRoot)}/[1-9][0-9]{12}/.test(Date.now().toString())||(ou=()=>(new Date).getTime());class yu{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){return this.styleIDMap.get(e)??-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let n;return n=void 0===t?this.id++:t,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function vu(e){let t=null;return e.getRootNode?.()?.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(t=e.getRootNode().host),t}function bu(e){const t=e.ownerDocument;return!!t&&(t.contains(e)||function(e){const t=e.ownerDocument;if(!t)return!1;const n=function(e){let t,n=e;for(;t=vu(n);)n=t;return n}(e);return t.contains(n)}(e))}const _u={};function Su(e){const t=_u[e];if(t)return t;const n=window.document;let r=window[e];if(n&&"function"==typeof n.createElement)try{const t=n.createElement("iframe");t.hidden=!0,n.head.appendChild(t);const s=t.contentWindow;s&&s[e]&&(r=s[e]),n.head.removeChild(t)}catch(e){}return _u[e]=r.bind(window)}function wu(...e){return Su("setTimeout")(...e)}var ku=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(ku||{}),xu=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(xu||{}),Tu=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(Tu||{}),Eu=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(Eu||{}),Iu=(e=>(e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange",e[e.RateChange=4]="RateChange",e))(Iu||{});function Cu(e){try{return e.contentDocument}catch(e){}}function Mu(e){return"__ln"in e}class Ru{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let t=this.head;for(let n=0;n<e;n++)t=t?.next||null;return t}addNode(e){const t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&Mu(e.previousSibling)){const n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&Mu(e.nextSibling)&&e.nextSibling.__ln.previous){const n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;null===t.next&&(this.tail=t),this.length++}removeNode(e){const t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next?t.next.previous=t.previous:this.tail=t.previous):(this.head=t.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const Ou=(e,t)=>`${e}@${t}`;class Au{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],t=new Set,n=new Ru,r=e=>{let t=e,n=-2;for(;-2===n;)t=t&&t.nextSibling,n=t&&this.mirror.getId(t);return n},s=s=>{if(!s.parentNode||!bu(s))return;const o=hl(s.parentNode)?this.mirror.getId(vu(s)):this.mirror.getId(s.parentNode),i=r(s);if(-1===o||-1===i)return n.addNode(s);const a=Ql(s,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskAllText:this.maskAllText,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,unmaskTextClass:this.unmaskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskAttributeFn:this.maskAttributeFn,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{fu(e,this.mirror)&&!uu(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)&&this.iframeManager.addIframe(e),mu(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),gu(s)&&this.shadowDomManager.addShadowRoot(s.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{uu(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(this.iframeManager.attachIframe(e,t),e.contentWindow&&this.canvasManager.addWindow(e.contentWindow),this.shadowDomManager.observeAttachShadow(e))},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)},onBlockedImageLoad:(e,t,{width:n,height:r})=>{this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:{style:{width:`${n}px`,height:`${r}px`}}}]})},ignoreCSSAttributes:this.ignoreCSSAttributes});a&&(e.push({parentId:o,nextId:i,node:a}),t.add(a.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const e of this.movedSet)Du(this.removes,e,this.mirror)&&!this.movedSet.has(e.parentNode)||s(e);for(const e of this.addedSet)Lu(this.droppedSet,e)||Du(this.removes,e,this.mirror)?Lu(this.movedSet,e)?s(e):this.droppedSet.add(e):s(e);let o=null;for(;n.length;){let e=null;if(o){const t=this.mirror.getId(o.value.parentNode),n=r(o.value);-1!==t&&-1!==n&&(e=o)}if(!e){let t=n.tail;for(;t;){const n=t;if(t=t.previous,n){const t=this.mirror.getId(n.value.parentNode);if(-1===r(n.value))continue;if(-1!==t){e=n;break}{const t=n.value;if(t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const r=t.parentNode.host;if(-1!==this.mirror.getId(r)){e=n;break}}}}}}if(!e){for(;n.head;)n.removeNode(n.head.value);break}o=e.previous,n.removeNode(e.value),s(e.value)}const i={texts:this.texts.map(e=>({id:this.mirror.getId(e.node),value:e.value})).filter(e=>!t.has(e.id)).filter(e=>this.mirror.has(e.id)),attributes:this.attributes.map(e=>{const{attributes:t}=e;if("string"==typeof t.style){const n=JSON.stringify(e.styleDiff),r=JSON.stringify(e._unchangedStyles);n.length<t.style.length&&(n+r).split("var(").length===t.style.split("var(").length&&(t.style=e.styleDiff)}return{id:this.mirror.getId(e.node),attributes:t}}).filter(e=>!t.has(e.id)).filter(e=>this.mirror.has(e.id)),removes:this.removes,adds:e};(i.texts.length||i.attributes.length||i.removes.length||i.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(i))},this.processMutation=e=>{if(!du(e.target,this.mirror))switch(e.type){case"characterData":{const t=e.target.textContent;uu(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||t===e.oldValue||this.texts.push({value:Xl(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,this.maskAllText)&&t?this.maskTextFn?this.maskTextFn(t,lu(e.target)):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{const t=e.target;let n=e.attributeName,r=e.target.getAttribute(n);if("value"===n){const n=kl(t),s=t.tagName;r=xl(t,s,n);const o=vl({maskInputOptions:this.maskInputOptions,tagName:s,type:n});r=bl({isMasked:Xl(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,o),element:t,value:r,maskInputFn:this.maskInputFn})}if(uu(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||r===e.oldValue)return;let s=this.attributeMap.get(e.target);if("IFRAME"===t.tagName&&"src"===n&&!this.keepIframeSrcFn(r)){if(Cu(t))return;n="rr_src"}if(s||(s={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(s),this.attributeMap.set(e.target,s)),"type"===n&&"INPUT"===t.tagName&&"password"===(e.oldValue||"").toLowerCase()&&t.setAttribute("data-rr-is-password","true"),!Jl(t.tagName,n)&&(s.attributes[n]=Vl(this.doc,_l(t.tagName),_l(n),r,t,this.maskAttributeFn),"style"===n)){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(e){this.unattachedDoc=this.doc}const n=this.unattachedDoc.createElement("span");e.oldValue&&n.setAttribute("style",e.oldValue);for(const e of Array.from(t.style)){const r=t.style.getPropertyValue(e),o=t.style.getPropertyPriority(e);r!==n.style.getPropertyValue(e)||o!==n.style.getPropertyPriority(e)?s.styleDiff[e]=""===o?r:[r,o]:s._unchangedStyles[e]=[r,o]}for(const e of Array.from(n.style))""===t.style.getPropertyValue(e)&&(s.styleDiff[e]=!1)}break}case"childList":if(uu(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!0))return;e.addedNodes.forEach(t=>this.genAdds(t,e.target)),e.removedNodes.forEach(t=>{const n=this.mirror.getId(t),r=hl(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);uu(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||du(t,this.mirror)||!function(e,t){return-1!==t.getId(e)}(t,this.mirror)||(this.addedSet.has(t)?(Nu(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===n||pu(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[Ou(n,r)]?Nu(this.movedSet,t):this.removes.push({parentId:r,id:n,isShadow:!(!hl(e.target)||!fl(e.target))||void 0})),this.mapRemoves.push(t))})}},this.genAdds=(e,t)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!this.addedSet.has(e)&&!this.movedSet.has(e)){if(this.mirror.hasNode(e)){if(du(e,this.mirror))return;this.movedSet.add(e);let n=null;t&&this.mirror.hasNode(t)&&(n=this.mirror.getId(t)),n&&-1!==n&&(this.movedMap[Ou(this.mirror.getId(e),n)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);uu(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(e.childNodes&&e.childNodes.forEach(e=>this.genAdds(e)),gu(e)&&e.shadowRoot.childNodes.forEach(t=>{this.processedNodeManager.add(t,this),this.genAdds(t,e)}))}}}init(e){["mutationCb","blockClass","blockSelector","unblockSelector","maskAllText","maskTextClass","unmaskTextClass","maskTextSelector","unmaskTextSelector","inlineStylesheet","maskInputOptions","maskAttributeFn","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager","ignoreCSSAttributes"].forEach(t=>{this[t]=e[t]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Nu(e,t){e.delete(t),t.childNodes?.forEach(t=>Nu(e,t))}function Du(e,t,n){return 0!==e.length&&function(e,t,n){let r=t.parentNode;for(;r;){const t=n.getId(r);if(e.some(e=>e.id===t))return!0;r=r.parentNode}return!1}(e,t,n)}function Lu(e,t){return 0!==e.size&&Pu(e,t)}function Pu(e,t){const{parentNode:n}=t;return!!n&&(!!e.has(n)||Pu(e,n))}let Fu;const ju=e=>Fu?(...t)=>{try{return e(...t)}catch(e){if(Fu&&!0===Fu(e))return()=>{};throw e}}:e,$u=[];function Bu(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch{}return e&&e.target}function Uu(e,t){const n=new Au;$u.push(n),n.init(e);let r=window.MutationObserver||window.__rrMutationObserver;const s=window?.Zone?.__symbol__?.("MutationObserver");s&&window[s]&&(r=window[s]);const o=new r(ju(t=>{e.onMutation&&!1===e.onMutation(t)||n.processMutations.bind(n)(t)}));return o.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),o}function Hu({scrollCb:e,doc:t,mirror:n,blockClass:r,blockSelector:s,unblockSelector:o,sampling:i}){return Zl("scroll",ju(nu(ju(i=>{const a=Bu(i);if(!a||uu(a,r,s,o,!0))return;const c=n.getId(a);if(a===t&&t.defaultView){const n=iu(t.defaultView);e({id:c,x:n.left,y:n.top})}else e({id:c,x:a.scrollLeft,y:a.scrollTop})}),i.scroll||100)),t)}const zu=["INPUT","TEXTAREA","SELECT"],qu=new WeakMap;function Wu({inputCb:e,doc:t,mirror:n,blockClass:r,blockSelector:s,unblockSelector:o,ignoreClass:i,ignoreSelector:a,maskInputOptions:c,maskInputFn:l,sampling:u,userTriggeredOnInput:d,maskTextClass:p,unmaskTextClass:h,maskTextSelector:f,unmaskTextSelector:m}){function g(e){let n=Bu(e);const u=e.isTrusted,g=n&&Sl(n.tagName);if("OPTION"===g&&(n=n.parentElement),!n||!g||zu.indexOf(g)<0||uu(n,r,s,o,!0))return;const v=n;if(v.classList.contains(i)||a&&v.matches(a))return;const b=kl(n);let _=xl(v,g,b),S=!1;const w=vl({maskInputOptions:c,tagName:g,type:b}),k=Xl(n,p,f,h,m,w);"radio"!==b&&"checkbox"!==b||(S=n.checked),_=bl({isMasked:k,element:n,value:_,maskInputFn:l}),y(n,d?{text:_,isChecked:S,userTriggered:u}:{text:_,isChecked:S});const x=n.name;"radio"===b&&x&&S&&t.querySelectorAll(`input[type="radio"][name="${x}"]`).forEach(e=>{if(e!==n){const t=bl({isMasked:k,element:e,value:xl(e,g,b),maskInputFn:l});y(e,d?{text:t,isChecked:!S,userTriggered:!1}:{text:t,isChecked:!S})}})}function y(t,r){const s=qu.get(t);if(!s||s.text!==r.text||s.isChecked!==r.isChecked){qu.set(t,r);const s=n.getId(t);ju(e)({...r,id:s})}}const v=("last"===u.input?["change"]:["input","change"]).map(e=>Zl(e,ju(g),t)),b=t.defaultView;if(!b)return()=>{v.forEach(e=>e())};const _=b.Object.getOwnPropertyDescriptor(b.HTMLInputElement.prototype,"value"),S=[[b.HTMLInputElement.prototype,"value"],[b.HTMLInputElement.prototype,"checked"],[b.HTMLSelectElement.prototype,"value"],[b.HTMLTextAreaElement.prototype,"value"],[b.HTMLSelectElement.prototype,"selectedIndex"],[b.HTMLOptionElement.prototype,"selected"]];return _&&_.set&&v.push(...S.map(e=>ru(e[0],e[1],{set(){ju(g)({target:this,isTrusted:!1})}},!1,b))),ju(()=>{v.forEach(e=>e())})}function Vu(e){return function(e,t){if(Xu("CSSGroupingRule")&&e.parentRule instanceof CSSGroupingRule||Xu("CSSMediaRule")&&e.parentRule instanceof CSSMediaRule||Xu("CSSSupportsRule")&&e.parentRule instanceof CSSSupportsRule||Xu("CSSConditionRule")&&e.parentRule instanceof CSSConditionRule){const n=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(n)}else if(e.parentStyleSheet){const n=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(n)}return t}(e,[])}function Ju(e,t,n){let r,s;return e?(e.ownerNode?r=t.getId(e.ownerNode):s=n.getId(e),{styleId:s,id:r}):{}}function Ku({mirror:e,stylesheetManager:t},n){let r=null;r="#document"===n.nodeName?e.getId(n):e.getId(n.host);const s="#document"===n.nodeName?n.defaultView?.Document:n.ownerDocument?.defaultView?.ShadowRoot,o=s?.prototype?Object.getOwnPropertyDescriptor(s?.prototype,"adoptedStyleSheets"):void 0;return null!==r&&-1!==r&&s&&o?(Object.defineProperty(n,"adoptedStyleSheets",{configurable:o.configurable,enumerable:o.enumerable,get(){return o.get?.call(this)},set(e){const n=o.set?.call(this,e);if(null!==r&&-1!==r)try{t.adoptStyleSheets(e,r)}catch(e){}return n}}),ju(()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:o.configurable,enumerable:o.enumerable,get:o.get,set:o.set})})):()=>{}}function Gu(e,t={}){const n=e.doc.defaultView;if(!n)return()=>{};let r;e.recordDOM&&(r=Uu(e,e.doc));const s=function({mousemoveCb:e,sampling:t,doc:n,mirror:r}){if(!1===t.mousemove)return()=>{};const s="number"==typeof t.mousemove?t.mousemove:50,o="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500;let i,a=[];const c=nu(ju(t=>{const n=Date.now()-i;e(a.map(e=>(e.timeOffset-=n,e)),t),a=[],i=null}),o),l=ju(nu(ju(e=>{const t=Bu(e),{clientX:n,clientY:s}=hu(e)?e.changedTouches[0]:e;i||(i=ou()),a.push({x:n,y:s,id:r.getId(t),timeOffset:ou()-i}),c("undefined"!=typeof DragEvent&&e instanceof DragEvent?xu.Drag:e instanceof MouseEvent?xu.MouseMove:xu.TouchMove)}),s,{trailing:!1})),u=[Zl("mousemove",l,n),Zl("touchmove",l,n),Zl("drag",l,n)];return ju(()=>{u.forEach(e=>e())})}(e),o=function({mouseInteractionCb:e,doc:t,mirror:n,blockClass:r,blockSelector:s,unblockSelector:o,sampling:i}){if(!1===i.mouseInteraction)return()=>{};const a=!0===i.mouseInteraction||void 0===i.mouseInteraction?{}:i.mouseInteraction,c=[];let l=null;return Object.keys(Tu).filter(e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==a[e]).forEach(i=>{let a=_l(i);const u=(t=>i=>{const a=Bu(i);if(uu(a,r,s,o,!0))return;let c=null,u=t;if("pointerType"in i){switch(i.pointerType){case"mouse":c=Eu.Mouse;break;case"touch":c=Eu.Touch;break;case"pen":c=Eu.Pen}c===Eu.Touch?Tu[t]===Tu.MouseDown?u="TouchStart":Tu[t]===Tu.MouseUp&&(u="TouchEnd"):Eu.Pen}else hu(i)&&(c=Eu.Touch);null!==c?(l=c,(u.startsWith("Touch")&&c===Eu.Touch||u.startsWith("Mouse")&&c===Eu.Mouse)&&(c=null)):Tu[t]===Tu.Click&&(c=l,l=null);const d=hu(i)?i.changedTouches[0]:i;if(!d)return;const p=n.getId(a),{clientX:h,clientY:f}=d;ju(e)({type:Tu[u],id:p,x:h,y:f,...null!==c&&{pointerType:c}})})(i);if(window.PointerEvent)switch(Tu[i]){case Tu.MouseDown:case Tu.MouseUp:a=a.replace("mouse","pointer");break;case Tu.TouchStart:case Tu.TouchEnd:return}c.push(Zl(a,u,t))}),ju(()=>{c.forEach(e=>e())})}(e),i=Hu(e),a=function({viewportResizeCb:e},{win:t}){let n=-1,r=-1;return Zl("resize",ju(nu(ju(()=>{const t=au(),s=cu();n===t&&r===s||(e({width:Number(s),height:Number(t)}),n=t,r=s)}),200)),t)}(e,{win:n}),c=Wu(e),l=function({mediaInteractionCb:e,blockClass:t,blockSelector:n,unblockSelector:r,mirror:s,sampling:o,doc:i}){const a=ju(i=>nu(ju(o=>{const a=Bu(o);if(!a||uu(a,t,n,r,!0))return;const{currentTime:c,volume:l,muted:u,playbackRate:d}=a;e({type:i,id:s.getId(a),currentTime:c,volume:l,muted:u,playbackRate:d})}),o.media||500)),c=[Zl("play",a(Iu.Play),i),Zl("pause",a(Iu.Pause),i),Zl("seeked",a(Iu.Seeked),i),Zl("volumechange",a(Iu.VolumeChange),i),Zl("ratechange",a(Iu.RateChange),i)];return ju(()=>{c.forEach(e=>e())})}(e);let u=()=>{},d=()=>{},p=()=>{},h=()=>{};e.recordDOM&&(u=function({styleSheetRuleCb:e,mirror:t,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const s=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(s,{apply:ju((r,s,o)=>{const[i,a]=o,{id:c,styleId:l}=Ju(s,t,n.styleMirror);return(c&&-1!==c||l&&-1!==l)&&e({id:c,styleId:l,adds:[{rule:i,index:a}]}),r.apply(s,o)})});const o=r.CSSStyleSheet.prototype.deleteRule;let i,a;r.CSSStyleSheet.prototype.deleteRule=new Proxy(o,{apply:ju((r,s,o)=>{const[i]=o,{id:a,styleId:c}=Ju(s,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:i}]}),r.apply(s,o)})}),r.CSSStyleSheet.prototype.replace&&(i=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(i,{apply:ju((r,s,o)=>{const[i]=o,{id:a,styleId:c}=Ju(s,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replace:i}),r.apply(s,o)})})),r.CSSStyleSheet.prototype.replaceSync&&(a=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:ju((r,s,o)=>{const[i]=o,{id:a,styleId:c}=Ju(s,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replaceSync:i}),r.apply(s,o)})}));const c={};Yu("CSSGroupingRule")?c.CSSGroupingRule=r.CSSGroupingRule:(Yu("CSSMediaRule")&&(c.CSSMediaRule=r.CSSMediaRule),Yu("CSSConditionRule")&&(c.CSSConditionRule=r.CSSConditionRule),Yu("CSSSupportsRule")&&(c.CSSSupportsRule=r.CSSSupportsRule));const l={};return Object.entries(c).forEach(([r,s])=>{l[r]={insertRule:s.prototype.insertRule,deleteRule:s.prototype.deleteRule},s.prototype.insertRule=new Proxy(l[r].insertRule,{apply:ju((r,s,o)=>{const[i,a]=o,{id:c,styleId:l}=Ju(s.parentStyleSheet,t,n.styleMirror);return(c&&-1!==c||l&&-1!==l)&&e({id:c,styleId:l,adds:[{rule:i,index:[...Vu(s),a||0]}]}),r.apply(s,o)})}),s.prototype.deleteRule=new Proxy(l[r].deleteRule,{apply:ju((r,s,o)=>{const[i]=o,{id:a,styleId:c}=Ju(s.parentStyleSheet,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:[...Vu(s),i]}]}),r.apply(s,o)})})}),ju(()=>{r.CSSStyleSheet.prototype.insertRule=s,r.CSSStyleSheet.prototype.deleteRule=o,i&&(r.CSSStyleSheet.prototype.replace=i),a&&(r.CSSStyleSheet.prototype.replaceSync=a),Object.entries(c).forEach(([e,t])=>{t.prototype.insertRule=l[e].insertRule,t.prototype.deleteRule=l[e].deleteRule})})}(e,{win:n}),d=Ku(e,e.doc),p=function({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:n,stylesheetManager:r},{win:s}){const o=s.CSSStyleDeclaration.prototype.setProperty;s.CSSStyleDeclaration.prototype.setProperty=new Proxy(o,{apply:ju((s,i,a)=>{const[c,l,u]=a;if(n.has(c))return o.apply(i,[c,l,u]);const{id:d,styleId:p}=Ju(i.parentRule?.parentStyleSheet,t,r.styleMirror);return(d&&-1!==d||p&&-1!==p)&&e({id:d,styleId:p,set:{property:c,value:l,priority:u},index:Vu(i.parentRule)}),s.apply(i,a)})});const i=s.CSSStyleDeclaration.prototype.removeProperty;return s.CSSStyleDeclaration.prototype.removeProperty=new Proxy(i,{apply:ju((s,o,a)=>{const[c]=a;if(n.has(c))return i.apply(o,[c]);const{id:l,styleId:u}=Ju(o.parentRule?.parentStyleSheet,t,r.styleMirror);return(l&&-1!==l||u&&-1!==u)&&e({id:l,styleId:u,remove:{property:c},index:Vu(o.parentRule)}),s.apply(o,a)})}),ju(()=>{s.CSSStyleDeclaration.prototype.setProperty=o,s.CSSStyleDeclaration.prototype.removeProperty=i})}(e,{win:n}),e.collectFonts&&(h=function({fontCb:e,doc:t}){const n=t.defaultView;if(!n)return()=>{};const r=[],s=new WeakMap,o=n.FontFace;n.FontFace=function(e,t,n){const r=new o(e,t,n);return s.set(r,{family:e,buffer:"string"!=typeof t,descriptors:n,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),r};const i=su(t.fonts,"add",function(t){return function(n){return wu(ju(()=>{const t=s.get(n);t&&(e(t),s.delete(n))}),0),t.apply(this,[n])}});return r.push(()=>{n.FontFace=o}),r.push(i),ju(()=>{r.forEach(e=>e())})}(e)));const f=function(e){const{doc:t,mirror:n,blockClass:r,blockSelector:s,unblockSelector:o,selectionCb:i}=e;let a=!0;const c=ju(()=>{const e=t.getSelection();if(!e||a&&e?.isCollapsed)return;a=e.isCollapsed||!1;const c=[],l=e.rangeCount||0;for(let t=0;t<l;t++){const i=e.getRangeAt(t),{startContainer:a,startOffset:l,endContainer:u,endOffset:d}=i;uu(a,r,s,o,!0)||uu(u,r,s,o,!0)||c.push({start:n.getId(a),startOffset:l,end:n.getId(u),endOffset:d})}i({ranges:c})});return c(),Zl("selectionchange",c)}(e),m=function({doc:e,customElementCb:t}){const n=e.defaultView;return n&&n.customElements?su(n.customElements,"define",function(e){return function(n,r,s){try{t({define:{name:n}})}catch(e){}return e.apply(this,[n,r,s])}}):()=>{}}(e),g=[];for(const t of e.plugins)g.push(t.observer(t.callback,n,t.options));return ju(()=>{$u.forEach(e=>e.reset()),r?.disconnect(),s(),o(),i(),a(),c(),l(),u(),d(),p(),h(),f(),m(),g.forEach(e=>e())})}function Xu(e){return void 0!==window[e]}function Yu(e){return Boolean(void 0!==window[e]&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class Qu{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,n,r){const s=n||this.getIdToRemoteIdMap(e),o=r||this.getRemoteIdToIdMap(e);let i=s.get(t);return i||(i=this.generateIdFn(),s.set(t,i),o.set(i,t)),i}getIds(e,t){const n=this.getIdToRemoteIdMap(e),r=this.getRemoteIdToIdMap(e);return t.map(t=>this.getId(e,t,n,r))}getRemoteId(e,t,n){const r=n||this.getRemoteIdToIdMap(e);if("number"!=typeof t)return t;return r.get(t)||-1}getRemoteIds(e,t){const n=this.getRemoteIdToIdMap(e);return t.map(t=>this.getRemoteId(e,t,n))}reset(e){if(!e)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}class Zu{constructor(){this.crossOriginIframeMirror=new Qu(Nl),this.crossOriginIframeRootIdMap=new WeakMap}addIframe(){}addLoadListener(){}attachIframe(){}}class ed{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new Qu(Nl),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Qu(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),this.recordCrossOriginIframes&&e.contentWindow?.addEventListener("message",this.handleMessage.bind(this)),this.loadListener?.(e);const n=Cu(e);n&&n.adoptedStyleSheets&&n.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(n.adoptedStyleSheets,this.mirror.getId(n))}handleMessage(e){const t=e;if("rrweb"!==t.data.type||t.origin!==t.data.origin)return;if(!e.source)return;const n=this.crossOriginIframeMap.get(e.source);if(!n)return;const r=this.transformCrossOriginEvent(n,t.data.event);r&&this.wrappedEmit(r,t.data.isCheckout)}transformCrossOriginEvent(e,t){switch(t.type){case ku.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);const n=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,n),this.patchRootIdOnNode(t.data.node,n),{timestamp:t.timestamp,type:ku.IncrementalSnapshot,data:{source:xu.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case ku.Meta:case ku.Load:case ku.DomContentLoaded:return!1;case ku.Plugin:return t;case ku.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case ku.IncrementalSnapshot:switch(t.data.source){case xu.Mutation:return t.data.adds.forEach(t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e);const n=this.crossOriginIframeRootIdMap.get(e);n&&this.patchRootIdOnNode(t.node,n)}),t.data.removes.forEach(t=>{this.replaceIds(t,e,["parentId","id"])}),t.data.attributes.forEach(t=>{this.replaceIds(t,e,["id"])}),t.data.texts.forEach(t=>{this.replaceIds(t,e,["id"])}),t;case xu.Drag:case xu.TouchMove:case xu.MouseMove:return t.data.positions.forEach(t=>{this.replaceIds(t,e,["id"])}),t;case xu.ViewportResize:return!1;case xu.MediaInteraction:case xu.MouseInteraction:case xu.Scroll:case xu.CanvasMutation:case xu.Input:return this.replaceIds(t.data,e,["id"]),t;case xu.StyleSheetRule:case xu.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case xu.Font:return t;case xu.Selection:return t.data.ranges.forEach(t=>{this.replaceIds(t,e,["start","end"])}),t;case xu.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),t.data.styles?.forEach(t=>{this.replaceStyleIds(t,e,["styleId"])}),t}}return!1}replace(e,t,n,r){for(const s of r)(Array.isArray(t[s])||"number"==typeof t[s])&&(Array.isArray(t[s])?t[s]=e.getIds(n,t[s]):t[s]=e.getId(n,t[s]));return t}replaceIds(e,t,n){return this.replace(this.crossOriginIframeMirror,e,t,n)}replaceStyleIds(e,t,n){return this.replace(this.crossOriginIframeStyleMirror,e,t,n)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(e=>{this.replaceIdOnNode(e,t)})}patchRootIdOnNode(e,t){e.type===pl.Document||e.rootId||(e.rootId=t),"childNodes"in e&&e.childNodes.forEach(e=>{this.patchRootIdOnNode(e,t)})}}class td{init(){}addShadowRoot(){}observeAttachShadow(){}reset(){}}class nd{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,t){if(!fl(e))return;if(this.shadowDoms.has(e))return;this.shadowDoms.add(e),this.bypassOptions.canvasManager.addShadowRoot(e);const n=Uu({...this.bypassOptions,doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},e);this.restoreHandlers.push(()=>n.disconnect()),this.restoreHandlers.push(Hu({...this.bypassOptions,scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),wu(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(Ku({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){const t=Cu(e),n=function(e){try{return e.contentWindow}catch(e){}}(e);t&&n&&this.patchAttachShadow(n.Element,t)}patchAttachShadow(e,t){const n=this;this.restoreHandlers.push(su(e.prototype,"attachShadow",function(e){return function(r){const s=e.call(this,r);return this.shadowRoot&&bu(this)&&n.addShadowRoot(this.shadowRoot,t),s}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch(e){}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet,this.bypassOptions.canvasManager.resetShadowRoots()}}for(var rd="undefined"==typeof Uint8Array?[]:new Uint8Array(256),sd=0;sd<64;sd++)rd["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(sd)]=sd;class od{reset(){}freeze(){}unfreeze(){}lock(){}unlock(){}snapshot(){}addWindow(){}addShadowRoot(){}resetShadowRoots(){}}class id{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new yu,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;const n={id:t,styleIds:[]},r=[];for(const t of e){let e;this.styleMirror.has(t)?e=this.styleMirror.getId(t):(e=this.styleMirror.add(t),r.push({styleId:e,rules:Array.from(t.rules||CSSRule,(e,t)=>({rule:gl(e),index:t}))})),n.styleIds.push(e)}r.length>0&&(n.styles=r),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class ad{constructor(){this.nodeMap=new WeakMap,this.active=!1}inOtherBuffer(e,t){const n=this.nodeMap.get(e);return n&&Array.from(n).some(e=>e!==t)}add(e,t){this.active||(this.active=!0,function(...e){Su("requestAnimationFrame")(...e)}(()=>{this.nodeMap=new WeakMap,this.active=!1})),this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(t))}destroy(){}}let cd,ld;try{if(2!==Array.from([1],e=>2*e)[0]){const e=document.createElement("iframe");document.body.appendChild(e),Array.from=e.contentWindow?.Array.from||Array.from,document.body.removeChild(e)}}catch(vb){console.debug("Unable to override Array.from",vb)}const ud=new yl;function dd(e={}){const{emit:t,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:s="rr-block",blockSelector:o=null,unblockSelector:i=null,ignoreClass:a="rr-ignore",ignoreSelector:c=null,maskAllText:l=!1,maskTextClass:u="rr-mask",unmaskTextClass:d=null,maskTextSelector:p=null,unmaskTextSelector:h=null,inlineStylesheet:f=!0,maskAllInputs:m,maskInputOptions:g,slimDOMOptions:y,maskAttributeFn:v,maskInputFn:b,maskTextFn:_,maxCanvasSize:S=null,packFn:w,sampling:k={},dataURLOptions:x={},mousemoveWait:T,recordDOM:E=!0,recordCanvas:I=!1,recordCrossOriginIframes:C=!1,recordAfter:M=("DOMContentLoaded"===e.recordAfter?e.recordAfter:"load"),userTriggeredOnInput:R=!1,collectFonts:O=!1,inlineImages:A=!1,plugins:N,keepIframeSrcFn:D=()=>!1,ignoreCSSAttributes:L=new Set([]),errorHandler:P,onMutation:F,getCanvasManager:j}=e;Fu=P;const $=!C||window.parent===window;let B=!1;if(!$)try{window.parent.document&&(B=!1)}catch(e){B=!0}if($&&!t)throw new Error("emit function is required");if(!$&&!B)return()=>{};void 0!==T&&void 0===k.mousemove&&(k.mousemove=T),ud.reset();const U=!0===m?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:void 0!==g?g:{},H=!0===y||"all"===y?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===y,headMetaDescKeywords:"all"===y}:y||{};let z;!function(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}();let q=0;const W=e=>{for(const t of N||[])t.eventProcessor&&(e=t.eventProcessor(e));return w&&!B&&(e=w(e)),e};cd=(e,s)=>{const o=e;if(o.timestamp=ou(),!$u[0]?.isFrozen()||o.type===ku.FullSnapshot||o.type===ku.IncrementalSnapshot&&o.data.source===xu.Mutation||$u.forEach(e=>e.unfreeze()),$)t?.(W(o),s);else if(B){const e={type:"rrweb",event:W(o),origin:window.location.origin,isCheckout:s};window.parent.postMessage(e,"*")}if(o.type===ku.FullSnapshot)z=o,q=0;else if(o.type===ku.IncrementalSnapshot){if(o.data.source===xu.Mutation&&o.data.isAttachIframe)return;q++;const e=r&&q>=r,t=n&&z&&o.timestamp-z.timestamp>n;(e||t)&&ee(!0)}};const V=e=>{cd({type:ku.IncrementalSnapshot,data:{source:xu.Mutation,...e}})},J=e=>cd({type:ku.IncrementalSnapshot,data:{source:xu.Scroll,...e}}),K=e=>cd({type:ku.IncrementalSnapshot,data:{source:xu.CanvasMutation,...e}}),G=new id({mutationCb:V,adoptedStyleSheetCb:e=>cd({type:ku.IncrementalSnapshot,data:{source:xu.AdoptedStyleSheet,...e}})}),X="boolean"==typeof __RRWEB_EXCLUDE_IFRAME__&&__RRWEB_EXCLUDE_IFRAME__?new Zu:new ed({mirror:ud,mutationCb:V,stylesheetManager:G,recordCrossOriginIframes:C,wrappedEmit:cd});for(const e of N||[])e.getMirror&&e.getMirror({nodeMirror:ud,crossOriginIframeMirror:X.crossOriginIframeMirror,crossOriginIframeStyleMirror:X.crossOriginIframeStyleMirror});const Y=new ad,Q=function(e,t){try{return e?e(t):new od}catch{return console.warn("Unable to initialize CanvasManager"),new od}}(j,{mirror:ud,win:window,mutationCb:e=>cd({type:ku.IncrementalSnapshot,data:{source:xu.CanvasMutation,...e}}),recordCanvas:I,blockClass:s,blockSelector:o,unblockSelector:i,maxCanvasSize:S,sampling:k.canvas,dataURLOptions:x,errorHandler:P}),Z="boolean"==typeof __RRWEB_EXCLUDE_SHADOW_DOM__&&__RRWEB_EXCLUDE_SHADOW_DOM__?new td:new nd({mutationCb:V,scrollCb:J,bypassOptions:{onMutation:F,blockClass:s,blockSelector:o,unblockSelector:i,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:p,unmaskTextSelector:h,inlineStylesheet:f,maskInputOptions:U,dataURLOptions:x,maskAttributeFn:v,maskTextFn:_,maskInputFn:b,recordCanvas:I,inlineImages:A,sampling:k,slimDOMOptions:H,iframeManager:X,stylesheetManager:G,canvasManager:Q,keepIframeSrcFn:D,processedNodeManager:Y,ignoreCSSAttributes:L},mirror:ud}),ee=(e=!1)=>{if(!E)return;cd({type:ku.Meta,data:{href:window.location.href,width:cu(),height:au()}},e),G.reset(),Z.init(),$u.forEach(e=>e.lock());const t=function(e,t){const{mirror:n=new yl,blockClass:r="rr-block",blockSelector:s=null,unblockSelector:o=null,maskAllText:i=!1,maskTextClass:a="rr-mask",unmaskTextClass:c=null,maskTextSelector:l=null,unmaskTextSelector:u=null,inlineStylesheet:d=!0,inlineImages:p=!1,recordCanvas:h=!1,maskAllInputs:f=!1,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOM:v=!1,dataURLOptions:b,preserveWhiteSpace:_,onSerialize:S,onIframeLoad:w,iframeLoadTimeout:k,onBlockedImageLoad:x,onStylesheetLoad:T,stylesheetLoadTimeout:E,keepIframeSrcFn:I=()=>!1,ignoreCSSAttributes:C=new Set([])}=t||{};return Ql(e,{doc:e,mirror:n,blockClass:r,blockSelector:s,unblockSelector:o,maskAllText:i,maskTextClass:a,unmaskTextClass:c,maskTextSelector:l,unmaskTextSelector:u,skipChild:!1,inlineStylesheet:d,maskInputOptions:!0===f?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:!1===f?{}:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:!0===v||"all"===v?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===v,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===v?{}:v,dataURLOptions:b,inlineImages:p,recordCanvas:h,preserveWhiteSpace:_,onSerialize:S,onIframeLoad:w,iframeLoadTimeout:k,onBlockedImageLoad:x,onStylesheetLoad:T,stylesheetLoadTimeout:E,keepIframeSrcFn:I,newlyAddedElement:!1,ignoreCSSAttributes:C})}(document,{mirror:ud,blockClass:s,blockSelector:o,unblockSelector:i,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:p,unmaskTextSelector:h,inlineStylesheet:f,maskAllInputs:U,maskAttributeFn:v,maskInputFn:b,maskTextFn:_,slimDOM:H,dataURLOptions:x,recordCanvas:I,inlineImages:A,onSerialize:e=>{fu(e,ud)&&X.addIframe(e),mu(e,ud)&&G.trackLinkElement(e),gu(e)&&Z.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{X.attachIframe(e,t),e.contentWindow&&Q.addWindow(e.contentWindow),Z.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{G.attachLinkElement(e,t)},onBlockedImageLoad:(e,t,{width:n,height:r})=>{V({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:{style:{width:`${n}px`,height:`${r}px`}}}]})},keepIframeSrcFn:D,ignoreCSSAttributes:L});if(!t)return console.warn("Failed to snapshot the document");cd({type:ku.FullSnapshot,data:{node:t,initialOffset:iu(window)}}),$u.forEach(e=>e.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&G.adoptStyleSheets(document.adoptedStyleSheets,ud.getId(document))};ld=ee;try{const e=[],t=e=>ju(Gu)({onMutation:F,mutationCb:V,mousemoveCb:(e,t)=>cd({type:ku.IncrementalSnapshot,data:{source:t,positions:e}}),mouseInteractionCb:e=>cd({type:ku.IncrementalSnapshot,data:{source:xu.MouseInteraction,...e}}),scrollCb:J,viewportResizeCb:e=>cd({type:ku.IncrementalSnapshot,data:{source:xu.ViewportResize,...e}}),inputCb:e=>cd({type:ku.IncrementalSnapshot,data:{source:xu.Input,...e}}),mediaInteractionCb:e=>cd({type:ku.IncrementalSnapshot,data:{source:xu.MediaInteraction,...e}}),styleSheetRuleCb:e=>cd({type:ku.IncrementalSnapshot,data:{source:xu.StyleSheetRule,...e}}),styleDeclarationCb:e=>cd({type:ku.IncrementalSnapshot,data:{source:xu.StyleDeclaration,...e}}),canvasMutationCb:K,fontCb:e=>cd({type:ku.IncrementalSnapshot,data:{source:xu.Font,...e}}),selectionCb:e=>{cd({type:ku.IncrementalSnapshot,data:{source:xu.Selection,...e}})},customElementCb:e=>{cd({type:ku.IncrementalSnapshot,data:{source:xu.CustomElement,...e}})},blockClass:s,ignoreClass:a,ignoreSelector:c,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:p,unmaskTextSelector:h,maskInputOptions:U,inlineStylesheet:f,sampling:k,recordDOM:E,recordCanvas:I,inlineImages:A,userTriggeredOnInput:R,collectFonts:O,doc:e,maskAttributeFn:v,maskInputFn:b,maskTextFn:_,keepIframeSrcFn:D,blockSelector:o,unblockSelector:i,slimDOMOptions:H,dataURLOptions:x,mirror:ud,iframeManager:X,stylesheetManager:G,shadowDomManager:Z,processedNodeManager:Y,canvasManager:Q,ignoreCSSAttributes:L,plugins:N?.filter(e=>e.observer)?.map(e=>({observer:e.observer,options:e.options,callback:t=>cd({type:ku.Plugin,data:{plugin:e.name,payload:t}})}))||[]},{});X.addLoadListener(n=>{try{e.push(t(n.contentDocument))}catch(e){console.warn(e)}});const n=()=>{ee(),e.push(t(document))};return"interactive"===document.readyState||"complete"===document.readyState?n():(e.push(Zl("DOMContentLoaded",()=>{cd({type:ku.DomContentLoaded,data:{}}),"DOMContentLoaded"===M&&n()})),e.push(Zl("load",()=>{cd({type:ku.Load,data:{}}),"load"===M&&n()},window))),()=>{e.forEach(e=>e()),Y.destroy(),ld=void 0,Fu=void 0}}catch(e){console.warn(e)}}var pd,hd;function fd(e){return e>9999999999?e:1e3*e}function md(e){return e>9999999999?e/1e3:e}function gd(e,t){"sentry.transaction"!==t.category&&(["ui.click","ui.input"].includes(t.category)?e.triggerUserActivity():e.checkAndHandleExpiredSession(),e.addUpdate(()=>(e.throttledAddEvent({type:ku.Custom,timestamp:1e3*(t.timestamp||0),data:{tag:"breadcrumb",payload:wn(t,10,1e3)}}),"console"===t.category)))}function yd(e){return e.closest("button,a")||e}function vd(e){const t=bd(e);return t&&t instanceof Element?yd(t):t}function bd(e){return function(e){return"object"==typeof e&&!!e&&"target"in e}(e)?e.target:e}let _d;dd.mirror=ud,dd.takeFullSnapshot=function(e){if(!ld)throw new Error("please take full snapshot after start recording");ld(e)},(hd=pd||(pd={}))[hd.NotStarted=0]="NotStarted",hd[hd.Running=1]="Running",hd[hd.Stopped=2]="Stopped";const Sd=new Set([xu.Mutation,xu.StyleSheetRule,xu.StyleDeclaration,xu.AdoptedStyleSheet,xu.CanvasMutation,xu.Selection,xu.MediaInteraction]);class wd{constructor(e,t,n=gd){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=t.timeout/1e3,this._threshold=t.threshold/1e3,this._scrollTimeout=t.scrollTimeout/1e3,this._replay=e,this._ignoreSelector=t.ignoreSelector,this._addBreadcrumbEvent=n}addListeners(){const e=(t=()=>{this._lastMutation=xd()},_d||(_d=[],$(sl,"open",function(e){return function(...t){if(_d)try{_d.forEach(e=>e())}catch{}return e.apply(sl,t)}})),_d.push(t),()=>{const e=_d?_d.indexOf(t):-1;e>-1&&_d.splice(e,1)});var t;this._teardown=()=>{e(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(e,t){if(function(e,t){return!kd.includes(e.tagName)||("INPUT"===e.tagName&&!["submit","button"].includes(e.getAttribute("type")||"")||(!("A"!==e.tagName||!(e.hasAttribute("download")||e.hasAttribute("target")&&"_self"!==e.getAttribute("target")))||!(!t||!e.matches(t))))}(t,this._ignoreSelector)||!function(e){return!(!e.data||"number"!=typeof e.data.nodeId||!e.timestamp)}(e))return;const n={timestamp:md(e.timestamp),clickBreadcrumb:e,clickCount:0,node:t};this._clicks.some(e=>e.node===n.node&&Math.abs(e.timestamp-n.timestamp)<1)||(this._clicks.push(n),1===this._clicks.length&&this._scheduleCheckClicks())}registerMutation(e=Date.now()){this._lastMutation=md(e)}registerScroll(e=Date.now()){this._lastScroll=md(e)}registerClick(e){const t=yd(e);this._handleMultiClick(t)}_handleMultiClick(e){this._getClicks(e).forEach(e=>{e.clickCount++})}_getClicks(e){return this._clicks.filter(t=>t.node===e)}_checkClicks(){const e=[],t=xd();this._clicks.forEach(n=>{!n.mutationAfter&&this._lastMutation&&(n.mutationAfter=n.timestamp<=this._lastMutation?this._lastMutation-n.timestamp:void 0),!n.scrollAfter&&this._lastScroll&&(n.scrollAfter=n.timestamp<=this._lastScroll?this._lastScroll-n.timestamp:void 0),n.timestamp+this._timeout<=t&&e.push(n)});for(const t of e){const e=this._clicks.indexOf(t);e>-1&&(this._generateBreadcrumbs(t),this._clicks.splice(e,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(e){const t=this._replay,n=e.scrollAfter&&e.scrollAfter<=this._scrollTimeout,r=e.mutationAfter&&e.mutationAfter<=this._threshold,s=!n&&!r,{clickCount:o,clickBreadcrumb:i}=e;if(s){const n=1e3*Math.min(e.mutationAfter||this._timeout,this._timeout),r=n<1e3*this._timeout?"mutation":"timeout",s={type:"default",message:i.message,timestamp:i.timestamp,category:"ui.slowClickDetected",data:{...i.data,url:sl.location.href,route:t.getCurrentRoute(),timeAfterClickMs:n,endReason:r,clickCount:o||1}};return void this._addBreadcrumbEvent(t,s)}if(o>1){const e={type:"default",message:i.message,timestamp:i.timestamp,category:"ui.multiClick",data:{...i.data,url:sl.location.href,route:t.getCurrentRoute(),clickCount:o,metric:!0}};this._addBreadcrumbEvent(t,e)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=oi(()=>this._checkClicks(),1e3)}}const kd=["A","BUTTON","INPUT"];function xd(){return Date.now()/1e3}function Td(e){return{timestamp:Date.now()/1e3,type:"default",...e}}var Ed=(e=>(e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment",e))(Ed||{});const Id=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled","data-sentry-component"]);function Cd(e){const t={};!e["data-sentry-component"]&&e["data-sentry-element"]&&(e["data-sentry-component"]=e["data-sentry-element"]);for(const n in e)if(Id.has(n)){let r=n;"data-testid"!==n&&"data-test-id"!==n||(r="testId"),t[r]=e[n]}return t}function Md(e,t){const n=dd.mirror.getId(e),r=n&&dd.mirror.getNode(n),s=r&&dd.mirror.getMeta(r),o=s&&function(e){return e.type===Ed.Element}(s)?s:null;return{message:t,data:o?{nodeId:n,node:{id:n,tagName:o.tagName,textContent:Array.from(o.childNodes).map(e=>e.type===Ed.Text&&e.textContent).filter(Boolean).map(e=>e.trim()).join(""),attributes:Cd(o.attributes)}}:{}}}const Rd={resource:function(e){const{entryType:t,initiatorType:n,name:r,responseEnd:s,startTime:o,decodedBodySize:i,encodedBodySize:a,responseStatus:c,transferSize:l}=e;return["fetch","xmlhttprequest"].includes(n)?null:{type:`${t}.${n}`,start:Nd(o),end:Nd(s),name:r,data:{size:l,statusCode:c,decodedBodySize:i,encodedBodySize:a}}},paint:function(e){const{duration:t,entryType:n,name:r,startTime:s}=e,o=Nd(s);return{type:n,name:r,start:o,end:o+t,data:void 0}},navigation:function(e){const{entryType:t,name:n,decodedBodySize:r,duration:s,domComplete:o,encodedBodySize:i,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,domInteractive:l,loadEventStart:u,loadEventEnd:d,redirectCount:p,startTime:h,transferSize:f,type:m}=e;return 0===s?null:{type:`${t}.${m}`,start:Nd(h),end:Nd(o),name:n,data:{size:f,decodedBodySize:r,encodedBodySize:i,duration:s,domInteractive:l,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,loadEventStart:u,loadEventEnd:d,domComplete:o,redirectCount:p}}}};function Od(e,t){return({metric:n})=>{t.replayPerformanceEntries.push(e(n))}}function Ad(e){const t=Rd[e.entryType];return t?t(e):null}function Nd(e){return((be()||sl.performance.timeOrigin)+e)/1e3}function Dd(e){const t=e.entries[e.entries.length-1];return jd(e,"largest-contentful-paint",t?.element?[t.element]:void 0)}function Ld(e){return void 0!==e.sources}function Pd(e){const t=[],n=[];for(const r of e.entries)if(Ld(r)){const e=[];for(const t of r.sources)if(t.node){n.push(t.node);const r=dd.mirror.getId(t.node);r&&e.push(r)}t.push({value:r.value,nodeIds:e.length?e:void 0})}return jd(e,"cumulative-layout-shift",n,t)}function Fd(e){const t=e.entries[e.entries.length-1];return jd(e,"interaction-to-next-paint",t?.target?[t.target]:void 0)}function jd(e,t,n,r){const s=e.value,o=e.rating,i=Nd(s);return{type:"web-vital",name:t,start:i,end:i,data:{value:s,size:s,rating:o,nodeIds:n?n.map(e=>dd.mirror.getId(e)):void 0,attributions:r}}}const $d="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,Bd=["log","warn","error"],Ud="[Replay] ";function Hd(e,t="info"){qs({category:"console",data:{logger:"replay"},level:t,message:`${Ud}${e}`},{level:t})}const zd=function(){let e=!1,t=!1;const n={exception:()=>{},infoTick:()=>{},setConfig:n=>{e=!!n.captureExceptions,t=!!n.traceInternals}};return $d?(Bd.forEach(e=>{n[e]=(...n)=>{j[e](Ud,...n),t&&Hd(n.join(""),Ws(e))}}),n.exception=(r,...s)=>{s.length&&n.error&&n.error(...s),j.error(Ud,r),e?ns(r,{mechanism:{handled:!0,type:"auto.function.replay.debug"}}):t&&Hd(r,"error")},n.infoTick=(...e)=>{j.log(Ud,...e),t&&setTimeout(()=>Hd(e[0]),0)}):Bd.forEach(e=>{n[e]=()=>{}}),n}();class qd extends Error{constructor(){super("Event buffer exceeded maximum size of 20000000.")}}class Wd{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1,this.waitForCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(e){const t=JSON.stringify(e).length;if(this._totalSize+=t,this._totalSize>ll)throw new qd;this.events.push(e)}finish(){return new Promise(e=>{const t=this.events;this.clear(),e(JSON.stringify(t))})}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const e=this.events.map(e=>e.timestamp).sort()[0];return e?fd(e):null}}class Vd{constructor(e){this._worker=e,this._id=0}ensureReady(){return this._ensureReadyPromise||(this._ensureReadyPromise=new Promise((e,t)=>{this._worker.addEventListener("message",({data:n})=>{n.success?e():t()},{once:!0}),this._worker.addEventListener("error",e=>{t(e)},{once:!0})})),this._ensureReadyPromise}destroy(){$d&&zd.log("Destroying compression worker"),this._worker.terminate()}postMessage(e,t){const n=this._getAndIncrementId();return new Promise((r,s)=>{const o=({data:t})=>{const i=t;if(i.method===e&&i.id===n){if(this._worker.removeEventListener("message",o),!i.success)return $d&&zd.error("Error in compression worker: ",i.response),void s(new Error("Error in compression worker"));r(i.response)}};this._worker.addEventListener("message",o),this._worker.postMessage({id:n,method:e,arg:t})})}_getAndIncrementId(){return this._id++}}class Jd{constructor(e){this._worker=new Vd(e),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this.waitForCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(e){const t=fd(e.timestamp);(!this._earliestTimestamp||t<this._earliestTimestamp)&&(this._earliestTimestamp=t);const n=JSON.stringify(e);return this._totalSize+=n.length,this._totalSize>ll?Promise.reject(new qd):this._sendEventToWorker(n)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear").then(null,e=>{$d&&zd.exception(e,'Sending "clear" message to worker failed',e)})}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(e){return this._worker.postMessage("addEvent",e)}async _finishRequest(){const e=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,e}}class Kd{constructor(e){this._fallback=new Wd,this._compression=new Jd(e),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get waitForCheckout(){return this._used.waitForCheckout}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(e){this._used.hasCheckout=e}set waitForCheckout(e){this._used.waitForCheckout=e}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(e){return this._used.addEvent(e)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch(e){return void($d&&zd.exception(e,"Failed to load the compression worker, falling back to simple buffer"))}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:e,hasCheckout:t,waitForCheckout:n}=this._fallback,r=[];for(const t of e)r.push(this._compression.addEvent(t));this._compression.hasCheckout=t,this._compression.waitForCheckout=n,this._used=this._compression;try{await Promise.all(r),this._fallback.clear()}catch(e){$d&&zd.exception(e,"Failed to add events when switching buffers.")}}}function Gd(){try{return"sessionStorage"in sl&&!!sl.sessionStorage}catch{return!1}}function Xd(e){return void 0!==e&&Math.random()<e}function Yd(e){if(Gd())try{sl.sessionStorage.setItem(ol,JSON.stringify(e))}catch{}}function Qd(e){const t=Date.now();return{id:e.id||ce(),started:e.started||t,lastActivity:e.lastActivity||t,segmentId:e.segmentId||0,sampled:e.sampled,previousSessionId:e.previousSessionId,dirty:e.dirty||!1}}function Zd({sessionSampleRate:e,allowBuffering:t,stickySession:n=!1},{previousSessionId:r}={}){const s=function(e,t){return Xd(e)?"session":!!t&&"buffer"}(e,t),o=Qd({sampled:s,previousSessionId:r});return n&&Yd(o),o}function ep(e,t,n=+new Date){return null===e||void 0===t||t<0||0!==t&&e+t<=n}function tp(e,{maxReplayDuration:t,sessionIdleExpire:n,targetTime:r=Date.now()}){return ep(e.started,t,r)||ep(e.lastActivity,n,r)}function np(e,{sessionIdleExpire:t,maxReplayDuration:n}){return!!tp(e,{sessionIdleExpire:t,maxReplayDuration:n})&&("buffer"!==e.sampled||0!==e.segmentId)}function rp({sessionIdleExpire:e,maxReplayDuration:t,previousSessionId:n},r){const s=r.stickySession&&function(){if(!Gd())return null;try{const e=sl.sessionStorage.getItem(ol);if(!e)return null;const t=JSON.parse(e);return $d&&zd.infoTick("Loading existing session"),Qd(t)}catch{return null}}();return s?np(s,{sessionIdleExpire:e,maxReplayDuration:t})?($d&&zd.infoTick("Session in sessionStorage is expired, creating new one..."),Zd(r,{previousSessionId:s.id})):s:($d&&zd.infoTick("Creating new session"),Zd(r,{previousSessionId:n}))}function sp(e,t,n){return!!ip(e,t)&&(op(e,t,n),!0)}async function op(e,t,n){const{eventBuffer:r}=e;if(!r||r.waitForCheckout&&!n)return null;const s="buffer"===e.recordingMode;try{n&&s&&r.clear(),n&&(r.hasCheckout=!0,r.waitForCheckout=!1);const o=function(e,t){try{if("function"==typeof t&&function(e){return e.type===ku.Custom}(e))return t(e)}catch(e){return $d&&zd.exception(e,"An error occurred in the `beforeAddRecordingEvent` callback, skipping the event..."),null}return e}(t,e.getOptions().beforeAddRecordingEvent);if(!o)return;return await r.addEvent(o)}catch(t){const n=t&&t instanceof qd,o=n?"addEventSizeExceeded":"addEvent",i=$e();if(i){const e=n?"buffer_overflow":"internal_sdk_error";i.recordDroppedEvent(e,"replay")}if(n&&s)return r.clear(),r.waitForCheckout=!0,null;e.handleException(t),await e.stop({reason:o})}}function ip(e,t){if(!e.eventBuffer||e.isPaused()||!e.isEnabled())return!1;const n=fd(t.timestamp);return!(n+e.timeouts.sessionIdlePause<Date.now()||n>e.getContext().initialTimestamp+e.getOptions().maxReplayDuration&&($d&&zd.infoTick(`Skipping event with timestamp ${n} because it is after maxReplayDuration`),1))}function ap(e){return!e.type}function cp(e){return"transaction"===e.type}function lp(e){return"feedback"===e.type}function up(e){return!!e.category}function dp(){const e=De().getPropagationContext().dsc;e&&delete e.replay_id;const t=hn();t&&delete _n(t).replay_id}function pp(e,t){return t.map(({type:t,start:n,end:r,name:s,data:o})=>{const i=e.throttledAddEvent({type:ku.Custom,timestamp:n,data:{tag:"performanceSpan",payload:{op:t,description:s,startTimestamp:n,endTimestamp:r,data:o}}});return"string"==typeof i?Promise.resolve(null):i})}function hp(e,t){e.isEnabled()&&null!==t&&(function(e,t){return(!$d||!e.getOptions()._experiments.traceInternals)&&nl(t,$e())}(e,t.name)||e.addUpdate(()=>(pp(e,[t]),!0)))}function fp(e){if(!e)return;const t=new TextEncoder;try{if("string"==typeof e)return t.encode(e).length;if(e instanceof URLSearchParams)return t.encode(e.toString()).length;if(e instanceof FormData){const n=cc(e);return t.encode(n).length}if(e instanceof Blob)return e.size;if(e instanceof ArrayBuffer)return e.byteLength}catch{}}function mp(e){if(!e)return;const t=parseInt(e,10);return isNaN(t)?void 0:t}function gp(e,t){if(!e)return{headers:{},size:void 0,_meta:{warnings:[t]}};const n={...e._meta},r=n.warnings||[];return n.warnings=[...r,t],e._meta=n,e}function yp(e,t){if(!t)return null;const{startTimestamp:n,endTimestamp:r,url:s,method:o,statusCode:i,request:a,response:c}=t;return{type:e,start:n/1e3,end:r/1e3,name:s,data:{method:o,statusCode:i,request:a,response:c}}}function vp(e){return{headers:{},size:e,_meta:{warnings:["URL_SKIPPED"]}}}function bp(e,t,n){if(!t&&0===Object.keys(e).length)return;if(!t)return{headers:e};if(!n)return{headers:e,size:t};const r={headers:e,size:t},{body:s,warnings:o}=function(e){if(!e||"string"!=typeof e)return{body:e};const t=e.length>al,n=function(e){const t=e[0],n=e[e.length-1];return"["===t&&"]"===n||"{"===t&&"}"===n}(e);if(t){const t=e.slice(0,al);return n?{body:t,warnings:["MAYBE_JSON_TRUNCATED"]}:{body:`${t}â¦`,warnings:["TEXT_TRUNCATED"]}}if(n)try{return{body:JSON.parse(e)}}catch{}return{body:e}}(n);return r.body=s,o?.length&&(r._meta={warnings:o}),r}function _p(e,t){return Object.entries(e).reduce((n,[r,s])=>{const o=r.toLowerCase();return t.includes(o)&&e[r]&&(n[o]=s),n},{})}function Sp(e,t){const n=function(e,t=sl.document.baseURI){if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith(sl.location.origin))return e;const n=new URL(e,t);if(n.origin!==new URL(t).origin)return e;const r=n.href;return!e.endsWith("/")&&r.endsWith("/")?r.slice(0,-1):r}(e);return ie(n,t)}function wp(e,t){const n={};return t.forEach(t=>{e.get(t)&&(n[t]=e.get(t))}),n}function kp(e,t){if(!e)return{};const n=e.headers;return n?n instanceof Headers?wp(n,t):Array.isArray(n)?{}:_p(n,t):{}}function xp(e){const t=$e();try{const{networkDetailAllowUrls:n,networkDetailDenyUrls:r,networkCaptureBodies:s,networkRequestHeaders:o,networkResponseHeaders:i}=e.getOptions(),a={replay:e,networkDetailAllowUrls:n,networkDetailDenyUrls:r,networkCaptureBodies:s,networkRequestHeaders:o,networkResponseHeaders:i};t&&t.on("beforeAddBreadcrumb",(e,t)=>function(e,t,n){if(t.data)try{(function(e){return"xhr"===e.category})(t)&&function(e){return e?.xhr}(n)&&(function(e,t){const{xhr:n,input:r}=t;if(!n)return;const s=fp(r),o=n.getResponseHeader("content-length")?mp(n.getResponseHeader("content-length")):function(e,t){try{return fp("json"===t&&e&&"object"==typeof e?JSON.stringify(e):e)}catch{return}}(n.response,n.responseType);void 0!==s&&(e.data.request_body_size=s),void 0!==o&&(e.data.response_body_size=o)}(t,n),async function(e,t,n){try{const r=function(e,t,n){const r=Date.now(),{startTimestamp:s=r,endTimestamp:o=r,input:i,xhr:a}=t,{url:c,method:l,status_code:u=0,request_body_size:d,response_body_size:p}=e.data;if(!c)return null;if(!a||!Sp(c,n.networkDetailAllowUrls)||Sp(c,n.networkDetailDenyUrls))return{startTimestamp:s,endTimestamp:o,url:c,method:l,statusCode:u,request:vp(d),response:vp(p)};const h=a[io],f=h?_p(h.request_headers,n.networkRequestHeaders):{},m=_p(dc(a),n.networkResponseHeaders),[g,y]=n.networkCaptureBodies?lc(i,zd):[void 0],[v,b]=n.networkCaptureBodies?function(e){const t=[];try{return[e.responseText]}catch(e){t.push(e)}try{return function(e,t){try{if("string"==typeof e)return[e];if(e instanceof Document)return[e.body.outerHTML];if("json"===t&&e&&"object"==typeof e)return[JSON.stringify(e)];if(!e)return[void 0]}catch(t){return $d&&zd.exception(t,"Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return $d&&zd.log("Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}(e.response,e.responseType)}catch(e){t.push(e)}return $d&&zd.warn("Failed to get xhr response body",...t),[void 0]}(a):[void 0],_=bp(f,d,g),S=bp(m,p,v);return{startTimestamp:s,endTimestamp:o,url:c,method:l,statusCode:u,request:y?gp(_,y):_,response:b?gp(S,b):S}}(e,t,n),s=yp("resource.xhr",r);hp(n.replay,s)}catch(e){$d&&zd.exception(e,"Failed to capture xhr breadcrumb")}}(t,n,e)),function(e){return"fetch"===e.category}(t)&&function(e){return e?.response}(n)&&(function(e,t){const{input:n,response:r}=t,s=fp(n?uc(n):void 0),o=r?mp(r.headers.get("content-length")):void 0;void 0!==s&&(e.data.request_body_size=s),void 0!==o&&(e.data.response_body_size=o)}(t,n),async function(e,t,n){try{const r=await async function(e,t,n){const r=Date.now(),{startTimestamp:s=r,endTimestamp:o=r}=t,{url:i,method:a,status_code:c=0,request_body_size:l,response_body_size:u}=e.data,d=Sp(i,n.networkDetailAllowUrls)&&!Sp(i,n.networkDetailDenyUrls),p=d?function({networkCaptureBodies:e,networkRequestHeaders:t},n,r){const s=n?(i=t,1===(o=n).length&&"string"!=typeof o[0]?kp(o[0],i):2===o.length?kp(o[1],i):{}):{};var o,i;if(!e)return bp(s,r,void 0);const a=uc(n),[c,l]=lc(a,zd),u=bp(s,r,c);return l?gp(u,l):u}(n,t.input,l):vp(l),h=await async function(e,{networkCaptureBodies:t,networkResponseHeaders:n},r,s){if(!e&&void 0!==s)return vp(s);const o=r?wp(r.headers,n):{};if(!r||!t&&void 0!==s)return bp(o,s,void 0);const[i,a]=await async function(e){const t=function(e){try{return e.clone()}catch(e){$d&&zd.exception(e,"Failed to clone response body")}}(e);if(!t)return[void 0,"BODY_PARSE_ERROR"];try{const e=await function(e){return new Promise((t,n)=>{const r=oi(()=>n(new Error("Timeout while trying to read response body")),500);(async function(e){return await e.text()})(e).then(e=>t(e),e=>n(e)).finally(()=>clearTimeout(r))})}(t);return[e]}catch(e){return e instanceof Error&&e.message.indexOf("Timeout")>-1?($d&&zd.warn("Parsing text body from response timed out"),[void 0,"BODY_PARSE_TIMEOUT"]):($d&&zd.exception(e,"Failed to get text body from response"),[void 0,"BODY_PARSE_ERROR"])}}(r),c=function(e,{networkCaptureBodies:t,responseBodySize:n,captureDetails:r,headers:s}){try{const o=e?.length&&void 0===n?fp(e):n;return r?bp(s,o,t?e:void 0):vp(o)}catch(e){return $d&&zd.exception(e,"Failed to serialize response body"),bp(s,n,void 0)}}(i,{networkCaptureBodies:t,responseBodySize:s,captureDetails:e,headers:o});return a?gp(c,a):c}(d,n,t.response,u);return{startTimestamp:s,endTimestamp:o,url:i,method:a,statusCode:c,request:p,response:h}}(e,t,n),s=yp("resource.fetch",r);hp(n.replay,s)}catch(e){$d&&zd.exception(e,"Failed to capture fetch breadcrumb")}}(t,n,e))}catch(e){$d&&zd.exception(e,"Error when enriching network breadcrumb")}}(a,e,t))}catch{}}function Tp(e){const{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:r}=e,s=Date.now()/1e3;return{type:"memory",name:"memory",start:s,end:s,data:{memory:{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:r}}}}const Ep=c.navigator;function Ip(e){let t=!1;return(n,r)=>{if(!e.checkAndHandleExpiredSession())return void($d&&zd.warn("Received replay event after session expired."));const s=r||!t;t=!0,e.clickDetector&&function(e,t){try{if(!function(e){return 3===e.type}(t))return;const{source:n}=t.data;if(Sd.has(n)&&e.registerMutation(t.timestamp),n===xu.Scroll&&e.registerScroll(t.timestamp),function(e){return e.data.source===xu.MouseInteraction}(t)){const{type:n,id:r}=t.data,s=dd.mirror.getNode(r);s instanceof HTMLElement&&n===Tu.Click&&e.registerClick(s)}}catch{}}(e.clickDetector,n),e.addUpdate(()=>{if("buffer"===e.recordingMode&&s&&e.setInitialState(),!sp(e,n,s))return!0;if(!s)return!1;const t=e.session;if(function(e,t){t&&e.session&&0===e.session.segmentId&&sp(e,function(e){const t=e.getOptions();return{type:ku.Custom,timestamp:Date.now(),data:{tag:"options",payload:{shouldRecordCanvas:e.isRecordingCanvas(),sessionSampleRate:t.sessionSampleRate,errorSampleRate:t.errorSampleRate,useCompressionOption:t.useCompression,blockAllMedia:t.blockAllMedia,maskAllText:t.maskAllText,maskAllInputs:t.maskAllInputs,useCompression:!!e.eventBuffer&&"worker"===e.eventBuffer.type,networkDetailHasUrls:t.networkDetailAllowUrls.length>0,networkCaptureBodies:t.networkCaptureBodies,networkRequestHasHeaders:t.networkRequestHeaders.length>0,networkResponseHasHeaders:t.networkResponseHeaders.length>0}}}}(e),!1)}(e,s),"buffer"===e.recordingMode&&t&&e.eventBuffer&&!t.dirty){const n=e.eventBuffer.getEarliestTimestamp();n&&($d&&zd.log(`Updating session start time to earliest event in buffer to ${new Date(n)}`),t.started=n,e.getOptions().stickySession&&Yd(t))}return t?.previousSessionId||"session"===e.recordingMode&&e.flush(),!0})}}class Cp extends Error{constructor(e){super(`Transport returned status code ${e}`)}}class Mp extends Error{constructor(e){super("Rate limit hit"),this.rateLimits=e}}async function Rp(e,t={count:0,interval:5e3}){const{recordingData:n,onError:r}=e;if(n.length)try{return await async function({recordingData:e,replayId:t,segmentId:n,eventContext:r,timestamp:s,session:o}){const i=function({recordingData:e,headers:t}){let n;const r=`${JSON.stringify(t)}\n`;if("string"==typeof e)n=`${r}${e}`;else{const t=(new TextEncoder).encode(r);n=new Uint8Array(t.length+e.length),n.set(t),n.set(e,t.length)}return n}({recordingData:e,headers:{segment_id:n}}),{urls:a,errorIds:c,traceIds:l,initialTimestamp:u}=r,d=$e(),p=De(),h=d?.getTransport(),f=d?.getDsn();if(!(d&&h&&f&&o.sampled))return Promise.resolve({});const m={type:"replay_event",replay_start_timestamp:u/1e3,timestamp:s/1e3,error_ids:c,trace_ids:l,urls:a,replay_id:t,segment_id:n,replay_type:o.sampled},g=await async function({client:e,scope:t,replayId:n,event:r}){const s={event_id:n,integrations:"object"!=typeof e._integrations||null===e._integrations||Array.isArray(e._integrations)?void 0:Object.keys(e._integrations)};e.emit("preprocessEvent",r,s);const o=await xr(e.getOptions(),r,s,t,e,Le());if(!o)return null;e.emit("postprocessEvent",o,s),o.platform=o.platform||"javascript";const i=e.getSdkMetadata(),{name:a,version:c,settings:l}=i?.sdk||{};return o.sdk={...o.sdk,name:a||"sentry.javascript.unknown",version:c||"0.0.0",settings:l},o}({scope:p,client:d,replayId:t,event:m});if(!g)return d.recordDroppedEvent("event_processor","replay"),$d&&zd.log("An event processor returned `null`, will not send event."),Promise.resolve({});delete g.sdkProcessingMetadata;const y=function(e,t,n,r){return Tn(Pn(e,Ln(e),r,n),[[{type:"replay_event"},e],[{type:"replay_recording",length:"string"==typeof t?(new TextEncoder).encode(t).length:t.length},t]])}(g,i,f,d.getOptions().tunnel);let v;try{v=await h.send(y)}catch(e){const t=new Error(il);try{t.cause=e}catch{}throw t}if("number"==typeof v.statusCode&&(v.statusCode<200||v.statusCode>=300))throw new Cp(v.statusCode);const b=fr({},v);if(hr(b,"replay"))throw new Mp(b);return v}(e),!0}catch(n){if(n instanceof Cp||n instanceof Mp)throw n;if(os("Replays",{_retryCount:t.count}),r&&r(n),t.count>=3){const e=new Error(`${il} - max retries exceeded`);try{e.cause=n}catch{}throw e}return t.interval*=++t.count,new Promise((n,r)=>{oi(async()=>{try{await Rp(e,t),n(!0)}catch(e){r(e)}},t.interval)})}}const Op="__THROTTLED";class Ap{constructor({options:e,recordingOptions:t}){this.eventBuffer=null,this.performanceEntries=[],this.replayPerformanceEntries=[],this.recordingMode="session",this.timeouts={sessionIdlePause:3e5,sessionIdleExpire:9e5},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._requiresManualStart=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=t,this._options=e,this._debouncedFlush=function(e,t,n){return function(e,t,n){let r,s,o;const i=null!=n&&n.maxWait?Math.max(n.maxWait,t):0,a=(null==n?void 0:n.setTimeoutImpl)||setTimeout;function c(){return l(),r=e(),r}function l(){void 0!==s&&clearTimeout(s),void 0!==o&&clearTimeout(o),s=o=void 0}function u(){return s&&clearTimeout(s),s=a(c,t),i&&void 0===o&&(o=a(c,i)),r}return u.cancel=l,u.flush=function(){return void 0!==s||void 0!==o?c():r},u}(e,t,{...n,setTimeoutImpl:oi})}(()=>this._flush(),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=function(e,t,n){const r=new Map;let s=!1;return(...o)=>{const i=Math.floor(Date.now()/1e3);if((e=>{const t=e-n;r.forEach((e,n)=>{n<t&&r.delete(n)})})(i),[...r.values()].reduce((e,t)=>e+t,0)>=t){const e=s;return s=!0,e?"__SKIPPED":Op}s=!1;const a=r.get(i)||0;return r.set(i,a+1),e(...o)}}((e,t)=>function(e,t,n){return ip(e,t)?op(e,t,n):Promise.resolve(null)}(this,e,t),300,5);const{slowClickTimeout:n,slowClickIgnoreSelectors:r}=this.getOptions(),s=n?{threshold:Math.min(3e3,n),timeout:n,scrollTimeout:300,ignoreSelector:r?r.join(","):""}:void 0;if(s&&(this.clickDetector=new wd(this,s)),$d){const t=e._experiments;zd.setConfig({captureExceptions:!!t.captureExceptions,traceInternals:!!t.traceInternals})}this._handleVisibilityChange=()=>{"visible"===sl.document.visibilityState?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()},this._handleWindowBlur=()=>{const e=Td({category:"ui.blur"});this._doChangeToBackgroundTasks(e)},this._handleWindowFocus=()=>{const e=Td({category:"ui.focus"});this._doChangeToForegroundTasks(e)},this._handleKeyboardEvent=e=>{!function(e,t){if(!e.isEnabled())return;e.updateUserActivity();const n=function(e){const{metaKey:t,shiftKey:n,ctrlKey:r,altKey:s,key:o,target:i}=e;if(!i||function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.isContentEditable}(i)||!o)return null;const a=t||r||s,c=1===o.length;if(!a&&c)return null;const l=C(i,{maxStringLength:200})||"<unknown>";return Td({category:"ui.keyDown",message:l,data:{...Md(i,l).data,metaKey:t,shiftKey:n,ctrlKey:r,altKey:s,key:o}})}(t);n&&gd(e,n)}(this,e)}}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}isRecordingCanvas(){return Boolean(this._canvas)}getOptions(){return this._options}handleException(e){$d&&zd.exception(e),this._options.onError&&this._options.onError(e)}initializeSampling(e){const{errorSampleRate:t,sessionSampleRate:n}=this._options,r=t<=0&&n<=0;this._requiresManualStart=r,r||(this._initializeSessionForSampling(e),this.session?!1!==this.session.sampled&&(this.recordingMode="buffer"===this.session.sampled&&0===this.session.segmentId?"buffer":"session",$d&&zd.infoTick(`Starting replay in ${this.recordingMode} mode`),this._initializeRecording()):$d&&zd.exception(new Error("Unable to initialize and create session")))}start(){if(this._isEnabled&&"session"===this.recordingMode)return void($d&&zd.log("Recording is already in progress"));if(this._isEnabled&&"buffer"===this.recordingMode)return void($d&&zd.log("Buffering is in progress, call `flush()` to save the replay"));$d&&zd.infoTick("Starting replay in session mode"),this._updateUserActivity();const e=rp({maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire},{stickySession:this._options.stickySession,sessionSampleRate:1,allowBuffering:!1});this.session=e,this.recordingMode="session",this._initializeRecording()}startBuffering(){if(this._isEnabled)return void($d&&zd.log("Buffering is in progress, call `flush()` to save the replay"));$d&&zd.infoTick("Starting replay in buffer mode");const e=rp({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration},{stickySession:this._options.stickySession,sessionSampleRate:0,allowBuffering:!0});this.session=e,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{const e=this._canvas;this._stopRecording=dd({...this._recordingOptions,..."buffer"===this.recordingMode?{checkoutEveryNms:6e4}:this._options._experiments.continuousCheckout&&{checkoutEveryNms:Math.max(36e4,this._options._experiments.continuousCheckout)},emit:Ip(this),.../iPhone|iPad|iPod/i.test(Ep?.userAgent??"")||/Macintosh/i.test(Ep?.userAgent??"")&&Ep?.maxTouchPoints&&Ep?.maxTouchPoints>1?{sampling:{mousemove:!1}}:{},onMutation:this._onMutationHandler.bind(this),...e?{recordCanvas:e.recordCanvas,getCanvasManager:e.getCanvasManager,sampling:e.sampling,dataURLOptions:e.dataURLOptions}:{}})}catch(e){this.handleException(e)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(e){return this.handleException(e),!1}}async stop({forceFlush:e=!1,reason:t}={}){if(this._isEnabled){this._isEnabled=!1,this.recordingMode="buffer";try{$d&&zd.log("Stopping Replay"+(t?` triggered by ${t}`:"")),dp(),this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),e&&await this._flush({force:!0}),this.eventBuffer?.destroy(),this.eventBuffer=null,n=this,function(){if(Gd())try{sl.sessionStorage.removeItem(ol)}catch{}}(),n.session=void 0}catch(e){this.handleException(e)}}var n}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),$d&&zd.log("Pausing replay"))}resume(){this._isPaused&&this._checkSession()&&(this._isPaused=!1,this.startRecording(),$d&&zd.log("Resuming replay"))}async sendBufferedReplayOrFlush({continueRecording:e=!0}={}){if("session"===this.recordingMode)return this.flushImmediate();const t=Date.now();$d&&zd.log("Converting buffer to session"),await this.flushImmediate();const n=this.stopRecording();e&&n&&"session"!==this.recordingMode&&(this.recordingMode="session",this.session&&(this.session.dirty=!1,this._updateUserActivity(t),this._updateSessionActivity(t),this._maybeSaveSession()),this.startRecording())}addUpdate(e){const t=e();"buffer"!==this.recordingMode&&this._isEnabled&&!0!==t&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),this._stopRecording)this.checkAndHandleExpiredSession(),this._updateSessionActivity();else{if(!this._checkSession())return;this.resume()}}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return"buffer"===this.recordingMode?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(e){if(!e||!1!==this.session?.sampled)return this.session?.id}checkAndHandleExpiredSession(){if(!(this._lastActivity&&ep(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&"session"===this.session.sampled))return!!this._checkSession();this.pause()}setInitialState(){const e=`${sl.location.pathname}${sl.location.hash}${sl.location.search}`,t=`${sl.location.origin}${e}`;this.performanceEntries=[],this.replayPerformanceEntries=[],this._clearContext(),this._context.initialUrl=t,this._context.initialTimestamp=Date.now(),this._context.urls.push(t)}throttledAddEvent(e,t){const n=this._throttledAddEvent(e,t);if(n===Op){const e=Td({category:"replay.throttled"});this.addUpdate(()=>!sp(this,{type:5,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e,metric:!0}}))}return n}getCurrentRoute(){const e=this.lastActiveSpan||hn(),t=e&&pn(e),n=(t&&sn(t).data||{})[yt];if(t&&n&&["route","custom"].includes(n))return sn(t).description}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=function({useCompression:e,workerUrl:t}){if(e&&window.Worker){const e=function(e){try{const t=e||("undefined"!=typeof __SENTRY_EXCLUDE_REPLAY_WORKER__&&__SENTRY_EXCLUDE_REPLAY_WORKER__?"":function(){const e=new Blob(['var t=Uint8Array,n=Uint16Array,r=Int32Array,e=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),s=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(t,e){for(var i=new n(31),s=0;s<31;++s)i[s]=e+=1<<t[s-1];var a=new r(i[30]);for(s=1;s<30;++s)for(var o=i[s];o<i[s+1];++o)a[o]=o-i[s]<<5|s;return{b:i,r:a}},o=a(e,2),h=o.b,f=o.r;h[28]=258,f[258]=28;for(var l=a(i,0).r,u=new n(32768),c=0;c<32768;++c){var v=(43690&c)>>1|(21845&c)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,u[c]=((65280&v)>>8|(255&v)<<8)>>1}var d=function(t,r,e){for(var i=t.length,s=0,a=new n(r);s<i;++s)t[s]&&++a[t[s]-1];var o,h=new n(r);for(s=1;s<r;++s)h[s]=h[s-1]+a[s-1]<<1;if(e){o=new n(1<<r);var f=15-r;for(s=0;s<i;++s)if(t[s])for(var l=s<<4|t[s],c=r-t[s],v=h[t[s]-1]++<<c,d=v|(1<<c)-1;v<=d;++v)o[u[v]>>f]=l}else for(o=new n(i),s=0;s<i;++s)t[s]&&(o[s]=u[h[t[s]-1]++]>>15-t[s]);return o},p=new t(288);for(c=0;c<144;++c)p[c]=8;for(c=144;c<256;++c)p[c]=9;for(c=256;c<280;++c)p[c]=7;for(c=280;c<288;++c)p[c]=8;var g=new t(32);for(c=0;c<32;++c)g[c]=5;var w=d(p,9,0),y=d(g,5,0),m=function(t){return(t+7)/8|0},b=function(n,r,e){return(null==e||e>n.length)&&(e=n.length),new t(n.subarray(r,e))},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(t,n,r){var e=new Error(n||M[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,E),!r)throw e;return e},z=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8},_=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8,t[e+2]|=r>>16},x=function(r,e){for(var i=[],s=0;s<r.length;++s)r[s]&&i.push({s:s,f:r[s]});var a=i.length,o=i.slice();if(!a)return{t:F,l:0};if(1==a){var h=new t(i[0].s+1);return h[i[0].s]=1,{t:h,l:1}}i.sort(function(t,n){return t.f-n.f}),i.push({s:-1,f:25001});var f=i[0],l=i[1],u=0,c=1,v=2;for(i[0]={s:-1,f:f.f+l.f,l:f,r:l};c!=a-1;)f=i[i[u].f<i[v].f?u++:v++],l=i[u!=c&&i[u].f<i[v].f?u++:v++],i[c++]={s:-1,f:f.f+l.f,l:f,r:l};var d=o[0].s;for(s=1;s<a;++s)o[s].s>d&&(d=o[s].s);var p=new n(d+1),g=A(i[c-1],p,0);if(g>e){s=0;var w=0,y=g-e,m=1<<y;for(o.sort(function(t,n){return p[n.s]-p[t.s]||t.f-n.f});s<a;++s){var b=o[s].s;if(!(p[b]>e))break;w+=m-(1<<g-p[b]),p[b]=e}for(w>>=y;w>0;){var M=o[s].s;p[M]<e?w-=1<<e-p[M]++-1:++s}for(;s>=0&&w;--s){var E=o[s].s;p[E]==e&&(--p[E],++w)}g=e}return{t:new t(p),l:g}},A=function(t,n,r){return-1==t.s?Math.max(A(t.l,n,r+1),A(t.r,n,r+1)):n[t.s]=r},D=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new n(++r),i=0,s=t[0],a=1,o=function(t){e[i++]=t},h=1;h<=r;++h)if(t[h]==s&&h!=r)++a;else{if(!s&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(s),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(s);a=1,s=t[h]}return{c:e.subarray(0,i),n:r}},T=function(t,n){for(var r=0,e=0;e<n.length;++e)r+=t[e]*n[e];return r},k=function(t,n,r){var e=r.length,i=m(n+2);t[i]=255&e,t[i+1]=e>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var s=0;s<e;++s)t[i+s+4]=r[s];return 8*(i+4+e)},U=function(t,r,a,o,h,f,l,u,c,v,m){z(r,m++,a),++h[256];for(var b=x(h,15),M=b.t,E=b.l,A=x(f,15),U=A.t,C=A.l,F=D(M),I=F.c,S=F.n,L=D(U),O=L.c,j=L.n,q=new n(19),B=0;B<I.length;++B)++q[31&I[B]];for(B=0;B<O.length;++B)++q[31&O[B]];for(var G=x(q,7),H=G.t,J=G.l,K=19;K>4&&!H[s[K-1]];--K);var N,P,Q,R,V=v+5<<3,W=T(h,p)+T(f,g)+l,X=T(h,M)+T(f,U)+l+14+3*K+T(q,H)+2*q[16]+3*q[17]+7*q[18];if(c>=0&&V<=W&&V<=X)return k(r,m,t.subarray(c,c+v));if(z(r,m,1+(X<W)),m+=2,X<W){N=d(M,E,0),P=M,Q=d(U,C,0),R=U;var Y=d(H,J,0);z(r,m,S-257),z(r,m+5,j-1),z(r,m+10,K-4),m+=14;for(B=0;B<K;++B)z(r,m+3*B,H[s[B]]);m+=3*K;for(var Z=[I,O],$=0;$<2;++$){var tt=Z[$];for(B=0;B<tt.length;++B){var nt=31&tt[B];z(r,m,Y[nt]),m+=H[nt],nt>15&&(z(r,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else N=w,P=p,Q=y,R=g;for(B=0;B<u;++B){var rt=o[B];if(rt>255){_(r,m,N[(nt=rt>>18&31)+257]),m+=P[nt+257],nt>7&&(z(r,m,rt>>23&31),m+=e[nt]);var et=31&rt;_(r,m,Q[et]),m+=R[et],et>3&&(_(r,m,rt>>5&8191),m+=i[et])}else _(r,m,N[rt]),m+=P[rt]}return _(r,m,N[256]),m+P[256]},C=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new t(0),I=function(){for(var t=new Int32Array(256),n=0;n<256;++n){for(var r=n,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[n]=r}return t}(),S=function(){var t=1,n=0;return{p:function(r){for(var e=t,i=n,s=0|r.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=e+=r[a];e=(65535&e)+15*(e>>16),i=(65535&i)+15*(i>>16)}t=e,n=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(n%=65521))<<8|n>>8}}},L=function(s,a,o,h,u){if(!u&&(u={l:1},a.dictionary)){var c=a.dictionary.subarray(-32768),v=new t(c.length+s.length);v.set(c),v.set(s,c.length),s=v,u.w=c.length}return function(s,a,o,h,u,c){var v=c.z||s.length,d=new t(h+v+5*(1+Math.ceil(v/7e3))+u),p=d.subarray(h,d.length-u),g=c.l,w=7&(c.r||0);if(a){w&&(p[0]=c.r>>3);for(var y=C[a-1],M=y>>13,E=8191&y,z=(1<<o)-1,_=c.p||new n(32768),x=c.h||new n(z+1),A=Math.ceil(o/3),D=2*A,T=function(t){return(s[t]^s[t+1]<<A^s[t+2]<<D)&z},F=new r(25e3),I=new n(288),S=new n(32),L=0,O=0,j=c.i||0,q=0,B=c.w||0,G=0;j+2<v;++j){var H=T(j),J=32767&j,K=x[H];if(_[J]=K,x[H]=J,B<=j){var N=v-j;if((L>7e3||q>24576)&&(N>423||!g)){w=U(s,p,0,F,I,S,O,q,G,j-G,w),q=L=O=0,G=j;for(var P=0;P<286;++P)I[P]=0;for(P=0;P<30;++P)S[P]=0}var Q=2,R=0,V=E,W=J-K&32767;if(N>2&&H==T(j-W))for(var X=Math.min(M,N)-1,Y=Math.min(32767,j),Z=Math.min(258,N);W<=Y&&--V&&J!=K;){if(s[j+Q]==s[j+Q-W]){for(var $=0;$<Z&&s[j+$]==s[j+$-W];++$);if($>Q){if(Q=$,R=W,$>X)break;var tt=Math.min(W,$-2),nt=0;for(P=0;P<tt;++P){var rt=j-W+P&32767,et=rt-_[rt]&32767;et>nt&&(nt=et,K=rt)}}}W+=(J=K)-(K=_[J])&32767}if(R){F[q++]=268435456|f[Q]<<18|l[R];var it=31&f[Q],st=31&l[R];O+=e[it]+i[st],++I[257+it],++S[st],B=j+Q,++L}else F[q++]=s[j],++I[s[j]]}}for(j=Math.max(j,B);j<v;++j)F[q++]=s[j],++I[s[j]];w=U(s,p,g,F,I,S,O,q,G,j-G,w),g||(c.r=7&w|p[w/8|0]<<3,w-=7,c.h=x,c.p=_,c.i=j,c.w=B)}else{for(j=c.w||0;j<v+g;j+=65535){var at=j+65535;at>=v&&(p[w/8|0]=g,at=v),w=k(p,w+1,s.subarray(j,at))}c.i=v}return b(d,0,h+m(w)+u)}(s,null==a.level?6:a.level,null==a.mem?u.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(s.length)))):20:12+a.mem,o,h,u)},O=function(t,n,r){for(;r;++n)t[n]=r,r>>>=8},j=function(){function n(n,r){if("function"==typeof n&&(r=n,n={}),this.ondata=r,this.o=n||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new t(98304),this.o.dictionary){var e=this.o.dictionary.subarray(-32768);this.b.set(e,32768-e.length),this.s.i=32768-e.length}}return n.prototype.p=function(t,n){this.ondata(L(t,this.o,0,0,this.s),n)},n.prototype.push=function(n,r){this.ondata||E(5),this.s.l&&E(4);var e=n.length+this.s.z;if(e>this.b.length){if(e>2*this.b.length-32768){var i=new t(-32768&e);i.set(this.b.subarray(0,this.s.z)),this.b=i}var s=this.b.length-this.s.z;this.b.set(n.subarray(0,s),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(n.subarray(s),32768),this.s.z=n.length-s+32768,this.s.i=32766,this.s.w=32768}else this.b.set(n,this.s.z),this.s.z+=n.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n.prototype.flush=function(){this.ondata||E(5),this.s.l&&E(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},n}();function q(t,n){n||(n={});var r=function(){var t=-1;return{p:function(n){for(var r=t,e=0;e<n.length;++e)r=I[255&r^n[e]]^r>>>8;t=r},d:function(){return~t}}}(),e=t.length;r.p(t);var i,s=L(t,n,10+((i=n).filename?i.filename.length+1:0),8),a=s.length;return function(t,n){var r=n.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=n.level<2?4:9==n.level?2:0,t[9]=3,0!=n.mtime&&O(t,4,Math.floor(new Date(n.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}}(s,n),O(s,a-8,r.d()),O(s,a-4,e),s}var B=function(){function t(t,n){this.c=S(),this.v=1,j.call(this,t,n)}return t.prototype.push=function(t,n){this.c.p(t),j.prototype.push.call(this,t,n)},t.prototype.p=function(t,n){var r=L(t,this.o,this.v&&(this.o.dictionary?6:2),n&&4,this.s);this.v&&(function(t,n){var r=n.level,e=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=e<<6|(n.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,n.dictionary){var i=S();i.p(n.dictionary),O(t,2,i.d())}}(r,this.o),this.v=0),n&&O(r,r.length-4,this.c.d()),this.ondata(r,n)},t.prototype.flush=function(){j.prototype.flush.call(this)},t}(),G="undefined"!=typeof TextEncoder&&new TextEncoder,H="undefined"!=typeof TextDecoder&&new TextDecoder;try{H.decode(F,{stream:!0})}catch(t){}var J=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,n){this.ondata||E(5),this.d&&E(4),this.ondata(K(t),this.d=n||!1)},t}();function K(n,r){if(G)return G.encode(n);for(var e=n.length,i=new t(n.length+(n.length>>1)),s=0,a=function(t){i[s++]=t},o=0;o<e;++o){if(s+5>i.length){var h=new t(s+8+(e-o<<1));h.set(i),i=h}var f=n.charCodeAt(o);f<128||r?a(f):f<2048?(a(192|f>>6),a(128|63&f)):f>55295&&f<57344?(a(240|(f=65536+(1047552&f)|1023&n.charCodeAt(++o))>>18),a(128|f>>12&63),a(128|f>>6&63),a(128|63&f)):(a(224|f>>12),a(128|f>>6&63),a(128|63&f))}return b(i,0,s)}const N=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const n=this._hasEvents?",":"";this.stream.push(n+t),this._hasEvents=!0}finish(){this.stream.push("]",!0);const t=function(t){let n=0;for(const r of t)n+=r.length;const r=new Uint8Array(n);for(let n=0,e=0,i=t.length;n<i;n++){const i=t[n];r.set(i,e),e+=i.length}return r}(this._deflatedData);return this._init(),t}_init(){this._hasEvents=!1,this._deflatedData=[],this.deflate=new B,this.deflate.ondata=(t,n)=>{this._deflatedData.push(t)},this.stream=new J((t,n)=>{this.deflate.push(t,n)}),this.stream.push("[")}},P={clear:()=>{N.clear()},addEvent:t=>N.addEvent(t),finish:()=>N.finish(),compress:t=>function(t){return q(K(t))}(t)};addEventListener("message",function(t){const n=t.data.method,r=t.data.id,e=t.data.arg;if(n in P&&"function"==typeof P[n])try{const t=P[n](e);postMessage({id:r,method:n,success:!0,response:t})}catch(t){postMessage({id:r,method:n,success:!1,response:t.message}),console.error(t)}}),postMessage({id:void 0,method:"init",success:!0,response:void 0});']);return URL.createObjectURL(e)}());if(!t)return;$d&&zd.log("Using compression worker"+(e?` from ${e}`:""));const n=new Worker(t);return new Kd(n)}catch(e){$d&&zd.exception(e,"Failed to create compression worker")}}(t);if(e)return e}return $d&&zd.log("Using simple buffer"),new Wd}({useCompression:this._options.useCompression,workerUrl:this._options.workerUrl}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this._isPaused=!1,this.startRecording()}_initializeSessionForSampling(e){const t=this._options.errorSampleRate>0,n=rp({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,previousSessionId:e},{stickySession:this._options.stickySession,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:t});this.session=n}_checkSession(){if(!this.session)return!1;const e=this.session;return!np(e,{sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration})||(this._refreshSession(e),!1)}async _refreshSession(e){this._isEnabled&&(await this.stop({reason:"refresh session"}),this.initializeSampling(e.id))}_addListeners(){try{sl.document.addEventListener("visibilitychange",this._handleVisibilityChange),sl.addEventListener("blur",this._handleWindowBlur),sl.addEventListener("focus",this._handleWindowFocus),sl.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(function(e){const t=$e();ro((e=>t=>{if(!e.isEnabled())return;const n=function(e){const{target:t,message:n}=function(e){const t="click"===e.name;let n,r=null;try{r=t?vd(e.event):bd(e.event),n=C(r,{maxStringLength:200})||"<unknown>"}catch{n="<unknown>"}return{target:r,message:n}}(e);return Td({category:`ui.${e.name}`,...Md(t,n)})}(t);if(!n)return;const r="click"===t.name,s=r?t.event:void 0;var o,i,a;!(r&&e.clickDetector&&s?.target)||s.altKey||s.metaKey||s.ctrlKey||s.shiftKey||(o=e.clickDetector,i=n,a=vd(t.event),o.handleClick(i,a)),gd(e,n)})(e)),uo(function(e){return t=>{if(!e.isEnabled())return;const n=function(e){const{from:t,to:n}=e,r=Date.now()/1e3;return{type:"navigation.push",start:r,end:r,name:n,data:{previous:t}}}(t);null!==n&&(e.getContext().urls.push(n.name),e.triggerUserActivity(),e.addUpdate(()=>(pp(e,[n]),!1)))}}(e)),function(e){const t=$e();t&&t.on("beforeAddBreadcrumb",t=>function(e,t){if(!e.isEnabled()||!up(t))return;const n=function(e){return!up(e)||["fetch","xhr","sentry.event","sentry.transaction"].includes(e.category)||e.category.startsWith("ui.")?null:"console"===e.category?function(e){const t=e.data?.arguments;if(!Array.isArray(t)||0===t.length)return Td(e);let n=!1;const r=t.map(e=>{if(!e)return e;if("string"==typeof e)return e.length>cl?(n=!0,`${e.slice(0,cl)}â¦`):e;if("object"==typeof e)try{const t=wn(e,7);return JSON.stringify(t).length>cl?(n=!0,`${JSON.stringify(t,null,2).slice(0,cl)}â¦`):t}catch{}return e});return Td({...e,data:{...e.data,arguments:r,...n?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}(e):Td(e)}(t);n&&gd(e,n)}(e,t))}(e),xp(e),gs(function(e){return Object.assign((t,n)=>{if(!e.isEnabled()||e.isPaused())return t;if(function(e){return"replay_event"===e.type}(t))return delete t.breadcrumbs,t;if(!ap(t)&&!cp(t)&&!lp(t))return t;if(!e.checkAndHandleExpiredSession())return dp(),t;if(lp(t))return e.flush(),t.contexts.feedback.replay_id=e.getSessionId(),function(e,t){e.triggerUserActivity(),e.addUpdate(()=>!t.timestamp||(e.throttledAddEvent({type:ku.Custom,timestamp:1e3*t.timestamp,data:{tag:"breadcrumb",payload:{timestamp:t.timestamp,type:"default",category:"sentry.feedback",data:{feedbackId:t.event_id}}}}),!1))}(e,t),t;if(function(e,t){return!(e.type||!e.exception?.values?.length||!t.originalException?.__rrweb__)}(t,n)&&!e.getOptions()._experiments.captureExceptions)return $d&&zd.log("Ignoring error from rrweb internals",t),null;const r=function(e,t){return"buffer"===e.recordingMode&&t.message!==il&&!(!t.exception||t.type)&&Xd(e.getOptions().errorSampleRate)}(e,t);if((r||"session"===e.recordingMode)&&(t.tags={...t.tags,replayId:e.getSessionId()}),r&&"buffer"===e.recordingMode&&"buffer"===e.session?.sampled){const t=e.session;t.dirty=!0,e.getOptions().stickySession&&Yd(t)}return t},{id:"Replay"})}(e)),t&&(t.on("beforeSendEvent",function(e){return t=>{e.isEnabled()&&ap(t)&&function(e,t){const n=t.exception?.values?.[0]?.value;"string"==typeof n&&(n.match(/(reactjs\.org\/docs\/error-decoder\.html\?invariant=|react\.dev\/errors\/)(418|419|422|423|425)/)||n.match(/(does not match server-rendered HTML|Hydration failed because)/i))&&gd(e,Td({category:"replay.hydrate-error",data:{url:R()}}))}(e,t)}}(e)),t.on("afterSendEvent",function(e){return(t,n)=>{if(!e.isEnabled()||!ap(t)&&!cp(t))return;const r=n.statusCode;!r||r<200||r>=300||(cp(t)?function(e,t){const n=e.getContext();t.contexts?.trace?.trace_id&&n.traceIds.size<100&&n.traceIds.add(t.contexts.trace.trace_id)}(e,t):function(e,t){const n=e.getContext();if(t.event_id&&n.errorIds.size<100&&n.errorIds.add(t.event_id),"buffer"!==e.recordingMode||!t.tags||!t.tags.replayId)return;const{beforeErrorSampling:r}=e.getOptions();("function"!=typeof r||r(t))&&oi(async()=>{try{await e.sendBufferedReplayOrFlush()}catch(t){e.handleException(t)}})}(e,t))}}(e)),t.on("createDsc",t=>{const n=e.getSessionId();n&&e.isEnabled()&&"session"===e.recordingMode&&e.checkAndHandleExpiredSession()&&(t.replay_id=n)}),t.on("spanStart",t=>{e.lastActiveSpan=t}),t.on("spanEnd",t=>{e.lastActiveSpan=t}),t.on("beforeSendFeedback",async(t,n)=>{const r=e.getSessionId();n?.includeReplay&&e.isEnabled()&&r&&t.contexts?.feedback&&("api"===t.contexts.feedback.source&&await e.sendBufferedReplayOrFlush(),t.contexts.feedback.replay_id=r)}),t.on("openFeedbackWidget",async()=>{await e.sendBufferedReplayOrFlush()}))}(this),this._hasInitializedCoreListeners=!0)}catch(e){this.handleException(e)}this._performanceCleanupCallback=function(e){function t(t){e.performanceEntries.includes(t)||e.performanceEntries.push(t)}function n({entries:e}){e.forEach(t)}const r=[];return["navigation","paint","resource"].forEach(e=>{r.push(Ea(e,n))}),r.push(xa(Od(Dd,e)),ka(Od(Pd,e)),Ta(Od(Fd,e))),()=>{r.forEach(e=>e())}}(this)}_removeListeners(){try{sl.document.removeEventListener("visibilitychange",this._handleVisibilityChange),sl.removeEventListener("blur",this._handleWindowBlur),sl.removeEventListener("focus",this._handleWindowFocus),sl.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceCleanupCallback&&this._performanceCleanupCallback()}catch(e){this.handleException(e)}}_doChangeToBackgroundTasks(e){this.session&&(tp(this.session,{maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire})||(e&&this._createCustomBreadcrumb(e),this.conditionalFlush()))}_doChangeToForegroundTasks(e){this.session&&(this.checkAndHandleExpiredSession()?e&&this._createCustomBreadcrumb(e):$d&&zd.log("Document has become active, but session has expired"))}_updateUserActivity(e=Date.now()){this._lastActivity=e}_updateSessionActivity(e=Date.now()){this.session&&(this.session.lastActivity=e,this._maybeSaveSession())}_createCustomBreadcrumb(e){this.addUpdate(()=>{this.throttledAddEvent({type:ku.Custom,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e}})})}_addPerformanceEntries(){let e=(t=this.performanceEntries,t.map(Ad).filter(Boolean)).concat(this.replayPerformanceEntries);var t;if(this.performanceEntries=[],this.replayPerformanceEntries=[],this._requiresManualStart){const t=this._context.initialTimestamp/1e3;e=e.filter(e=>e.start>=t)}return Promise.all(pp(this,e))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:e,eventBuffer:t}=this;if(!e||!t||this._requiresManualStart)return;if(e.segmentId)return;const n=t.getEarliestTimestamp();n&&n<this._context.initialTimestamp&&(this._context.initialTimestamp=n)}_popEventContext(){const e={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),e}async _runFlush(){const e=this.getSessionId();if(this.session&&this.eventBuffer&&e){if(await this._addPerformanceEntries(),this.eventBuffer?.hasEvents&&(await async function(e){try{return Promise.all(pp(e,[Tp(sl.performance.memory)]))}catch{return[]}}(this),this.eventBuffer&&e===this.getSessionId()))try{this._updateInitialTimestampFromEventBuffer();const t=Date.now();if(t-this._context.initialTimestamp>this._options.maxReplayDuration+3e4)throw new Error("Session is too long, not sending replay");const n=this._popEventContext(),r=this.session.segmentId++;this._maybeSaveSession();const s=await this.eventBuffer.finish();await Rp({replayId:e,recordingData:s,segmentId:r,eventContext:n,session:this.session,timestamp:t,onError:e=>this.handleException(e)})}catch(e){this.handleException(e),this.stop({reason:"sendReplay"});const t=$e();if(t){const n=e instanceof Mp?"ratelimit_backoff":"send_error";t.recordDroppedEvent(n,"replay")}}}else $d&&zd.error("No session or eventBuffer found to flush.")}async _flush({force:e=!1}={}){if(!this._isEnabled&&!e)return;if(!this.checkAndHandleExpiredSession())return void($d&&zd.error("Attempting to finish replay event after session expired."));if(!this.session)return;const t=this.session.started,n=Date.now()-t;this._debouncedFlush.cancel();const r=n<this._options.minReplayDuration,s=n>this._options.maxReplayDuration+5e3;if(r||s)return $d&&zd.log(`Session duration (${Math.floor(n/1e3)}s) is too ${r?"short":"long"}, not sending replay.`),void(r&&this._debouncedFlush());const o=this.eventBuffer;o&&0===this.session.segmentId&&!o.hasCheckout&&$d&&zd.log("Flushing initial segment without checkout.");const i=!!this._flushLock;this._flushLock||(this._flushLock=this._runFlush());try{await this._flushLock}catch(e){this.handleException(e)}finally{this._flushLock=void 0,i&&this._debouncedFlush()}}_maybeSaveSession(){this.session&&this._options.stickySession&&Yd(this.session)}_onMutationHandler(e){const{ignoreMutations:t}=this._options._experiments;if(t?.length&&e.some(e=>{const n=function(e){if(!e)return null;try{return e.nodeType===e.ELEMENT_NODE?e:e.parentElement}catch{return null}}(e.target),r=t.join(",");return n?.matches(r)}))return!1;const n=e.length,r=this._options.mutationLimit,s=r&&n>r;if(n>this._options.mutationBreadcrumbLimit||s){const e=Td({category:"replay.mutations",data:{count:n,limit:s}});this._createCustomBreadcrumb(e)}return!s||(this.stop({reason:"mutationLimit",forceFlush:"session"===this.recordingMode}),!1)}}function Np(e,t){return[...e,...t].join(",")}const Dp='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',Lp=["content-length","content-type","accept"];let Pp=!1;const Fp=e=>new jp(e);class jp{constructor({flushMinDelay:e=5e3,flushMaxDelay:t=5500,minReplayDuration:n=4999,maxReplayDuration:r=36e5,stickySession:s=!0,useCompression:o=!0,workerUrl:i,_experiments:a={},maskAllText:c=!0,maskAllInputs:l=!0,blockAllMedia:u=!0,mutationBreadcrumbLimit:d=750,mutationLimit:p=1e4,slowClickTimeout:h=7e3,slowClickIgnoreSelectors:f=[],networkDetailAllowUrls:m=[],networkDetailDenyUrls:g=[],networkCaptureBodies:y=!0,networkRequestHeaders:v=[],networkResponseHeaders:b=[],mask:_=[],maskAttributes:S=["title","placeholder","aria-label"],unmask:w=[],block:k=[],unblock:x=[],ignore:T=[],maskFn:E,beforeAddRecordingEvent:I,beforeErrorSampling:C,onError:M}={}){this.name="Replay";const R=function({mask:e,unmask:t,block:n,unblock:r,ignore:s}){return{maskTextSelector:Np(e,[".sentry-mask","[data-sentry-mask]"]),unmaskTextSelector:Np(t,[]),blockSelector:Np(n,[".sentry-block","[data-sentry-block]","base","iframe[srcdoc]:not([src])"]),unblockSelector:Np(r,[]),ignoreSelector:Np(s,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'])}}({mask:_,unmask:w,block:k,unblock:x,ignore:T});if(this._recordingOptions={maskAllInputs:l,maskAllText:c,maskInputOptions:{password:!0},maskTextFn:E,maskInputFn:E,maskAttributeFn:(e,t,n)=>function({el:e,key:t,maskAttributes:n,maskAllText:r,privacyOptions:s,value:o}){return r?s.unmaskTextSelector&&e.matches(s.unmaskTextSelector)?o:n.includes(t)||"value"===t&&"INPUT"===e.tagName&&["submit","button"].includes(e.getAttribute("type")||"")?o.replace(/[\S]/g,"*"):o:o}({maskAttributes:S,maskAllText:c,privacyOptions:R,key:e,value:t,el:n}),...R,slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0,errorHandler:e=>{try{e.__rrweb__=!0}catch{}},recordCrossOriginIframes:Boolean(a.recordCrossOriginIframes)},this._initialOptions={flushMinDelay:e,flushMaxDelay:t,minReplayDuration:Math.min(n,5e4),maxReplayDuration:Math.min(r,36e5),stickySession:s,useCompression:o,workerUrl:i,blockAllMedia:u,maskAllInputs:l,maskAllText:c,mutationBreadcrumbLimit:d,mutationLimit:p,slowClickTimeout:h,slowClickIgnoreSelectors:f,networkDetailAllowUrls:m,networkDetailDenyUrls:g,networkCaptureBodies:y,networkRequestHeaders:$p(v),networkResponseHeaders:$p(b),beforeAddRecordingEvent:I,beforeErrorSampling:C,onError:M,_experiments:a},this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${Dp}`:Dp,this._recordingOptions.ignoreCSSAttributes=new Set(["background-image"])),this._isInitialized&&Xa())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return Pp}set _isInitialized(e){Pp=e}afterAllSetup(e){Xa()&&!this._replay&&(this._setup(e),this._initialize(e))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:"session"===this._replay.recordingMode}):Promise.resolve()}flush(e){return this._replay?this._replay.isEnabled()?this._replay.sendBufferedReplayOrFlush(e):(this._replay.start(),Promise.resolve()):Promise.resolve()}getReplayId(e){if(this._replay?.isEnabled())return this._replay.getSessionId(e)}getRecordingMode(){if(this._replay?.isEnabled())return this._replay.recordingMode}_initialize(e){this._replay&&(this._maybeLoadFromReplayCanvasIntegration(e),this._replay.initializeSampling())}_setup(e){const t=function(e,t){const n=t.getOptions(),r={sessionSampleRate:0,errorSampleRate:0,...e},s=Wt(n.replaysSessionSampleRate),o=Wt(n.replaysOnErrorSampleRate);return null==s&&null==o&&D(()=>{console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set.")}),null!=s&&(r.sessionSampleRate=s),null!=o&&(r.errorSampleRate=o),r}(this._initialOptions,e);this._replay=new Ap({options:t,recordingOptions:this._recordingOptions})}_maybeLoadFromReplayCanvasIntegration(e){try{const t=e.getIntegrationByName("ReplayCanvas");if(!t)return;this._replay._canvas=t.getOptions()}catch{}}}function $p(e){return[...Lp,...e.map(e=>e.toLowerCase())]}function Bp(){const e=$e();return e?.getIntegrationByName("Replay")}const Up=100,Hp=10,zp="flag.evaluation.";function qp(e){const t=De().getScopeData().contexts.flags,n=t?t.values:[];return n.length?(void 0===e.contexts&&(e.contexts={}),e.contexts.flags={values:[...n]},e):e}function Wp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Up;const r=De().getScopeData().contexts;r.flags||(r.flags={values:[]}),function(e,t,n,r){if("boolean"!=typeof n)return;if(e.length>r)return void(i&&j.error(`[Feature Flags] insertToFlagBuffer called on a buffer larger than maxSize=${r}`));const s=e.findIndex(e=>e.flag===t);-1!==s&&e.splice(s,1),e.length===r&&e.shift(),e.push({flag:t,result:n})}(r.flags.values,e,t,n)}function Vp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Hp;if("boolean"!=typeof t)return;const r=hn();if(!r)return;const s=sn(r).data;(`${zp}${e}`in s||Object.keys(s).filter(e=>e.startsWith(zp)).length<n)&&r.setAttribute(`${zp}${e}`,t)}const Jp=()=>({name:"LaunchDarkly",processEvent:(e,t,n)=>qp(e)});function Kp(){return{name:"sentry-flag-auditor",type:"flag-used",synchronous:!0,method:(e,t,n)=>{Wp(e,t.value),Vp(e,t.value)}}}function Gp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:De();const{message:r,name:s,email:o,url:i,source:a,associatedEventId:c,tags:l}=e,u={contexts:{feedback:{contact_email:o,name:s,message:r,url:i,source:a,associated_event_id:c}},type:"feedback",level:"info",tags:l},d=(null==n?void 0:n.getClient())||$e();return d&&d.emit("beforeSendFeedback",u,t),n.captureEvent(u,t)}const Xp=c,Yp=Xp.document,Qp=Xp.navigator,Zp="Report a Bug",eh=(e,t={includeReplay:!0})=>{if(!e.message)throw new Error("Unable to submit feedback with empty message");const n=$e();if(!n)throw new Error("No client setup, cannot send feedback.");e.tags&&Object.keys(e.tags).length&&De().setTags(e.tags);const r=Gp({source:"api",url:R(),...e},t);return new Promise((e,t)=>{const s=setTimeout(()=>t("Unable to determine if Feedback was correctly sent."),3e4),o=n.on("afterSendEvent",(n,i)=>{if(n.event_id===r)return clearTimeout(s),o(),i?.statusCode&&i.statusCode>=200&&i.statusCode<300?e(r):t(403===i?.statusCode?"Unable to send feedback. This could be because this domain is not in your list of allowed domains.":"Unable to send feedback. This could be because of network issues, or because you are using an ad-blocker.")})})},th="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function nh(e,t){return{...e,...t,tags:{...e.tags,...t.tags},onFormOpen:()=>{t.onFormOpen?.(),e.onFormOpen?.()},onFormClose:()=>{t.onFormClose?.(),e.onFormClose?.()},onSubmitSuccess:(n,r)=>{t.onSubmitSuccess?.(n,r),e.onSubmitSuccess?.(n,r)},onSubmitError:n=>{t.onSubmitError?.(n),e.onSubmitError?.(n)},onFormSubmitted:()=>{t.onFormSubmitted?.(),e.onFormSubmitted?.()},themeDark:{...e.themeDark,...t.themeDark},themeLight:{...e.themeLight,...t.themeLight}}}function rh(e,t){return Object.entries(t).forEach(([t,n])=>{e.setAttributeNS(null,t,n)}),e}const sh="rgba(88, 74, 192, 1)",oh={foreground:"#2b2233",background:"#ffffff",accentForeground:"white",accentBackground:sh,successColor:"#268d75",errorColor:"#df3338",border:"1.5px solid rgba(41, 35, 47, 0.13)",boxShadow:"0px 4px 24px 0px rgba(43, 34, 51, 0.12)",outline:"1px auto var(--accent-background)",interactiveFilter:"brightness(95%)"},ih={foreground:"#ebe6ef",background:"#29232f",accentForeground:"white",accentBackground:sh,successColor:"#2da98c",errorColor:"#f55459",border:"1.5px solid rgba(235, 230, 239, 0.15)",boxShadow:"0px 4px 24px 0px rgba(43, 34, 51, 0.12)",outline:"1px auto var(--accent-background)",interactiveFilter:"brightness(150%)"};function ah(e){return`\n  --foreground: ${e.foreground};\n  --background: ${e.background};\n  --accent-foreground: ${e.accentForeground};\n  --accent-background: ${e.accentBackground};\n  --success-color: ${e.successColor};\n  --error-color: ${e.errorColor};\n  --border: ${e.border};\n  --box-shadow: ${e.boxShadow};\n  --outline: ${e.outline};\n  --interactive-filter: ${e.interactiveFilter};\n  `}const ch=({lazyLoadIntegration:e,getModalIntegration:t,getScreenshotIntegration:n})=>({id:r="sentry-feedback",autoInject:s=!0,showBranding:o=!0,isEmailRequired:i=!1,isNameRequired:a=!1,showEmail:c=!0,showName:l=!0,enableScreenshot:u=!0,useSentryUser:d={email:"email",name:"username"},tags:p,styleNonce:h,scriptNonce:f,colorScheme:m="system",themeLight:g={},themeDark:y={},addScreenshotButtonLabel:v="Add a screenshot",cancelButtonLabel:b="Cancel",confirmButtonLabel:_="Confirm",emailLabel:S="Email",emailPlaceholder:w="your.email@example.org",formTitle:k="Report a Bug",isRequiredLabel:x="(required)",messageLabel:T="Description",messagePlaceholder:E="What's the bug? What did you expect?",nameLabel:I="Name",namePlaceholder:C="Your Name",removeScreenshotButtonLabel:M="Remove screenshot",submitButtonLabel:R="Send Bug Report",successMessageText:O="Thank you for your report!",triggerLabel:A=Zp,triggerAriaLabel:N="",highlightToolText:D="Highlight",hideToolText:L="Hide",removeHighlightText:P="Remove",onFormOpen:F,onFormClose:$,onSubmitSuccess:B,onSubmitError:U,onFormSubmitted:H}={})=>{const z={id:r,autoInject:s,showBranding:o,isEmailRequired:i,isNameRequired:a,showEmail:c,showName:l,enableScreenshot:u,useSentryUser:d,tags:p,styleNonce:h,scriptNonce:f,colorScheme:m,themeDark:y,themeLight:g,triggerLabel:A,triggerAriaLabel:N,cancelButtonLabel:b,submitButtonLabel:R,confirmButtonLabel:_,formTitle:k,emailLabel:S,emailPlaceholder:w,messageLabel:T,messagePlaceholder:E,nameLabel:I,namePlaceholder:C,successMessageText:O,isRequiredLabel:x,addScreenshotButtonLabel:v,removeScreenshotButtonLabel:M,highlightToolText:D,hideToolText:L,removeHighlightText:P,onFormClose:$,onFormOpen:F,onSubmitError:U,onSubmitSuccess:B,onFormSubmitted:H};let q=null,W=[];const V=e=>{if(!q){const t=Yp.createElement("div");t.id=String(e.id),Yp.body.appendChild(t),q=t.attachShadow({mode:"open"}),q.appendChild(function({colorScheme:e,themeDark:t,themeLight:n,styleNonce:r}){const s=Yp.createElement("style");return s.textContent=`\n:host {\n  --font-family: system-ui, 'Helvetica Neue', Arial, sans-serif;\n  --font-size: 14px;\n  --z-index: 100000;\n\n  --page-margin: 16px;\n  --inset: auto 0 0 auto;\n  --actor-inset: var(--inset);\n\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n\n  ${"system"!==e?"color-scheme: only light;":""}\n\n  ${ah("dark"===e?{...ih,...t}:{...oh,...n})}\n}\n\n${"system"===e?`\n@media (prefers-color-scheme: dark) {\n  :host {\n    ${ah({...ih,...t})}\n  }\n}`:""}\n}\n`,r&&s.setAttribute("nonce",r),s}(e))}return q},J=async r=>{const s=r.enableScreenshot&&!(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(Qp.userAgent)||/Macintosh/i.test(Qp.userAgent)&&Qp.maxTouchPoints&&Qp.maxTouchPoints>1||!isSecureContext);let o,i;try{o=(t?t():await e("feedbackModalIntegration",f))(),We(o)}catch{throw th&&j.error("[Feedback] Error when trying to load feedback integrations. Try using `feedbackSyncIntegration` in your `Sentry.init`."),new Error("[Feedback] Missing feedback modal integration!")}try{const t=s?n?n():await e("feedbackScreenshotIntegration",f):void 0;t&&(i=t(),We(i))}catch{th&&j.error("[Feedback] Missing feedback screenshot integration. Proceeding without screenshots.")}const a=o.createDialog({options:{...r,onFormClose:()=>{a?.close(),r.onFormClose?.()},onFormSubmitted:()=>{a?.close(),r.onFormSubmitted?.()}},screenshotIntegration:i,sendFeedback:eh,shadow:V(r)});return a},K=(e,t={})=>{const n=nh(z,t),r="string"==typeof e?Yp.querySelector(e):"function"==typeof e.addEventListener?e:null;if(!r)throw th&&j.error("[Feedback] Unable to attach to target element"),new Error("Unable to attach to target element");let s=null;const o=async()=>{s||(s=await J({...n,onFormSubmitted:()=>{s?.removeFromDom(),n.onFormSubmitted?.()}})),s.appendToDom(),s.open()};r.addEventListener("click",o);const i=()=>{W=W.filter(e=>e!==i),s?.removeFromDom(),s=null,r.removeEventListener("click",o)};return W.push(i),i},G=(e={})=>{const t=nh(z,e),n=V(t),r=function({triggerLabel:e,triggerAriaLabel:t,shadow:n,styleNonce:r}){const s=Yp.createElement("button");if(s.type="button",s.className="widget__actor",s.ariaHidden="false",s.ariaLabel=t||e||Zp,s.appendChild(function(){const e=e=>Xp.document.createElementNS("http://www.w3.org/2000/svg",e),t=rh(e("svg"),{width:"20",height:"20",viewBox:"0 0 20 20",fill:"var(--actor-color, var(--foreground))"}),n=rh(e("g"),{clipPath:"url(#clip0_57_80)"}),r=rh(e("path"),{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.6622 15H12.3997C12.2129 14.9959 12.031 14.9396 11.8747 14.8375L8.04965 12.2H7.49956V19.1C7.4875 19.3348 7.3888 19.5568 7.22256 19.723C7.05632 19.8892 6.83435 19.9879 6.59956 20H2.04956C1.80193 19.9968 1.56535 19.8969 1.39023 19.7218C1.21511 19.5467 1.1153 19.3101 1.11206 19.0625V12.2H0.949652C0.824431 12.2017 0.700142 12.1783 0.584123 12.1311C0.468104 12.084 0.362708 12.014 0.274155 11.9255C0.185602 11.8369 0.115689 11.7315 0.0685419 11.6155C0.0213952 11.4995 -0.00202913 11.3752 -0.00034808 11.25V3.75C-0.00900498 3.62067 0.0092504 3.49095 0.0532651 3.36904C0.0972798 3.24712 0.166097 3.13566 0.255372 3.04168C0.344646 2.94771 0.452437 2.87327 0.571937 2.82307C0.691437 2.77286 0.82005 2.74798 0.949652 2.75H8.04965L11.8747 0.1625C12.031 0.0603649 12.2129 0.00407221 12.3997 0H15.6622C15.9098 0.00323746 16.1464 0.103049 16.3215 0.278167C16.4966 0.453286 16.5964 0.689866 16.5997 0.9375V3.25269C17.3969 3.42959 18.1345 3.83026 18.7211 4.41679C19.5322 5.22788 19.9878 6.32796 19.9878 7.47502C19.9878 8.62209 19.5322 9.72217 18.7211 10.5333C18.1345 11.1198 17.3969 11.5205 16.5997 11.6974V14.0125C16.6047 14.1393 16.5842 14.2659 16.5395 14.3847C16.4948 14.5035 16.4268 14.6121 16.3394 14.7042C16.252 14.7962 16.147 14.8698 16.0307 14.9206C15.9144 14.9714 15.7891 14.9984 15.6622 15ZM1.89695 10.325H1.88715V4.625H8.33715C8.52423 4.62301 8.70666 4.56654 8.86215 4.4625L12.6872 1.875H14.7247V13.125H12.6872L8.86215 10.4875C8.70666 10.3835 8.52423 10.327 8.33715 10.325H2.20217C2.15205 10.3167 2.10102 10.3125 2.04956 10.3125C1.9981 10.3125 1.94708 10.3167 1.89695 10.325ZM2.98706 12.2V18.1625H5.66206V12.2H2.98706ZM16.5997 9.93612V5.01393C16.6536 5.02355 16.7072 5.03495 16.7605 5.04814C17.1202 5.13709 17.4556 5.30487 17.7425 5.53934C18.0293 5.77381 18.2605 6.06912 18.4192 6.40389C18.578 6.73866 18.6603 7.10452 18.6603 7.47502C18.6603 7.84552 18.578 8.21139 18.4192 8.54616C18.2605 8.88093 18.0293 9.17624 17.7425 9.41071C17.4556 9.64518 17.1202 9.81296 16.7605 9.90191C16.7072 9.91509 16.6536 9.9265 16.5997 9.93612Z"});t.appendChild(n).appendChild(r);const s=e("defs"),o=rh(e("clipPath"),{id:"clip0_57_80"}),i=rh(e("rect"),{width:"20",height:"20",fill:"white"});return o.appendChild(i),s.appendChild(o),t.appendChild(s).appendChild(o).appendChild(i),t}()),e){const t=Yp.createElement("span");t.appendChild(Yp.createTextNode(e)),s.appendChild(t)}const o=function(e){const t=Yp.createElement("style");return t.textContent='\n.widget__actor {\n  position: fixed;\n  z-index: var(--z-index);\n  margin: var(--page-margin);\n  inset: var(--actor-inset);\n\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 16px;\n\n  font-family: inherit;\n  font-size: var(--font-size);\n  font-weight: 600;\n  line-height: 1.14em;\n  text-decoration: none;\n\n  background: var(--actor-background, var(--background));\n  border-radius: var(--actor-border-radius, 1.7em/50%);\n  border: var(--actor-border, var(--border));\n  box-shadow: var(--actor-box-shadow, var(--box-shadow));\n  color: var(--actor-color, var(--foreground));\n  fill: var(--actor-color, var(--foreground));\n  cursor: pointer;\n  opacity: 1;\n  transition: transform 0.2s ease-in-out;\n  transform: translate(0, 0) scale(1);\n}\n.widget__actor[aria-hidden="true"] {\n  opacity: 0;\n  pointer-events: none;\n  visibility: hidden;\n  transform: translate(0, 16px) scale(0.98);\n}\n\n.widget__actor:hover {\n  background: var(--actor-hover-background, var(--background));\n  filter: var(--interactive-filter);\n}\n\n.widget__actor svg {\n  width: 1.14em;\n  height: 1.14em;\n}\n\n@media (max-width: 600px) {\n  .widget__actor span {\n    display: none;\n  }\n}\n',e&&t.setAttribute("nonce",e),t}(r);return{el:s,appendToDom(){n.appendChild(o),n.appendChild(s)},removeFromDom(){s.remove(),o.remove()},show(){s.ariaHidden="false"},hide(){s.ariaHidden="true"}}}({triggerLabel:t.triggerLabel,triggerAriaLabel:t.triggerAriaLabel,shadow:n,styleNonce:h});return K(r.el,{...t,onFormOpen(){r.hide()},onFormClose(){r.show()},onFormSubmitted(){r.show()}}),r};return{name:"Feedback",setupOnce(){Xa()&&z.autoInject&&("loading"===Yp.readyState?Yp.addEventListener("DOMContentLoaded",()=>G().appendToDom()):G().appendToDom())},attachTo:K,createWidget(e={}){const t=G(nh(z,e));return t.appendToDom(),t},createForm:async(e={})=>J(nh(z,e)),remove(){q&&(q.parentElement?.remove(),q=null),W.forEach(e=>e()),W=[]}}};function lh(){const e=$e();return e?.getIntegrationByName("Feedback")}var uh,dh,ph,hh,fh,mh,gh,yh={},vh=[],bh=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,_h=Array.isArray;function Sh(e,t){for(var n in t)e[n]=t[n];return e}function wh(e){var t=e.parentNode;t&&t.removeChild(e)}function kh(e,t,n){var r,s,o,i={};for(o in t)"key"==o?r=t[o]:"ref"==o?s=t[o]:i[o]=t[o];if(arguments.length>2&&(i.children=arguments.length>3?uh.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(o in e.defaultProps)void 0===i[o]&&(i[o]=e.defaultProps[o]);return xh(e,i,r,s,null)}function xh(e,t,n,r,s){var o={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==s?++ph:s,__i:-1,__u:0};return null==s&&null!=dh.vnode&&dh.vnode(o),o}function Th(e){return e.children}function Eh(e,t){this.props=e,this.context=t}function Ih(e,t){if(null==t)return e.__?Ih(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?Ih(e):null}function Ch(e,t,n){var r,s=e.__v,o=s.__e,i=e.__P;if(i)return(r=Sh({},s)).__v=s.__v+1,dh.vnode&&dh.vnode(r),$h(i,r,s,e.__n,void 0!==i.ownerSVGElement,32&s.__u?[o]:null,t,null==o?Ih(s):o,!!(32&s.__u),n),r.__.__k[r.__i]=r,r.__d=void 0,r.__e!=o&&Mh(r),r}function Mh(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return Mh(e)}}function Rh(e){(!e.__d&&(e.__d=!0)&&hh.push(e)&&!Oh.__r++||fh!==dh.debounceRendering)&&((fh=dh.debounceRendering)||mh)(Oh)}function Oh(){var e,t,n,r=[],s=[];for(hh.sort(gh);e=hh.shift();)e.__d&&(n=hh.length,t=Ch(e,r,s)||t,0===n||hh.length>n?(Bh(r,t,s),s.length=r.length=0,t=void 0,hh.sort(gh)):t&&dh.__c&&dh.__c(t,vh));t&&Bh(r,t,s),Oh.__r=0}function Ah(e,t,n,r,s,o,i,a,c,l,u){var d,p,h,f,m,g=r&&r.__k||vh,y=t.length;for(n.__d=c,function(e,t,n){var r,s,o,i,a,c=t.length,l=n.length,u=l,d=0;for(e.__k=[],r=0;r<c;r++)null!=(s=e.__k[r]=null==(s=t[r])||"boolean"==typeof s||"function"==typeof s?null:"string"==typeof s||"number"==typeof s||"bigint"==typeof s||s.constructor==String?xh(null,s,null,null,s):_h(s)?xh(Th,{children:s},null,null,null):void 0===s.constructor&&s.__b>0?xh(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s)?(s.__=e,s.__b=e.__b+1,a=Dh(s,n,i=r+d,u),s.__i=a,o=null,-1!==a&&(u--,(o=n[a])&&(o.__u|=131072)),null==o||null===o.__v?(-1==a&&d--,"function"!=typeof s.type&&(s.__u|=65536)):a!==i&&(a===i+1?d++:a>i?u>c-i?d+=a-i:d--:d=a<i&&a==i-1?a-i:0,a!==r+d&&(s.__u|=65536))):(o=n[r])&&null==o.key&&o.__e&&(o.__e==e.__d&&(e.__d=Ih(o)),Hh(o,o,!1),n[r]=null,u--);if(u)for(r=0;r<l;r++)null!=(o=n[r])&&!(131072&o.__u)&&(o.__e==e.__d&&(e.__d=Ih(o)),Hh(o,o))}(n,t,g),c=n.__d,d=0;d<y;d++)null!=(h=n.__k[d])&&"boolean"!=typeof h&&"function"!=typeof h&&(p=-1===h.__i?yh:g[h.__i]||yh,h.__i=d,$h(e,h,p,s,o,i,a,c,l,u),f=h.__e,h.ref&&p.ref!=h.ref&&(p.ref&&Uh(p.ref,null,h),u.push(h.ref,h.__c||f,h)),null==m&&null!=f&&(m=f),65536&h.__u||p.__k===h.__k?c=Nh(h,c,e):"function"==typeof h.type&&void 0!==h.__d?c=h.__d:f&&(c=f.nextSibling),h.__d=void 0,h.__u&=-196609);n.__d=c,n.__e=m}function Nh(e,t,n){var r,s;if("function"==typeof e.type){for(r=e.__k,s=0;r&&s<r.length;s++)r[s]&&(r[s].__=e,t=Nh(r[s],t,n));return t}e.__e!=t&&(n.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8===t.nodeType);return t}function Dh(e,t,n,r){var s=e.key,o=e.type,i=n-1,a=n+1,c=t[n];if(null===c||c&&s==c.key&&o===c.type)return n;if(r>(null==c||131072&c.__u?0:1))for(;i>=0||a<t.length;){if(i>=0){if((c=t[i])&&!(131072&c.__u)&&s==c.key&&o===c.type)return i;i--}if(a<t.length){if((c=t[a])&&!(131072&c.__u)&&s==c.key&&o===c.type)return a;a++}}return-1}function Lh(e,t,n){"-"===t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||bh.test(t)?n:n+"px"}function Ph(e,t,n,r,s){var o;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||Lh(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||Lh(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])o=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?r?n.u=r.u:(n.u=Date.now(),e.addEventListener(t,o?jh:Fh,o)):e.removeEventListener(t,o?jh:Fh,o);else{if(s)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==t&&"height"!==t&&"href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&"rowSpan"!==t&&"colSpan"!==t&&"role"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!==t[4]?e.removeAttribute(t):e.setAttribute(t,n))}}function Fh(e){if(this.l){var t=this.l[e.type+!1];if(e.t){if(e.t<=t.u)return}else e.t=Date.now();return t(dh.event?dh.event(e):e)}}function jh(e){if(this.l)return this.l[e.type+!0](dh.event?dh.event(e):e)}function $h(e,t,n,r,s,o,i,a,c,l){var u,d,p,h,f,m,g,y,v,b,_,S,w,k,x,T=t.type;if(void 0!==t.constructor)return null;128&n.__u&&(c=!!(32&n.__u),o=[a=t.__e=n.__e]),(u=dh.__b)&&u(t);e:if("function"==typeof T)try{if(y=t.props,v=(u=T.contextType)&&r[u.__c],b=u?v?v.props.value:u.__:r,n.__c?g=(d=t.__c=n.__c).__=d.__E:("prototype"in T&&T.prototype.render?t.__c=d=new T(y,b):(t.__c=d=new Eh(y,b),d.constructor=T,d.render=zh),v&&v.sub(d),d.props=y,d.state||(d.state={}),d.context=b,d.__n=r,p=d.__d=!0,d.__h=[],d._sb=[]),null==d.__s&&(d.__s=d.state),null!=T.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=Sh({},d.__s)),Sh(d.__s,T.getDerivedStateFromProps(y,d.__s))),h=d.props,f=d.state,d.__v=t,p)null==T.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==T.getDerivedStateFromProps&&y!==h&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(y,b),!d.__e&&(null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(y,d.__s,b)||t.__v===n.__v)){for(t.__v!==n.__v&&(d.props=y,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(e){e&&(e.__=t)}),_=0;_<d._sb.length;_++)d.__h.push(d._sb[_]);d._sb=[],d.__h.length&&i.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(y,d.__s,b),null!=d.componentDidUpdate&&d.__h.push(function(){d.componentDidUpdate(h,f,m)})}if(d.context=b,d.props=y,d.__P=e,d.__e=!1,S=dh.__r,w=0,"prototype"in T&&T.prototype.render){for(d.state=d.__s,d.__d=!1,S&&S(t),u=d.render(d.props,d.state,d.context),k=0;k<d._sb.length;k++)d.__h.push(d._sb[k]);d._sb=[]}else do{d.__d=!1,S&&S(t),u=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&++w<25);d.state=d.__s,null!=d.getChildContext&&(r=Sh(Sh({},r),d.getChildContext())),p||null==d.getSnapshotBeforeUpdate||(m=d.getSnapshotBeforeUpdate(h,f)),Ah(e,_h(x=null!=u&&u.type===Th&&null==u.key?u.props.children:u)?x:[x],t,n,r,s,o,i,a,c,l),d.base=t.__e,t.__u&=-161,d.__h.length&&i.push(d),g&&(d.__E=d.__=null)}catch(e){t.__v=null,c||null!=o?(t.__e=a,t.__u|=c?160:32,o[o.indexOf(a)]=null):(t.__e=n.__e,t.__k=n.__k),dh.__e(e,t,n)}else null==o&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=function(e,t,n,r,s,o,i,a,c){var l,u,d,p,h,f,m,g=n.props,y=t.props,v=t.type;if("svg"===v&&(s=!0),null!=o)for(l=0;l<o.length;l++)if((h=o[l])&&"setAttribute"in h==!!v&&(v?h.localName===v:3===h.nodeType)){e=h,o[l]=null;break}if(null==e){if(null===v)return document.createTextNode(y);e=s?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,y.is&&y),o=null,a=!1}if(null===v)g===y||a&&e.data===y||(e.data=y);else{if(o=o&&uh.call(e.childNodes),g=n.props||yh,!a&&null!=o)for(g={},l=0;l<e.attributes.length;l++)g[(h=e.attributes[l]).name]=h.value;for(l in g)h=g[l],"children"==l||("dangerouslySetInnerHTML"==l?d=h:"key"===l||l in y||Ph(e,l,null,h,s));for(l in y)h=y[l],"children"==l?p=h:"dangerouslySetInnerHTML"==l?u=h:"value"==l?f=h:"checked"==l?m=h:"key"===l||a&&"function"!=typeof h||g[l]===h||Ph(e,l,h,g[l],s);if(u)a||d&&(u.__html===d.__html||u.__html===e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(d&&(e.innerHTML=""),Ah(e,_h(p)?p:[p],t,n,r,s&&"foreignObject"!==v,o,i,o?o[0]:n.__k&&Ih(n,0),a,c),null!=o)for(l=o.length;l--;)null!=o[l]&&wh(o[l]);a||(l="value",void 0!==f&&(f!==e[l]||"progress"===v&&!f||"option"===v&&f!==g[l])&&Ph(e,l,f,g[l],!1),l="checked",void 0!==m&&m!==e[l]&&Ph(e,l,m,g[l],!1))}return e}(n.__e,t,n,r,s,o,i,c,l);(u=dh.diffed)&&u(t)}function Bh(e,t,n){for(var r=0;r<n.length;r++)Uh(n[r],n[++r],n[++r]);dh.__c&&dh.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){dh.__e(e,t.__v)}})}function Uh(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){dh.__e(e,n)}}function Hh(e,t,n){var r,s;if(dh.unmount&&dh.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||Uh(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){dh.__e(e,t)}r.base=r.__P=null,e.__c=void 0}if(r=e.__k)for(s=0;s<r.length;s++)r[s]&&Hh(r[s],t,n||"function"!=typeof e.type);n||null==e.__e||wh(e.__e),e.__=e.__e=e.__d=void 0}function zh(e,t,n){return this.constructor(e,n)}uh=vh.slice,dh={__e:function(e,t,n,r){for(var s,o,i;t=t.__;)if((s=t.__c)&&!s.__)try{if((o=s.constructor)&&null!=o.getDerivedStateFromError&&(s.setState(o.getDerivedStateFromError(e)),i=s.__d),null!=s.componentDidCatch&&(s.componentDidCatch(e,r||{}),i=s.__d),i)return s.__E=s}catch(t){e=t}throw e}},ph=0,Eh.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=Sh({},this.state),"function"==typeof e&&(e=e(Sh({},n),this.props)),e&&Sh(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),Rh(this))},Eh.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Rh(this))},Eh.prototype.render=Th,hh=[],mh="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,gh=function(e,t){return e.__v.__b-t.__v.__b},Oh.__r=0;var qh,Wh,Vh,Jh,Kh=0,Gh=[],Xh=[],Yh=dh,Qh=Yh.__b,Zh=Yh.__r,ef=Yh.diffed,tf=Yh.__c,nf=Yh.unmount,rf=Yh.__;function sf(e,t){Yh.__h&&Yh.__h(Wh,e,Kh||t),Kh=0;var n=Wh.__H||(Wh.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:Xh}),n.__[e]}function of(e){return Kh=1,af(yf,e)}function af(e,t,n){var r=sf(qh++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):yf(void 0,t),function(e){var t=r.__N?r.__N[0]:r.__[0],n=r.t(t,e);t!==n&&(r.__N=[n,r.__[1]],r.__c.setState({}))}],r.__c=Wh,!Wh.u)){var s=function(e,t,n){if(!r.__c.__H)return!0;var s=r.__c.__H.__.filter(function(e){return!!e.__c});if(s.every(function(e){return!e.__N}))return!o||o.call(this,e,t,n);var i=!1;return s.forEach(function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(i=!0)}}),!(!i&&r.__c.props===e)&&(!o||o.call(this,e,t,n))};Wh.u=!0;var o=Wh.shouldComponentUpdate,i=Wh.componentWillUpdate;Wh.componentWillUpdate=function(e,t,n){if(this.__e){var r=o;o=void 0,s(e,t,n),o=r}i&&i.call(this,e,t,n)},Wh.shouldComponentUpdate=s}return r.__N||r.__}function cf(e,t){var n=sf(qh++,4);!Yh.__s&&gf(n.__H,t)&&(n.__=e,n.i=t,Wh.__h.push(n))}function lf(e,t){var n=sf(qh++,7);return gf(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function uf(e,t){return Kh=8,lf(function(){return e},t)}function df(){for(var e;e=Gh.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(ff),e.__H.__h.forEach(mf),e.__H.__h=[]}catch(t){e.__H.__h=[],Yh.__e(t,e.__v)}}Yh.__b=function(e){Wh=null,Qh&&Qh(e)},Yh.__=function(e,t){t.__k&&t.__k.__m&&(e.__m=t.__k.__m),rf&&rf(e,t)},Yh.__r=function(e){Zh&&Zh(e),qh=0;var t=(Wh=e.__c).__H;t&&(Vh===Wh?(t.__h=[],Wh.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.__V=Xh,e.__N=e.i=void 0})):(t.__h.forEach(ff),t.__h.forEach(mf),t.__h=[],qh=0)),Vh=Wh},Yh.diffed=function(e){ef&&ef(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==Gh.push(t)&&Jh===Yh.requestAnimationFrame||((Jh=Yh.requestAnimationFrame)||hf)(df)),t.__H.__.forEach(function(e){e.i&&(e.__H=e.i),e.__V!==Xh&&(e.__=e.__V),e.i=void 0,e.__V=Xh})),Vh=Wh=null},Yh.__c=function(e,t){t.some(function(e){try{e.__h.forEach(ff),e.__h=e.__h.filter(function(e){return!e.__||mf(e)})}catch(n){t.some(function(e){e.__h&&(e.__h=[])}),t=[],Yh.__e(n,e.__v)}}),tf&&tf(e,t)},Yh.unmount=function(e){nf&&nf(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(e){try{ff(e)}catch(e){t=e}}),n.__H=void 0,t&&Yh.__e(t,n.__v))};var pf="function"==typeof requestAnimationFrame;function hf(e){var t,n=function(){clearTimeout(r),pf&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);pf&&(t=requestAnimationFrame(n))}function ff(e){var t=Wh,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),Wh=t}function mf(e){var t=Wh;e.__c=e.__(),Wh=t}function gf(e,t){return!e||e.length!==t.length||t.some(function(t,n){return t!==e[n]})}function yf(e,t){return"function"==typeof t?t(e):t}const vf=Object.defineProperty({__proto__:null,useCallback:uf,useContext:function(e){var t=Wh.context[e.__c],n=sf(qh++,9);return n.c=e,t?(null==n.__&&(n.__=!0,t.sub(Wh)),t.props.value):e.__},useDebugValue:function(e,t){Yh.useDebugValue&&Yh.useDebugValue(t?t(e):e)},useEffect:function(e,t){var n=sf(qh++,3);!Yh.__s&&gf(n.__H,t)&&(n.__=e,n.i=t,Wh.__H.__h.push(n))},useErrorBoundary:function(e){var t=sf(qh++,10),n=of();return t.__=e,Wh.componentDidCatch||(Wh.componentDidCatch=function(e,r){t.__&&t.__(e,r),n[1](e)}),[n[0],function(){n[1](void 0)}]},useId:function(){var e=sf(qh++,11);if(!e.__){for(var t=Wh.__v;null!==t&&!t.__m&&null!==t.__;)t=t.__;var n=t.__m||(t.__m=[0,0]);e.__="P"+n[0]+"-"+n[1]++}return e.__},useImperativeHandle:function(e,t,n){Kh=6,cf(function(){return"function"==typeof e?(e(t()),function(){return e(null)}):e?(e.current=t(),function(){return e.current=null}):void 0},null==n?n:n.concat(e))},useLayoutEffect:cf,useMemo:lf,useReducer:af,useRef:function(e){return Kh=5,lf(function(){return{current:e}},[])},useState:of},Symbol.toStringTag,{value:"Module"});function bf(){const e=e=>Yp.createElementNS("http://www.w3.org/2000/svg",e),t=rh(e("svg"),{width:"32",height:"30",viewBox:"0 0 72 66",fill:"inherit"}),n=rh(e("path"),{transform:"translate(11, 11)",d:"M29,2.26a4.67,4.67,0,0,0-8,0L14.42,13.53A32.21,32.21,0,0,1,32.17,40.19H27.55A27.68,27.68,0,0,0,12.09,17.47L6,28a15.92,15.92,0,0,1,9.23,12.17H4.62A.76.76,0,0,1,4,39.06l2.94-5a10.74,10.74,0,0,0-3.36-1.9l-2.91,5a4.54,4.54,0,0,0,1.69,6.24A4.66,4.66,0,0,0,4.62,44H19.15a19.4,19.4,0,0,0-8-17.31l2.31-4A23.87,23.87,0,0,1,23.76,44H36.07a35.88,35.88,0,0,0-16.41-31.8l4.67-8a.77.77,0,0,1,1.05-.27c.53.29,20.29,34.77,20.66,35.17a.76.76,0,0,1-.68,1.13H40.6q.09,1.91,0,3.81h4.78A4.59,4.59,0,0,0,50,39.43a4.49,4.49,0,0,0-.62-2.28Z"});return t.appendChild(n),t}function _f({options:e}){const t=lf(()=>({__html:bf().outerHTML}),[]);return kh("h2",{class:"dialog__header"},kh("span",{class:"dialog__title"},e.formTitle),e.showBranding?kh("a",{class:"brand-link",target:"_blank",href:"https://sentry.io/welcome/",title:"Powered by Sentry",rel:"noopener noreferrer",dangerouslySetInnerHTML:t}):null)}function Sf(e,t){const n=e.get(t);return"string"==typeof n?n.trim():""}function wf({options:e,defaultEmail:t,defaultName:n,onFormClose:r,onSubmit:s,onSubmitSuccess:o,onSubmitError:i,showEmail:a,showName:c,screenshotInput:l}){const{tags:u,addScreenshotButtonLabel:d,removeScreenshotButtonLabel:p,cancelButtonLabel:h,emailLabel:f,emailPlaceholder:m,isEmailRequired:g,isNameRequired:y,messageLabel:v,messagePlaceholder:b,nameLabel:_,namePlaceholder:S,submitButtonLabel:w,isRequiredLabel:k}=e,[x,T]=of(!1),[E,I]=of(null),[C,M]=of(!1),R=l?.input,[O,A]=of(null),N=uf(e=>{A(e),M(!1)},[]),D=uf(e=>{const t=function(e,t){const n=[];return t.isNameRequired&&!e.name&&n.push(t.nameLabel),t.isEmailRequired&&!e.email&&n.push(t.emailLabel),e.message||n.push(t.messageLabel),n}(e,{emailLabel:f,isEmailRequired:g,isNameRequired:y,messageLabel:v,nameLabel:_});return t.length>0?I(`Please enter in the following required fields: ${t.join(", ")}`):I(null),0===t.length},[f,g,y,v,_]),L=uf(async e=>{T(!0);try{if(e.preventDefault(),!(e.target instanceof HTMLFormElement))return;const t=new FormData(e.target),n=await(l&&C?l.value():void 0),r={name:Sf(t,"name"),email:Sf(t,"email"),message:Sf(t,"message"),attachments:n?[n]:void 0};if(!D(r))return;try{const e=await s({name:r.name,email:r.email,message:r.message,source:"widget",tags:u},{attachments:r.attachments});o(r,e)}catch(e){th&&j.error(e),I(e),i(e)}}finally{T(!1)}},[l&&C,o,i]);return kh("form",{class:"form",onSubmit:L},R&&C?kh(R,{onError:N}):null,kh("fieldset",{class:"form__right","data-sentry-feedback":!0,disabled:x},kh("div",{class:"form__top"},E?kh("div",{class:"form__error-container"},E):null,c?kh("label",{for:"name",class:"form__label"},kh(kf,{label:_,isRequiredLabel:k,isRequired:y}),kh("input",{class:"form__input",defaultValue:n,id:"name",name:"name",placeholder:S,required:y,type:"text"})):kh("input",{"aria-hidden":!0,value:n,name:"name",type:"hidden"}),a?kh("label",{for:"email",class:"form__label"},kh(kf,{label:f,isRequiredLabel:k,isRequired:g}),kh("input",{class:"form__input",defaultValue:t,id:"email",name:"email",placeholder:m,required:g,type:"email"})):kh("input",{"aria-hidden":!0,value:t,name:"email",type:"hidden"}),kh("label",{for:"message",class:"form__label"},kh(kf,{label:v,isRequiredLabel:k,isRequired:!0}),kh("textarea",{autoFocus:!0,class:"form__input form__input--textarea",id:"message",name:"message",placeholder:b,required:!0,rows:5})),R?kh("label",{for:"screenshot",class:"form__label"},kh("button",{class:"btn btn--default",disabled:x,type:"button",onClick:()=>{A(null),M(e=>!e)}},C?p:d),O?kh("div",{class:"form__error-container"},O.message):null):null),kh("div",{class:"btn-group"},kh("button",{class:"btn btn--primary",disabled:x,type:"submit"},w),kh("button",{class:"btn btn--default",disabled:x,type:"button",onClick:r},h))))}function kf({label:e,isRequired:t,isRequiredLabel:n}){return kh("span",{class:"form__label__text"},e,t&&kh("span",{class:"form__label__text--required"},n))}function xf(){const e=e=>Xp.document.createElementNS("http://www.w3.org/2000/svg",e),t=rh(e("svg"),{width:"16",height:"17",viewBox:"0 0 16 17",fill:"inherit"}),n=rh(e("g"),{clipPath:"url(#clip0_57_156)"}),r=rh(e("path"),{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.55544 15.1518C4.87103 16.0308 6.41775 16.5 8 16.5C10.1217 16.5 12.1566 15.6571 13.6569 14.1569C15.1571 12.6566 16 10.6217 16 8.5C16 6.91775 15.5308 5.37103 14.6518 4.05544C13.7727 2.73985 12.5233 1.71447 11.0615 1.10897C9.59966 0.503466 7.99113 0.34504 6.43928 0.653721C4.88743 0.962403 3.46197 1.72433 2.34315 2.84315C1.22433 3.96197 0.462403 5.38743 0.153721 6.93928C-0.15496 8.49113 0.00346625 10.0997 0.608967 11.5615C1.21447 13.0233 2.23985 14.2727 3.55544 15.1518ZM4.40546 3.1204C5.46945 2.40946 6.72036 2.03 8 2.03C9.71595 2.03 11.3616 2.71166 12.575 3.92502C13.7883 5.13838 14.47 6.78405 14.47 8.5C14.47 9.77965 14.0905 11.0306 13.3796 12.0945C12.6687 13.1585 11.6582 13.9878 10.476 14.4775C9.29373 14.9672 7.99283 15.0953 6.73777 14.8457C5.48271 14.596 4.32987 13.9798 3.42502 13.075C2.52018 12.1701 1.90397 11.0173 1.65432 9.76224C1.40468 8.50718 1.5328 7.20628 2.0225 6.02404C2.5122 4.8418 3.34148 3.83133 4.40546 3.1204Z"}),s=rh(e("path"),{d:"M6.68775 12.4297C6.78586 12.4745 6.89218 12.4984 7 12.5C7.11275 12.4955 7.22315 12.4664 7.32337 12.4145C7.4236 12.3627 7.51121 12.2894 7.58 12.2L12 5.63999C12.0848 5.47724 12.1071 5.28902 12.0625 5.11098C12.0178 4.93294 11.9095 4.77744 11.7579 4.67392C11.6064 4.57041 11.4221 4.52608 11.24 4.54931C11.0579 4.57254 10.8907 4.66173 10.77 4.79999L6.88 10.57L5.13 8.56999C5.06508 8.49566 4.98613 8.43488 4.89768 8.39111C4.80922 8.34735 4.713 8.32148 4.61453 8.31498C4.51605 8.30847 4.41727 8.32147 4.32382 8.35322C4.23038 8.38497 4.14413 8.43484 4.07 8.49999C3.92511 8.63217 3.83692 8.81523 3.82387 9.01092C3.81083 9.2066 3.87393 9.39976 4 9.54999L6.43 12.24C6.50187 12.3204 6.58964 12.385 6.68775 12.4297Z"});t.appendChild(n).append(s,r);const o=e("defs"),i=rh(e("clipPath"),{id:"clip0_57_156"}),a=rh(e("rect"),{width:"16",height:"16",fill:"white",transform:"translate(0 0.5)"});return i.appendChild(a),o.appendChild(i),t.appendChild(o).appendChild(i).appendChild(a),t}function Tf({open:e,onFormSubmitted:t,...n}){const r=n.options,s=lf(()=>({__html:xf().outerHTML}),[]),[o,i]=of(null),a=uf(()=>{o&&(clearTimeout(o),i(null)),t()},[o]),c=uf((e,r)=>{n.onSubmitSuccess(e,r),i(setTimeout(()=>{t(),i(null)},5e3))},[t]);return kh(Th,null,o?kh("div",{class:"success__position",onClick:a},kh("div",{class:"success__content"},r.successMessageText,kh("span",{class:"success__icon",dangerouslySetInnerHTML:s}))):kh("dialog",{class:"dialog",onClick:r.onFormClose,open:e},kh("div",{class:"dialog__position"},kh("div",{class:"dialog__content",onClick:e=>{e.stopPropagation()}},kh(_f,{options:r}),kh(wf,{...n,onSubmitSuccess:c})))))}const Ef=()=>({name:"FeedbackModal",setupOnce(){},createDialog:({options:e,screenshotIntegration:t,sendFeedback:n,shadow:r})=>{const s=r,o=e.useSentryUser,i=function(){const e=De().getUser(),t=Le().getUser(),n=Pe().getUser();return e&&Object.keys(e).length?e:t&&Object.keys(t).length?t:n}(),a=Yp.createElement("div"),c=function(e){const t=Yp.createElement("style");return t.textContent="\n:host {\n  --dialog-inset: var(--inset);\n}\n\n\n.dialog {\n  position: fixed;\n  z-index: var(--z-index);\n  margin: 0;\n  inset: 0;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0;\n  height: 100vh;\n  width: 100vw;\n\n  color: var(--dialog-color, var(--foreground));\n  fill: var(--dialog-color, var(--foreground));\n  line-height: 1.75em;\n\n  background-color: rgba(0, 0, 0, 0.05);\n  border: none;\n  inset: 0;\n  opacity: 1;\n  transition: opacity 0.2s ease-in-out;\n}\n\n.dialog__position {\n  position: fixed;\n  z-index: var(--z-index);\n  inset: var(--dialog-inset);\n  padding: var(--page-margin);\n  display: flex;\n  max-height: calc(100vh - (2 * var(--page-margin)));\n}\n@media (max-width: 600px) {\n  .dialog__position {\n    inset: var(--page-margin);\n    padding: 0;\n  }\n}\n\n.dialog__position:has(.editor) {\n  inset: var(--page-margin);\n  padding: 0;\n}\n\n.dialog:not([open]) {\n  opacity: 0;\n  pointer-events: none;\n  visibility: hidden;\n}\n.dialog:not([open]) .dialog__content {\n  transform: translate(0, -16px) scale(0.98);\n}\n\n.dialog__content {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n  padding: var(--dialog-padding, 24px);\n  max-width: 100%;\n  width: 100%;\n  max-height: 100%;\n  overflow: auto;\n\n  background: var(--dialog-background, var(--background));\n  border-radius: var(--dialog-border-radius, 20px);\n  border: var(--dialog-border, var(--border));\n  box-shadow: var(--dialog-box-shadow, var(--box-shadow));\n  transform: translate(0, 0) scale(1);\n  transition: transform 0.2s ease-in-out;\n}\n\n\n\n.dialog__header {\n  display: flex;\n  gap: 4px;\n  justify-content: space-between;\n  font-weight: var(--dialog-header-weight, 600);\n  margin: 0;\n}\n.dialog__title {\n  align-self: center;\n  width: var(--form-width, 272px);\n}\n\n@media (max-width: 600px) {\n  .dialog__title {\n    width: auto;\n  }\n}\n\n.dialog__position:has(.editor) .dialog__title {\n  width: auto;\n}\n\n\n.brand-link {\n  display: inline-flex;\n}\n.brand-link:focus-visible {\n  outline: var(--outline);\n}\n\n\n.form {\n  display: flex;\n  overflow: auto;\n  flex-direction: row;\n  gap: 16px;\n  flex: 1 0;\n}\n\n.form fieldset {\n  border: none;\n  margin: 0;\n  padding: 0;\n}\n\n.form__right {\n  flex: 0 0 auto;\n  display: flex;\n  overflow: auto;\n  flex-direction: column;\n  justify-content: space-between;\n  gap: 20px;\n  width: var(--form-width, 100%);\n}\n\n.dialog__position:has(.editor) .form__right {\n  width: var(--form-width, 272px);\n}\n\n.form__top {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.form__error-container {\n  color: var(--error-color);\n  fill: var(--error-color);\n}\n\n.form__label {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  margin: 0px;\n}\n\n.form__label__text {\n  display: flex;\n  gap: 4px;\n  align-items: center;\n}\n\n.form__label__text--required {\n  font-size: 0.85em;\n}\n\n.form__input {\n  font-family: inherit;\n  line-height: inherit;\n  background: transparent;\n  box-sizing: border-box;\n  border: var(--input-border, var(--border));\n  border-radius: var(--input-border-radius, 6px);\n  color: var(--input-color, inherit);\n  fill: var(--input-color, inherit);\n  font-size: var(--input-font-size, inherit);\n  font-weight: var(--input-font-weight, 500);\n  padding: 6px 12px;\n}\n\n.form__input::placeholder {\n  opacity: 0.65;\n  color: var(--input-placeholder-color, inherit);\n  filter: var(--interactive-filter);\n}\n\n.form__input:focus-visible {\n  outline: var(--input-focus-outline, var(--outline));\n}\n\n.form__input--textarea {\n  font-family: inherit;\n  resize: vertical;\n}\n\n.error {\n  color: var(--error-color);\n  fill: var(--error-color);\n}\n\n\n.btn-group {\n  display: grid;\n  gap: 8px;\n}\n\n.btn {\n  line-height: inherit;\n  border: var(--button-border, var(--border));\n  border-radius: var(--button-border-radius, 6px);\n  cursor: pointer;\n  font-family: inherit;\n  font-size: var(--button-font-size, inherit);\n  font-weight: var(--button-font-weight, 600);\n  padding: var(--button-padding, 6px 16px);\n}\n.btn[disabled] {\n  opacity: 0.6;\n  pointer-events: none;\n}\n\n.btn--primary {\n  color: var(--button-primary-color, var(--accent-foreground));\n  fill: var(--button-primary-color, var(--accent-foreground));\n  background: var(--button-primary-background, var(--accent-background));\n  border: var(--button-primary-border, var(--border));\n  border-radius: var(--button-primary-border-radius, 6px);\n  font-weight: var(--button-primary-font-weight, 500);\n}\n.btn--primary:hover {\n  color: var(--button-primary-hover-color, var(--accent-foreground));\n  fill: var(--button-primary-hover-color, var(--accent-foreground));\n  background: var(--button-primary-hover-background, var(--accent-background));\n  filter: var(--interactive-filter);\n}\n.btn--primary:focus-visible {\n  background: var(--button-primary-hover-background, var(--accent-background));\n  filter: var(--interactive-filter);\n  outline: var(--button-primary-focus-outline, var(--outline));\n}\n\n.btn--default {\n  color: var(--button-color, var(--foreground));\n  fill: var(--button-color, var(--foreground));\n  background: var(--button-background, var(--background));\n  border: var(--button-border, var(--border));\n  border-radius: var(--button-border-radius, 6px);\n  font-weight: var(--button-font-weight, 500);\n}\n.btn--default:hover {\n  color: var(--button-color, var(--foreground));\n  fill: var(--button-color, var(--foreground));\n  background: var(--button-hover-background, var(--background));\n  filter: var(--interactive-filter);\n}\n.btn--default:focus-visible {\n  background: var(--button-hover-background, var(--background));\n  filter: var(--interactive-filter);\n  outline: var(--button-focus-outline, var(--outline));\n}\n\n\n.success__position {\n  position: fixed;\n  inset: var(--dialog-inset);\n  padding: var(--page-margin);\n  z-index: var(--z-index);\n}\n.success__content {\n  background: var(--success-background, var(--background));\n  border: var(--success-border, var(--border));\n  border-radius: var(--success-border-radius, 1.7em/50%);\n  box-shadow: var(--success-box-shadow, var(--box-shadow));\n  font-weight: var(--success-font-weight, 600);\n  color: var(--success-color);\n  fill: var(--success-color);\n  padding: 12px 24px;\n  line-height: 1.75em;\n\n  display: grid;\n  align-items: center;\n  grid-auto-flow: column;\n  gap: 6px;\n  cursor: default;\n}\n\n.success__icon {\n  display: flex;\n}\n\n",e&&t.setAttribute("nonce",e),t}(e.styleNonce);let l="";const u={get el(){return a},appendToDom(){s.contains(c)||s.contains(a)||(s.appendChild(c),s.appendChild(a))},removeFromDom(){a.remove(),c.remove(),Yp.body.style.overflow=l},open(){p(!0),e.onFormOpen?.(),$e()?.emit("openFeedbackWidget"),l=Yp.body.style.overflow,Yp.body.style.overflow="hidden"},close(){p(!1),Yp.body.style.overflow=l}},d=t?.createInput({h:kh,hooks:vf,dialog:u,options:e}),p=t=>{!function(e,t){var n,r,s;dh.__&&dh.__(e,t),n=t.__k,r=[],s=[],$h(t,e=t.__k=kh(Th,null,[e]),n||yh,yh,void 0!==t.ownerSVGElement,n?null:t.firstChild?uh.call(t.childNodes):null,r,n?n.__e:t.firstChild,!1,s),e.__d=void 0,Bh(r,e,s)}(kh(Tf,{options:e,screenshotInput:d,showName:e.showName||e.isNameRequired,showEmail:e.showEmail||e.isEmailRequired,defaultName:o&&i?.[o.name]||"",defaultEmail:o&&i?.[o.email]||"",onFormClose:()=>{p(!1),e.onFormClose?.()},onSubmit:n,onSubmitSuccess:(t,n)=>{p(!1),e.onSubmitSuccess?.(t,n)},onSubmitError:t=>{e.onSubmitError?.(t)},onFormSubmitted:()=>{e.onFormSubmitted?.()},open:t}),a)};return u}});function If(e){const t=Yp.createElement("style"),n="#1A141F",r="#302735";return t.textContent=`\n.editor {\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n}\n\n.editor__image-container {\n  justify-items: center;\n  padding: 15px;\n  position: relative;\n  height: 100%;\n  border-radius: var(--menu-border-radius, 6px);\n\n  background-color: ${n};\n  background-image: repeating-linear-gradient(\n      -145deg,\n      transparent,\n      transparent 8px,\n      ${n} 8px,\n      ${n} 11px\n    ),\n    repeating-linear-gradient(\n      -45deg,\n      transparent,\n      transparent 15px,\n      ${r} 15px,\n      ${r} 16px\n    );\n}\n\n.editor__canvas-container {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.editor__canvas-container > * {\n  object-fit: contain;\n  position: absolute;\n}\n\n.editor__tool-container {\n  padding-top: 8px;\n  display: flex;\n  justify-content: center;\n}\n\n.editor__tool-bar {\n  display: flex;\n  gap: 8px;\n}\n\n.editor__tool {\n  display: flex;\n  padding: 8px 12px;\n  justify-content: center;\n  align-items: center;\n  border: var(--button-border, var(--border));\n  border-radius: var(--button-border-radius, 6px);\n  background: var(--button-background, var(--background));\n  color: var(--button-color, var(--foreground));\n}\n\n.editor__tool--active {\n  background: var(--button-primary-background, var(--accent-background));\n  color: var(--button-primary-color, var(--accent-foreground));\n}\n\n.editor__rect {\n  position: absolute;\n  z-index: 2;\n}\n\n.editor__rect button {\n  opacity: 0;\n  position: absolute;\n  top: -12px;\n  right: -12px;\n  cursor: pointer;\n  padding: 0;\n  z-index: 3;\n  border: none;\n  background: none;\n}\n\n.editor__rect:hover button {\n  opacity: 1;\n}\n`,e&&t.setAttribute("nonce",e),t}function Cf(e,t,n){if(!e)return;const r=e.getContext("2d",t);r&&n(e,r)}function Mf(e,t){Cf(e,{alpha:!0},(e,n)=>{n.drawImage(t,0,0,t.width,t.height,0,0,e.width,e.height)})}function Rf(e,t,n){Cf(e,{alpha:!0},(e,r)=>{n.length&&(r.fillStyle="rgba(0, 0, 0, 0.25)",r.fillRect(0,0,e.width,e.height)),n.forEach(e=>{!function(e,t,n){switch(e.type){case"highlight":t.shadowColor="rgba(0, 0, 0, 0.7)",t.shadowBlur=50,t.fillStyle=n,t.fillRect(e.x-1,e.y-1,e.w+2,e.h+2),t.clearRect(e.x,e.y,e.w,e.h);break;case"hide":t.fillStyle="rgb(0, 0, 0)",t.fillRect(e.x,e.y,e.w,e.h)}}(e,r,t)})})}function Of({h:e,hooks:t,outputBuffer:n,dialog:r,options:s}){const o=function({hooks:e}){return function({onBeforeScreenshot:t,onScreenshot:n,onAfterScreenshot:r,onError:s}){const o=function(){const[t,n]=e.useState(Xp.devicePixelRatio??1);return e.useEffect(()=>{const e=()=>{n(Xp.devicePixelRatio)},t=matchMedia(`(resolution: ${Xp.devicePixelRatio}dppx)`);return t.addEventListener("change",e),()=>{t.removeEventListener("change",e)}},[]),t}();e.useEffect(()=>{(async()=>{t();const e=await Qp.mediaDevices.getDisplayMedia({video:{width:Xp.innerWidth*o,height:Xp.innerHeight*o},audio:!1,monitorTypeSurfaces:"exclude",preferCurrentTab:!0,selfBrowserSurface:"include",surfaceSwitching:"exclude"}),s=Yp.createElement("video");await new Promise((t,r)=>{s.srcObject=e,s.onloadedmetadata=()=>{n(s,o),e.getTracks().forEach(e=>e.stop()),t()},s.play().catch(r)}),r()})().catch(s)},[])}}({hooks:t}),i=function({h:e}){return function({action:t,setAction:n,options:r}){return e("div",{class:"editor__tool-container"},e("div",{class:"editor__tool-bar"},e("button",{type:"button",class:"editor__tool "+("highlight"===t?"editor__tool--active":""),onClick:()=>{n("highlight"===t?"":"highlight")}},r.highlightToolText),e("button",{type:"button",class:"editor__tool "+("hide"===t?"editor__tool--active":""),onClick:()=>{n("hide"===t?"":"hide")}},r.hideToolText)))}}({h:e}),a=function({h:e}){return function(){return e("svg",{"data-test-id":"icon-close",viewBox:"0 0 16 16",fill:"#2B2233",height:"25px",width:"25px"},e("circle",{r:"7",cx:"8",cy:"8",fill:"white"}),e("path",{strokeWidth:"1.5",d:"M8,16a8,8,0,1,1,8-8A8,8,0,0,1,8,16ZM8,1.53A6.47,6.47,0,1,0,14.47,8,6.47,6.47,0,0,0,8,1.53Z"}),e("path",{strokeWidth:"1.5",d:"M5.34,11.41a.71.71,0,0,1-.53-.22.74.74,0,0,1,0-1.06l5.32-5.32a.75.75,0,0,1,1.06,1.06L5.87,11.19A.74.74,0,0,1,5.34,11.41Z"}),e("path",{strokeWidth:"1.5",d:"M10.66,11.41a.74.74,0,0,1-.53-.22L4.81,5.87A.75.75,0,0,1,5.87,4.81l5.32,5.32a.74.74,0,0,1,0,1.06A.71.71,0,0,1,10.66,11.41Z"}))}}({h:e}),c={__html:If(s.styleNonce).innerText},l=r.el.style,u=({screenshot:r})=>{const[o,l]=t.useState("highlight"),[u,d]=t.useState([]),p=t.useRef(null),h=t.useRef(null),f=t.useRef(null),m=t.useRef(null),[g,y]=t.useState(1),v=t.useMemo(()=>{const e=Yp.getElementById(s.id);if(!e)return"white";const t=getComputedStyle(e);return t.getPropertyValue("--button-primary-background")||t.getPropertyValue("--accent-background")},[s.id]);t.useLayoutEffect(()=>{const e=()=>{const t=p.current;t&&(Cf(r.canvas,{alpha:!1},e=>{const n=Math.min(t.clientWidth/e.width,t.clientHeight/e.height);y(n)}),0!==t.clientHeight&&0!==t.clientWidth||setTimeout(e,0))};return e(),Xp.addEventListener("resize",e),()=>{Xp.removeEventListener("resize",e)}},[r]);const b=t.useCallback((e,t)=>{Cf(e,{alpha:!0},(e,n)=>{n.scale(t,t),e.width=r.canvas.width,e.height=r.canvas.height})},[r]);t.useEffect(()=>{b(h.current,r.dpi),Mf(h.current,r.canvas)},[r]),t.useEffect(()=>{b(f.current,r.dpi),Cf(f.current,{alpha:!0},(e,t)=>{t.clearRect(0,0,e.width,e.height)}),Rf(f.current,v,u)},[u,v]),t.useEffect(()=>{b(n,r.dpi),Mf(n,r.canvas),Cf(Yp.createElement("canvas"),{alpha:!0},(e,t)=>{t.scale(r.dpi,r.dpi),e.width=r.canvas.width,e.height=r.canvas.height,Rf(e,v,u),Mf(n,e)})},[u,r,v]);const _=t.useCallback(e=>t=>{t.preventDefault(),t.stopPropagation(),d(t=>{const n=[...t];return n.splice(e,1),n})},[]),S={width:r.canvas.width*g+"px",height:r.canvas.height*g+"px"},w=e=>{e.stopPropagation()};return e("div",{class:"editor"},e("style",{nonce:s.styleNonce,dangerouslySetInnerHTML:c}),e("div",{class:"editor__image-container"},e("div",{class:"editor__canvas-container",ref:p},e("canvas",{ref:h,id:"background",style:S}),e("canvas",{ref:f,id:"foreground",style:S}),e("div",{ref:m,onMouseDown:e=>{if(!o||!m.current)return;const t=m.current.getBoundingClientRect(),n={type:o,x:e.offsetX/g,y:e.offsetY/g},r=(e,n)=>{const r=(n.clientX-t.x)/g,s=(n.clientY-t.y)/g;return{type:e.type,x:Math.min(e.x,r),y:Math.min(e.y,s),w:Math.abs(r-e.x),h:Math.abs(s-e.y)}},s=e=>{Cf(f.current,{alpha:!0},(e,t)=>{t.clearRect(0,0,e.width,e.height)}),Rf(f.current,v,[...u,r(n,e)])},i=e=>{const t=r(n,e);t.w*g>=1&&t.h*g>=1&&d(e=>[...e,t]),Yp.removeEventListener("mousemove",s),Yp.removeEventListener("mouseup",i)};Yp.addEventListener("mousemove",s),Yp.addEventListener("mouseup",i)},style:S},u.map((t,n)=>e("div",{key:n,class:"editor__rect",style:{top:t.y*g+"px",left:t.x*g+"px",width:t.w*g+"px",height:t.h*g+"px"}},e("button",{"aria-label":s.removeHighlightText,onClick:_(n),onMouseDown:w,onMouseUp:w,type:"button"},e(a,null))))))),e(i,{options:s,action:o,setAction:l}))};return function({onError:r}){const[s,i]=t.useState();return o({onBeforeScreenshot:t.useCallback(()=>{l.display="none"},[]),onScreenshot:t.useCallback((e,t)=>{Cf(Yp.createElement("canvas"),{alpha:!1},(n,r)=>{r.scale(t,t),n.width=e.videoWidth,n.height=e.videoHeight,r.drawImage(e,0,0,n.width,n.height),i({canvas:n,dpi:t})}),n.width=e.videoWidth,n.height=e.videoHeight},[]),onAfterScreenshot:t.useCallback(()=>{l.display="block"},[]),onError:t.useCallback(e=>{l.display="block",r(e)},[])}),s?e(u,{screenshot:s}):e("div",null)}}const Af=()=>({name:"FeedbackScreenshot",setupOnce(){},createInput:({h:e,hooks:t,dialog:n,options:r})=>{const s=Yp.createElement("canvas");return{input:Of({h:e,hooks:t,outputBuffer:s,dialog:n,options:r}),value:async()=>{const e=await new Promise(e=>{s.toBlob(e,"image/png")});if(e)return{data:new Uint8Array(await e.arrayBuffer()),filename:"screenshot.png",contentType:"application/png"}}}}}),Nf={replayIntegration:"replay",replayCanvasIntegration:"replay-canvas",feedbackIntegration:"feedback",feedbackModalIntegration:"feedback-modal",feedbackScreenshotIntegration:"feedback-screenshot",captureConsoleIntegration:"captureconsole",contextLinesIntegration:"contextlines",linkedErrorsIntegration:"linkederrors",dedupeIntegration:"dedupe",extraErrorDataIntegration:"extraerrordata",graphqlClientIntegration:"graphqlclient",httpClientIntegration:"httpclient",reportingObserverIntegration:"reportingobserver",rewriteFramesIntegration:"rewriteframes",browserProfilingIntegration:"browserprofiling",moduleMetadataIntegration:"modulemetadata",instrumentAnthropicAiClient:"instrumentanthropicaiclient",instrumentOpenAiClient:"instrumentopenaiclient",instrumentGoogleGenAIClient:"instrumentgooglegenaiclient",instrumentLangGraph:"instrumentlanggraph",createLangChainCallbackHandler:"createlangchaincallbackhandler"},Df=Ss;async function Lf(e,t){const n=Nf[e],r=Df.Sentry=Df.Sentry||{};if(!n)throw new Error(`Cannot lazy load integration: ${e}`);const s=r[e];if("function"==typeof s&&!("_isShim"in s))return s;const o=function(e){var t;const n=$e(),r=(null==n||null===(t=n.getOptions())||void 0===t?void 0:t.cdnBaseUrl)||"https://browser.sentry-cdn.com";return new URL(`/${a}/${e}.min.js`,r).toString()}(n),i=Ss.document.createElement("script");i.src=o,i.crossOrigin="anonymous",i.referrerPolicy="strict-origin",t&&i.setAttribute("nonce",t);const c=new Promise((e,t)=>{i.addEventListener("load",()=>e()),i.addEventListener("error",t)}),l=Ss.document.currentScript,u=Ss.document.body||Ss.document.head||(null==l?void 0:l.parentElement);if(!u)throw new Error(`Could not find parent element to insert lazy-loaded ${e} script`);u.appendChild(i);try{await c}catch{throw new Error(`Error when loading integration: ${e}`)}const d=r[e];if("function"!=typeof d)throw new Error(`Could not load integration: ${e}`);return d}const Pf=ch({lazyLoadIntegration:Lf}),Ff=ch({getModalIntegration:()=>Ef,getScreenshotIntegration:()=>Af}),jf="MULTIPLEXED_TRANSPORT_EXTRA_KEY";function $f(e,t){let n;return In(e,(e,r)=>(t.includes(r)&&(n=Array.isArray(e)?e[1]:void 0),!!n)),n}function Bf(e,t){return n=>{const r=e(n),s=new Map,o=t||(e=>{var t;const n=e.getEvent();return null!=n&&null!==(t=n.extra)&&void 0!==t&&t[jf]&&Array.isArray(n.extra[jf])?n.extra[jf]:[]});function i(t,r){const o=r?`${t}:${r}`:t;let i=s.get(o);if(!i){const a=lt(t);if(!a)return;const c=mt(a,n.tunnel);i=r?function(e,t){return n=>{const r=e(n);return{...r,send:async e=>{const n=$f(e,["event","transaction","profile","replay_event"]);return n&&(n.release=t),r.send(e)}}}}(e,r)({...n,url:c}):e({...n,url:c}),s.set(o,i)}return[t,i]}return{send:async function(e){const t=o({envelope:e,getEvent:function(t){const n=null!=t&&t.length?t:["event"];return $f(e,n)}}).map(e=>"string"==typeof e?i(e,void 0):i(e.dsn,e.release)).filter(e=>!!e),n=t.length?t:[["",r]];return(await Promise.all(n.map(t=>{let[n,r]=t;return r.send(function(e,t){return Tn(t?{...e[0],dsn:t}:e[0],e[1])}(e,n))})))[0]},flush:async function(e){const t=[...s.values(),r];return(await Promise.all(t.map(t=>t.flush(e)))).every(e=>e)}}}}const Uf=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.levels||A,n=e.handled??!0;return{name:"CaptureConsole",setup(e){"console"in c&&As(r=>{let{args:s,level:o}=r;$e()===e&&t.includes(o)&&function(e,t,n){const r=Ws(t),s=new Error,o={level:Ws(t),extra:{arguments:e}};Fe(i=>{if(i.addEventProcessor(e=>(e.logger="console",pe(e,{handled:n,type:"auto.core.capture_console"}),e)),"assert"===t){if(!e[0]){const t=`Assertion failed: ${se(e.slice(1)," ")||"console.assert"}`;i.setExtra("arguments",e.slice(1)),i.captureMessage(t,r,{captureContext:o,syntheticException:s})}return}const a=e.find(e=>e instanceof Error);if(a)return void ns(a,o);const c=se(e," ");i.captureMessage(c,r,{captureContext:o,syntheticException:s})})}(s,o,n)})}}};function Hf(e,t,n){return"util"in c&&"function"==typeof c.util.format?c.util.format(...e):function(e,t,n){return e.map(e=>b(e)?String(e):JSON.stringify(wn(e,t,n))).join(" ")}(e,t,n)}function zf(e,t){const n={},r=new Array(t.length).fill("{}").join(" ");return n["sentry.message.template"]=`${e} ${r}`,t.forEach((e,t)=>{n[`sentry.message.parameter.${t}`]=e}),n}const qf={[St]:"auto.log.console"},Wf=function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).levels||A;return{name:"ConsoleLogs",setup(t){const{enableLogs:n,normalizeDepth:r=3,normalizeMaxBreadth:s=1e3}=t.getOptions();n?As(n=>{let{args:o,level:i}=n;if($e()!==t||!e.includes(i))return;const a=o[0],c=o.slice(1);if("assert"===i)return void(a||Kn({level:"error",message:c.length>0?`Assertion failed: ${Hf(c,r,s)}`:"Assertion failed",attributes:qf}));const l="log"===i,u=o.length>1&&"string"==typeof o[0]&&(d=o[0],!/%[sdifocO]/.test(d));var d;const p={...qf,...u?zf(a,c):{}};Kn({level:l?"info":i,message:Hf(o,r,s),severityNumber:l?10:void 0,attributes:p})}):i&&j.warn("`enableLogs` is not enabled, ConsoleLogs integration disabled")}}},Vf=["trace","debug","info","warn","error","fatal"];function Jf(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Set(e.levels??Vf),n=e.client;return{log(e){const{type:r,level:s,message:o,args:i,tag:a,date:c,...l}=e,u=n||$e();if(!u)return;const d=function(e,t){if("verbose"===e)return"debug";if("silent"===e)return"trace";if(e){const t=Kf[e];if(t)return t}if("number"==typeof t){const e=Gf[t];if(e)return e}return"info"}(r,s);if(!t.has(d))return;const{normalizeDepth:p=3,normalizeMaxBreadth:h=1e3}=u.getOptions(),f=[];o&&f.push(o),i&&i.length>0&&f.push(Hf(i,p,h));const m=f.join(" ");l["sentry.origin"]="auto.log.consola",a&&(l["consola.tag"]=a),r&&(l["consola.type"]=r),null!=s&&"number"==typeof s&&(l["consola.level"]=s),Kn({level:d,message:m,attributes:l})}}}const Kf={silent:"trace",fatal:"fatal",error:"error",warn:"warn",log:"info",info:"info",success:"info",fail:"error",ready:"info",start:"info",box:"info",debug:"debug",trace:"trace",verbose:"debug",critical:"fatal",notice:"info"},Gf={0:"fatal",1:"warn",2:"info",3:"info",4:"debug",5:"trace"},Xf="gen_ai.prompt",Yf="gen_ai.system",Qf="gen_ai.request.model",Zf="gen_ai.request.stream",em="gen_ai.request.temperature",tm="gen_ai.request.max_tokens",nm="gen_ai.request.frequency_penalty",rm="gen_ai.request.presence_penalty",sm="gen_ai.request.top_p",om="gen_ai.request.top_k",im="gen_ai.request.encoding_format",am="gen_ai.request.dimensions",cm="gen_ai.response.finish_reasons",lm="gen_ai.response.model",um="gen_ai.response.id",dm="gen_ai.response.stop_reason",pm="gen_ai.usage.input_tokens",hm="gen_ai.usage.output_tokens",fm="gen_ai.usage.total_tokens",mm="gen_ai.operation.name",gm="gen_ai.request.messages",ym="gen_ai.response.text",vm="gen_ai.request.available_tools",bm="gen_ai.response.streaming",_m="gen_ai.response.tool_calls",Sm="gen_ai.agent.name",wm="gen_ai.pipeline.name",km="gen_ai.usage.cache_creation_input_tokens",xm="gen_ai.usage.cache_read_input_tokens",Tm="gen_ai.invoke_agent",Em="openai.response.id",Im="openai.response.model",Cm="openai.response.timestamp",Mm="openai.usage.completion_tokens",Rm="openai.usage.prompt_tokens",Om={CHAT:"chat",RESPONSES:"responses",EMBEDDINGS:"embeddings"},Am="anthropic.response.timestamp",Nm="auto.ai.langchain",Dm={human:"user",ai:"assistant",assistant:"assistant",system:"system",function:"function",tool:"tool"},Lm=2e4,Pm=e=>(new TextEncoder).encode(e).length,Fm=e=>Pm(JSON.stringify(e));function jm(e,t){if(Pm(e)<=t)return e;let n=0,r=e.length,s="";for(;n<=r;){const o=Math.floor((n+r)/2),i=e.slice(0,o);Pm(i)<=t?(s=i,n=o+1):r=o-1}return s}function $m(e){return"string"==typeof e?e:e.text}function Bm(e,t){return"string"==typeof e?t:{...e,text:t}}function Um(e){return function(e,t){if(!Array.isArray(e)||0===e.length)return e;if(Fm(e)<=t)return e;const n=e.map(Fm);let r=0,s=e.length;for(let o=e.length-1;o>=0;o--){const e=n[o];if(e&&r+e>t)break;e&&(r+=e),s=o}return s===e.length?function(e,t){return e&&"object"==typeof e?function(e){return null!==e&&"object"==typeof e&&"content"in e&&"string"==typeof e.content}(e)?function(e,t){const n={...e,content:""},r=t-Fm(n);if(r<=0)return[];const s=jm(e.content,r);return[{...e,content:s}]}(e,t):function(e){return null!==e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)&&e.parts.length>0}(e)?function(e,t){const{parts:n}=e,r=n.map(e=>Bm(e,""));let s=t-Fm({...e,parts:r});if(s<=0)return[];const o=[];for(const e of n){const t=$m(e),n=Pm(t);if(!(n<=s)){if(0===o.length){const n=jm(t,s);n&&o.push(Bm(e,n));break}break}o.push(e),s-=n}return o.length>0?[{...e,parts:o}]:[]}(e,t):[]:[]}(e[e.length-1],t):e.slice(s)}(e,Lm)}const Hm=(e,t,n)=>{null!=n&&(e[t]=n)},zm=(e,t,n)=>{const r=Number(n);Number.isNaN(r)||(e[t]=r)};function qm(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch{return String(e)}}function Wm(e){const t=e.toLowerCase();return Dm[t]??t}function Vm(e){return e.includes("System")?"system":e.includes("Human")?"user":e.includes("AI")||e.includes("Assistant")?"assistant":e.includes("Function")?"function":e.includes("Tool")?"tool":"user"}function Jm(e){if(e&&!Array.isArray(e))return e.invocation_params}function Km(e){return e.map(e=>{var t;const n=e._getType;if("function"==typeof n)return{role:Wm(n.call(e)),content:qm(e.content)};const r=null===(t=e.constructor)||void 0===t?void 0:t.name;if(r)return{role:Wm(Vm(r)),content:qm(e.content)};if(e.type)return{role:Wm(String(e.type).toLowerCase()),content:qm(e.content)};if(e.role)return{role:Wm(String(e.role)),content:qm(e.content)};if(1===e.lc&&e.kwargs){var s;const t=e.id,n=Array.isArray(t)&&t.length>0?t[t.length-1]:"";return{role:Wm("string"==typeof n?Vm(n):"user"),content:qm(null===(s=e.kwargs)||void 0===s?void 0:s.content)}}return{role:"user",content:qm(e.content)}})}function Gm(e,t,n){const r={},s="kwargs"in e?e.kwargs:void 0,o=(null==t?void 0:t.temperature)??(null==n?void 0:n.ls_temperature)??(null==s?void 0:s.temperature);zm(r,em,o);const i=(null==t?void 0:t.max_tokens)??(null==n?void 0:n.ls_max_tokens)??(null==s?void 0:s.max_tokens);zm(r,tm,i);const a=(null==t?void 0:t.top_p)??(null==s?void 0:s.top_p);zm(r,sm,a);const c=null==t?void 0:t.frequency_penalty;zm(r,nm,c);const l=null==t?void 0:t.presence_penalty;return zm(r,rm,l),t&&"stream"in t&&Hm(r,Zf,Boolean(t.stream)),r}function Xm(e,t,n,r,s,o){return{[Yf]:qm(e??"langchain"),[mm]:n,[Qf]:qm(t),[St]:Nm,...Gm(r,s,o)}}function Ym(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.recordInputs??!1,n=e.recordOutputs??!1,r=new Map,s=e=>{const t=r.get(e);null!=t&&t.isRecording()&&(t.end(),r.delete(e))},o={lc_serializable:!1,lc_namespace:["langchain_core","callbacks","sentry"],lc_secrets:void 0,lc_attributes:void 0,lc_aliases:void 0,lc_serializable_keys:void 0,lc_id:["langchain_core","callbacks","sentry"],lc_kwargs:{},name:"SentryCallbackHandler",ignoreLLM:!1,ignoreChain:!1,ignoreAgent:!1,ignoreRetriever:!1,ignoreCustomEvent:!1,raiseError:!1,awaitHandlers:!0,handleLLMStart(e,n,s,o,i,a,c,l){const u=Jm(a),d=function(e,t,n,r,s){const o=Xm(null==s?void 0:s.ls_provider,(null==r?void 0:r.model)??(null==s?void 0:s.ls_model_name)??"unknown","pipeline",e,r,s);if(n&&Array.isArray(t)&&t.length>0){const e=t.map(e=>({role:"user",content:e}));Hm(o,gm,qm(e))}return o}(e,n,t,u,c),p=d[Qf];Si({name:`${d[mm]} ${p}`,op:"gen_ai.pipeline",attributes:{...d,[_t]:"gen_ai.pipeline"}},e=>(r.set(s,e),e))},handleChatModelStart(e,n,s,o,i,a,c,l){const u=Jm(a),d=function(e,t,n,r,s){var o;const i=Xm((null==s?void 0:s.ls_provider)??(null===(o=e.id)||void 0===o?void 0:o[2]),(null==r?void 0:r.model)??(null==s?void 0:s.ls_model_name)??"unknown","chat",e,r,s);if(n&&Array.isArray(t)&&t.length>0){const e=Um(Km(t.flat()));Hm(i,gm,qm(e))}return i}(e,n,t,u,c),p=d[Qf];Si({name:`${d[mm]} ${p}`,op:"gen_ai.chat",attributes:{...d,[_t]:"gen_ai.chat"}},e=>(r.set(s,e),e))},handleLLMEnd(e,t,o,i,a){const c=r.get(t);if(null!=c&&c.isRecording()){const r=function(e,t){var n,r,s;if(!e)return;const o={};if(Array.isArray(e.generations)){const n=e.generations.flat().map(e=>{var t,n;return null!==(t=e.generationInfo)&&void 0!==t&&t.finish_reason?e.generationInfo.finish_reason:null!==(n=e.generation_info)&&void 0!==n&&n.finish_reason?e.generation_info.finish_reason:null}).filter(e=>"string"==typeof e);if(n.length>0&&Hm(o,cm,qm(n)),function(e,t){const n=[],r=e.flat();for(const e of r){var s;const t=null===(s=e.message)||void 0===s?void 0:s.content;if(Array.isArray(t))for(const e of t){const t=e;"tool_use"===t.type&&n.push(t)}}n.length>0&&Hm(t,_m,qm(n))}(e.generations,o),t){const t=e.generations.flat().map(e=>{var t;return e.text??(null===(t=e.message)||void 0===t?void 0:t.content)}).filter(e=>"string"==typeof e);t.length>0&&Hm(o,ym,qm(t))}}!function(e,t){if(!e)return;const n=e.tokenUsage,r=e.usage;if(n)zm(t,pm,n.promptTokens),zm(t,hm,n.completionTokens),zm(t,fm,n.totalTokens);else if(r){zm(t,pm,r.input_tokens),zm(t,hm,r.output_tokens);const e=Number(r.input_tokens),n=Number(r.output_tokens),s=(Number.isNaN(e)?0:e)+(Number.isNaN(n)?0:n);s>0&&zm(t,fm,s),void 0!==r.cache_creation_input_tokens&&zm(t,km,r.cache_creation_input_tokens),void 0!==r.cache_read_input_tokens&&zm(t,xm,r.cache_read_input_tokens)}}(e.llmOutput,o);const i=e.llmOutput,a=null===(n=e.generations)||void 0===n||null===(n=n[0])||void 0===n?void 0:n[0],c=null==a?void 0:a.message,l=(null==i?void 0:i.model_name)??(null==i?void 0:i.model)??(null==c||null===(r=c.response_metadata)||void 0===r?void 0:r.model_name);l&&Hm(o,lm,l);const u=(null==i?void 0:i.id)??(null==c?void 0:c.id);u&&Hm(o,um,u);const d=(null==i?void 0:i.stop_reason)??(null==c||null===(s=c.response_metadata)||void 0===s?void 0:s.finish_reason);return d&&Hm(o,dm,qm(d)),o}(e,n);r&&c.setAttributes(r),s(t)}},handleLLMError(e,t){const n=r.get(t);null!=n&&n.isRecording()&&(n.setStatus({code:jt,message:"llm_error"}),s(t)),ns(e,{mechanism:{handled:!1,type:`${Nm}.llm_error_handler`}})},handleChainStart(e,n,s,o){const i=e.name||"unknown_chain",a={[St]:"auto.ai.langchain","langchain.chain.name":i};t&&(a["langchain.chain.inputs"]=JSON.stringify(n)),Si({name:`chain ${i}`,op:"gen_ai.invoke_agent",attributes:{...a,[_t]:"gen_ai.invoke_agent"}},e=>(r.set(s,e),e))},handleChainEnd(e,t){const o=r.get(t);null!=o&&o.isRecording()&&(n&&o.setAttributes({"langchain.chain.outputs":JSON.stringify(e)}),s(t))},handleChainError(e,t){const n=r.get(t);null!=n&&n.isRecording()&&(n.setStatus({code:jt,message:"chain_error"}),s(t)),ns(e,{mechanism:{handled:!1,type:`${Nm}.chain_error_handler`}})},handleToolStart(e,n,s,o){const i=e.name||"unknown_tool",a={[St]:Nm,"gen_ai.tool.name":i};t&&(a["gen_ai.tool.input"]=n),Si({name:`execute_tool ${i}`,op:"gen_ai.execute_tool",attributes:{...a,[_t]:"gen_ai.execute_tool"}},e=>(r.set(s,e),e))},handleToolEnd(e,t){const o=r.get(t);null!=o&&o.isRecording()&&(n&&o.setAttributes({"gen_ai.tool.output":JSON.stringify(e)}),s(t))},handleToolError(e,t){const n=r.get(t);null!=n&&n.isRecording()&&(n.setStatus({code:jt,message:"tool_error"}),s(t)),ns(e,{mechanism:{handled:!1,type:`${Nm}.tool_error_handler`}})},copy:()=>o,toJSON:()=>({lc:1,type:"not_implemented",id:o.lc_id}),toJSONNotImplemented:()=>({lc:1,type:"not_implemented",id:o.lc_id})};return o}const Qm=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{depth:t=3,captureErrorCause:n=!0}=e;return{name:"ExtraErrorData",processEvent(e,r,s){const{maxValueLength:o}=s.getOptions();return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if(!t.originalException||!h(t.originalException))return e;const o=t.originalException.name||t.originalException.constructor.name,i=Zm(t.originalException,r,s);if(i){const t={...e.contexts},r=wn(i,n);return _(r)&&(B(r,"__sentry_skip_normalization__",!0),t[o]=r),{...e,contexts:t}}return e}(e,r,t,n,o)}}};function Zm(e,t,n){try{const r=["name","message","stack","line","column","fileName","lineNumber","columnNumber","toJSON"],s={};for(const t of Object.keys(e)){if(-1!==r.indexOf(t))continue;const o=e[t];s[t]=h(o)||"string"==typeof o?n?ne(`${o}`,n):`${o}`:o}if(t&&void 0!==e.cause)if(h(e.cause)){const t=e.cause.name||e.cause.constructor.name;s.cause={[t]:Zm(e.cause,!1,n)}}else s.cause=e.cause;if("function"==typeof e.toJSON){const t=e.toJSON();for(const e of Object.keys(t)){const n=t[e];s[e]=h(n)?n.toString():n}}return s}catch(e){i&&j.error("Unable to extract extra data from the Error object:",e)}return null}const eg=()=>({name:"FeatureFlags",processEvent:(e,t,n)=>qp(e),addFeatureFlag(e,t){Wp(e,t),Vp(e,t)}});function tg(e){return e.includes("messages")?"messages":e.includes("completions")?"completions":e.includes("models")?"models":e.includes("chat")?"chat":e.split(".").pop()||"unknown"}function ng(e){return`gen_ai.${tg(e)}`}function rg(e,t){return e?`${e}.${t}`:t}function sg(e,t,n,r,s){if(void 0!==t&&e.setAttributes({[pm]:t}),void 0!==n&&e.setAttributes({[hm]:n}),void 0!==t||void 0!==n||void 0!==r||void 0!==s){const o=(t??0)+(n??0)+(r??0)+(s??0);e.setAttributes({[fm]:o})}}function og(e){if("string"==typeof e)return jm(e,Lm);if(Array.isArray(e)){const t=Um(e);return JSON.stringify(t)}return JSON.stringify(e)}function ig(e,t,n,r){if(!e||"object"!=typeof e)return;const s=function(e,t){var n;return"type"in e&&"string"==typeof e.type&&"error"===e.type&&(t.setStatus({code:jt,message:(null===(n=e.error)||void 0===n?void 0:n.type)??"internal_error"}),ns(e.error,{mechanism:{handled:!1,type:"auto.ai.anthropic.anthropic_error"}}),!0)}(e,r);s||(function(e,t){if("message_delta"===e.type&&e.usage&&"output_tokens"in e.usage&&"number"==typeof e.usage.output_tokens&&(t.completionTokens=e.usage.output_tokens),e.message){const n=e.message;n.id&&(t.responseId=n.id),n.model&&(t.responseModel=n.model),n.stop_reason&&t.finishReasons.push(n.stop_reason),n.usage&&("number"==typeof n.usage.input_tokens&&(t.promptTokens=n.usage.input_tokens),"number"==typeof n.usage.cache_creation_input_tokens&&(t.cacheCreationInputTokens=n.usage.cache_creation_input_tokens),"number"==typeof n.usage.cache_read_input_tokens&&(t.cacheReadInputTokens=n.usage.cache_read_input_tokens))}}(e,t),function(e,t){"content_block_start"===e.type&&"number"==typeof e.index&&e.content_block&&("tool_use"!==e.content_block.type&&"server_tool_use"!==e.content_block.type||(t.activeToolBlocks[e.index]={id:e.content_block.id,name:e.content_block.name,inputJsonParts:[]}))}(e,t),function(e,t,n){if("content_block_delta"===e.type&&e.delta){if("number"==typeof e.index&&"partial_json"in e.delta&&"string"==typeof e.delta.partial_json){const n=t.activeToolBlocks[e.index];n&&n.inputJsonParts.push(e.delta.partial_json)}n&&"string"==typeof e.delta.text&&t.responseTexts.push(e.delta.text)}}(e,t,n),function(e,t){if("content_block_stop"!==e.type||"number"!=typeof e.index)return;const n=t.activeToolBlocks[e.index];if(!n)return;const r=n.inputJsonParts.join("");let s;try{s=r?JSON.parse(r):{}}catch{s={__unparsed:r}}t.toolCalls.push({type:"tool_use",id:n.id,name:n.name,input:s}),delete t.activeToolBlocks[e.index]}(e,t))}const ag=["messages.create","messages.stream","messages.countTokens","models.get","completions.create","models.retrieve","beta.messages.create"];function cg(e,t){const n=function(e){const{system:t,messages:n}=e;return[..."string"==typeof t?[{role:"system",content:e.system}]:[],...Array.isArray(n)?n:null!=n?[n]:[]]}(t);if(n.length){const t=og(n);e.setAttributes({[gm]:t})}if("input"in t){const n=og(t.input);e.setAttributes({[gm]:n})}"prompt"in t&&e.setAttributes({[Xf]:JSON.stringify(t.prompt)})}function lg(e,t,n){throw ns(e,{mechanism:{handled:!1,type:"auto.ai.anthropic",data:{function:n}}}),t.isRecording()&&(t.setStatus({code:jt,message:"internal_error"}),t.end()),e}function ug(e,t,n,r,s,o,i,a,c,l,u){return Si({name:`${o} ${s[Qf]??"unknown"} stream-response`,op:ng(i),attributes:s},l&&!u?async t=>{try{return c.recordInputs&&a&&cg(t,a),async function*(e,t,n){const r={responseTexts:[],finishReasons:[],responseId:"",responseModel:"",promptTokens:void 0,completionTokens:void 0,cacheCreationInputTokens:void 0,cacheReadInputTokens:void 0,toolCalls:[],activeToolBlocks:{}};try{for await(const s of e)ig(s,r,n,t),yield s}finally{r.responseId&&t.setAttributes({[um]:r.responseId}),r.responseModel&&t.setAttributes({[lm]:r.responseModel}),sg(t,r.promptTokens,r.completionTokens,r.cacheCreationInputTokens,r.cacheReadInputTokens),t.setAttributes({[bm]:!0}),r.finishReasons.length>0&&t.setAttributes({[cm]:JSON.stringify(r.finishReasons)}),n&&r.responseTexts.length>0&&t.setAttributes({[ym]:r.responseTexts.join("")}),n&&r.toolCalls.length>0&&t.setAttributes({[_m]:JSON.stringify(r.toolCalls)}),t.end()}}(await e.apply(n,r),t,c.recordOutputs??!1)}catch(e){return lg(e,t,i)}}:e=>{try{return c.recordInputs&&a&&cg(e,a),function(e,t,n){const r={responseTexts:[],finishReasons:[],responseId:"",responseModel:"",promptTokens:void 0,completionTokens:void 0,cacheCreationInputTokens:void 0,cacheReadInputTokens:void 0,toolCalls:[],activeToolBlocks:{}};return e.on("streamEvent",e=>{ig(e,r,n,t)}),e.on("message",()=>{!function(e,t,n){t.isRecording()&&(e.responseId&&t.setAttributes({[um]:e.responseId}),e.responseModel&&t.setAttributes({[lm]:e.responseModel}),sg(t,e.promptTokens,e.completionTokens,e.cacheCreationInputTokens,e.cacheReadInputTokens),t.setAttributes({[bm]:!0}),e.finishReasons.length>0&&t.setAttributes({[cm]:JSON.stringify(e.finishReasons)}),n&&e.responseTexts.length>0&&t.setAttributes({[ym]:e.responseTexts.join("")}),n&&e.toolCalls.length>0&&t.setAttributes({[_m]:JSON.stringify(e.toolCalls)}),t.end())}(r,t,n)}),e.on("error",e=>{ns(e,{mechanism:{handled:!1,type:"auto.ai.anthropic.stream_error"}}),t.isRecording()&&(t.setStatus({code:jt,message:"stream_error"}),t.end())}),e}(t.apply(n,r),e,c.recordOutputs??!1)}catch(t){return lg(t,e,i)}})}function dg(e,t,n,r){return new Proxy(e,{apply(s,o,i){const a=function(e,t){const n={[Yf]:"anthropic",[mm]:tg(t),[St]:"auto.ai.anthropic"};if(e.length>0&&"object"==typeof e[0]&&null!==e[0]){const t=e[0];t.tools&&Array.isArray(t.tools)&&(n[vm]=JSON.stringify(t.tools)),n[Qf]=t.model??"unknown","temperature"in t&&(n[em]=t.temperature),"top_p"in t&&(n[sm]=t.top_p),"stream"in t&&(n[Zf]=t.stream),"top_k"in t&&(n[om]=t.top_k),"frequency_penalty"in t&&(n[nm]=t.frequency_penalty),"max_tokens"in t&&(n[tm]=t.max_tokens)}else n[Qf]="models.retrieve"===t||"models.get"===t?e[0]:"unknown";return n}(i,t),c=a[Qf]??"unknown",l=tg(t),u="object"==typeof i[0]?i[0]:void 0,d=Boolean(null==u?void 0:u.stream),p="messages.stream"===t;return d||p?ug(e,s,n,i,a,l,t,u,r,d,p):_i({name:`${l} ${c}`,op:ng(t),attributes:a},e=>(r.recordInputs&&u&&cg(e,u),vi(()=>s.apply(n,i),e=>{ns(e,{mechanism:{handled:!1,type:"auto.ai.anthropic",data:{function:t}}})},()=>{},t=>function(e,t,n){t&&"object"==typeof t&&("type"in t&&"error"===t.type?function(e,t){t.error&&(e.setStatus({code:jt,message:t.error.type||"internal_error"}),ns(t.error,{mechanism:{handled:!1,type:"auto.ai.anthropic.anthropic_error"}}))}(e,t):(n&&function(e,t){if("content"in t&&Array.isArray(t.content)){e.setAttributes({[ym]:t.content.map(e=>e.text).filter(e=>!!e).join("")});const n=[];for(const e of t.content)"tool_use"!==e.type&&"server_tool_use"!==e.type||n.push(e);n.length>0&&e.setAttributes({[_m]:JSON.stringify(n)})}"completion"in t&&e.setAttributes({[ym]:t.completion}),"input_tokens"in t&&e.setAttributes({[ym]:JSON.stringify(t.input_tokens)})}(e,t),function(e,t){"id"in t&&"model"in t&&(e.setAttributes({[um]:t.id,[lm]:t.model}),"created"in t&&"number"==typeof t.created&&e.setAttributes({[Am]:new Date(1e3*t.created).toISOString()}),"created_at"in t&&"number"==typeof t.created_at&&e.setAttributes({[Am]:new Date(1e3*t.created_at).toISOString()}),"usage"in t&&t.usage&&sg(e,t.usage.input_tokens,t.usage.output_tokens,t.usage.cache_creation_input_tokens,t.usage.cache_read_input_tokens))}(e,t)))}(e,t,r.recordOutputs))))}})}function pg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;return new Proxy(e,{get(e,r){const s=e[r],o=rg(t,String(r));return"function"==typeof s&&function(e){return ag.includes(e)}(o)?dg(s,o,e,n):"function"==typeof s?s.bind(e):s&&"object"==typeof s?pg(s,o,n):s}})}function hg(e,t){var n;const r=Boolean(null===(n=$e())||void 0===n?void 0:n.getOptions().sendDefaultPii);return pg(e,"",{recordInputs:r,recordOutputs:r,...t})}const fg=["models.generateContent","models.generateContentStream","chats.create","sendMessage","sendMessageStream"],mg="google_genai",gg="chats.create",yg="chat";function vg(e,t,n,r){e&&!function(e,t){const n=null==e?void 0:e.promptFeedback;if(null!=n&&n.blockReason){const e=n.blockReasonMessage??n.blockReason;return t.setStatus({code:jt,message:`Content blocked: ${e}`}),ns(`Content blocked: ${e}`,{mechanism:{handled:!1,type:"auto.ai.google_genai"}}),!0}return!1}(e,r)&&(function(e,t){"string"==typeof e.responseId&&(t.responseId=e.responseId),"string"==typeof e.modelVersion&&(t.responseModel=e.modelVersion);const n=e.usageMetadata;n&&("number"==typeof n.promptTokenCount&&(t.promptTokens=n.promptTokenCount),"number"==typeof n.candidatesTokenCount&&(t.completionTokens=n.candidatesTokenCount),"number"==typeof n.totalTokenCount&&(t.totalTokens=n.totalTokenCount))}(e,t),function(e,t,n){Array.isArray(e.functionCalls)&&t.toolCalls.push(...e.functionCalls);for(const s of e.candidates??[]){null!=s&&s.finishReason&&!t.finishReasons.includes(s.finishReason)&&t.finishReasons.push(s.finishReason);for(const e of(null==s||null===(r=s.content)||void 0===r?void 0:r.parts)??[]){var r;n&&e.text&&t.responseTexts.push(e.text),e.functionCall&&t.toolCalls.push({type:"function",id:e.functionCall.id,name:e.functionCall.name,arguments:e.functionCall.args})}}}(e,t,n))}function bg(e,t){if("model"in e&&"string"==typeof e.model)return e.model;if(t&&"object"==typeof t){const e=t;if("model"in e&&"string"==typeof e.model)return e.model;if("modelVersion"in e&&"string"==typeof e.modelVersion)return e.modelVersion}return"unknown"}function _g(e,t){if("contents"in t){const n=og(t.contents);e.setAttributes({[gm]:n})}if("message"in t){const n=og(t.message);e.setAttributes({[gm]:n})}if("history"in t){const n=og(t.history);e.setAttributes({[gm]:n})}}function Sg(e,t,n,r){const s=t===gg;return new Proxy(e,{apply(e,o,i){const a=i[0],c=function(e,t,n){const r={[Yf]:mg,[mm]:tg(e),[St]:"auto.ai.google_genai"};if(t){if(r[Qf]=bg(t,n),"config"in t&&"object"==typeof t.config&&t.config){const e=t.config;if(Object.assign(r,function(e){const t={};return"temperature"in e&&"number"==typeof e.temperature&&(t[em]=e.temperature),"topP"in e&&"number"==typeof e.topP&&(t[sm]=e.topP),"topK"in e&&"number"==typeof e.topK&&(t[om]=e.topK),"maxOutputTokens"in e&&"number"==typeof e.maxOutputTokens&&(t[tm]=e.maxOutputTokens),"frequencyPenalty"in e&&"number"==typeof e.frequencyPenalty&&(t[nm]=e.frequencyPenalty),"presencePenalty"in e&&"number"==typeof e.presencePenalty&&(t[rm]=e.presencePenalty),t}(e)),"tools"in e&&Array.isArray(e.tools)){const t=e.tools.flatMap(e=>e.functionDeclarations);r[vm]=JSON.stringify(t)}}}else r[Qf]=bg({},n);return r}(t,a,n),l=c[Qf]??"unknown",u=tg(t);return function(e){return e.includes("Stream")||e.endsWith("generateContentStream")||e.endsWith("sendMessageStream")}(t)?Si({name:`${u} ${l} stream-response`,op:ng(t),attributes:c},async s=>{try{return r.recordInputs&&a&&_g(s,a),async function*(e,t,n){const r={responseTexts:[],finishReasons:[],toolCalls:[]};try{for await(const s of e)vg(s,r,n,t),yield s}finally{const e={[bm]:!0};r.responseId&&(e[um]=r.responseId),r.responseModel&&(e[lm]=r.responseModel),void 0!==r.promptTokens&&(e[pm]=r.promptTokens),void 0!==r.completionTokens&&(e[hm]=r.completionTokens),void 0!==r.totalTokens&&(e[fm]=r.totalTokens),r.finishReasons.length&&(e[cm]=JSON.stringify(r.finishReasons)),n&&r.responseTexts.length&&(e[ym]=r.responseTexts.join("")),n&&r.toolCalls.length&&(e[_m]=JSON.stringify(r.toolCalls)),t.setAttributes(e),t.end()}}(await e.apply(n,i),s,Boolean(r.recordOutputs))}catch(e){throw s.setStatus({code:jt,message:"internal_error"}),ns(e,{mechanism:{handled:!1,type:"auto.ai.google_genai",data:{function:t}}}),s.end(),e}}):_i({name:s?`${u} ${l} create`:`${u} ${l}`,op:ng(t),attributes:c},o=>(r.recordInputs&&a&&_g(o,a),vi(()=>e.apply(n,i),e=>{ns(e,{mechanism:{handled:!1,type:"auto.ai.google_genai",data:{function:t}}})},()=>{},e=>{s||function(e,t,n){if(t&&"object"==typeof t){if(t.usageMetadata&&"object"==typeof t.usageMetadata){const n=t.usageMetadata;"number"==typeof n.promptTokenCount&&e.setAttributes({[pm]:n.promptTokenCount}),"number"==typeof n.candidatesTokenCount&&e.setAttributes({[hm]:n.candidatesTokenCount}),"number"==typeof n.totalTokenCount&&e.setAttributes({[fm]:n.totalTokenCount})}if(n&&Array.isArray(t.candidates)&&t.candidates.length>0){const n=t.candidates.map(e=>{var t;return null!==(t=e.content)&&void 0!==t&&t.parts&&Array.isArray(e.content.parts)?e.content.parts.map(e=>"string"==typeof e.text?e.text:"").filter(e=>e.length>0).join(""):""}).filter(e=>e.length>0);n.length>0&&e.setAttributes({[ym]:n.join("")})}if(n&&t.functionCalls){const n=t.functionCalls;Array.isArray(n)&&n.length>0&&e.setAttributes({[_m]:JSON.stringify(n)})}}}(o,e,r.recordOutputs)})))}})}function wg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;return new Proxy(e,{get:(e,r,s)=>{const o=Reflect.get(e,r,s),i=rg(t,String(r));if("function"==typeof o&&function(e){if(fg.includes(e))return!0;const t=e.split(".").pop();return fg.includes(t)}(i)){if(i===gg){const t=Sg(o,i,e,n);return function(){const e=t(...arguments);return e&&"object"==typeof e?wg(e,yg,n):e}}return Sg(o,i,e,n)}return"function"==typeof o?o.bind(e):o&&"object"==typeof o?wg(o,i,n):o}})}function kg(e,t){var n;const r=Boolean(null===(n=$e())||void 0===n?void 0:n.getOptions().sendDefaultPii);return wg(e,"",{recordInputs:r,recordOutputs:r,...t})}const xg="auto.ai.langgraph";function Tg(e){const t=e;let n=0,r=0,s=0;if(t.usage_metadata&&"object"==typeof t.usage_metadata){const e=t.usage_metadata;return"number"==typeof e.input_tokens&&(n=e.input_tokens),"number"==typeof e.output_tokens&&(r=e.output_tokens),"number"==typeof e.total_tokens&&(s=e.total_tokens),{inputTokens:n,outputTokens:r,totalTokens:s}}if(t.response_metadata&&"object"==typeof t.response_metadata){const e=t.response_metadata;if(e.tokenUsage&&"object"==typeof e.tokenUsage){const t=e.tokenUsage;"number"==typeof t.promptTokens&&(n=t.promptTokens),"number"==typeof t.completionTokens&&(r=t.completionTokens),"number"==typeof t.totalTokens&&(s=t.totalTokens)}}return{inputTokens:n,outputTokens:r,totalTokens:s}}function Eg(e,t){const n=t;if(n.response_metadata&&"object"==typeof n.response_metadata){const t=n.response_metadata;t.model_name&&"string"==typeof t.model_name&&e.setAttribute(lm,t.model_name),t.finish_reason&&"string"==typeof t.finish_reason&&e.setAttribute(cm,[t.finish_reason])}}function Ig(e,t){return new Proxy(e,{apply:(e,n,r)=>_i({op:"gen_ai.create_agent",name:"create_agent",attributes:{[St]:xg,[_t]:"gen_ai.create_agent",[mm]:"create_agent"}},s=>{try{const o=Reflect.apply(e,n,r),i=r.length>0?r[0]:{};null!=i&&i.name&&"string"==typeof i.name&&(s.setAttribute(Sm,i.name),s.updateName(`create_agent ${i.name}`));const a=o.invoke;return a&&"function"==typeof a&&(o.invoke=function(e,t,n,r){return new Proxy(e,{apply:(e,s,o)=>_i({op:"gen_ai.invoke_agent",name:"invoke_agent",attributes:{[St]:xg,[_t]:Tm,[mm]:"invoke_agent"}},async i=>{try{const a=null==n?void 0:n.name;a&&"string"==typeof a&&(i.setAttribute(wm,a),i.setAttribute(Sm,a),i.updateName(`invoke_agent ${a}`));const c=function(e){var t,n;if(null===(t=e.builder)||void 0===t||null===(t=t.nodes)||void 0===t||null===(t=t.tools)||void 0===t||null===(t=t.runnable)||void 0===t||!t.tools)return null;const r=null===(n=e.builder)||void 0===n||null===(n=n.nodes)||void 0===n||null===(n=n.tools)||void 0===n||null===(n=n.runnable)||void 0===n?void 0:n.tools;return r&&Array.isArray(r)&&0!==r.length?r.map(e=>{var t,n,r;return{name:null===(t=e.lc_kwargs)||void 0===t?void 0:t.name,description:null===(n=e.lc_kwargs)||void 0===n?void 0:n.description,schema:null===(r=e.lc_kwargs)||void 0===r?void 0:r.schema}}):null}(t);c&&i.setAttribute(vm,JSON.stringify(c));const l=r.recordInputs,u=r.recordOutputs,d=o.length>0?o[0].messages??[]:[];if(d&&l){const e=Um(Km(d));i.setAttribute(gm,JSON.stringify(e))}const p=await Reflect.apply(e,s,o);return u&&function(e,t,n){const r=null==n?void 0:n.messages;if(!r||!Array.isArray(r))return;const s=(null==t?void 0:t.length)??0,o=r.length>s?r.slice(s):[];if(0===o.length)return;const i=function(e){if(!e||0===e.length)return null;const t=[];for(const n of e)if(n&&"object"==typeof n){const e=n.tool_calls;e&&Array.isArray(e)&&t.push(...e)}return t.length>0?t:null}(o);i&&e.setAttribute(_m,JSON.stringify(i));const a=Km(o);e.setAttribute(ym,JSON.stringify(a));let c=0,l=0,u=0;for(const t of o){const n=Tg(t);c+=n.inputTokens,l+=n.outputTokens,u+=n.totalTokens,Eg(e,t)}c>0&&e.setAttribute(pm,c),l>0&&e.setAttribute(hm,l),u>0&&e.setAttribute(fm,u)}(i,d??null,p),p}catch(e){throw i.setStatus({code:jt,message:"internal_error"}),ns(e,{mechanism:{handled:!1,type:"auto.ai.langgraph.error"}}),e}})})}(a.bind(o),o,i,t)),o}catch(e){throw s.setStatus({code:jt,message:"internal_error"}),ns(e,{mechanism:{handled:!1,type:"auto.ai.langgraph.error"}}),e}})})}function Cg(e,t){const n=t||{};return e.compile=Ig(e.compile.bind(e),n),e}const Mg=["responses.create","chat.completions.create","embeddings.create"],Rg=["response.created","response.in_progress","response.failed","response.completed","response.incomplete","response.queued","response.output_text.delta","response.output_item.added","response.function_call_arguments.delta","response.function_call_arguments.done","response.output_item.done"];function Og(e){return e.includes("chat.completions")?Om.CHAT:e.includes("responses")?Om.RESPONSES:e.includes("embeddings")?Om.EMBEDDINGS:e.split(".").pop()||"unknown"}function Ag(e){return`gen_ai.${Og(e)}`}function Ng(e){return null!==e&&"object"==typeof e&&"type"in e&&"string"==typeof e.type&&e.type.startsWith("response.")}function Dg(e){return null!==e&&"object"==typeof e&&"object"in e&&"chat.completion.chunk"===e.object}function Lg(e,t,n,r){void 0!==t&&e.setAttributes({[Rm]:t,[pm]:t}),void 0!==n&&e.setAttributes({[Mm]:n,[hm]:n}),void 0!==r&&e.setAttributes({[fm]:r})}function Pg(e,t,n,r){e.setAttributes({[Em]:t,[um]:t}),e.setAttributes({[Im]:n,[lm]:n}),e.setAttributes({[Cm]:new Date(1e3*r).toISOString()})}function Fg(e,t){for(const n of e){const e=n.index;if(void 0!==e&&n.function)if(e in t.chatCompletionToolCalls){const r=t.chatCompletionToolCalls[e];n.function.arguments&&null!=r&&r.function&&(r.function.arguments+=n.function.arguments)}else t.chatCompletionToolCalls[e]={...n,function:{name:n.function.name,arguments:n.function.arguments||""}}}}function jg(e,t,n){t.responseId=e.id??t.responseId,t.responseModel=e.model??t.responseModel,t.responseTimestamp=e.created??t.responseTimestamp,e.usage&&(t.promptTokens=e.usage.prompt_tokens,t.completionTokens=e.usage.completion_tokens,t.totalTokens=e.usage.total_tokens);for(const o of e.choices??[]){var r,s;n&&(null!==(r=o.delta)&&void 0!==r&&r.content&&t.responseTexts.push(o.delta.content),null!==(s=o.delta)&&void 0!==s&&s.tool_calls&&Fg(o.delta.tool_calls,t)),o.finish_reason&&t.finishReasons.push(o.finish_reason)}}function $g(e,t,n,r){if(!e||"object"!=typeof e)return void t.eventTypes.push("unknown:non-object");if(e instanceof Error)return r.setStatus({code:jt,message:"internal_error"}),void ns(e,{mechanism:{handled:!1,type:"auto.ai.openai.stream-response"}});if(!("type"in e))return;const s=e;if(Rg.includes(s.type)){if(n&&("response.output_item.done"===s.type&&"item"in s&&t.responsesApiToolCalls.push(s.item),"response.output_text.delta"===s.type&&"delta"in s&&s.delta))t.responseTexts.push(s.delta);else if("response"in s){const{response:e}=s;t.responseId=e.id??t.responseId,t.responseModel=e.model??t.responseModel,t.responseTimestamp=e.created_at??t.responseTimestamp,e.usage&&(t.promptTokens=e.usage.input_tokens,t.completionTokens=e.usage.output_tokens,t.totalTokens=e.usage.total_tokens),e.status&&t.finishReasons.push(e.status),n&&e.output_text&&t.responseTexts.push(e.output_text)}}else t.eventTypes.push(s.type)}function Bg(e,t){if("messages"in t){const n=og(t.messages);e.setAttributes({[gm]:n})}if("input"in t){const n=og(t.input);e.setAttributes({[gm]:n})}}function Ug(e,t,n,r){return async function(){for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];const a=function(e,t){const n={[Yf]:"openai",[mm]:Og(t),[St]:"auto.ai.openai"};if(e.length>0&&"object"==typeof e[0]&&null!==e[0]){const t=e[0],r=[...Array.isArray(t.tools)?t.tools:[],...t.web_search_options&&"object"==typeof t.web_search_options?[{type:"web_search_options",...t.web_search_options}]:[]];r.length>0&&(n[vm]=JSON.stringify(r))}if(e.length>0&&"object"==typeof e[0]&&null!==e[0]){const t=e[0];n[Qf]=t.model??"unknown","temperature"in t&&(n[em]=t.temperature),"top_p"in t&&(n[sm]=t.top_p),"frequency_penalty"in t&&(n[nm]=t.frequency_penalty),"presence_penalty"in t&&(n[rm]=t.presence_penalty),"stream"in t&&(n[Zf]=t.stream),"encoding_format"in t&&(n[im]=t.encoding_format),"dimensions"in t&&(n[am]=t.dimensions)}else n[Qf]="unknown";return n}(o,t),c=a[Qf]||"unknown",l=Og(t),u=o[0];return u&&"object"==typeof u&&!0===u.stream?Si({name:`${l} ${c} stream-response`,op:Ag(t),attributes:a},async s=>{try{return r.recordInputs&&u&&Bg(s,u),async function*(e,t,n){const r={eventTypes:[],responseTexts:[],finishReasons:[],responseId:"",responseModel:"",responseTimestamp:0,promptTokens:void 0,completionTokens:void 0,totalTokens:void 0,chatCompletionToolCalls:{},responsesApiToolCalls:[]};try{for await(const s of e)Dg(s)?jg(s,r,n):Ng(s)&&$g(s,r,n,t),yield s}finally{Pg(t,r.responseId,r.responseModel,r.responseTimestamp),Lg(t,r.promptTokens,r.completionTokens,r.totalTokens),t.setAttributes({[bm]:!0}),r.finishReasons.length&&t.setAttributes({[cm]:JSON.stringify(r.finishReasons)}),n&&r.responseTexts.length&&t.setAttributes({[ym]:r.responseTexts.join("")});const e=[...Object.values(r.chatCompletionToolCalls),...r.responsesApiToolCalls];e.length>0&&t.setAttributes({[_m]:JSON.stringify(e)}),t.end()}}(await e.apply(n,o),s,r.recordOutputs??!1)}catch(e){throw s.setStatus({code:jt,message:"internal_error"}),ns(e,{mechanism:{handled:!1,type:"auto.ai.openai.stream",data:{function:t}}}),s.end(),e}}):_i({name:`${l} ${c}`,op:Ag(t),attributes:a},async s=>{try{r.recordInputs&&u&&Bg(s,u);const t=await e.apply(n,o);return function(e,t,n){if(!t||"object"!=typeof t)return;const r=t;var s;if(function(e){return null!==e&&"object"==typeof e&&"object"in e&&"chat.completion"===e.object}(r)){if(function(e,t,n){if(Pg(e,t.id,t.model,t.created),t.usage&&Lg(e,t.usage.prompt_tokens,t.usage.completion_tokens,t.usage.total_tokens),Array.isArray(t.choices)){const r=t.choices.map(e=>e.finish_reason).filter(e=>null!==e);if(r.length>0&&e.setAttributes({[cm]:JSON.stringify(r)}),n){const n=t.choices.map(e=>{var t;return null===(t=e.message)||void 0===t?void 0:t.tool_calls}).filter(e=>Array.isArray(e)&&e.length>0).flat();n.length>0&&e.setAttributes({[_m]:JSON.stringify(n)})}}}(e,r,n),n&&null!==(s=r.choices)&&void 0!==s&&s.length){const t=r.choices.map(e=>{var t;return(null===(t=e.message)||void 0===t?void 0:t.content)||""});e.setAttributes({[ym]:JSON.stringify(t)})}}else!function(e){return null!==e&&"object"==typeof e&&"object"in e&&"response"===e.object}(r)?function(e){if(null===e||"object"!=typeof e||!("object"in e))return!1;const t=e;return"list"===t.object&&"string"==typeof t.model&&t.model.toLowerCase().includes("embedding")}(r)&&function(e,t){e.setAttributes({[Im]:t.model,[lm]:t.model}),t.usage&&Lg(e,t.usage.prompt_tokens,void 0,t.usage.total_tokens)}(e,r):(function(e,t,n){if(Pg(e,t.id,t.model,t.created_at),t.status&&e.setAttributes({[cm]:JSON.stringify([t.status])}),t.usage&&Lg(e,t.usage.input_tokens,t.usage.output_tokens,t.usage.total_tokens),n){const n=t;if(Array.isArray(n.output)&&n.output.length>0){const t=n.output.filter(e=>"object"==typeof e&&null!==e&&"function_call"===e.type);t.length>0&&e.setAttributes({[_m]:JSON.stringify(t)})}}}(e,r,n),n&&r.output_text&&e.setAttributes({[ym]:r.output_text}))}(s,t,r.recordOutputs),t}catch(e){throw ns(e,{mechanism:{handled:!1,type:"auto.ai.openai",data:{function:t}}}),e}})}}function Hg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;return new Proxy(e,{get(e,r){const s=e[r],o=function(e,t){return e?`${e}.${t}`:t}(t,String(r));return"function"==typeof s&&function(e){return Mg.includes(e)}(o)?Ug(s,o,e,n):"function"==typeof s?s.bind(e):s&&"object"==typeof s?Hg(s,o,n):s}})}function zg(e,t){var n;const r=Boolean(null===(n=$e())||void 0===n?void 0:n.getOptions().sendDefaultPii);return Hg(e,"",{recordInputs:r,recordOutputs:r,...t})}const qg=["reauthenticate","signInAnonymously","signInWithOAuth","signInWithIdToken","signInWithOtp","signInWithPassword","signInWithSSO","signOut","signUp","verifyOtp"],Wg=["createUser","deleteUser","listUsers","getUserById","updateUserById","inviteUserByEmail"],Vg={eq:"eq",neq:"neq",gt:"gt",gte:"gte",lt:"lt",lte:"lte",like:"like","like(all)":"likeAllOf","like(any)":"likeAnyOf",ilike:"ilike","ilike(all)":"ilikeAllOf","ilike(any)":"ilikeAnyOf",is:"is",in:"in",cs:"contains",cd:"containedBy",sr:"rangeGt",nxl:"rangeGte",sl:"rangeLt",nxr:"rangeLte",adj:"rangeAdjacent",ov:"overlaps",fts:"",plfts:"plain",phfts:"phrase",wfts:"websearch",not:"not"},Jg=["select","insert","upsert","update","delete"];function Kg(e){try{e.__SENTRY_INSTRUMENTED__=!0}catch{}}function Gg(e){try{return e.__SENTRY_INSTRUMENTED__}catch{return!1}}function Xg(e,t){if(""===t||"*"===t)return"select(*)";if("select"===e)return`select(${t})`;if("or"===e||e.endsWith(".or"))return`${e}${t}`;const[n,...r]=t.split(".");let s;return s=null!=n&&n.startsWith("fts")?"textSearch":null!=n&&n.startsWith("plfts")?"textSearch[plain]":null!=n&&n.startsWith("phfts")?"textSearch[phrase]":null!=n&&n.startsWith("wfts")?"textSearch[websearch]":n&&Vg[n]||"filter",`${s}(${e}, ${r.join(".")})`}function Yg(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Proxy(e,{apply:(n,r,s)=>_i({name:`auth ${t?"(admin) ":""}${e.name}`,attributes:{[St]:"auto.db.supabase",[_t]:"db","db.system":"postgresql","db.operation":`auth.${t?"admin.":""}${e.name}`}},e=>Reflect.apply(n,r,s).then(t=>(t&&"object"==typeof t&&"error"in t&&t.error?(e.setStatus({code:jt}),ns(t.error,{mechanism:{handled:!1,type:"auto.db.supabase.auth"}})):e.setStatus({code:Ft}),e.end(),t)).catch(t=>{throw e.setStatus({code:jt}),e.end(),ns(t,{mechanism:{handled:!1,type:"auto.db.supabase.auth"}}),t}).then(...s))})}function Qg(e){Gg(e.prototype.then)||(e.prototype.then=new Proxy(e.prototype.then,{apply(e,t,n){var r;const s=Jg,o=t,i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case"GET":return"select";case"POST":var n;return null!==(n=t.Prefer)&&void 0!==n&&n.includes("resolution=")?"upsert":"insert";case"PATCH":return"update";case"DELETE":return"delete";default:return"<unknown-op>"}}(o.method,o.headers);if(!s.includes(i))return Reflect.apply(e,t,n);if(null==o||null===(r=o.url)||void 0===r||!r.pathname||"string"!=typeof o.url.pathname)return Reflect.apply(e,t,n);const a=o.url.pathname.split("/"),c=a.length>0?a[a.length-1]:"",l=[];for(const[e,t]of o.url.searchParams.entries())l.push(Xg(e,t));const u=Object.create(null);if(_(o.body))for(const[e,t]of Object.entries(o.body))u[e]=t;const d=`${"select"===i?"":`${i}${u?"(...) ":""}`}${l.join(" ")} from(${c})`,p={"db.table":c,"db.schema":o.schema,"db.url":o.url.origin,"db.sdk":o.headers["X-Client-Info"],"db.system":"postgresql","db.operation":i,[St]:"auto.db.supabase",[_t]:"db"};return l.length&&(p["db.query"]=l),Object.keys(u).length&&(p["db.body"]=u),_i({name:d,attributes:p},r=>Reflect.apply(e,t,[]).then(e=>{if(r&&(e&&"object"==typeof e&&"status"in e&&Bt(r,e.status||500),r.end()),e.error){const t=new Error(e.error.message);e.error.code&&(t.code=e.error.code),e.error.details&&(t.details=e.error.details);const n={};l.length&&(n.query=l),Object.keys(u).length&&(n.body=u),ns(t,e=>(e.addEventProcessor(e=>(pe(e,{handled:!1,type:"auto.db.supabase.postgres"}),e)),e.setContext("supabase",n),e))}const t={type:"supabase",category:`db.${i}`,message:d},n={};return l.length&&(n.query=l),Object.keys(u).length&&(n.body=u),Object.keys(n).length&&(t.data=n),qs(t),e},e=>{throw r&&(Bt(r,500),r.end()),e}).then(...n))}}),Kg(e.prototype.then))}const Zg=e=>{var t;e?(Gg((t=e.constructor===Function?e:e.constructor).prototype.from)||(t.prototype.from=new Proxy(t.prototype.from,{apply(e,t,n){const r=Reflect.apply(e,t,n);return function(e){for(const t of Jg)Gg(e.prototype[t])||(e.prototype[t]=new Proxy(e.prototype[t],{apply(e,n,r){const s=Reflect.apply(e,n,r),o=s.constructor;return i&&j.log(`Instrumenting ${t} operation's PostgRESTFilterBuilder`),Qg(o),s}}),Kg(e.prototype[t]))}(r.constructor),r}}),Kg(t.prototype.from)),function(e){const t=e.auth;if(t&&!Gg(e.auth)){for(const n of qg){const r=t[n];r&&"function"==typeof e.auth[n]&&(e.auth[n]=Yg(r))}for(const n of Wg){const r=t.admin[n];r&&"function"==typeof e.auth.admin[n]&&(e.auth.admin[n]=Yg(r,!0))}Kg(e.auth)}}(e)):i&&j.warn("Supabase integration was not installed because no Supabase client was provided.")},ey=e=>{return t=e.supabaseClient,{setupOnce(){Zg(t)},name:"Supabase"};var t};function ty(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=new String(String.raw(e,...n));return s.__sentry_template_string__=e.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),s.__sentry_template_values__=n,s}const ny=ty;function ry(e,t,n,r,s){Kn({level:e,message:t,attributes:n,severityNumber:s},r)}function sy(e,t){let{scope:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};ry("trace",e,t,n)}function oy(e,t){let{scope:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};ry("debug",e,t,n)}function iy(e,t){let{scope:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};ry("info",e,t,n)}function ay(e,t){let{scope:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};ry("warn",e,t,n)}function cy(e,t){let{scope:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};ry("error",e,t,n)}function ly(e,t){let{scope:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};ry("fatal",e,t,n)}function uy(e,t,n,r){nr({type:e,name:t,value:n,unit:null==r?void 0:r.unit,attributes:null==r?void 0:r.attributes},{scope:null==r?void 0:r.scope})}function dy(e){uy("counter",e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2?arguments[2]:void 0)}function py(e,t,n){uy("gauge",e,t,n)}function hy(e,t,n){uy("distribution",e,t,n)}const fy=new Map,my=new Set;function gy(e,t){var n;null===(n=t.exception)||void 0===n||null===(n=n.values)||void 0===n||n.forEach(t=>{var n;null===(n=t.stacktrace)||void 0===n||null===(n=n.frames)||void 0===n||n.forEach(t=>{if(!t.filename||t.module_metadata)return;const n=function(e,t){return function(e){if(c._sentryModuleMetadata)for(const t of Object.keys(c._sentryModuleMetadata)){const n=c._sentryModuleMetadata[t];if(my.has(t))continue;my.add(t);const r=e(t);for(const e of r.reverse())if(e.filename){fy.set(e.filename,n);break}}}(e),fy.get(t)}(e,t.filename);n&&(t.module_metadata=n)})})}function yy(e){var t;null===(t=e.exception)||void 0===t||null===(t=t.values)||void 0===t||t.forEach(e=>{var t;null===(t=e.stacktrace)||void 0===t||null===(t=t.frames)||void 0===t||t.forEach(e=>{delete e.module_metadata})})}const vy=()=>({name:"ModuleMetadata",setup(e){e.on("beforeEnvelope",e=>{In(e,(e,t)=>{if("event"===t){const t=Array.isArray(e)?e[1]:void 0;t&&(yy(t),e[1]=t)}})}),e.on("applyFrameMetadata",t=>{t.type||gy(e.getOptions().stackParser,t)})}});const by=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function _y(){let e="",t=!1;for(let n=arguments.length-1;n>=-1&&!t;n--){const r=n>=0?n<0||arguments.length<=n?void 0:arguments[n]:"/";r&&(e=`${r}/${e}`,t="/"===r.charAt(0))}return e=function(e,t){let n=0;for(let t=e.length-1;t>=0;t--){const r=e[t];"."===r?e.splice(t,1):".."===r?(e.splice(t,1),n++):n&&(e.splice(t,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}(e.split("/").filter(e=>!!e),!t).join("/"),(t?"/":"")+e||"."}function Sy(e){let t=0;for(;t<e.length&&""===e[t];t++);let n=e.length-1;for(;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}const wy=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.root,n=e.prefix||"app:///",r="window"in c&&!!c.window,s=e.iteratee||function(e){let{isBrowser:t,root:n,prefix:r}=e;return e=>{if(!e.filename)return e;const s=/^[a-zA-Z]:\\/.test(e.filename)||e.filename.includes("\\")&&!e.filename.includes("/"),o=/^\//.test(e.filename);if(t){if(n){const t=e.filename;0===t.indexOf(n)&&(e.filename=t.replace(n,r))}}else if(s||o){const t=s?e.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):e.filename,o=n?function(e,t){e=_y(e).slice(1),t=_y(t).slice(1);const n=Sy(e.split("/")),r=Sy(t.split("/")),s=Math.min(n.length,r.length);let o=s;for(let e=0;e<s;e++)if(n[e]!==r[e]){o=e;break}let i=[];for(let e=o;e<n.length;e++)i.push("..");return i=i.concat(r.slice(o)),i.join("/")}(n,t):function(e){let t=function(e){const t=e.length>1024?`<truncated>${e.slice(-1024)}`:e,n=by.exec(t);return n?n.slice(1):[]}(e)[2]||"";return t}(t);e.filename=`${r}${o}`}return e}}({isBrowser:r,root:t,prefix:n});return{name:"RewriteFrames",processEvent(e){let t=e;return e.exception&&Array.isArray(e.exception.values)&&(t=function(e){try{return{...e,exception:{...e.exception,values:e.exception.values.map(e=>{return{...e,...e.stacktrace&&{stacktrace:(t=e.stacktrace,{...t,frames:null==t||null===(n=t.frames)||void 0===n?void 0:n.map(e=>s(e))})}};var t,n})}}}catch{return e}}(t)),t}}},ky=e=>({name:"ThirdPartyErrorsFilter",setup(e){e.on("beforeEnvelope",e=>{In(e,(e,t)=>{if("event"===t){const t=Array.isArray(e)?e[1]:void 0;t&&(yy(t),e[1]=t)}})}),e.on("applyFrameMetadata",t=>{t.type||gy(e.getOptions().stackParser,t)})},processEvent(t){const n=function(e){const t=ee(e);if(t)return t.filter(e=>!!e.filename&&null!=(e.lineno??e.colno)).map(e=>e.module_metadata?Object.keys(e.module_metadata).filter(e=>e.startsWith(xy)).map(e=>e.slice(xy.length)):[])}(t);if(n){const r=n["drop-error-if-contains-third-party-frames"===e.behaviour||"apply-tag-if-contains-third-party-frames"===e.behaviour?"some":"every"](t=>!t.some(t=>e.filterKeys.includes(t)));if(r){if("drop-error-if-contains-third-party-frames"===e.behaviour||"drop-error-if-exclusively-contains-third-party-frames"===e.behaviour)return null;t.tags={...t.tags,third_party_code:!0}}}return t}}),xy="_sentryBundlerPluginAppKey:";function Ty(e){return{...e,path:"path"in e&&Array.isArray(e.path)?e.path.join("."):void 0,keys:"keys"in e?JSON.stringify(e.keys):void 0,unionErrors:"unionErrors"in e?JSON.stringify(e.unionErrors):void 0}}function Ey(e){return e.map(e=>"number"==typeof e?"<array>":e).join(".")}function Iy(e){const t=new Set;for(const n of e.issues){const e=Ey(n.path);e.length>0&&t.add(e)}const n=Array.from(t);if(0===n.length){let t="variable";if(e.issues.length>0){const n=e.issues[0];void 0!==n&&"expected"in n&&"string"==typeof n.expected&&(t=n.expected)}return`Failed to validate ${t}`}return`Failed to validate keys: ${ne(n.join(", "),100)}`}const Cy=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.limit??10;return{name:"ZodErrors",processEvent:(n,r)=>function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;if(!(null!==(t=r.exception)&&void 0!==t&&t.values&&s.originalException&&(o=s.originalException,h(o)&&"ZodError"===o.name&&Array.isArray(o.issues))&&0!==s.originalException.issues.length))return r;var o;try{const t=(n?s.originalException.issues:s.originalException.issues.slice(0,e)).map(Ty);return n&&(Array.isArray(s.attachments)||(s.attachments=[]),s.attachments.push({filename:"zod_issues.json",data:JSON.stringify({issues:t})})),{...r,exception:{...r.exception,values:[{...r.exception.values[0],value:Iy(s.originalException)},...r.exception.values.slice(1)]},extra:{...r.extra,"zoderror.issues":t.slice(0,e)}}}catch(e){return{...r,extra:{...r.extra,"zoderrors sentry integration parse error":{message:"an exception was thrown while processing ZodError within applyZodErrorsToEvent()",error:e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:"unknown"}}}}}(t,e.saveZodIssuesAsAttachment,n,r)}},My={startProfiler:function(){const e=$e();e?e.getIntegrationByName("BrowserProfiling")?e.emit("startUIProfiler"):ho&&j.warn("BrowserProfiling integration is not available"):ho&&j.warn("No Sentry client available, profiling is not started")},stopProfiler:function(){const e=$e();e?e.getIntegrationByName("BrowserProfiling")?e.emit("stopUIProfiler"):ho&&j.warn("ProfilingIntegration is not available"):ho&&j.warn("No Sentry client available, profiling is not started")}};function Ry(e,t){let{metadata:n,tunnel:r,dsn:s}=t;const o={event_id:e.event_id,sent_at:(new Date).toISOString(),...(null==n?void 0:n.sdk)&&{sdk:{name:n.sdk.name,version:n.sdk.version}},...!!r&&!!s&&{dsn:ct(s)}},i=function(e){return[{type:"user_report"},e]}(e);return Tn(o,[i])}function Oy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Ss.document,n=(null==t?void 0:t.head)||(null==t?void 0:t.body);if(!n)return void(ho&&j.error("[showReportDialog] Global document not defined"));const r=De(),s=$e(),o=null==s?void 0:s.getDsn();if(!o)return void(ho&&j.error("[showReportDialog] DSN not configured"));const i={...e,user:{...r.getUser(),...e.user},eventId:e.eventId||ds()},a=Ss.document.createElement("script");a.async=!0,a.crossOrigin="anonymous",a.src=function(e,t){const n=pt(e);if(!n)return"";const r=`${ft(n)}embed/error-page/`;let s=`dsn=${ct(n)}`;for(const e in t)if("dsn"!==e&&"onClose"!==e)if("user"===e){const e=t.user;if(!e)continue;e.name&&(s+=`&name=${encodeURIComponent(e.name)}`),e.email&&(s+=`&email=${encodeURIComponent(e.email)}`)}else s+=`&${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`;return`${r}?${s}`}(o,i);const{onLoad:c,onClose:l}=i;if(c&&(a.onload=c),l){const e=t=>{if("__sentry_reportdialog_closed__"===t.data)try{l()}finally{Ss.removeEventListener("message",e)}};Ss.addEventListener("message",e)}n.appendChild(a)}const Ay=c,Ny=new WeakMap,Dy=function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).types||["crash","deprecation","intervention"];function t(e){if(Ny.has($e()))for(const t of e)Fe(e=>{e.setExtra("url",t.url);const n=`ReportingObserver [${t.type}]`;let r="No details available";if(t.body){const n={};for(const e in t.body)n[e]=t.body[e];if(e.setExtra("body",n),"crash"===t.type){const e=t.body;r=[e.crashId||"",e.reason||""].join(" ").trim()||r}else r=t.body.message||r}rs(`${n}: ${r}`)})}return{name:"ReportingObserver",setupOnce(){"ReportingObserver"in Ds&&new Ay.ReportingObserver(t,{buffered:!0,types:e}).observe()},setup(e){Ny.set(e,!0)}}},Ly=function(){const e={failedRequestStatusCodes:[[500,599]],failedRequestTargets:[/.*/],...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}};return{name:"HttpClient",setup(t){!function(e,t){Ps()&&Fs(n=>{if($e()!==e)return;const{response:r,args:s,error:o,virtualError:i}=n,[a,c]=s;r&&function(e,t,n,r,s){if($y(e,n.status,n.url)){const e=function(e,t){return!t&&e instanceof Request||e instanceof Request&&e.bodyUsed?e:new Request(e,t)}(t,r);let o,i,a,c;Uy()&&([o,a]=Py("Cookie",e),[i,c]=Py("Set-Cookie",n)),ss(By({url:e.url,method:e.method,status:n.status,requestHeaders:o,responseHeaders:i,requestCookies:a,responseCookies:c,error:s,type:"fetch"}))}}(t,a,r,c,o||i)},!1)}(t,e),function(e,t){"XMLHttpRequest"in c&&ao(n=>{if($e()!==e)return;const{error:r,virtualError:s}=n,o=n.xhr,i=o[io];if(!i)return;const{method:a,request_headers:c}=i;try{!function(e,t,n,r,s){if($y(e,t.status,t.responseURL)){let e,o,i;if(Uy()){try{const e=t.getResponseHeader("Set-Cookie")||t.getResponseHeader("set-cookie")||void 0;e&&(o=jy(e))}catch{}try{i=function(e){const t=e.getAllResponseHeaders();return t?t.split("\r\n").reduce((e,t)=>{const[n,r]=t.split(": ");return n&&r&&(e[n]=r),e},{}):{}}(t)}catch{}e=r}ss(By({url:t.responseURL,method:n,status:t.status,requestHeaders:e,responseHeaders:i,responseCookies:o,error:s,type:"xhr"}))}}(t,o,a,c,r||s)}catch(e){ho&&j.warn("Error while extracting response event form XHR response",e)}})}(t,e)}}};function Py(e,t){const n=function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(t.headers);let r;try{const t=n[e]||n[e.toLowerCase()]||void 0;t&&(r=jy(t))}catch{}return[n,r]}function Fy(e){if(e){const t=e["Content-Length"]||e["content-length"];if(t)return parseInt(t,10)}}function jy(e){return e.split("; ").reduce((e,t)=>{const[n,r]=t.split("=");return n&&r&&(e[n]=r),e},{})}function $y(e,t,n){return function(e,t){return e.some(e=>"number"==typeof e?e===t:t>=e[0]&&t<=e[1])}(e.failedRequestStatusCodes,t)&&(r=e.failedRequestTargets,s=n,r.some(e=>"string"==typeof e?s.includes(e):e.test(s)))&&!nl(n,$e());var r,s}function By(e){const t=$e(),n=t&&e.error&&e.error instanceof Error?e.error.stack:void 0,r=n&&t?t.getOptions().stackParser(n,0,1):void 0,s=`HTTP Client Error with status code: ${e.status}`,o={message:s,exception:{values:[{type:"Error",value:s,stacktrace:r?{frames:r}:void 0}]},request:{url:e.url,method:e.method,headers:e.requestHeaders,cookies:e.requestCookies},contexts:{response:{status_code:e.status,headers:e.responseHeaders,cookies:e.responseCookies,body_size:Fy(e.responseHeaders)}}};return pe(o,{type:`auto.http.client.${e.type}`,handled:!1}),o}function Uy(){const e=$e();return!!e&&Boolean(e.getOptions().sendDefaultPii)}const Hy=c,zy=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=null!=e.frameContextLines?e.frameContextLines:7;return{name:"ContextLines",processEvent:e=>function(e,t){var n;const r=Hy.document,s=Hy.location&&Qs(Hy.location.href);if(!r||!s)return e;const o=null===(n=e.exception)||void 0===n?void 0:n.values;if(null==o||!o.length)return e;const i=r.documentElement.innerHTML;if(!i)return e;const a=["<!DOCTYPE html>","<html>",...i.split("\n"),"</html>"];return o.forEach(e=>{const n=e.stacktrace;null!=n&&n.frames&&(n.frames=n.frames.map(e=>function(e,t,n,r){return e.filename===n&&e.lineno&&t.length?(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;if(void 0===t.lineno)return;const r=e.length,s=Math.max(Math.min(r-1,t.lineno-1),0);t.pre_context=e.slice(Math.max(0,s-n),s).map(e=>re(e,0));const o=Math.min(r-1,s);t.context_line=re(e[o],t.colno||0),t.post_context=e.slice(Math.min(s+1,r),s+1+n).map(e=>re(e,0))}(t,e,r),e):e}(e,a,s,t)))}),e}(e,t)}};function qy(e){const{query:t,operationName:n}=e,{operationName:r=n,operationType:s}=function(e){const t=e.match(/^(?:\s*)(query|mutation|subscription)(?:\s*)(\w+)(?:\s*)[{(]/);if(t)return{operationType:t[1],operationName:t[2]};const n=e.match(/^(?:\s*)(query|mutation|subscription)(?:\s*)[{(]/);return n?{operationType:n[1],operationName:void 0}:{operationType:void 0,operationName:void 0}}(t);return r?`${s} ${r}`:`${s}`}function Wy(e){let t;if("xhr"in e){const n=e.xhr[io];t=n&&lc(n.body)[0]}else t=lc(uc(e.input))[0];return t}function Vy(e){let t;try{const n=JSON.parse(e);n.query&&(t=n)}finally{return t}}const Jy=e=>({name:"GraphQLClient",setup(t){!function(e,t){e.on("beforeOutgoingRequestSpan",(e,n)=>{const r=sn(e).data||{};if("http.client"!==r[_t])return;const s=r["url.full"]||r["http.url"],o=r["http.request.method"]||r["http.method"];if(!y(s)||!y(o))return;const{endpoints:i}=t,a=ie(s,i),c=Wy(n);if(a&&c){const t=Vy(c);if(t){const n=qy(t);e.updateName(`${o} ${s} (${n})`),e.setAttribute("graphql.document",c)}}})}(t,e),function(e,t){e.on("beforeOutgoingRequestBreadcrumb",(e,n)=>{const{category:r,type:s,data:o}=e;if("http"===s&&("fetch"===r||"xhr"===r)){const e=null==o?void 0:o.url,{endpoints:r}=t,s=ie(e,r),i=Wy(n);if(s&&o&&i){const e=Vy(i);if(!o.graphql&&e){const t=qy(e);o["graphql.document"]=e.query,o["graphql.operation"]=t}}}})}(t,e)}});var Ky=Object.defineProperty,Gy=(e,t,n)=>((e,t,n)=>t in e?Ky(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);function Xy(e,t,n=1/0,r=0){return e?e.nodeType!==e.ELEMENT_NODE||r>n?-1:t(e)?r:Xy(e.parentNode,t,n,r+1):-1}function Yy(e,t){return n=>{const r=n;if(null===r)return!1;try{if(e)if("string"==typeof e){if(r.matches(`.${e}`))return!0}else if(function(e,t){for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}return!1}(r,e))return!0;return!(!t||!r.matches(t))}catch{return!1}}}const Qy="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let Zy={map:{},getId:()=>(console.error(Qy),-1),getNode:()=>(console.error(Qy),null),removeNodeFromMap(){console.error(Qy)},has:()=>(console.error(Qy),!1),reset(){console.error(Qy)}};function ev(e,t,n,r,s=window){const o=s.Object.getOwnPropertyDescriptor(e,t);return s.Object.defineProperty(e,t,r?n:{set(e){iv(()=>{n.set.call(this,e)},0),o&&o.set&&o.set.call(this,e)}}),()=>ev(e,t,o||{},!0)}function tv(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],s=n(r);return"function"==typeof s&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=s,()=>{e[t]=r}}catch{return()=>{}}}function nv(e,t,n,r,s){if(!e)return!1;const o=function(e){if(!e)return null;try{return e.nodeType===e.ELEMENT_NODE?e:e.parentElement}catch(e){return null}}(e);if(!o)return!1;const i=Yy(t,n);if(!s){const e=r&&o.matches(r);return i(o)&&!e}const a=Xy(o,i);let c=-1;return!(a<0)&&(r&&(c=Xy(o,Yy(null,r))),a>-1&&c<0||a<c)}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Zy=new Proxy(Zy,{get:(e,t,n)=>("map"===t&&console.error(Qy),Reflect.get(e,t,n))})),Date.now().toString();const rv={};function sv(e){const t=rv[e];if(t)return t;const n=window.document;let r=window[e];if(n&&"function"==typeof n.createElement)try{const t=n.createElement("iframe");t.hidden=!0,n.head.appendChild(t);const s=t.contentWindow;s&&s[e]&&(r=s[e]),n.head.removeChild(t)}catch(e){}return rv[e]=r.bind(window)}function ov(...e){return sv("requestAnimationFrame")(...e)}function iv(...e){return sv("setTimeout")(...e)}var av=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(av||{});let cv;const lv=e=>cv?(...t)=>{try{return e(...t)}catch(e){if(cv&&!0===cv(e))return()=>{};throw e}}:e;for(var uv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",dv="undefined"==typeof Uint8Array?[]:new Uint8Array(256),pv=0;pv<64;pv++)dv[uv.charCodeAt(pv)]=pv;const hv=new Map,fv=(e,t,n)=>{if(!e||!yv(e,t)&&"object"!=typeof e)return;const r=function(e,t){let n=hv.get(e);return n||(n=new Map,hv.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}(n,e.constructor.name);let s=r.indexOf(e);return-1===s&&(s=r.length,r.push(e)),s};function mv(e,t,n){if(e instanceof Array)return e.map(e=>mv(e,t,n));if(null===e)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer)return{rr_type:e.constructor.name,base64:function(e){var t,n=new Uint8Array(e),r=n.length,s="";for(t=0;t<r;t+=3)s+=uv[n[t]>>2],s+=uv[(3&n[t])<<4|n[t+1]>>4],s+=uv[(15&n[t+1])<<2|n[t+2]>>6],s+=uv[63&n[t+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s}(e)};if(e instanceof DataView)return{rr_type:e.constructor.name,args:[mv(e.buffer,t,n),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement){const t=e.constructor.name,{src:n}=e;return{rr_type:t,src:n}}return e instanceof HTMLCanvasElement?{rr_type:"HTMLImageElement",src:e.toDataURL()}:e instanceof ImageData?{rr_type:e.constructor.name,args:[mv(e.data,t,n),e.width,e.height]}:yv(e,t)||"object"==typeof e?{rr_type:e.constructor.name,index:fv(e,t,n)}:e}const gv=(e,t,n)=>e.map(e=>mv(e,t,n)),yv=(e,t)=>{const n=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(e=>"function"==typeof t[e]);return Boolean(n.find(n=>e instanceof t[n]))};function vv(e,t,n,r,s){const o=[];try{const i=tv(e.HTMLCanvasElement.prototype,"getContext",function(e){return function(o,...i){if(!nv(this,t,n,r,!0)){const e=function(e){return"experimental-webgl"===e?"webgl":e}(o);if("__context"in this||(this.__context=e),s&&["webgl","webgl2"].includes(e))if(i[0]&&"object"==typeof i[0]){const e=i[0];e.preserveDrawingBuffer||(e.preserveDrawingBuffer=!0)}else i.splice(0,1,{preserveDrawingBuffer:!0})}return e.apply(this,[o,...i])}});o.push(i)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{o.forEach(e=>e())}}function bv(e,t,n,r,s,o,i,a){const c=[],l=Object.getOwnPropertyNames(e);for(const i of l)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(i))try{if("function"!=typeof e[i])continue;const l=tv(e,i,function(e){return function(...c){const l=e.apply(this,c);if(fv(l,a,this),"tagName"in this.canvas&&!nv(this.canvas,r,s,o,!0)){const e=gv(c,a,this),r={type:t,property:i,args:e};n(this.canvas,r)}return l}});c.push(l)}catch{const r=ev(e,i,{set(e){n(this.canvas,{type:t,property:i,args:[e],setter:!0})}});c.push(r)}return c}class _v{constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.shadowDoms=new Set,this.windowsSet=new WeakSet,this.windows=[],this.restoreHandlers=[],this.frozen=!1,this.locked=!1,this.snapshotInProgressMap=new Map,this.worker=null,this.lastSnapshotTime=0,this.processMutation=(e,t)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)};const{enableManualSnapshot:t,sampling:n="all",win:r,recordCanvas:s,errorHandler:o}=e;e.sampling=n,this.mutationCb=e.mutationCb,this.mirror=e.mirror,this.options=e,o&&(cv=o),(s&&"number"==typeof n||t)&&(this.worker=this.initFPSWorker()),this.addWindow(r),t||lv(()=>{s&&"all"===n&&(this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher()),s&&"number"==typeof n&&this.initCanvasFPSObserver()})()}reset(){this.pendingCanvasMutations.clear(),this.restoreHandlers.forEach(e=>{try{e()}catch(e){}}),this.restoreHandlers=[],this.windowsSet=new WeakSet,this.windows=[],this.shadowDoms=new Set,this.worker?.terminate(),this.worker=null,this.snapshotInProgressMap=new Map}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}addWindow(e){const{sampling:t="all",blockClass:n,blockSelector:r,unblockSelector:s,recordCanvas:o,enableManualSnapshot:i}=this.options;if(!this.windowsSet.has(e)){if(i)return this.windowsSet.add(e),void this.windows.push(new WeakRef(e));lv(()=>{if(o&&"all"===t&&this.initCanvasMutationObserver(e,n,r,s),o&&"number"==typeof t){const t=vv(e,n,r,s,!0);this.restoreHandlers.push(()=>{t()})}})(),this.windowsSet.add(e),this.windows.push(new WeakRef(e))}}addShadowRoot(e){this.shadowDoms.add(new WeakRef(e))}resetShadowRoots(){this.shadowDoms=new Set}snapshot(e,t){t?.skipRequestAnimationFrame?this.takeSnapshot(performance.now(),!0,e):ov(t=>this.takeSnapshot(t,!0,e))}initFPSWorker(){const e=new Worker(function(){const e=new Blob(['for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t="undefined"==typeof Uint8Array?[]:new Uint8Array(256),a=0;a<64;a++)t[e.charCodeAt(a)]=a;var n=function(t){var a,n=new Uint8Array(t),r=n.length,s="";for(a=0;a<r;a+=3)s+=e[n[a]>>2],s+=e[(3&n[a])<<4|n[a+1]>>4],s+=e[(15&n[a+1])<<2|n[a+2]>>6],s+=e[63&n[a+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s};const r=new Map,s=new Map;const i=self;i.onmessage=async function(e){if(!("OffscreenCanvas"in globalThis))return i.postMessage({id:e.data.id});{const{id:t,bitmap:a,width:o,height:f,maxCanvasSize:c,dataURLOptions:g}=e.data,u=async function(e,t,a){const r=e+"-"+t;if("OffscreenCanvas"in globalThis){if(s.has(r))return s.get(r);const i=new OffscreenCanvas(e,t);i.getContext("2d");const o=await i.convertToBlob(a),f=await o.arrayBuffer(),c=n(f);return s.set(r,c),c}return""}(o,f,g),[h,d]=function(e,t,a){if(!a)return[e,t];const[n,r]=a;if(e<=n&&t<=r)return[e,t];let s=e,i=t;return s>n&&(i=Math.floor(n*t/e),s=n),i>r&&(s=Math.floor(r*e/t),i=r),[s,i]}(o,f,c),l=new OffscreenCanvas(h,d),w=l.getContext("bitmaprenderer"),p=h===o&&d===f?a:await createImageBitmap(a,{resizeWidth:h,resizeHeight:d,resizeQuality:"low"});w?.transferFromImageBitmap(p),a.close();const y=await l.convertToBlob(g),v=y.type,b=await y.arrayBuffer(),m=n(b);if(p.close(),!r.has(t)&&await u===m)return r.set(t,m),i.postMessage({id:t});if(r.get(t)===m)return i.postMessage({id:t});i.postMessage({id:t,type:v,base64:m,width:o,height:f}),r.set(t,m)}};']);return URL.createObjectURL(e)}());return e.onmessage=e=>{const t=e.data,{id:n}=t;if(this.snapshotInProgressMap.set(n,!1),!("base64"in t))return;const{base64:r,type:s,width:o,height:i}=t;this.mutationCb({id:n,type:av["2D"],commands:[{property:"clearRect",args:[0,0,o,i]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:r}],type:s}]},0,0,o,i]}]})},e}initCanvasFPSObserver(){let e;if(!this.windows.length&&!this.shadowDoms.size)return;const t=n=>{this.takeSnapshot(n,!1),e=ov(t)};e=ov(t),this.restoreHandlers.push(()=>{e&&cancelAnimationFrame(e)})}initCanvasMutationObserver(e,t,n,r){const s=vv(e,t,n,r,!1),o=function(e,t,n,r,s){const o=[],i=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const a of i)try{if("function"!=typeof t.CanvasRenderingContext2D.prototype[a])continue;const i=tv(t.CanvasRenderingContext2D.prototype,a,function(o){return function(...i){return nv(this.canvas,n,r,s,!0)||iv(()=>{const n=gv(i,t,this);e(this.canvas,{type:av["2D"],property:a,args:n})},0),o.apply(this,i)}});o.push(i)}catch{const n=ev(t.CanvasRenderingContext2D.prototype,a,{set(t){e(this.canvas,{type:av["2D"],property:a,args:[t],setter:!0})}});o.push(n)}return()=>{o.forEach(e=>e())}}(this.processMutation.bind(this),e,t,n,r),i=function(e,t,n,r,s){const o=[];return o.push(...bv(t.WebGLRenderingContext.prototype,av.WebGL,e,n,r,s,0,t)),void 0!==t.WebGL2RenderingContext&&o.push(...bv(t.WebGL2RenderingContext.prototype,av.WebGL2,e,n,r,s,0,t)),()=>{o.forEach(e=>e())}}(this.processMutation.bind(this),e,t,n,r,this.mirror);this.restoreHandlers.push(()=>{s(),o(),i()})}getCanvasElements(e,t,n){const r=[],s=s=>{s.querySelectorAll("canvas").forEach(s=>{nv(s,e,t,n,!0)||r.push(s)})};for(const e of this.windows){const t=e.deref();let n;try{n=t&&t.document}catch{}n&&s(n)}for(const e of this.shadowDoms){const t=e.deref();t&&s(t)}return r}takeSnapshot(e,t,n){const{sampling:r,blockClass:s,blockSelector:o,unblockSelector:i,dataURLOptions:a,maxCanvasSize:c}=this.options,l=1e3/("all"===r?2:r||2);return!(this.lastSnapshotTime&&e-this.lastSnapshotTime<l)&&(this.lastSnapshotTime=e,(n?[n]:this.getCanvasElements(s,o,i)).forEach(e=>{const n=this.mirror.getId(e);if(this.mirror.hasNode(e)&&e.width&&e.height&&!this.snapshotInProgressMap.get(n)){if(this.snapshotInProgressMap.set(n,!0),!t&&["webgl","webgl2"].includes(e.__context)){const t=e.getContext(e.__context);!1===t?.getContextAttributes()?.preserveDrawingBuffer&&t.clear(t.COLOR_BUFFER_BIT)}createImageBitmap(e).then(t=>{this.worker?.postMessage({id:n,bitmap:t,width:e.width,height:e.height,dataURLOptions:a,maxCanvasSize:c},[t])}).catch(e=>{lv(()=>{throw this.snapshotInProgressMap.delete(n),e})()})}}),!0)}startPendingCanvasMutationFlusher(){ov(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const e=t=>{this.rafStamps.latestId=t,ov(e)};ov(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,t)=>{const n=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,n)}),ov(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,t){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(e);if(!n||-1===t)return;const r=n.map(e=>{const{type:t,...n}=e;return n}),{type:s}=n[0];this.mutationCb({id:t,type:s,commands:r}),this.pendingCanvasMutations.delete(e)}}try{if(2!==Array.from([1],e=>2*e)[0]){const e=document.createElement("iframe");document.body.appendChild(e),Array.from=e.contentWindow?.Array.from||Array.from,document.body.removeChild(e)}}catch(vb){console.debug("Unable to override Array.from",vb)}var Sv;new class{constructor(){Gy(this,"idNodeMap",new Map),Gy(this,"nodeMetaMap",new WeakMap)}getId(e){if(!e)return-1;const t=this.getMeta(e)?.id;return t??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(e=>this.removeNodeFromMap(e))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)}replace(e,t){const n=this.getNode(e);if(n){const e=this.nodeMetaMap.get(n);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}},function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"}(Sv||(Sv={}));const wv={low:{sampling:{canvas:1},dataURLOptions:{type:"image/webp",quality:.25}},medium:{sampling:{canvas:2},dataURLOptions:{type:"image/webp",quality:.4}},high:{sampling:{canvas:4},dataURLOptions:{type:"image/webp",quality:.5}}},kv=1280,xv=(e={})=>{const[t,n]=e.maxCanvasSize||[],r={quality:e.quality||"medium",enableManualSnapshot:e.enableManualSnapshot,maxCanvasSize:[t?Math.min(t,kv):kv,n?Math.min(n,kv):kv]};let s;const o=new Promise(e=>s=e);return{name:"ReplayCanvas",getOptions(){const{quality:e,enableManualSnapshot:t,maxCanvasSize:n}=r;return{enableManualSnapshot:t,recordCanvas:!0,getCanvasManager:e=>{const r=new _v({...e,enableManualSnapshot:t,maxCanvasSize:n,errorHandler:e=>{try{"object"==typeof e&&(e.__rrweb__=!0)}catch{}}});return s(r),r},...wv[e]||wv.medium}},async snapshot(e,t){(await o).snapshot(e,t)}}};function Tv(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e();null==e||e.emit("endPageloadSpan")}function Ev(e){const t=hn();if(t===e)return;const n=De();e.end=new Proxy(e.end,{apply:(e,r,s)=>(Te(n,t),Reflect.apply(e,r,s))}),Te(n,e)}const Iv=100,Cv=5e3,Mv=36e5;function Rv(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function Ov(e){return Rv(e.getAllKeys())}function Av(e){let t;function n(){return null==t&&(t=function(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const r=Rv(n);return e=>r.then(n=>e(n.transaction(t,"readwrite").objectStore(t)))}(e.dbName||"sentry-offline",e.storeName||"queue")),t}return{push:async t=>{try{const r=await Rn(t);await function(e,t,n){return e(e=>Ov(e).then(r=>{if(!(r.length>=n))return e.put(t,Math.max(...r,0)+1),Rv(e.transaction)}))}(n(),r,e.maxQueueSize||30)}catch{}},unshift:async t=>{try{const r=await Rn(t);await function(e,t,n){return e(e=>Ov(e).then(r=>{if(!(r.length>=n))return e.put(t,Math.min(...r,0)-1),Rv(e.transaction)}))}(n(),r,e.maxQueueSize||30)}catch{}},shift:async()=>{try{const e=await function(e){return e(e=>Ov(e).then(t=>{const n=t[0];if(null!=n)return Rv(e.get(n)).then(t=>(e.delete(n),Rv(e.transaction).then(()=>t)))}))}(n());if(e)return function(e){let t="string"==typeof e?Mn(e):e;function n(e){const n=t.subarray(0,e);return t=t.subarray(e+1),n}function r(){let e=t.indexOf(10);return e<0&&(e=t.length),JSON.parse(function(e){const t=u(c);return t.decodePolyfill?t.decodePolyfill(e):(new TextDecoder).decode(e)}(n(e)))}const s=r(),o=[];for(;t.length;){const e=r(),t="number"==typeof e.length?e.length:void 0;o.push([e,t?n(t):r()])}return[s,o]}(e)}catch{}}}}function Nv(){return function(e){return t=>{const n=e({...t,createStore:Av});return Ss.addEventListener("online",async e=>{await n.flush()}),n}}(function(e){function t(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i&&j.log("[Offline]:",...t)}return n=>{const r=e(n);if(!n.createStore)throw new Error("No `createStore` function was provided");const s=n.createStore(n);let o,i=Cv;function a(e){o&&clearTimeout(o),o=setTimeout(async()=>{o=void 0;const e=await s.shift();e&&(t("Attempting to send previously queued event"),e[0].sent_at=(new Date).toISOString(),l(e,!0).catch(e=>{t("Failed to retry sending",e)}))},e),"number"!=typeof o&&o.unref&&o.unref()}function c(){o||(a(i),i=Math.min(2*i,Mv))}async function l(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!o&&Cn(e,["replay_event","replay_recording"]))return await s.push(e),a(Iv),{};try{if(n.shouldSend&&!1===await n.shouldSend(e))throw new Error("Envelope not sent because `shouldSend` callback returned false");const t=await r.send(e);let s=Iv;var l,u;if(t)if(null!==(l=t.headers)&&void 0!==l&&l["retry-after"])s=pr(t.headers["retry-after"]);else if(null!==(u=t.headers)&&void 0!==u&&u["x-sentry-rate-limits"])s=6e4;else if((t.statusCode||0)>=400)return t;return a(s),i=Cv,t}catch(r){if(await function(e,t,r){return!Cn(e,["client_report"])&&(!n.shouldStore||n.shouldStore(e,t,r))}(e,r,i))return o?await s.unshift(e):await s.push(e),c(),t("Error sending. Event queued.",r),{};throw r}}return n.flushAtStartup&&c(),{send:l,flush:e=>(void 0===e&&(i=Cv,a(Iv)),r.flush(e))}}}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ai))}const Dv=function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).sidecarUrl||"http://localhost:8969/stream";return{name:"SpotlightBrowser",setup:()=>{ho&&j.log("Using Sidecar URL",e)},processEvent:e=>function(e){var t;return Boolean("transaction"===e.type&&e.spans&&(null===(t=e.contexts)||void 0===t?void 0:t.trace)&&"ui.action.click"===e.contexts.trace.op&&e.spans.some(e=>{let{description:t}=e;return null==t?void 0:t.includes("#sentry-spotlight")}))}(e)?null:e,afterAllSetup:t=>{!function(e,t){const n=si("fetch");let r=0;e.on("beforeEnvelope",e=>{r>3?j.warn("[Spotlight] Disabled Sentry -> Spotlight integration due to too many failed requests:",r):n(t,{method:"POST",body:Rn(e),headers:{"Content-Type":"application/x-sentry-envelope"},mode:"cors"}).then(e=>{e.status>=200&&e.status<400&&(r=0)},e=>{r++,j.error("Sentry SDK can't connect to Sidecar is it running? See: https://spotlightjs.com/sidecar/npx/",e)})})}(t,e)}}},Lv=()=>({name:"OpenFeature",processEvent:(e,t,n)=>qp(e)});class Pv{after(e,t){Wp(t.flagKey,t.value),Vp(t.flagKey,t.value)}error(e,t,n){Wp(e.flagKey,e.defaultValue),Vp(e.flagKey,e.defaultValue)}}const Fv=e=>{let{featureFlagClientClass:t}=e;return{name:"Unleash",setupOnce(){$(t.prototype,"isEnabled",jv)},processEvent:(e,t,n)=>qp(e)}};function jv(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const s=n[0],o=e.apply(this,n);return"string"==typeof s&&"boolean"==typeof o?(Wp(s,o),Vp(s,o)):ho&&j.error(`[Feature Flags] UnleashClient.isEnabled does not match expected signature. arg0: ${s} (${typeof s}), result: ${o} (${typeof o})`),o}}function $v(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const s=n[0],o=e.apply(this,n);return"string"==typeof s&&"boolean"==typeof o&&(Wp(s,o),Vp(s,o)),o}}const Bv=e=>{let{growthbookClass:t}=e;return(e=>{let{growthbookClass:t}=e;return{name:"GrowthBook",setupOnce(){const e=t.prototype;"function"==typeof e.isOn&&$(e,"isOn",$v),"function"==typeof e.getFeatureValue&&$(e,"getFeatureValue",$v)},processEvent:(e,t,n)=>qp(e)}})({growthbookClass:t})},Uv=e=>{let{featureFlagClient:t}=e;return{name:"Statsig",setup(e){t.on("gate_evaluation",e=>{Wp(e.gate.name,e.gate.value),Vp(e.gate.name,e.gate.value)})},processEvent:(e,t,n)=>qp(e)}};async function Hv(){const e=$e();if(!e)return"no-client-active";if(!e.getDsn())return"no-dsn-configured";try{await Ti(()=>fetch("https://o447951.ingest.sentry.io/api/4509632503087104/envelope/?sentry_version=7&sentry_key=c1dfb07d783ad5325c245c1fd3725390&sentry_client=sentry.javascript.browser%2F1.33.7",{body:"{}",method:"POST",mode:"cors",credentials:"omit"}))}catch{return"sentry-unreachable"}}const zv=e=>{let{worker:t}=e;return{name:"WebWorker",setupOnce:()=>{(Array.isArray(t)?t:[t]).forEach(e=>qv(e))},addWorker:e=>qv(e)}};function qv(e){e.addEventListener("message",e=>{(function(e){if(!_(e)||!0!==e._sentryMessage)return!1;const t="_sentryDebugIds"in e,n="_sentryWorkerError"in e;return!(!t&&!n)&&(!(t&&!_(e._sentryDebugIds)&&void 0!==e._sentryDebugIds)&&!(n&&!_(e._sentryWorkerError)))})(e.data)&&(e.stopImmediatePropagation(),e.data._sentryDebugIds&&(ho&&j.log("Sentry debugId web worker message received",e.data),Ss._sentryDebugIds={...e.data._sentryDebugIds,...Ss._sentryDebugIds}),e.data._sentryWorkerError&&(ho&&j.log("Sentry worker rejection message received",e.data._sentryWorkerError),function(e){const t=$e();if(!t)return;const n=t.getOptions().stackParser,r=t.getOptions().attachStacktrace,s=e.reason,o=b(s)?Mo(s):Zr(n,s,void 0,r,!0);o.level="error",e.filename&&(o.contexts={...o.contexts,worker:{filename:e.filename}}),ss(o,{originalException:s,mechanism:{handled:!1,type:"auto.browser.web_worker.onunhandledrejection"}}),ho&&j.log("Captured worker unhandled rejection",s)}(e.data._sentryWorkerError)))})}function Wv(e){let{self:t}=e;t.postMessage({_sentryMessage:!0,_sentryDebugIds:t._sentryDebugIds??void 0}),t.addEventListener("unhandledrejection",e=>{var n;const r={reason:Co(e),filename:null===(n=t.location)||void 0===n?void 0:n.href};t.postMessage({_sentryMessage:!0,_sentryWorkerError:r}),ho&&j.log("[Sentry Worker] Forwarding unhandled rejection to parent",r)}),ho&&j.log("[Sentry Worker] Registered worker with unhandled rejection handling")}function Vv(){return window.location.hostname.includes("app.napkin.ai")||"true"===new URLSearchParams(window.location.search).get("isProduction")}function Jv(e,t,n){try{const r=n.toLowerCase();if(e.message&&e.message.toLowerCase().includes(r))return!0;if(t&&t.originalException){const e=t.originalException;if(e&&e.message&&e.message.toLowerCase().includes(r))return!0}if(e.exception&&Array.isArray(e.exception.values))for(const t of e.exception.values)if(t.stacktrace&&Array.isArray(t.stacktrace.frames))for(const e of t.stacktrace.frames)if(e.filename&&e.filename.toLowerCase().includes(r)||e.function&&e.function.toLowerCase().includes(r))return!0;if(e.culprit&&e.culprit.toLowerCase().includes(r))return!0}catch(e){console.error("[Sentry] Error in _eventComingFromSrc: ",e)}return!1}window.NapkinSentry={errorHashes:{},init:function(){try{li({dsn:Vv()?"https://02d72dcf91f3ffafdfa130e080a6f809@o4507804332654592.ingest.de.sentry.io/4507825891246160":"https://f7b31574b55e1d3a86ce2e969584fc2b@o4507804332654592.ingest.de.sentry.io/4507804354609232",release:window.gitCommit||"unknown",integrations:[_c(),tl(),Fp({maskAllText:!1,blockAllMedia:!1,networkRequestHeaders:["X-Napkin-Workspace-Id"],networkResponseHeaders:["X-Napkin-Workspace-Id"]}),Kp()],sendDefaultPii:!0,tracesSampleRate:.1,tracePropagationTargets:["localhost",/^https:\/\/napkin\.ai\/api/],replaysSessionSampleRate:0,replaysOnErrorSampleRate:1,profilesSampleRate:1,ignoreErrors:["ResizeObserver loop limit exceeded","ResizeObserver loop completed with undelivered notifications","Non-Error promise rejection captured with value","Error looking up record in object store by key range","WKWebView API client did not respond to this postMessage","Invalid call to runtime.sendMessage(). Tab not found.","Invalid event type from worker: undefined","Unexpected EOF","NS_ERROR_FILE_CORRUPTED","NS_ERROR_NOT_INITIALIZED","NS_ERROR_ABORT","NS_ERROR_FAILURE","NS_ERROR_UNEXPECTED","NS_ERROR_FILE_NOT_DIRECTORY","The operation is insecure.","Failed to execute 'write' on 'Clipboard': Document is not focused.","sendBeacon",/^Method not found$/,"Failed to execute 'insertRule' on 'CSSStyleSheet'","hookGeo",'can\'t redefine non-configurable property "geolocation"',"Invalid or unexpected token","TypeError: Illegal invocation","Unexpected token","Unexpected end of script","Unexpected end of input","Promise.resolve is not a function","Failed to fetch","Load failed","AbortError","NetworkError when attempting to fetch resource.","NS_ERROR_FILE_NOT_FOUND","Unexpected identifier 'https","Connection to Indexed Database server lost. Refresh the page to try again","Database deleted by request of the user","Encountered full disk while opening backing store for indexedDB.open.","Unable to open database file on disk","Internal error opening backing store for indexedDB.open.","Internal error deleting database.","Object store cannot be found in the database","secret is not defined","zaloJSV2","Stylesheet append timeout","LaunchDarklyFlagFetchError","GA is not defined","Invalid content for node type paragraph","Failed to execute 'collapse' on 'Selection'","null is not an object (evaluating 'o.type')","Cannot read properties of null (reading 'type')","Called contentMatchAt on a node with invalid content","Content hole not allowed in a leaf node spec","is larger than the node's length","Cannot read properties of null (reading 'pmViewDesc')","Cannot read properties of undefined (reading '_focused')","__spreadArray",'can\'t redefine non-configurable property "get"',"IFrameMessageHandler","onReady is not defined","onHide is not defined","Cannot read properties of undefined (reading 'checker')","window.webkit.messageHandlers","kCFErrorDomainCFNetwork","Attempting to change value of a readonly property.","Can only call Window.structuredClone on instances of Window","The object does not support the operation or argument.","Error: Error","No error message","TypeError: window.checkLogin is not a function","TypeError: null is not an object (evaluating 'l.formElement')","Origin is only applicable schemes http and https: file://","Object captured as promise rejection with keys:","(type=error) captured as promise rejection","(type=unhandledrejection) captured as promise rejection","AbortController is not a constructor","window.performance.getEntriesByName","jb","_chromeNamespace","contentWindow","Can't find variable: post","Can't find variable: GM_getValue","Can't find variable: unsafeWindow","Can't find variable: gmo","undefined is not an object (evaluating 'a.K')","undefined is not an object (evaluating 'a.J')","null is not an object (evaluating 'e.contentDocument.body')","webVitals.getCLS is not a function","webVitals is not defined","jQuery is not defined","$ is not defined","$ is not a function","customDispatchEvent is not defined","Java bridge method invocation error","Java object is gone","WebViewJavascriptBridge is not defined","Java exception was raised during method invocation","GetHTMLElementsAtPoint","Data cannot be cloned","window[objectName][methodName] is not a function","window[functionName] is not a function","Blocked a frame with origin","WebAssembly","TricentisAlertAlerter","TricentisShadowDomUnlocker","UCShellJava.sdkEventFire","There is no clipping info for given tab","zp_token","repeatInterval_c","shadowDOMUnlocker is not defined","toscaAlertAlerter is not defined","Mx is not defined","_0x563ad2 is not defined","LIDNotifyId is not defined","nativeInitedNotify is not defined","frappe is not defined","ethereum","HTMLOUT is not defined","wsimtgo","yandexReadabilityChecker","_logicalFormForControl","GM_listValues","WeixinJSBridge","getCosmeticsFilters","applyAdblockCode",/^Cannot read properties of null (reading 'document')$/,/^f is undefined$/,"change_ua","Menu caption text is required!","Not allowed to access cross-origin stylesheet","webtranslation_detect","args.site.enabledFeatures is undefined"],beforeSend(e,t){try{if(e.message&&window.NapkinSentry.errorHashes[e.message]>5)return null;window.NapkinSentry.errorHashes[e.message]=window.NapkinSentry.errorHashes[e.message]?window.NapkinSentry.errorHashes[e.message]+1:1}catch(e){console.error("[Sentry] Error in beforeSend: ",e)}return e.message&&e.message.includes("auth/network-request-failed")&&(e.fingerprint=["auth/network-request-failed"]),Jv(e,t,"file://")?(console.warn("[Sentry] Ignoring local file error: ",e.message),null):Jv(e,t,"blob:")?(console.warn("[Sentry] Ignoring blob file error: ",e.message),null):Jv(e,t,"chrome-extension://")?(console.warn("[Sentry] Ignoring chrome extension error: ",e.message),null):Jv(e,t,"moz-extension://")?(console.warn("[Sentry] Ignoring firefox extension error: ",e.message),null):Jv(e,t,"clarity.js")?(console.warn("[Sentry] Ignoring clarity.js error: ",e.message),null):Jv(e,t,"@sentry-internal")||Jv(e,t,"@sentry")?(console.warn("[Sentry] Ignoring sentry-internal error: ",e.message),null):Jv(e,t,"bundle/m.js")?(console.warn("[Sentry] Ignoring monitoring bundle error: ",e.message),null):Jv(e,t,"gtm.js")?(console.warn("[Sentry] Ignoring Google Tag Manager error: ",e.message),null):Jv(e,t,"prosemirror-transform")||Jv(e,t,"prosemirror-view")?(console.warn("[Sentry] Ignoring prosemirror error: ",e.message),null):Jv(e,t,"translate.googleapis.com")||Jv(e,t,"translate_http")||Jv(e,t,"translate.datong.info")||Jv(e,t,"intercomcdn.com")||Jv(e,t,"undefined is not an object (evaluating 'a.J')")||Jv(e,t,"rocket-loader.min.js")||Jv(e,t,"u.c.b.r.o.w.s.e.r")?null:e},beforeBreadcrumb(e,t){try{if("console"===e.category&&"debug"===e.level)return null}catch(e){}return e}}),console.debug("[Sentry] Loaded");try{const e=window.__napkin_sentry_queue||[];if(Array.isArray(e)&&e.length>0){console.debug("[Sentry] Flushing early error queue (exceptions/rejections only):",e.length),e.forEach(e=>{try{if(!e)return;if("exception"===e.type){const t=e.error;t instanceof Error?ns(t):console.debug("[Sentry] Skipping early exception (not an Error instance):",e)}else if("rejection"===e.type){const t=e.reason;t instanceof Error?ns(t):console.debug("[Sentry] Skipping early rejection (not an Error instance):",e)}}catch(e){console.error("[Sentry] Error in flushing early queue: ",e)}});try{window.__napkin_sentry_queue=[]}catch(e){}}}catch(e){console.error("[Sentry] Error flushing early queue: ",e)}}catch(e){console.error("[Sentry] Error in loading Sentry: ",e)}if(window.location.search.includes("debug-session=true"))try{Bp().start(),ls("debug-record","true"),console.debug("[Sentry] Session Replay Started from debug-session=true query parameter");const e=window.location.search.match(/email=([^&]*)/);e&&(us({email:e[1]}),console.debug("[Sentry] User email set for the session replay",e[1]))}catch(e){console.error("[Sentry] Error in starting the session replay: ",e)}},getClient:function(){return o}};function Kv(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gv={},Xv=Uint8Array,Yv=Uint16Array,Qv=Int32Array,Zv=new Xv([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),eb=new Xv([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),tb=new Xv([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),nb=function(e,t){for(var n=new Yv(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var s=new Qv(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)s[o]=o-n[r]<<5|r;return{b:n,r:s}},rb=nb(Zv,2),sb=rb.b,ob=rb.r;sb[28]=258,ob[258]=28;for(var ib=nb(eb,0).r,ab=new Yv(32768),cb=0;cb<32768;++cb){var lb=(43690&cb)>>1|(21845&cb)<<1;lb=(61680&(lb=(52428&lb)>>2|(13107&lb)<<2))>>4|(3855&lb)<<4,ab[cb]=((65280&lb)>>8|(255&lb)<<8)>>1}var ub=function(e,t,n){for(var r=e.length,s=0,o=new Yv(t);s<r;++s)e[s]&&++o[e[s]-1];var i,a=new Yv(t);for(s=1;s<t;++s)a[s]=a[s-1]+o[s-1]<<1;if(n){i=new Yv(1<<t);var c=15-t;for(s=0;s<r;++s)if(e[s])for(var l=s<<4|e[s],u=t-e[s],d=a[e[s]-1]++<<u,p=d|(1<<u)-1;d<=p;++d)i[ab[d]>>c]=l}else for(i=new Yv(r),s=0;s<r;++s)e[s]&&(i[s]=ab[a[e[s]-1]++]>>15-e[s]);return i},db=new Xv(288);for(cb=0;cb<144;++cb)db[cb]=8;for(cb=144;cb<256;++cb)db[cb]=9;for(cb=256;cb<280;++cb)db[cb]=7;for(cb=280;cb<288;++cb)db[cb]=8;var pb=new Xv(32);for(cb=0;cb<32;++cb)pb[cb]=5;var hb=ub(db,9,0),fb=ub(pb,5,0),mb=function(e){return(e+7)/8|0},gb=function(e,t,n){return(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length),new Xv(e.subarray(t,n))},yb=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],vb=function(e,t,n){var r=new Error(t||yb[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,vb),!n)throw r;return r},bb=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},_b=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},Sb=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var s=n.length,o=n.slice();if(!s)return{t:Cb,l:0};if(1==s){var i=new Xv(n[0].s+1);return i[n[0].s]=1,{t:i,l:1}}n.sort(function(e,t){return e.f-t.f}),n.push({s:-1,f:25001});var a=n[0],c=n[1],l=0,u=1,d=2;for(n[0]={s:-1,f:a.f+c.f,l:a,r:c};u!=s-1;)a=n[n[l].f<n[d].f?l++:d++],c=n[l!=u&&n[l].f<n[d].f?l++:d++],n[u++]={s:-1,f:a.f+c.f,l:a,r:c};var p=o[0].s;for(r=1;r<s;++r)o[r].s>p&&(p=o[r].s);var h=new Yv(p+1),f=wb(n[u-1],h,0);if(f>t){r=0;var m=0,g=f-t,y=1<<g;for(o.sort(function(e,t){return h[t.s]-h[e.s]||e.f-t.f});r<s;++r){var v=o[r].s;if(!(h[v]>t))break;m+=y-(1<<f-h[v]),h[v]=t}for(m>>=g;m>0;){var b=o[r].s;h[b]<t?m-=1<<t-h[b]++-1:++r}for(;r>=0&&m;--r){var _=o[r].s;h[_]==t&&(--h[_],++m)}f=t}return{t:new Xv(h),l:f}},wb=function(e,t,n){return-1==e.s?Math.max(wb(e.l,t,n+1),wb(e.r,t,n+1)):t[e.s]=n},kb=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new Yv(++t),r=0,s=e[0],o=1,i=function(e){n[r++]=e},a=1;a<=t;++a)if(e[a]==s&&a!=t)++o;else{if(!s&&o>2){for(;o>138;o-=138)i(32754);o>2&&(i(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(i(s),--o;o>6;o-=6)i(8304);o>2&&(i(o-3<<5|8208),o=0)}for(;o--;)i(s);o=1,s=e[a]}return{c:n.subarray(0,r),n:t}},xb=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},Tb=function(e,t,n){var r=n.length,s=mb(t+2);e[s]=255&r,e[s+1]=r>>8,e[s+2]=255^e[s],e[s+3]=255^e[s+1];for(var o=0;o<r;++o)e[s+o+4]=n[o];return 8*(s+4+r)},Eb=function(e,t,n,r,s,o,i,a,c,l,u){bb(t,u++,n),++s[256];for(var d=Sb(s,15),p=d.t,h=d.l,f=Sb(o,15),m=f.t,g=f.l,y=kb(p),v=y.c,b=y.n,_=kb(m),S=_.c,w=_.n,k=new Yv(19),x=0;x<v.length;++x)++k[31&v[x]];for(x=0;x<S.length;++x)++k[31&S[x]];for(var T=Sb(k,7),E=T.t,I=T.l,C=19;C>4&&!E[tb[C-1]];--C);var M,R,O,A,N=l+5<<3,D=xb(s,db)+xb(o,pb)+i,L=xb(s,p)+xb(o,m)+i+14+3*C+xb(k,E)+2*k[16]+3*k[17]+7*k[18];if(c>=0&&N<=D&&N<=L)return Tb(t,u,e.subarray(c,c+l));if(bb(t,u,1+(L<D)),u+=2,L<D){M=ub(p,h,0),R=p,O=ub(m,g,0),A=m;var P=ub(E,I,0);for(bb(t,u,b-257),bb(t,u+5,w-1),bb(t,u+10,C-4),u+=14,x=0;x<C;++x)bb(t,u+3*x,E[tb[x]]);u+=3*C;for(var F=[v,S],j=0;j<2;++j){var $=F[j];for(x=0;x<$.length;++x){var B=31&$[x];bb(t,u,P[B]),u+=E[B],B>15&&(bb(t,u,$[x]>>5&127),u+=$[x]>>12)}}}else M=hb,R=db,O=fb,A=pb;for(x=0;x<a;++x){var U=r[x];if(U>255){_b(t,u,M[257+(B=U>>18&31)]),u+=R[B+257],B>7&&(bb(t,u,U>>23&31),u+=Zv[B]);var H=31&U;_b(t,u,O[H]),u+=A[H],H>3&&(_b(t,u,U>>5&8191),u+=eb[H])}else _b(t,u,M[U]),u+=R[U]}return _b(t,u,M[256]),u+R[256]},Ib=new Qv([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Cb=new Xv(0),Mb=function(e,t,n,r,s,o){var i=o.z||e.length,a=new Xv(r+i+5*(1+Math.ceil(i/7e3))+s),c=a.subarray(r,a.length-s),l=o.l,u=7&(o.r||0);if(t){u&&(c[0]=o.r>>3);for(var d=Ib[t-1],p=d>>13,h=8191&d,f=(1<<n)-1,m=o.p||new Yv(32768),g=o.h||new Yv(f+1),y=Math.ceil(n/3),v=2*y,b=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<v)&f},_=new Qv(25e3),S=new Yv(288),w=new Yv(32),k=0,x=0,T=o.i||0,E=0,I=o.w||0,C=0;T+2<i;++T){var M=b(T),R=32767&T,O=g[M];if(m[R]=O,g[M]=R,I<=T){var A=i-T;if((k>7e3||E>24576)&&(A>423||!l)){u=Eb(e,c,0,_,S,w,x,E,C,T-C,u),E=k=x=0,C=T;for(var N=0;N<286;++N)S[N]=0;for(N=0;N<30;++N)w[N]=0}var D=2,L=0,P=h,F=R-O&32767;if(A>2&&M==b(T-F))for(var j=Math.min(p,A)-1,$=Math.min(32767,T),B=Math.min(258,A);F<=$&&--P&&R!=O;){if(e[T+D]==e[T+D-F]){for(var U=0;U<B&&e[T+U]==e[T+U-F];++U);if(U>D){if(D=U,L=F,U>j)break;var H=Math.min(F,U-2),z=0;for(N=0;N<H;++N){var q=T-F+N&32767,W=q-m[q]&32767;W>z&&(z=W,O=q)}}}F+=(R=O)-(O=m[R])&32767}if(L){_[E++]=268435456|ob[D]<<18|ib[L];var V=31&ob[D],J=31&ib[L];x+=Zv[V]+eb[J],++S[257+V],++w[J],I=T+D,++k}else _[E++]=e[T],++S[e[T]]}}for(T=Math.max(T,I);T<i;++T)_[E++]=e[T],++S[e[T]];u=Eb(e,c,l,_,S,w,x,E,C,T-C,u),l||(o.r=7&u|c[u/8|0]<<3,u-=7,o.h=g,o.p=m,o.i=T,o.w=I)}else{for(T=o.w||0;T<i+l;T+=65535){var K=T+65535;K>=i&&(c[u/8|0]=l,K=i),u=Tb(c,u+1,e.subarray(T,K))}o.i=i}return gb(a,0,r+mb(u)+s)},Rb=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,r=9;--r;)n=(1&n&&-306674912)^n>>>1;e[t]=n}return e}(),Ob=function(){var e=-1;return{p:function(t){for(var n=e,r=0;r<t.length;++r)n=Rb[255&n^t[r]]^n>>>8;e=n},d:function(){return~e}}},Ab=function(e,t,n,r,s){if(!s&&(s={l:1},t.dictionary)){var o=t.dictionary.subarray(-32768),i=new Xv(o.length+e.length);i.set(o),i.set(e,o.length),e=i,s.w=o.length}return Mb(e,null==t.level?6:t.level,null==t.mem?s.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,n,r,s)},Nb=function(e,t,n){for(var r=e(),s=e.toString(),o=s.slice(s.indexOf("[")+1,s.lastIndexOf("]")).replace(/\s+/g,"").split(","),i=0;i<r.length;++i){var a=r[i],c=o[i];if("function"==typeof a){t+=";"+c+"=";var l=a.toString();if(a.prototype)if(-1!=l.indexOf("[native code]")){var u=l.indexOf(" ",8)+1;t+=l.slice(u,l.indexOf("(",u))}else for(var d in t+=l,a.prototype)t+=";"+c+".prototype."+d+"="+a.prototype[d].toString();else t+=l}else n[c]=a}return t},Db=[],Lb=function(){return[Xv,Yv,Qv,Zv,eb,tb,ob,ib,hb,db,fb,pb,ab,Ib,Cb,ub,bb,_b,Sb,wb,kb,xb,Tb,Eb,mb,gb,Mb,Ab,Ub,Fb]},Pb=function(){return[$b,Bb,jb,Ob,Rb]},Fb=function(e){return postMessage(e,[e.buffer])},jb=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},$b=function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&jb(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var r=0;r<=n.length;++r)e[r+10]=n.charCodeAt(r)}},Bb=function(e){return 10+(e.filename?e.filename.length+1:0)};function Ub(e,t){return Ab(e,t||{},0,0)}function Hb(e,t,n){return n||(n=t,t={}),"function"!=typeof n&&vb(7),function(e,t,n,r,s,o){var i=function(e,t,n,r){if(!Db[n]){for(var s="",o={},i=e.length-1,a=0;a<i;++a)s=Nb(e[a],s,o);Db[n]={c:Nb(e[i],s,o),e:o}}var c=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n}({},Db[n].e);return function(e,t,n,r,s){var o=new Worker(Gv[t]||(Gv[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return o.onmessage=function(e){var t=e.data,n=t.$e$;if(n){var r=new Error(n[0]);r.code=n[1],r.stack=n[2],s(r,null)}else s(null,t)},o.postMessage(n,r),o}(Db[n].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,c,function(e){var t=[];for(var n in e)e[n].buffer&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t}(c),r)}(n,function(e){return Fb(zb(e.data[0],e.data[1]))},2,function(e,t){i.terminate(),o(e,t)});return i.postMessage([e,t],t.consume?[e.buffer]:[]),function(){i.terminate()}}(e,t,[Lb,Pb,function(){return[zb]}],0,0,n)}function zb(e,t){t||(t={});var n=Ob(),r=e.length;n.p(e);var s=Ab(e,t,Bb(t),8),o=s.length;return $b(s,t),jb(s,o-8,n.d()),jb(s,o-4,r),s}var qb="undefined"!=typeof TextDecoder&&new TextDecoder;try{qb.decode(Cb,{stream:!0})}catch(e){}class Wb{constructor(){this.lastTs=0,this.lastSuffix=1,this.backDict={},this.getKey=e=>{let t=!1;const n=`__${e}`;if(!this.backDict[n]){t=!0;const e=Date.now()%10**11;let r=e;r===this.lastTs?(r=1e4*r+this.lastSuffix,this.lastSuffix+=1):this.lastSuffix=1,this.backDict[n]=r,this.lastTs=e}return[this.backDict[n],t]}}}class Vb{constructor(e){this.sendSetAttribute=(e,t,n)=>{if(this.isDictDisabled){const r=[12,e,t,n];return this.app.send(r)}{const r=[35,e,this.applyDict(t),this.applyDict(n)];return this.app.send(r)}},this.app=e.app,this.isDictDisabled=e.isDictDisabled,this.dict=new Wb}applyDict(e){const[t,n]=this.dict.getKey(e);return n&&this.app.send([34,t,e]),t}clear(){this.dict=new Wb}}class Jb{constructor(e,t){this.app=e,this.startParams=t,this.conditions=[],this.hasStarted=!1,this.createConditionFromFilter=e=>{const t=Gb(e);if(t.type)return t},this.durationInt=null}setConditions(e){this.conditions=e}async fetchConditions(e,t){try{const n=await fetch(`${this.app.options.ingestPoint}/v1/web/conditions/${e}`,{method:"GET",headers:{Authorization:`Bearer ${t}`}}),{conditions:r}=await n.json(),s=[];r.forEach(e=>{e.filters.forEach(t=>{let n;"fetch"===t.type?(n={type:"network_request",subConditions:[],name:e.name},t.filters.forEach(e=>{const t=this.createConditionFromFilter(e);t&&n.subConditions.push(t)})):n=this.createConditionFromFilter(t),n&&("session_duration"===n.type&&this.processDuration(n.value[0],e.name),s.push({...n,name:e.name}))})}),this.conditions=s}catch(e){this.app.debug.error("Critical: cannot fetch start conditions")}}trigger(e){if(!this.hasStarted)try{this.hasStarted=!0,this.app.start(this.startParams,void 0,e)}catch(e){this.app.debug.error(e)}}processMessage(e){if(!this.hasStarted)switch(e[0]){case 78:this.jsExceptionEvent(e);break;case 27:this.customEvent(e);break;case 68:this.clickEvent(e);break;case 122:this.pageLocationEvent(e);break;case 83:this.networkRequest(e)}}processFlags(e){const t=this.conditions.filter(e=>"feature_flag"===e.type);t.length&&t.forEach(t=>{const n=Kb[t.operator];n&&e.find(e=>n(e.key,t.value))&&this.trigger(t.name)})}processDuration(e,t){this.durationInt=setInterval(()=>{performance.now()>e&&this.trigger(t)},1e3),this.app.attachStopCallback(()=>{this.durationInt&&clearInterval(this.durationInt)})}networkRequest(e){const t=this.conditions.filter(e=>"network_request"===e.type);t.length&&t.forEach(t=>{const n=t.subConditions.filter(e=>"isAny"!==e.operator);n.length?n.every(t=>{let n;switch(t.key){case"url":n=e[3];break;case"status":n=e[6];break;case"method":n=e[2];break;case"duration":n=e[8]}const r=Kb[t.operator];if(r&&r(n,t.value))return!0})&&this.trigger(t.name):0===n.length&&t.subConditions.length&&this.trigger(t.name)})}customEvent(e){const t=this.conditions.filter(e=>"custom_event"===e.type);t.length&&t.forEach(t=>{const n=Kb[t.operator];n&&(n(e[1],t.value)||n(e[2],t.value))&&this.trigger(t.name)})}clickEvent(e){const t=this.conditions.filter(e=>"click"===e.type);t.length&&t.forEach(t=>{const n=Kb[t.operator];n&&(n(e[3],t.value)||n(e[4],t.value))&&this.trigger(t.name)})}pageLocationEvent(e){const t=this.conditions.filter(e=>"visited_url"===e.type);t&&t.forEach(t=>{const n=Kb[t.operator];n&&n(e[1],t.value)&&this.trigger(t.name)})}jsExceptionEvent(e){const t=[e[1],e[2],e[3]],n=this.conditions.filter(e=>"exception"===e.type);n&&n.forEach(e=>{const n=Kb[e.operator];n&&t.some(t=>n(t,e.value))&&this.trigger(e.name)})}}const Kb={is:(e,t)=>t.some(t=>e.includes(t)),isAny:()=>!0,isNot:(e,t)=>!t.some(t=>e.includes(t)),contains:(e,t)=>t.some(t=>e.includes(t)),notContains:(e,t)=>!t.some(t=>e.includes(t)),startsWith:(e,t)=>t.some(t=>e.startsWith(t)),endsWith:(e,t)=>t.some(t=>e.endsWith(t)),greaterThan:(e,t)=>e>t,greaterOrEqual:(e,t)=>e>=t,lessOrEqual:(e,t)=>e<=t,lessThan:(e,t)=>e<t},Gb=e=>{const t={on:"is",notOn:"isNot",">":"greaterThan","<":"lessThan","=":"is","<=":"lessOrEqual",">=":"greaterOrEqual"},n=e=>{if(Object.keys(t).includes(e))return t[e]};let r={type:"",operator:"",value:e.value,key:""};switch(e.type){case"click":r={type:"click",operator:n(e.operator),value:e.value,key:""};break;case"location":r={type:"visited_url",operator:e.operator,value:e.value,key:""};break;case"custom":r={type:"custom_event",operator:e.operator,value:e.value,key:""};break;case"metadata":r={type:"featureFlag"===e.source?"feature_flag":e.type,operator:e.operator,value:e.value,key:""};break;case"error":r={type:"exception",operator:e.operator,value:e.value,key:""};break;case"duration":r={type:"session_duration",value:e.value,key:"",operator:"is"};break;case"fetchUrl":r={type:"network_request",key:"url",operator:e.operator,value:e.value};break;case"fetchStatusCode":r={type:"network_request",key:"status",operator:n(e.operator),value:e.value};break;case"fetchMethod":r={type:"network_request",key:"method",operator:n(e.operator),value:e.value};break;case"fetchDuration":r={type:"network_request",key:"duration",operator:n(e.operator),value:e.value}}return r};class Xb{constructor(e){this.app=e,this.flags=[],this.storageKey="__openreplay_flags";const t=this.app.sessionStorage.getItem(this.storageKey);if(t){const e=t.split(";").filter(Boolean);this.flags=e.map(e=>JSON.parse(e))}}getFeatureFlag(e){return this.flags.find(t=>t.key===e)}isFlagEnabled(e){return-1!==this.flags.findIndex(t=>t.key===e)}onFlagsLoad(e){this.onFlagsCb=e}async reloadFlags(e){const t=this.app.sessionStorage.getItem(this.storageKey),n={};t&&t.split(";").filter(Boolean).forEach(e=>{const t=JSON.parse(e);n[t.key]={key:t.key,value:t.value}});const r=this.app.session.getInfo(),s=this.app.session.userInfo,o={projectID:r.projectID,userID:r.userID,metadata:r.metadata,referrer:document.referrer,os:s.userOS,device:s.userDevice,country:s.userCountry,state:s.userState,city:s.userCity,browser:s.userBrowser,persistFlags:n},i=e??this.app.session.getSessionToken(),a=await fetch(this.app.options.ingestPoint+"/v1/web/feature-flags",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(o)});if(200===a.status){const e=await a.json();return this.handleFlags(e.flags)}}handleFlags(e){var t;const n=[];e.forEach(e=>{e.is_persist&&n.push(e)});let r="";return this.diffPersist(n).forEach(e=>{r+=`${JSON.stringify(e)};`}),this.app.sessionStorage.setItem(this.storageKey,r),this.flags=e,null===(t=this.onFlagsCb)||void 0===t?void 0:t.call(this,e)}clearPersistFlags(){this.app.sessionStorage.removeItem(this.storageKey)}diffPersist(e){const t=this.app.sessionStorage.getItem(this.storageKey);if(!t)return e;const n=t.split(";").filter(Boolean).map(e=>JSON.parse(e));return e.filter(e=>-1===n.findIndex(t=>t.key===e.key))}}const Yb={htmlmasked:"hidden",masked:"obscured"},Qb=!("undefined"==typeof window),Zb=Qb&&navigator.userAgent.match(/firefox|fxios/i);let e_=Qb?Date.now()-performance.now():0;function t_(){e_=Date.now()-performance.now()}function n_(){return e_}const r_=Qb&&performance.now?()=>Math.round(performance.now()+e_):()=>Date.now(),s_="repeat"in String.prototype?e=>"*".repeat(e.length):e=>e.replace(/./g,"*");function o_(e){return e.trim().replace(/\s+/g," ")}function i_(e){return e.startsWith("https://")||e.startsWith("http://")}const a_="https://docs.openreplay.com",c_={};function l_(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/";c_[e]||(console.warn(`OpenReplay: ${e} is deprecated. ${t?`Please, use ${t} instead.`:""} Visit ${a_}${n} for more information.`),c_[e]=!0)}function u_(e){let t=e.getAttribute("data-openreplay-label");return null!==t||(t=e.getAttribute("data-asayer-label"),null!==t&&l_('"data-asayer-label" attribute','"data-openreplay-label" attribute',"/")),t}function d_(e,t){const n=`data-openreplay-${t}`;return!!e.hasAttribute(n)&&(Yb[t]&&l_(`"${n}" attribute`,`"${Yb[t]}" attribute`,"/en/sdk/sanitize-data"),!0)}function p_(e){try{return e instanceof HTMLIFrameElement?e.contentDocument:e instanceof Window?e.document:e instanceof Document?e.defaultView:"nodeType"in e?e.nodeType:"addEventListener"in e&&e.addEventListener,!0}catch(e){if(e instanceof DOMException&&"SecurityError"===e.name)return!1}return!0}function h_(e){return e.toString(16).padStart(2,"0")}function f_(){try{return window.self&&window.top&&window.self!==window.top}catch(e){return!0}}function m_(e){return window.Zone&&"__symbol__"in window.Zone?window.Zone.__symbol__(e):e}function g_(e,t){if(t)return new MutationObserver(e);{const t=m_("MutationObserver");return new window[t](e)}}function y_(e,t,n,r,s){if(!p_(e))return;let o="addEventListener";s||(o=m_("addEventListener"));try{e[o]?e[o](t,n,r):e.addEventListener(t,n,r)}catch(n){const r=n.message;console.error(`Openreplay: ${r}; if this error is caused by an IframeObserver, ignore it`,t,e)}}function v_(e,t,n,r,s){if(!p_(e))return;let o="removeEventListener";s||(o=m_("removeEventListener"));try{e[o]?e[o](t,n,r):e.removeEventListener(t,n,r)}catch(n){const r=n.message;console.error(`Openreplay: ${r}; if this error is caused by an IframeObserver, ignore it`,t,e)}}const b_=new class{constructor(){this.taskQueue=[],this.isRunning=!1}addTask(e){this.taskQueue.push(e),this.runTasks()}runTasks(){if(this.isRunning||0===this.taskQueue.length)return;this.isRunning=!0;const e=()=>{if(0===this.taskQueue.length)return void(this.isRunning=!1);const t=this.taskQueue.shift();Promise.resolve(t()).then(()=>{requestAnimationFrame(()=>e())})};e()}};function __(e){b_.addTask(e)}function S_(e,t){const n={...e};for(const r in t)if(t.hasOwnProperty(r)){const s=t[r],o=e[r];"object"!=typeof s||Array.isArray(s)||null===s?n[r]=s:n[r]=S_(o||{},s)}return n}function w_(e){return[0,e]}function k_(e,t,n,r,s){return[8,e,t,n,r,s]}function x_(e,t,n){return[9,e,t,n]}function T_(e,t){return[13,e,t]}function E_(e,t){return[30,e,t]}function I_(e,t,n,r){return[57,e,t,n,r]}function C_(e){return[58,e]}function M_(e,t,n,r){return[60,e,t,n,r]}function R_(e,t,n){return[61,e,t,n]}function O_(e,t){return[70,e,t]}function A_(e,t,n){return[71,e,t,n]}function N_(e,t,n,r){return[73,e,t,n,r]}function D_(e,t){return[75,e,t]}function L_(e,t){return[76,e,t]}function P_(e,t){return[77,e,t]}function F_(e,t,n,r){return[78,e,t,n,r]}function j_(e,t,n,r,s,o,i,a,c){return[83,e,t,n,r,s,o,i,a,c]}function $_(e,t,n){return[113,e,t,n]}function B_(e){return[115,e]}function U_(e,t,n,r,s,o,i,a,c,l){return[116,e,t,n,r,s,o,i,a,c,l]}function H_(e){return[117,e]}function z_(e){return[118,e]}const q_=Qb&&"performance"in window&&"memory"in performance?performance:{memory:{}},W_=Qb?1024*(navigator.deviceMemory||0):0,V_=q_.memory.jsHeapSizeLimit||0,J_="__or__watched_tags__";class K_{constructor(e){this.intervals={},this.tags=[],this.sessionStorage=e.sessionStorage,this.errLog=e.errLog,this.onTag=e.onTag;const t=JSON.parse(e.sessionStorage.getItem(J_)??"[]");this.setTags(t),this.observer=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting&&e.target){const t=e.target.__or_watcher_tagname;t&&this.onTagRendered(t),this.observer.unobserve(e.target)}})})}async fetchTags(e,t){return fetch(`${e}/v1/web/tags`,{method:"GET",headers:{Authorization:`Bearer ${t}`}}).then(e=>e.json()).then(e=>{let{tags:t}=e;if(t&&t.length){this.setTags(t);const e=JSON.stringify(t);this.sessionStorage.setItem(J_,e||"")}}).catch(e=>this.errLog(e))}setTags(e){this.tags=e,this.intervals={},e.forEach(e=>{this.intervals[e.id]=setInterval(()=>{const t=document.querySelectorAll(e.selector);if(t.length>0){const n=t[0];n.__or_watcher_tagname=e.id,this.observer.observe(n)}},500)})}onTagRendered(e){this.intervals[e]&&clearInterval(this.intervals[e]),this.onTag(e)}clear(){this.tags.forEach(e=>{clearInterval(this.intervals[e.id])}),this.tags=[],this.intervals={},this.observer.disconnect()}}const G_={position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.40)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'},X_={display:"flex",flexDirection:"column",gap:"2rem",alignItems:"center",padding:"1.5rem",borderRadius:"2px",border:"1px solid rgb(255 255 255 / var(--tw-bg-opacity, 1))",background:"#FFF",width:"22rem"},Y_={display:"flex","flex-direction":"column",gap:"unset","align-items":"center",padding:"unset",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',"border-radius":"2px",border:"1px solid rgb(255 255 255 / var(--tw-bg-opacity, 1))",background:"rgba(255, 255, 255, 0.75)",width:"22rem"},Q_={fontFamily:"Verdana, sans-serif",fontSize:"1.25rem",fontStyle:"normal",fontWeight:"500",lineHeight:"1.75rem",color:"rgba(0, 0, 0, 0.85)"},Z_={borderTop:"1px solid rgba(0, 0, 0, 0.06)",borderBottom:"1px solid rgba(0, 0, 0, 0.06)",padding:"1.25rem 0rem",color:"rgba(0, 0, 0, 0.85)",fontFamily:"Verdana, sans-serif",fontSize:"13px",fontStyle:"normal",fontWeight:"400",lineHeight:"auto",whiteSpace:"pre-wrap"},eS={display:"flex",padding:"0.4rem 0.9375rem",justifyContent:"center",alignItems:"center",gap:"0.625rem",borderRadius:"0.25rem",border:"1px solid #394EFF",background:"#394EFF",boxShadow:"0px 2px 0px 0px rgba(0, 0, 0, 0.04)",color:"#FFF",textAlign:"center",fontFamily:"Verdana, sans-serif",fontSize:"1rem",fontStyle:"normal",fontWeight:"500",lineHeight:"1.5rem",cursor:"pointer"},tS={fontFamily:"Verdana, sans-serif",fontSize:"13px",fontWeight:"500",lineHeight:"auto",display:"flex",justifyContent:"space-between",width:"100%",cursor:"pointer"},nS={display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.625rem",fontSize:"13px",lineHeight:"auto"},rS={padding:"0.5rem",gap:"0.5rem",fontFamily:"Verdana, sans-serif",fontSize:"16px",fontStyle:"normal",fontWeight:"500",lineHeight:"auto",color:"white",display:"flex",alignItems:"center",width:"100%",borderRadius:"2px",background:"rgba(0, 0, 0, 0.75)",boxSizing:"border-box"},sS={boxSizing:"border-box",display:"block",width:"100%",borderBottom:"1px solid rgb(255 255 255 / var(--tw-bg-opacity, 1))",background:"#FFF",padding:"0.65rem",alignSelf:"stretch",color:"#000",fontFamily:"Verdana, sans-serif",fontStyle:"normal",fontWeight:"400"},oS={...sS,display:"flex",flexDirection:"column",alignItems:"center",gap:"0.625rem"},iS={fontSize:"1.25rem",fontWeight:"500",cursor:"pointer",color:"#394EFF"},aS={display:"flex",padding:"0.4rem 0.9375rem",justifyContent:"center",alignItems:"center",gap:"0.625rem",borderRadius:"0.25rem",border:"1px solid #394EFF",background:"#394EFF",boxShadow:"0px 2px 0px 0px rgba(0, 0, 0, 0.04)",color:"#FFF",textAlign:"center",fontFamily:"Verdana, sans-serif",fontSize:"1rem",fontStyle:"normal",fontWeight:"500",lineHeight:"1.5rem",width:"100%",boxSizing:"border-box",cursor:"pointer"},cS={marginTop:"1rem",marginBottom:"1rem",cursor:"pointer",display:"block",fontWeight:"500",fontSize:"13px!important",lineHeight:"auto"},lS={display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",padding:"0.5rem",width:"100%",boxSizing:"border-box"},uS={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:"6.25em",outline:"1px solid #394EFF",fontSize:"13px",height:"24px",width:"24px"},dS={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:"6.25em",outline:"1px solid #D2DFFF",boxShadow:"0px 2px 0px 0px rgba(0, 0, 0, 0.04)",background:"#D2DFFF",fontSize:"13px",height:"24px",width:"24px"},pS={borderRadius:"0.375rem",border:"1px solid rgba(0, 0, 0, 0.06)",background:"#F5F7FF",boxShadow:"0px 2px 0px 0px rgba(0, 0, 0, 0.04)",display:"flex",flexDirection:"column",padding:"0.625rem 0.9375rem",gap:"0.5rem",alignSelf:"stretch"},hS={fontWeight:"bold"},fS={fontSize:"13px",lineHeight:"auto"},mS={marginRight:"0.5rem",cursor:"pointer",color:"#394EFF",textAlign:"center",fontFamily:"Verdana, sans-serif",fontSize:"13px",fontStyle:"normal",fontWeight:"500",lineHeight:"auto"},gS={...mS,display:"flex",padding:"0.25rem 0.9375rem",justifyContent:"center",alignItems:"center",gap:"0.5rem",borderRadius:"0.25rem",border:"1px solid #394EFF"},yS={display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",boxSizing:"border-box"},vS={border:"4px solid rgba(255, 255, 255, 0.4)",width:"16px",height:"16px",borderRadius:"50%",borderLeftColor:"#fff",animation:"spin 0.5s linear infinite"},bS={width:1280,height:720};class _S{constructor(e){this.app=e,this.mediaRecorder=null,this.recordedChunks=[],this.stream=null,this.recStartTs=null}async startRecording(e,t,n,r){this.recStartTs=this.app.timestamp();const s=t;try{this.stream=await navigator.mediaDevices.getUserMedia({video:!!r&&{...s,frameRate:{ideal:e}},audio:n}),this.mediaRecorder=new MediaRecorder(this.stream,{mimeType:"video/webm;codecs=vp9"}),this.recordedChunks=[],this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&this.recordedChunks.push(e.data)},this.mediaRecorder.start()}catch(e){console.error(e)}}async stopRecording(){return new Promise(e=>{this.mediaRecorder&&(this.mediaRecorder.onstop=()=>{const t=new Blob(this.recordedChunks,{type:"video/webm"});e(t)},this.mediaRecorder.stop())})}async sendToAPI(){const e=await this.stopRecording();return fetch(`${this.app.options.ingestPoint}/v1/web/uxt/upload-url`,{headers:{Authorization:`Bearer ${this.app.session.getSessionToken()}`}}).then(e=>{if(e.ok)return e.json();throw new Error("Failed to get upload url")}).then(t=>{let{url:n}=t;return fetch(n,{method:"PUT",headers:{"Content-Type":"video/webm"},body:e})}).catch(console.error).finally(()=>{this.discard()})}async saveToFile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"recorded-video.webm";const t=await this.stopRecording(),n=URL.createObjectURL(t),r=document.createElement("a");r.style.display="none",r.href=n,r.download=e,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(n),document.body.removeChild(r)}discard(){var e,t;null===(e=this.mediaRecorder)||void 0===e||e.stop(),null===(t=this.stream)||void 0===t||t.getTracks().forEach(e=>e.stop())}}function SS(e,t,n,r,s){const o=document.createElement(e);return o.className=t,Object.assign(o.style,n),r&&(o.textContent=r),s&&(o.id=s),o}const wS="or_uxt_test_start",kS="or_uxt_task_index",xS="or_uxt_session_id";class TS{constructor(e,t,n,r,s,o,i,a,c){this.ingestPoint=e,this.getTimestamp=t,this.token=n,this.testId=r,this.storageKey=s,this.setStorageKey=o,this.removeStorageKey=i,this.getStorageKey=a,this.getSessionId=c,this.durations={testStart:0,tasks:[]},this.getDurations=()=>this.durations,this.setDurations=e=>{this.durations.testStart=e.testStart,this.durations.tasks=e.tasks},this.signalTask=(e,t,n)=>{if(!e)return console.error("User Testing: No Task ID Given");const r=this.durations.tasks.find(t=>t.taskId===e),s=this.getTimestamp(),o=r?s-r.started:0;return fetch(`${this.ingestPoint}/v1/web/uxt/signals/task`,{method:"POST",headers:{Authorization:`Bearer ${this.token}`},body:JSON.stringify({testId:this.testId,taskId:e,status:t,duration:o,timestamp:s,taskAnswer:n})})},this.signalTest=e=>{const t=this.getTimestamp();if("begin"===e&&this.testId){const e=this.getSessionId();this.setStorageKey(xS,e),this.setStorageKey(this.storageKey,this.testId.toString()),this.setStorageKey(wS,t.toString())}else this.removeStorageKey(this.storageKey),this.removeStorageKey(kS),this.removeStorageKey(wS);const n=t-(this.durations.testStart||t);return fetch(`${this.ingestPoint}/v1/web/uxt/signals/test`,{method:"POST",headers:{Authorization:`Bearer ${this.token}`},body:JSON.stringify({testId:this.testId,status:e,duration:n,timestamp:t})})};const l=this.getStorageKey(wS);l&&(this.durations.testStart=parseInt(l,10))}}class ES{constructor(e,t){this.app=e,this.storageKey=t,this.bg=SS("div","bg",G_,void 0,"__or_ut_bg"),this.container=SS("div","container",X_,void 0,"__or_ut_ct"),this.widgetGuidelinesVisible=!0,this.widgetTasksVisible=!1,this.widgetVisible=!0,this.isActive=!1,this.descriptionSection=null,this.taskSection=null,this.endSection=null,this.stopButton=null,this.stopButtonContainer=null,this.test=null,this.testId=null,this.signalManager=null,this.getTest=(e,t,n)=>{this.testId=e;const r=this.app.options.ingestPoint;return fetch(`${r}/v1/web/uxt/test/${e}`,{headers:{Authorization:`Bearer ${t}`}}).then(e=>e.json()).then(r=>{let{test:s}=r;this.isActive=!0,this.test=s,this.signalManager=new TS(this.app.options.ingestPoint,()=>this.app.timestamp(),t,e,this.storageKey,(e,t)=>this.app.localStorage.setItem(e,t),e=>this.app.localStorage.removeItem(e),e=>this.app.localStorage.getItem(e),()=>this.app.getSessionID()),this.createGreeting(s.title,s.reqMic,s.reqCamera),n&&((s.reqMic||s.reqCamera)&&this.userRecorder.startRecording(30,bS,s.reqMic,s.reqCamera),this.showWidget(s.description,s.tasks,!0),this.showTaskSection())}).then(()=>e).catch(e=>{console.log("OR: Error fetching test",e)})},this.hideTaskSection=()=>!1,this.showTaskSection=()=>!0,this.collapseWidget=()=>!1,this.removeGreeting=()=>!1,this.toggleDescriptionVisibility=()=>{},this.currentTaskIndex=0,this.userRecorder=new _S(e),this.app.getSessionID()!==this.app.localStorage.getItem(xS)&&(this.app.localStorage.removeItem(this.storageKey),this.app.localStorage.removeItem(xS),this.app.localStorage.removeItem("or_uxt_test_id"),this.app.localStorage.removeItem(kS),this.app.localStorage.removeItem(wS));const n=this.app.localStorage.getItem(kS);n&&(this.currentTaskIndex=parseInt(n,10))}getTestId(){return this.testId}createGreeting(e,t,n){const r=SS("div","title",Q_,e),s=SS("div","description",Z_,"Welcome, you're here to help us improve, not to be judged. Your insights matter!\n\nð¹ We're recording this browser tab to learn from your experience.\nð¤ Please enable mic and camera if asked, to give us a complete picture."),o=SS("div","button",eS,"Read guidelines to begin");this.removeGreeting=()=>((t||n)&&this.userRecorder.startRecording(30,bS,t,n),this.container.removeChild(o),this.container.removeChild(s),this.container.removeChild(r),!1),o.onclick=()=>{var e,t,n,r;this.removeGreeting();const s=null===(e=this.signalManager)||void 0===e?void 0:e.getDurations();s&&this.signalManager&&(s.testStart=this.app.timestamp(),this.signalManager.setDurations(s)),null===(t=this.signalManager)||void 0===t||t.signalTest("begin"),this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',Object.assign(this.container.style,Y_),this.showWidget((null===(n=this.test)||void 0===n?void 0:n.guidelines)||"",(null===(r=this.test)||void 0===r?void 0:r.tasks)||[])},this.container.append(r,s,o),this.bg.appendChild(this.container),document.body.appendChild(this.bg)}showWidget(e,t,n){this.container.innerHTML="",Object.assign(this.bg.style,{position:"fixed",zIndex:99999999999999,right:"8px",left:"unset",width:"fit-content",top:"8px",height:"fit-content",background:"unset",display:"unset",alignItems:"unset",justifyContent:"unset"});const r=this.createTitleSection();this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',Object.assign(this.container.style,Y_);const s=this.createDescriptionSection(e),o=this.createTasksSection(t),i=SS("div","stop_bn_or",cS,"Abort Session"),a=SS("div","stop_ct_or",{fontSize:"13px!important"});a.style.fontSize="13px",a.append(i),this.container.append(r,s,o,a),this.taskSection=o,this.descriptionSection=s,this.stopButton=i,this.stopButtonContainer=a,i.onclick=()=>{var e;this.userRecorder.discard(),null===(e=this.signalManager)||void 0===e||e.signalTest("skipped"),document.body.removeChild(this.bg),window.close()},n?this.toggleDescriptionVisibility():this.hideTaskSection()}createTitleSection(){var e;const t=SS("div","title",rS),n=function(){const e=document.createElement("div");e.className="grid";for(let t=0;t<16;t++){const t=document.createElement("div");Object.assign(t.style,{width:"2px",height:"2px",borderRadius:"10px",background:"white"}),t.className="cell",e.appendChild(t)}return Object.assign(e.style,{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"repeat(4, 1fr)",gap:"2px",cursor:"grab"}),e}(),r=SS("div","title_text",{maxWidth:"19rem",overflow:"hidden",textOverflow:"ellipsis",width:"100%",fontSize:16,lineHeight:"auto",cursor:"pointer"},null===(e=this.test)||void 0===e?void 0:e.title),s=function(){const e=document.createElement("div");Object.assign(e.style,{width:"0",height:"0",borderLeft:"7px solid transparent",borderRight:"7px solid transparent",borderBottom:"7px solid white"});const t=document.createElement("div");return t.appendChild(e),Object.assign(t.style,{display:"flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",cursor:"pointer",marginLeft:"auto",transform:"rotate(180deg)"}),t}();t.append(n,r,s);const o=e=>(this.widgetVisible=e,this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',Object.assign(this.container.style,this.widgetVisible?Y_:{border:"none",background:"none",padding:0}),this.taskSection&&Object.assign(this.taskSection.style,this.widgetVisible?sS:{display:"none"}),this.descriptionSection&&Object.assign(this.descriptionSection.style,this.widgetVisible?sS:{display:"none"}),this.endSection&&Object.assign(this.endSection.style,this.widgetVisible?sS:{display:"none"}),this.stopButton&&Object.assign(this.stopButton.style,this.widgetVisible?cS:{display:"none"}),e),i=()=>{Object.assign(s.style,{transform:this.widgetVisible?"rotate(0deg)":"rotate(180deg)"}),o(!this.widgetVisible)};var a,c;return r.onclick=i,s.onclick=i,a=this.bg,(c=n).onmousedown=function(e){const t=a.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top;function s(e,s){let o=e-n,i=s-r;o<=5&&(o=5),i<=5&&(i=5),o>=window.innerWidth-t.width&&(o=window.innerWidth-t.width),i>=window.innerHeight-t.height&&(i=window.innerHeight-t.height),a.style.left=`${o}px`,a.style.top=`${i}px`}function o(e){s(e.pageX,e.pageY)}a.style.position="fixed",a.style.zIndex=99999999999999,s(e.pageX,e.pageY),document.addEventListener("mousemove",o);const i=()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",i)};document.addEventListener("mouseup",i)},c.ondragstart=function(){return!1},this.collapseWidget=()=>o(!1),t}createDescriptionSection(e){const t=SS("div","description_section_or",sS),n=SS("div","description_s_title_or",tS),r=SS("div","title",{fontSize:13,fontWeight:500,lineHeight:"auto"},"Introduction & Guidelines"),s=SS("div","icon",iS,"-"),o=SS("div","content",nS),i=SS("div","text_description",{maxHeight:"250px",overflowY:"auto",whiteSpace:"pre-wrap",fontSize:13,color:"#454545",lineHeight:"auto"});i.innerHTML=e;const a=SS("div","button_begin_or",aS,"Begin Test");n.append(r,s),o.append(i,a),t.append(n,o);const c=()=>{this.widgetGuidelinesVisible=!this.widgetGuidelinesVisible,s.textContent=this.widgetGuidelinesVisible?"-":"+",Object.assign(o.style,this.widgetGuidelinesVisible?nS:{display:"none"})};return n.onclick=c,this.toggleDescriptionVisibility=()=>{this.widgetGuidelinesVisible=!1,s.textContent=this.widgetGuidelinesVisible?"-":"+",Object.assign(o.style,this.widgetGuidelinesVisible?nS:{display:"none"}),o.removeChild(a)},a.onclick=()=>{if(c(),this.test){var e,t;const r=null===(e=this.signalManager)||void 0===e?void 0:e.getDurations(),s=r?r.tasks.findIndex(e=>this.test&&e.taskId===this.test.tasks[0].task_id):null;var n;r&&-1===s&&(r.tasks.push({taskId:this.test.tasks[0].task_id,started:this.app.timestamp()}),null===(n=this.signalManager)||void 0===n||n.setDurations(r)),null===(t=this.signalManager)||void 0===t||t.signalTask(this.test.tasks[0].task_id,"begin")}this.showTaskSection(),o.removeChild(a)},t}createTasksSection(e){this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',Object.assign(this.container.style,Y_);const t=SS("div","task_section_or",sS),n=SS("div","description_t_title_or",tS),r=SS("div","title",{fontSize:"13px",fontWeight:"500",lineHeight:"auto"},"Tasks"),s=SS("div","icon",iS,"-"),o=SS("div","content",nS),i=SS("div","pagination",lS),a=SS("div","taskCard",pS),c=SS("div","taskText",hS),l=SS("div","taskDescription",fS),u=SS("div","taskButtons",yS),d=SS("div","taskText",hS);d.textContent="Your answer";const p=SS("textarea","taskDescription",{resize:"vertical"}),h=SS("div","inputArea",pS);h.append(d,p);const f=SS("div","closePanelButton",mS,"Collapse Panel"),m=SS("div","nextButton",gS,"Done, Next");n.append(r,s),a.append(c,l),u.append(f,m),o.append(i,a,h,u),t.append(n,o);const g=()=>{const t=e[this.currentTaskIndex];c.textContent=t.title,l.textContent=t.description,t.allow_typing?h.style.display="flex":h.style.display="none"};e.forEach((e,t)=>{const n=SS("span",`or_task_${t}`,{outline:"1px solid #efefef",fontSize:"13px",height:"24px",width:"24px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:"6.25em"},(t+1).toString());n.id=`or_task_${t}`,i.append(n)}),this.hideTaskSection=()=>(s.textContent="+",Object.assign(o.style,{display:"none"}),this.widgetTasksVisible=!1,!1),this.showTaskSection=()=>(s.textContent="-",Object.assign(o.style,nS),this.widgetTasksVisible=!0,!0);const y=()=>{const e=document.getElementById(`or_task_${this.currentTaskIndex}`);e&&Object.assign(e.style,uS);for(let e=0;e<this.currentTaskIndex;e++){const t=document.getElementById(`or_task_${e}`);t&&Object.assign(t.style,dS)}};return n.onclick=()=>{this.widgetTasksVisible=!this.widgetTasksVisible,s.textContent=this.widgetTasksVisible?"-":"+",Object.assign(o.style,this.widgetTasksVisible?nS:{display:"none"})},f.onclick=this.collapseWidget,m.onclick=()=>{var t;const n=e[this.currentTaskIndex].allow_typing?p.value:void 0;if(p.value="",null===(t=this.signalManager)||void 0===t||t.signalTask(e[this.currentTaskIndex].task_id,"done",n),this.currentTaskIndex<e.length-1){var r,s;this.currentTaskIndex++,g();const t=null===(r=this.signalManager)||void 0===r?void 0:r.getDurations();var o;t&&-1===t.tasks.findIndex(t=>t.taskId===e[this.currentTaskIndex].task_id)&&(t.tasks.push({taskId:e[this.currentTaskIndex].task_id,started:this.app.timestamp()}),null===(o=this.signalManager)||void 0===o||o.setDurations(t)),null===(s=this.signalManager)||void 0===s||s.signalTask(e[this.currentTaskIndex].task_id,"begin"),y()}else this.showEndSection();this.app.localStorage.setItem("or_uxt_task_index",this.currentTaskIndex.toString())},setTimeout(()=>{const e=document.getElementById("or_task_0");e&&Object.assign(e.style,uS),g(),y()},1),t}showEndSection(){var e,t,n,r;let s=!0;null===(e=this.signalManager)||void 0===e||e.signalTest("done");const o=SS("div","end_section_or",oS),i=SS("div","end_title_or",{fontSize:"1.25rem",fontWeight:"500"},"Thank you! ð"),a=SS("div","end_description_or",{},(null===(t=this.test)||void 0===t?void 0:t.conclusion)??"Thank you for participating in our usability test. Your feedback has been captured and will be used to enhance our website. \n\nWe appreciate your time and valuable input."),c=SS("div","end_button_or",aS,"Submitting Feedback"),l=function(){!function(){const e=document.createElement("style");e.type="text/css",e.innerText="@keyframes spin {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n    }",document.head.appendChild(e)}();const e=document.createElement("div");return e.classList.add("spinner"),Object.assign(e.style,vS),e}();c.appendChild(l),null!==(n=this.test)&&void 0!==n&&n.reqMic||null!==(r=this.test)&&void 0!==r&&r.reqCamera?this.userRecorder.sendToAPI().then(()=>{c.removeChild(l),c.textContent="End Session",s=!1}).catch(e=>{console.error(e),c.removeChild(l),c.textContent="End Session",s=!1}):(c.removeChild(l),c.textContent="End Session",s=!1),this.taskSection&&this.container.removeChild(this.taskSection),this.descriptionSection&&this.container.removeChild(this.descriptionSection),this.stopButton&&this.stopButtonContainer&&this.container.removeChild(this.stopButtonContainer),c.onclick=()=>{s||(window.close(),document.body.removeChild(this.bg))},o.append(i,a,c),this.endSection=o,this.container.append(o)}}function IS(e){return!!e&&null!=e.nodeType}function CS(e){return"http://www.w3.org/2000/svg"===e.namespaceURI||"svg"===e.localName}function MS(e){return e.nodeType===Node.ELEMENT_NODE}function RS(e){return e.nodeType===Node.TEXT_NODE}function OS(e){return e.nodeType===Node.DOCUMENT_NODE}function AS(e){return e.nodeType===Node.DOCUMENT_NODE||e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}function NS(e,t){return e.localName===t}class DS{constructor(e,t){this.app=e,this.options=t,this.snapshots={},this.intervals=[],this.restartTracking=()=>{this.clear(),this.app.nodes.scanTree(this.captureCanvas)},this.captureCanvas=e=>{const t=this.app.nodes.getID(e);t&&NS(e,"canvas")&&(this.app.sanitizer.isObscured(t)||this.app.sanitizer.isHidden(t)||!NS(e,"canvas")||this.snapshots[t]||new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target?this.snapshots[t]&&this.snapshots[t].createdAt?this.snapshots[t].paused=!1:this.recordCanvas(e.target,t):this.snapshots[t]&&(this.snapshots[t].paused=!0))})}).observe(e))},this.recordCanvas=(e,t)=>{const n=this.app.timestamp();this.snapshots[t]={images:[],createdAt:n,paused:!1,dummy:document.createElement("canvas")};const r=[119,t.toString(),n];this.app.send(r);const s=e=>{!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"medium",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>5?arguments[5]:void 0;const s=`image/${arguments.length>4?arguments[4]:void 0}`;if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]){const o=window.devicePixelRatio||1;n.width=e.width/o,n.height=e.height/o;const i=n.getContext("2d");if(!i)return"";i.clearRect(0,0,n.width,n.height),i.drawImage(e,0,0,n.width,n.height),n.toBlob(r,s,LS[t])}else e.toBlob(r,s,LS[t])}(e,this.options.quality,this.snapshots[t].dummy,this.options.fixedScaling,this.fileExt,e=>{if(e){if(!this.snapshots[t])return this.app.debug.warn("Canvas not present in snapshots after capture:",this.snapshots,t);this.snapshots[t].images.push({id:this.app.timestamp(),data:e}),this.snapshots[t].images.length>9&&(this.sendSnaps(this.snapshots[t].images,t,this.snapshots[t].createdAt),this.snapshots[t].images=[])}})},o=setInterval(()=>{const n=this.app.nodes.getID(e),r=n?this.app.nodes.getNode(n):void 0;return this.snapshots[t]?r&&NS(r,"canvas")&&r===e?void(this.snapshots[t].paused||(this.options.useAnimationFrame?requestAnimationFrame(()=>{s(r)}):s(r))):(this.app.debug.log("Canvas element not in sync",r,e),void clearInterval(o)):(this.app.debug.log("Canvas is not present in {snapshots}"),void clearInterval(o))},this.interval);this.intervals.push(o)},this.fileExt=t.fileExt??"webp",this.interval=1e3/t.fps}startTracking(){setTimeout(()=>{this.app.nodes.scanTree(this.captureCanvas),this.app.nodes.attachNodeCallback(this.captureCanvas)},250)}sendSnaps(e,t,n){if(0===Object.keys(this.snapshots).length)return;const r=new FormData;e.forEach(e=>{const s=e.data;s&&(r.append("snapshot",s,`${n}_${t}_${e.id}.${this.fileExt}`),this.options.isDebug&&function(e,t){const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}(s,`${n}_${t}_${e.id}.${this.fileExt}`))});const s=()=>{this.app.debug.log("Restarting tracker; token expired"),this.app.stop(!1),setTimeout(()=>{this.app.start({},!0)},250)};fetch(this.app.options.ingestPoint+"/v1/web/images",{method:"POST",headers:{Authorization:`Bearer ${this.app.session.getSessionToken()??""}`},body:r}).then(e=>401!==e.status||s()).catch(e=>{this.app.debug.error("error saving canvas",e)})}clear(){this.intervals.forEach(e=>clearInterval(e)),this.snapshots={}}}const LS={low:.35,medium:.55,high:.8};class PS{constructor(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.shouldLog=e=>this.level>=e,this.info=function(){e.shouldLog(5)&&console.info(...arguments)},this.log=function(){e.shouldLog(4)&&console.log(...arguments)},this.warn=function(){e.shouldLog(3)&&console.warn(...arguments)},this.error=function(){e.shouldLog(2)&&console.error(...arguments)},this.level=t}}const FS={interval:3e4,batchSize:2500,enabled:!0};class jS{constructor(e,t,n){this.nodes=e,this.unregisterNode=t,this.start=()=>{this.options.enabled&&(this.stop(),this.interval=setInterval(()=>{!function(e,t,n){const r=e.entries();!function e(){const s=[];let o=r.next();for(;!o.done&&s.length<t;)s.push(o.value),o=r.next();s.length>0&&(s.forEach(e=>{let[t,r]=e;r&&n(r)}),setTimeout(e,50))}()}(this.nodes,this.options.batchSize,e=>{const t=function(e){try{var t;if(!e.isConnected)return[!1,"not connected"];const n=e.nodeType===Node.DOCUMENT_NODE,r=n?e.defaultView:null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView,s=n?e:e.ownerDocument;return r?r.closed?[!1,"window closed"]:null!=s&&s.documentElement.isConnected?[!0,"ok"]:[!1,"documentElement not connected"]:[!1,"no window"]}catch(e){return[!1,e]}}(e)[0];t||this.unregisterNode(e)})},this.options.interval))},this.stop=()=>{this.interval&&clearInterval(this.interval)},this.options={...FS,...n}}}class $S{constructor(e){var t=this;this.nodes=new Map,this.totalNodeAmount=0,this.nodeCallbacks=[],this.elementListeners=new Map,this.nextNodeId=0,this.attachNodeCallback=e=>this.nodeCallbacks.push(e),this.scanTree=e=>{this.nodes.forEach(t=>t?e(t):void 0)},this.attachNodeListener=function(e,n,r){let s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const o=t.getID(e);if(void 0===o)return;y_(e,n,r,s,t.forceNgOff);let i=t.elementListeners.get(o);void 0===i&&(i=[],t.elementListeners.set(o,i)),i.push([n,r,s])},this.createFrameId=(e,t)=>function(e,t){if(e<0||e>3)throw new RangeError("OR: nesting level overflow, max 4");if(t<0||t>127)throw new RangeError("OR: frame order overflow, max 128");return((3&e)<<29|(127&t)<<22)>>>0}(e,t),this.unregisterNode=e=>{const t=e[this.node_id];if(void 0!==t){e[this.node_id]=void 0,delete e[this.node_id],this.nodes.delete(t);const n=this.elementListeners.get(t);void 0!==n&&(this.elementListeners.delete(t),n.forEach(t=>v_(e,t[0],t[1],t[2],this.forceNgOff))),this.totalNodeAmount--}return t},this.node_id=e.node_id,this.forceNgOff=e.forceNgOff,this.maintainer=new jS(this.nodes,this.unregisterNode,e.maintainer),this.maintainer.start()}crossdomainMode(e,t){this.nextNodeId=this.createFrameId(e,t)}registerNode(e){let t=e[this.node_id];const n=void 0===t;return n&&(t=this.nextNodeId,this.totalNodeAmount++,this.nextNodeId++,this.nodes.set(t,e),e[this.node_id]=t),[t,n]}cleanTree(){for(const[e,t]of this.nodes)t&&!document.contains(t)&&this.unregisterNode(t)}callNodeCallbacks(e,t){this.nodeCallbacks.forEach(n=>n(e,t))}getID(e){if(e)return e[this.node_id]}getNode(e){return this.nodes.get(e)}getNodeCount(){return this.totalNodeAmount}clear(){for(const[e,t]of this.nodes)t&&this.unregisterNode(t);this.nextNodeId=0,this.nodes.clear()}}let BS=99e6;function US(e){return AS(e)&&!!e.adoptedStyleSheets}let HS=15;function zS(){return HS++}const qS=new Map,WS={},VS={};function JS(e){if(function(e){return e.nodeType===Node.COMMENT_NODE}(e))return!0;if(RS(e))return!1;if(!MS(e))return!0;const t=e.tagName.toUpperCase();if("LINK"===t){const t=e.getAttribute("rel"),n=e.getAttribute("as");return!(null!=t&&t.includes("stylesheet")||"style"===n||"font"===n)}return"SCRIPT"===t||"NOSCRIPT"===t||"META"===t||"TITLE"===t||"BASE"===t}function KS(e){return!!AS(e)||!JS(e)}var GS,XS;!function(e){e[e.New=0]="New",e[e.Removed=1]="Removed",e[e.Changed=2]="Changed"}(GS||(GS={}));class YS{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.app=e,this.isTopContext=t,this.commited=[],this.recents=new Map,this.indexes=[],this.attributesMap=new Map,this.textSet=new Set,this.disableSprites=!1,this.inlineRemoteCss=!1,this.inlinerOptions=void 0,this.domParser=new DOMParser,this.disableSprites=Boolean(n.disableSprites),this.inlineRemoteCss=Boolean(n.inlineRemoteCss),this.inlinerOptions=n.inlinerOptions,this.observer=g_(this.app.safe(e=>{for(const t of e){const e=t.target,n=t.type;if(!KS(e))continue;if("childList"===n){for(let e=0;e<t.removedNodes.length;e++)KS(t.removedNodes[e])&&this.bindNode(t.removedNodes[e]);for(let e=0;e<t.addedNodes.length;e++)this.bindTree(t.addedNodes[e]);continue}const r=this.app.nodes.getID(e);if(void 0!==r){if(this.recents.has(r)||this.recents.set(r,GS.Changed),"attributes"===n){const e=t.attributeName;if(null===e)continue;let n=this.attributesMap.get(r);void 0===n&&this.attributesMap.set(r,n=new Set),n.add(e);continue}"characterData"!==n||this.textSet.add(r)}}this.commitNodes()}),this.app.options.forceNgOff)}clear(){this.commited.length=0,this.recents.clear(),this.indexes.length=1,this.attributesMap.clear(),this.textSet.clear()}handleIframeSrcChange(e){const t=e.contentDocument;if(t&&void 0!==this.app.nodes.getID(t)){const n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,{acceptNode:e=>JS(e)||void 0===this.app.nodes.getID(e)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},!1);let r=0;const s=this.app.nodes.getNodeCount(),o=e.contentDocument,i=this.app.nodes.unregisterNode.bind(this.app.nodes);for(;n.nextNode();)o.contains(n.currentNode)||(r+=1,i(n.currentNode));const a=Math.floor(r/s*100);a>30&&this.app.send(B_(a))}}sendNodeAttribute(e,t,n,r){if(CS(t))return n.startsWith("xlink:")&&(n=n.substring(6)),null===r&&this.app.send(T_(e,n)),function(e){return"use"===e.localName}(t)&&"href"===n&&!this.disableSprites?void async function(e,t,n){try{const t=e.getAttribute("xlink:href")||e.getAttribute("href");if(!t)return void console.debug("Openreplay: xlink:href or href not found on <use>.");let r,[s,o]=t.split("#");if(!s&&o){let e;e=t.startsWith("#")?`#${CSS.escape(t.substring(1))}`:CSS.escape(t);const n=document.querySelector(e);if(n){const e=`\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="${n.getAttribute("viewBox")||"0 0 24 24"}">\n          ${n.innerHTML}\n        </svg>\n      `;return WS[o]=e,e}return void console.warn("Openreplay: Sprite symbol not found in the document.")}if(!s&&!o)return void console.warn("Openreplay: Invalid xlink:href or href found on <use>.");if(WS[o])return WS[o];if(VS[s])1===VS[s]?await new Promise(e=>{let t=0;const n=setInterval(()=>{t>100&&(clearInterval(n),e(!1)),1!==VS[s]?(r=VS[s],clearInterval(n),e(!0)):t++},100)}):r=VS[s]??'<svg xmlns="http://www.w3.org/2000/svg"></svg>';else{VS[s]=1;const e=await fetch(s),t=await e.text();r=n.parseFromString(t,"image/svg+xml"),VS[s]=r}const i=r.getElementById(o);if(!i)return console.debug("Openreplay: Symbol not found in SVG."),"";{const e=`\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="${i.getAttribute("viewBox")||"0 0 24 24"}">\n          ${i.innerHTML}\n        </svg>\n      `;return WS[o]=e,e}}catch(e){console.error("Openreplay: Error processing <use> element:",e)}}(t,0,this.domParser).then(t=>{t&&this.app.send(function(e,t,n){return[12,e,t,n]}(e,n,`_$OPENREPLAY_SPRITE$_${t}`))}).catch(e=>{console.error("Openreplay: Error parsing <use> element:",e)}):void("href"===n?(r.length>1e5&&(r=""),this.app.send(M_(e,n,r,this.app.getBaseHref()))):this.app.attributeSender.sendSetAttribute(e,n,r));if("src"!==n&&"srcset"!==n&&"integrity"!==n&&"crossorigin"!==n&&"autocomplete"!==n&&"on"!==n.substring(0,2)&&("value"!==n||!NS(t,"input")||"button"===t.type||"reset"===t.type||"submit"===t.type))if(null!==r){if("style"===n||"href"===n&&NS(t,"link"))return"rel"in t&&"stylesheet"===t.rel&&this.inlineRemoteCss?void setTimeout(()=>{var n,r;!function(e,t,n,r,s,o,i,a,c){const l=a?null:r();a||o(l,t);const u=e.sheet;if(u&&!i)try{const e=function e(t){try{const n=t.rules||t.cssRules;if(!n)return null;let r=t.href;!r&&t.ownerNode&&t.ownerNode.ownerDocument&&(r=t.ownerNode.ownerDocument.location.href);const s=Array.from(n,t=>function(t,n){if(function(e){return"styleSheet"in e}(t)){let n;try{n=e(t.styleSheet)||function(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const n=["@import",`url(${JSON.stringify(e.href)})`];return""===e.layerName?n.push("layer"):e.layerName&&n.push(`layer(${e.layerName})`),e.supportsText&&n.push(`supports(${e.supportsText})`),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}(t)}catch(e){n=t.cssText}return t.styleSheet.href?p(n,t.styleSheet.href):n}{let e=t.cssText;return function(e){return"selectorText"in e}(t)&&t.selectorText.includes(":")&&(e=function(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}(e)),n?p(e,n):e}}(t,r)).join("");return function(e){return e.includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),e}(s)}catch(e){return null}}(u);if(e)return void d(e)}catch(e){}function d(e){const t=function(e){const t=[];let n=!1,r=!1,s="",o=0,i="";for(let a=0;a<e.length;a++){const c=e[a],l=e[a+1]||"";r||"/"!==c||"*"!==l?n?"*"===c&&"/"===l&&(n=!1,a++):r||'"'!==c&&"'"!==c?r?(i+=c,c===s&&"\\"!==e[a-1]&&(r=!1)):(i+=c,"{"===c?o++:"}"===c&&(o--,0===o&&(t.push(i.trim()),i=""))):(r=!0,s=c,i+=c):(n=!0,a++)}return i.trim()&&t.push(i.trim()),t}(e=e.replace(/\/\*[\s\S]*?\*\//g,""));for(let e=0;e<t.length;e++)s(l,t[e],e,n)}function p(e,t){if(!e)return"";const n=/^(?:[a-z+]+:)?\/\//i,r=/^www\..*/i,s=/^(data:)([^,]*),(.*)/i;return e.replace(/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,(e,o,i,a,c,l)=>{const u=i||c||l,d=o||a||"";if(!u)return e;if(n.test(u)||r.test(u))return`url(${d}${u}${d})`;if(s.test(u))return`url(${d}${u}${d})`;if("/"===u[0])return`url(${d}${function(e){let t="";return t=e.indexOf("//")>-1?e.split("/").slice(0,3).join("/"):e.split("/")[0],t=t.split("?")[0],t}(t)+u}${d})`;const p=t.split("/"),h=u.split("/");p.pop();for(const e of h)"."!==e&&(".."===e?p.pop():p.push(e));return`url(${d}${p.join("/")}${d})`})}e.href&&fetch(e.href).then(e=>{if(!e.ok)throw new Error(`response status ${e.status}`);return e.text()}).then(e=>{a&&c?c(e,BS++):d(e)}).catch(t=>{console.error(`OpenReplay: Failed to fetch CSS from ${e.href}:`,t)})}(t,e,this.app.getBaseHref(),zS,(e,t,n,r)=>{this.app.send(N_(e,t,n,r))},(e,t)=>{this.app.send(L_(e,t))},null===(n=this.inlinerOptions)||void 0===n?void 0:n.forceFetch,null===(r=this.inlinerOptions)||void 0===r?void 0:r.forcePlain,(t,n)=>{this.app.send(x_(n,e,0)),setTimeout(()=>{this.app.send(R_(n,t,this.app.getBaseHref()))},10)})},0):void this.app.send(M_(e,n,r,this.app.getBaseHref()));("href"===n||r.length>1e5)&&(r=""),["alt","placeholder"].includes(n)&&this.app.sanitizer.privateMode&&(r=r.replaceAll(/./g,"*")),this.app.attributeSender.sendSetAttribute(e,n,r)}else this.app.send(T_(e,n))}sendNodeData(e,t,n){NS(t,"style")?this.app.send(R_(e,n,this.app.getBaseHref())):(n=this.app.sanitizer.sanitize(e,n),this.app.send(function(e,t){return[14,e,t]}(e,n)))}bindNode(e){const[t,n]=this.app.nodes.registerNode(e);n?this.recents.set(t,GS.New):this.recents.get(t)!==GS.New&&this.recents.set(t,GS.Removed)}bindTree(e){if(!KS(e))return;this.bindNode(e);const t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,{acceptNode:e=>(void 0!==this.app.nodes.getID(e)&&this.app.debug.info("! Node is already bound",e),JS(e)||void 0!==this.app.nodes.getID(e)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT)},!1);for(;t.nextNode();)this.bindNode(t.currentNode)}unbindTree(e){const t=this.app.nodes.unregisterNode(e);if(void 0!==t&&this.recents.get(t)===GS.Removed){this.app.send(function(e){return[11,e]}(t));const n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,{acceptNode:e=>JS(e)||void 0===this.app.nodes.getID(e)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},!1);let r=0;const s=this.app.nodes.getNodeCount();for(;n.nextNode();)r+=1,this.app.nodes.unregisterNode(n.currentNode);const o=Math.floor(r/s*100);o>30&&this.app.send(B_(o))}}_commitNode(e,t){if(AS(t))return!0;const n=t.assignedSlot?t.assignedSlot:t.parentNode;let r;if(!NS(t,"html")||!this.isTopContext){if(null===n)return this.unbindTree(t),!1;if(r=this.app.nodes.getID(n),void 0===r)return this.unbindTree(t),!1;if(!this.commitNode(r))return this.unbindTree(t),!1;if(this.app.sanitizer.handleNode(e,r,t),this.app.sanitizer.isHidden(r))return!1}let s=t.previousSibling;for(;null!==s;){const t=this.app.nodes.getID(s);if(void 0!==t){this.commitNode(t),this.indexes[e]=this.indexes[t]+1;break}s=s.previousSibling}null===s&&(this.indexes[e]=0);const o=this.recents.get(e),i=o===GS.New,a=this.indexes[e];if(void 0===a)throw"commitNode: missing node index";if(i){if(MS(t)){let n=t;if(void 0!==r){if(this.app.sanitizer.isHidden(e)){const e=n.clientWidth,r=n.clientHeight;n=t.cloneNode(),n.style.width=`${e}px`,n.style.height=`${r}px`}"rel"in n&&"stylesheet"===n.rel&&this.inlineRemoteCss?this.app.send(k_(e,r,a,"STYLE",!1)):this.app.send(k_(e,r,a,n.tagName,CS(t)))}for(let t=0;t<n.attributes.length;t++){const r=n.attributes[t];this.sendNodeAttribute(e,n,r.nodeName,r.value)}}else RS(t)&&(this.app.send(x_(e,r,a)),this.sendNodeData(e,n,t.data));return!0}o===GS.Removed&&void 0!==r&&this.app.send(function(e,t,n){return[10,e,t,n]}(e,r,a));const c=this.attributesMap.get(e);if(void 0!==c){if(!MS(t))throw"commitNode: node is not an element";for(const n of c)this.sendNodeAttribute(e,t,n,t.getAttribute(n))}if(this.textSet.has(e)){if(!RS(t))throw"commitNode: node is not a text";this.sendNodeData(e,n,t.data)}return!0}commitNode(e){const t=this.app.nodes.getNode(e);if(!t)return!1;const n=this.commited[e];return void 0!==n?n:this.commited[e]=this._commitNode(e,t)}commitNodes(){let e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(const[n,r]of this.recents.entries())this.commitNode(n),r===GS.New&&(e=this.app.nodes.getNode(n))&&this.app.nodes.callNodeCallbacks(e,t);this.clear()}observeRoot(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.observer.observe(e,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1}),this.bindTree(n),t(this.app.nodes.getID(e)),this.commitNodes(!0)}disconnect(){this.observer.disconnect(),this.clear()}}class QS extends YS{observe(e){const t=e.contentDocument,n=this.app.nodes.getID(e);t&&void 0!==n&&this.observeRoot(t,e=>{void 0!==e?(this.docId=e,this.app.send(O_(n,e))):this.app.debug.log("OpenReplay: Iframe document not bound")})}syntheticObserve(e,t){this.observeRoot(t,t=>{void 0!==t?this.app.send(O_(e,t)):this.app.debug.log("OpenReplay: Iframe document not bound")})}}class ZS extends YS{observe(e){const t=e.shadowRoot,n=this.app.nodes.getID(e);t&&void 0!==n&&this.observeRoot(t,e=>{void 0!==e?this.app.send(O_(n,e)):this.app.debug.error("OpenReplay: Shadow Root was not bound")})}}class ew{constructor(){this.states=new WeakMap}calcOffset(e){let t=0,n=0;if(e.parent&&([t,n]=this.calcOffset(e.parent)),!e.offset){const{left:t,top:n}=e.iFrame.getBoundingClientRect();e.offset=[t,n]}const[r,s]=e.offset;return[t+r,n+s]}getDocumentOffset(e){const t=this.states.get(e);return t?this.calcOffset(t):[0,0]}observe(e){var t;const n=e.contentDocument;if(!n)return;const r=e.ownerDocument,s={offset:null,iFrame:e,parent:this.states.get(r)||null,clear:()=>{var e;r.removeEventListener("scroll",o),null===(e=r.defaultView)||void 0===e||e.removeEventListener("resize",o)}},o=()=>{s.offset=null};r.addEventListener("scroll",o),null===(t=r.defaultView)||void 0===t||t.addEventListener("resize",o),this.states.set(n,s)}clear(){this.states=new WeakMap}}function tw(e){switch(e){case XS.Inline:return{inlineRemoteCss:!0,inlinerOptions:{forceFetch:!1,forcePlain:!1}};case XS.InlineFetched:return{inlineRemoteCss:!0,inlinerOptions:{forceFetch:!0,forcePlain:!1}};case XS.PlainFetched:return{inlineRemoteCss:!0,inlinerOptions:{forceFetch:!0,forcePlain:!0}};case XS.Disabled:default:return{inlineRemoteCss:!1,inlinerOptions:{forceFetch:!1,forcePlain:!1}}}}!function(e){e[e.Disabled=0]="Disabled",e[e.Inline=1]="Inline",e[e.InlineFetched=2]="InlineFetched",e[e.PlainFetched=3]="PlainFetched"}(XS||(XS={}));const nw=Qb?Element.prototype.attachShadow:()=>new ShadowRoot;class rw extends YS{constructor(e){const t=Object.assign({captureIFrames:!0,disableSprites:!1,inlineCss:0},e.options),n={disableSprites:t.disableSprites,...tw(t.inlineCss)};super(e.app,!0,n),this.iframeOffsets=new ew,this.contextCallbacks=[],this.contextsSet=new WeakSet,this.iframeObserversArr=[],this.iframeObservers=new WeakMap,this.docObservers=new WeakMap,this.shadowRootObservers=new WeakMap,this.app=e.app,this.options=t,this.app.nodes.attachNodeCallback(e=>{NS(e,"iframe")&&(this.options.captureIFrames&&!d_(e,"obscured")||d_(e,"capture"))&&this.handleIframe(e)}),this.app.nodes.attachNodeCallback(e=>{MS(e)&&null!==e.shadowRoot&&this.handleShadowRoot(e.shadowRoot)})}attachContextCallback(e){this.contextCallbacks.push(e)}getDocumentOffset(e){return this.iframeOffsets.getDocumentOffset(e)}handleIframe(e){const t=this.app.safe(()=>setTimeout(()=>{const t=this.app.nodes.getID(e);if(void 0===t||!function(e){try{return Boolean(e.contentDocument)}catch(e){return!1}}(e))return;const n=e.contentWindow,r=e.contentDocument;if(!r)return void this.app.debug.warn("no doc for iframe found",e);if(r&&this.docObservers.has(r))return void this.app.debug.info("doc already observed for",t);const s=new QS(this.app,!1,{});this.iframeObservers.set(e,s),this.docObservers.set(r,s),this.iframeObserversArr.push(s),s.observe(e),this.iframeOffsets.observe(e),n&&n===n.window&&!this.contextsSet.has(n)&&(this.contextsSet.add(n),this.contextCallbacks.forEach(e=>e(n)))},250));e.addEventListener("load",t),t()}handleShadowRoot(e){const t=new ZS(this.app);this.shadowRootObservers.set(e,t),t.observe(e.host)}observe(){const e=this;Element.prototype.attachShadow=function(){const t=nw.apply(this,arguments);return e.handleShadowRoot(t),t},this.app.nodes.clear(),this.observeRoot(window.document,()=>{this.app.send([7]),this.app.nodes.callNodeCallbacks(document,!0)},window.document.documentElement)}crossdomainObserve(e,t,n){const r=this;Element.prototype.attachShadow=function(){const e=nw.apply(this,arguments);return r.handleShadowRoot(e),e},this.app.nodes.clear(),this.app.nodes.crossdomainMode(n,t);const s=new QS(this.app);this.iframeObservers.set(window.document,s),s.syntheticObserve(e,window.document)}disconnect(){this.iframeOffsets.clear(),Element.prototype.attachShadow=nw,this.iframeObserversArr.forEach(e=>e.disconnect()),this.iframeObserversArr=[],this.iframeObservers=new WeakMap,this.shadowRootObservers=new WeakMap,this.docObservers=new WeakMap,super.disconnect()}}var sw;!function(e){e[e.Plain=0]="Plain",e[e.Obscured=1]="Obscured",e[e.Hidden=2]="Hidden"}(sw||(sw={}));const ow=e=>e.trim().replace(/[^\f\n\r\t\v\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff\s]/g,"*");class iw{constructor(e){var t;this.obscured=new Set,this.hidden=new Set,this.app=e.app;this.privateMode=(null===(t=e.options)||void 0===t?void 0:t.privateMode)??!1,this.options=Object.assign({obscureTextEmails:!0,obscureTextNumbers:!1,privateMode:!1,domSanitizer:void 0},e.options)}handleNode(e,t,n){if(this.options.privateMode){if(MS(n)&&!d_(n,"unmask"))return this.obscured.add(e);if(RS(n)&&!d_(n.parentNode,"unmask"))return this.obscured.add(e)}if((this.obscured.has(t)||MS(n)&&(d_(n,"masked")||d_(n,"obscured")))&&this.obscured.add(e),(this.hidden.has(t)||MS(n)&&(d_(n,"htmlmasked")||d_(n,"hidden")))&&this.hidden.add(e),void 0!==this.options.domSanitizer&&MS(n)){const t=this.options.domSanitizer(n);t===sw.Obscured&&this.obscured.add(e),t===sw.Hidden&&this.hidden.add(e)}}sanitize(e,t){return this.obscured.has(e)?ow(t):(this.options.obscureTextNumbers&&(t=t.replace(/\d/g,"0")),this.options.obscureTextEmails&&(t=t.replace(/^\w+([+.-]\w+)*@\w+([.-]\w+)*\.\w{2,3}$/g,e=>{const[t,n]=e.split("@"),[r,s]=n.split(".");return`${s_(t)}@${s_(r)}.${s_(s)}`})),t)}isObscured(e){return this.obscured.has(e)}isHidden(e){return this.hidden.has(e)}getInnerTextSecure(e){const t=this.app.nodes.getID(e);return t?this.sanitize(t,e.innerText):""}clear(){this.obscured.clear(),this.hidden.clear()}}class aw{constructor(e){this.metadata={},this.userID=null,this.callbacks=[],this.timestamp=0,this.getPageNumber=()=>{const e=this.app.sessionStorage.getItem(this.options.session_pageno_key);if(null!=e)return parseInt(e)},this.incPageNo=()=>{let e=this.getPageNumber();return void 0===e?e=0:e++,this.app.sessionStorage.setItem(this.options.session_pageno_key,e.toString()),e},this.getSessionToken=e=>{const t=this.token||this.app.sessionStorage.getItem(this.options.session_token_key);if(e&&t){const n=t.split("_&_")[1];if(!n||n!==e)return this.app.sessionStorage.removeItem(this.options.session_token_key),void(this.token=void 0)}return(t?t.split("_&_")[0]:null)||void 0},this.setSessionToken=(e,t)=>{this.token=`${e}_&_${t}`,this.app.sessionStorage.setItem(this.options.session_token_key,`${e}_&_${t}`)},this.app=e.app,this.options=e.options,this.createTabId()}attachUpdateCallback(e){this.callbacks.push(e)}handleUpdate(e){null==e.userID&&delete e.userID,null==e.sessionID&&delete e.sessionID,this.callbacks.forEach(t=>t(e))}assign(e){void 0!==e.userID&&(this.userID=e.userID),void 0!==e.metadata&&Object.entries(e.metadata).forEach(e=>{let[t,n]=e;return this.metadata[t]=n}),void 0!==e.sessionID&&(this.sessionID=e.sessionID),void 0!==e.timestamp&&(this.timestamp=e.timestamp),void 0!==e.projectID&&(this.projectID=e.projectID),this.handleUpdate(e)}setMetadata(e,t){this.metadata[e]=t,this.handleUpdate({metadata:{[e]:t}})}setUserID(e){this.userID=e,this.handleUpdate({userID:e})}setUserInfo(e){this.userInfo=e}applySessionHash(e){const t=decodeURI(e).split("&");let n=e,r="100500";2==t.length&&([r,n]=t),r&&n&&(this.app.sessionStorage.setItem(this.options.session_token_key,n),this.app.sessionStorage.setItem(this.options.session_pageno_key,r))}getSessionHash(){const e=this.getPageNumber(),t=this.getSessionToken();if(void 0!==e&&void 0!==t)return encodeURI(String(e)+"&"+t)}getTabId(){return this.tabId||this.createTabId(),this.tabId}regenerateTabId(){const e=function(){const e=new Uint8Array(6),t=window.crypto||window.msCrypto;return t?(t.getRandomValues(e),Array.from(e,h_).join("")):Array.from({length:12},()=>h_(Math.floor(16*Math.random()))).join("")}();this.app.sessionStorage.setItem(this.options.session_tabid_key,e),this.tabId=e}createTabId(){const e=this.app.sessionStorage.getItem(this.options.session_tabid_key);e?this.tabId=e:this.regenerateTabId()}getInfo(){return{sessionID:this.sessionID,metadata:this.metadata,userID:this.userID,timestamp:this.timestamp,projectID:this.projectID}}reset(){this.app.sessionStorage.removeItem(this.options.session_token_key),this.metadata={},this.userID=null,this.sessionID=void 0,this.timestamp=0}}class cw{constructor(e){this.app=e,this.timer=null,this.callbacks=[]}attach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;r&&(e=e.bind(r)),n&&(e=this.app.safe(e)),this.callbacks.unshift(t?function(e,t){let n=0;return()=>{n++>=t&&(n=0,e())}}(e,t):e)}start(){null===this.timer&&(this.timer=setInterval(()=>this.callbacks.forEach(e=>{e&&e()}),30))}stop(){null!==this.timer&&(clearInterval(this.timer),this.timer=null)}}const lw="canceled",uw="or_uxt_active",dw="or_buffer_1",pw=e=>({reason:e,success:!1}),hw=e=>({...e,success:!0});var fw;function mw(){const e=-1*(new Date).getTimezoneOffset(),t=e>=0?"+":"-",n=Math.floor(Math.abs(e)/60),r=Math.abs(e)%60;return`UTC${t}${String(n).padStart(2,"0")}:${String(r).padStart(2,"0")}`}!function(e){e[e.NotActive=0]="NotActive",e[e.Starting=1]="Starting",e[e.Active=2]="Active",e[e.ColdStart=3]="ColdStart"}(fw||(fw={}));const gw=e=>new Promise(t=>setTimeout(t,e)),yw="never-gonna-give-you-up",vw="never-gonna-let-you-down",bw="never-gonna-run-around-and-desert-you",_w="tracker inside a child iframe",Sw="getting node id for child iframe",ww="batch of messages from an iframe window",kw="signal that parent is live",xw="stop tracker inside frame",Tw="start tracker inside frame",Ew="hello-how-are-you-im-under-the-water-please-help-me";class Iw{constructor(e,t,n,r,s){var o,i,a=this;this.signalError=r,this.insideIframe=s,this.messages=[],this.bufferedMessages1=[],this.bufferedMessages2=[],this.startCallbacks=[],this.stopCallbacks=[],this.commitCallbacks=[],this.activityState=fw.NotActive,this.version="16.4.10",this.socketMode=!1,this.compressionThreshold=24e3,this.bc=null,this.canvasRecorder=null,this.conditionsManager=null,this.canStart=!1,this.rootId=null,this.pageFrames=[],this.frameOderNumber=0,this.frameLevel=0,this.features={},this.emptyBatchCounter=0,this.parentActive=!1,this.checkStatus=()=>this.parentActive,this.parentCrossDomainFrameListener=e=>{const{data:t}=e;if(t&&e.source!==window){if(t.line===Tw){if(this.active())return;try{this.allowAppStart(),this.start()}catch(e){console.error("children frame restart failed:",e)}}t.line===kw&&(this.parentActive=!0),t.line===Sw&&(this.parentActive=!0,this.rootId=t.id,this.session.setSessionToken(t.token,this.projectKey),this.frameOderNumber=t.frameOrderNumber,this.frameLevel=t.frameLevel,this.debug.log("starting iframe tracking",t),this.allowAppStart()),t.line===xw&&this.active()&&this.stop()}},this.trackedFrames=[],this.crossDomainIframeListener=e=>{if(!this.active()||e.source===window)return;const{data:t}=e;if(t){if(t.line===_w){var n;null===(n=e.source)||void 0===n||n.postMessage({ping:!0,line:kw},"*");const s=async()=>{if(null===e.source)return console.error("Couldnt connect to event.source for child iframe tracking");const n=await this.checkNodeId(e.source);if(n)try{var r;this.trackedFrames.includes(t.context)?this.debug.log("Trying to observe already added iframe; ignore if its a restart"):this.trackedFrames.push(t.context),await this.waitStarted();const s=this.session.getSessionToken(this.projectKey),o=this.trackedFrames.findIndex(e=>e===t.context)+1;0===o&&this.debug.error("Couldnt get order number for iframe",t.context,this.trackedFrames);const i={line:Sw,id:n,token:s,frameOrderNumber:o,frameLevel:this.frameLevel+1};this.debug.log("Got child frame signal; nodeId",n,e.source,i),null===(r=e.source)||void 0===r||r.postMessage(i,"*")}catch(e){console.error(e)}else this.debug.log("Couldnt get node id for iframe",e.source)};var r;s(),this.active()?null===(r=e.source)||void 0===r||r.postMessage({line:Tw},"*"):this.addCommand(Tw)}if(t.line===ww){const n=t.messages.map(t=>{if(20===t[0]){let n=t;return this.pageFrames.forEach(r=>{if(r.contentWindow===e.source){const[e,s,o]=t,{left:i,top:a}=r.getBoundingClientRect();n=[e,s+i,o+a]}}),n}if(68===t[0]){let n=t;return this.pageFrames.forEach(r=>{if(r.contentWindow===e.source){const[e,s,o,i,a,c,l]=t,{left:u,top:d,width:p,height:h}=r.getBoundingClientRect(),f=(c/100*p+u)/document.documentElement.scrollWidth,m=(l/100*h+d)/document.documentElement.scrollHeight;n=[e,s,o,i,a,Math.round(1e3*f)/10,Math.round(1e3*m)/10]}}),n}return t});this.messages.push(...n)}if(t.line===Ew){if(!this.pollingQueue.order.length)return;const n=this.pollingQueue.order[0];if(n&&0===this.pollingQueue[n].length)return void(this.pollingQueue.order=this.pollingQueue.order.filter(e=>e!==n));var s;this.pollingQueue[n].includes(t.context)&&(this.pollingQueue[n]=this.pollingQueue[n].filter(e=>e!==t.context),null===(s=e.source)||void 0===s||s.postMessage({line:n},"*"),0===this.pollingQueue[n].length&&this.pollingQueue.order.shift())}}},this.pollingQueue={order:[]},this.addCommand=e=>{this.pollingQueue.order.push(e),this.pollingQueue[e]=[...this.trackedFrames]},this.bootChildrenFrames=async()=>{await this.waitStarted(),this.addCommand(Tw)},this.killChildrenFrames=()=>{this.addCommand(xw)},this.signalIframeTracker=()=>{var e;const t=this.session.getTabId();window.parent.postMessage({line:_w,source:t,context:this.contextId},(null===(e=this.options.crossdomain)||void 0===e?void 0:e.parentDomain)??"*");let n=0,r=250,s=0,o=!1;const i=()=>{var e;o||this.checkStatus()?o=!0:(window.parent.postMessage({line:_w,source:t,context:this.contextId},(null===(e=this.options.crossdomain)||void 0===e?void 0:e.parentDomain)??"*"),this.debug.info("Trying to signal to parent, attempt:",n+1),n++)};for(let e=0;e<10;e++){if(this.checkStatus()){o=!0;break}s+=r,setTimeout(()=>{i()},s),r*=1.5}},this.startTimeout=null,this.send=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var n;a.activityState!==fw.NotActive&&(a.activityState===fw.ColdStart?(a.bufferedMessages1.push(e),a.singleBuffer||a.bufferedMessages2.push(e),null===(n=a.conditionsManager)||void 0===n||n.processMessage(e)):a.messages.push(e),a.activityState===fw.Active&&t&&a.commit())},this.coldStartCommitN=0,this.delay=0,this.attachStartCallback=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(e=a.safe(e)),a.startCallbacks.push(e)},this.attachStopCallback=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(e=a.safe(e)),a.stopCallbacks.push(e)},this.attachEventListener=function(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];r&&(n=a.safe(n)),a.attachStartCallback(()=>e?y_(e,t,n,s,a.options.forceNgOff):null,r),a.attachStopCallback(()=>e?v_(e,t,n,s,a.options.forceNgOff):null,r)},this.coldInterval=null,this.orderNumber=0,this.coldStartTs=0,this.singleBuffer=!1,this.coldStart=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;a.singleBuffer=!1;const n=a.checkSessionToken(e.forceNew);t&&await a.setupConditionalStart(e);const r=()=>{a.orderNumber+=1,t_(),a.coldStartTs=r_(),a.orderNumber%2==0?(a.bufferedMessages1.length=0,a.bufferedMessages1.push(w_(a.timestamp())),a.bufferedMessages1.push(z_(a.session.getTabId()))):(a.bufferedMessages2.length=0,a.bufferedMessages2.push(w_(a.timestamp())),a.bufferedMessages2.push(z_(a.session.getTabId()))),a.stop(!1),a.activityState=fw.ColdStart,e.sessionHash&&a.session.applySessionHash(e.sessionHash),e.forceNew&&a.session.reset(),a.session.assign({userID:e.userID,metadata:e.metadata}),n||(a.debug.log("continuing session on new tab",a.session.getTabId()),a.send(H_(a.session.getTabId()))),a.observer.observe(),a.ticker.start()};a.coldInterval=setInterval(()=>{r()},3e4),r()},this.setupConditionalStart=async e=>{var t;this.conditionsManager=new Jb(this,e);const n=await fetch(this.options.ingestPoint+"/v1/web/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...this.getTrackerInfo(),timestamp:r_(),doNotRecord:!0,bufferDiff:0,userID:this.session.getInfo().userID,token:void 0,deviceMemory:W_,jsHeapSizeLimit:V_,timezone:mw(),width:window.screen.width,height:window.screen.height})}),{token:r,userBrowser:s,userCity:o,userCountry:i,userDevice:a,userOS:c,userState:l,projectID:u,features:d}=await n.json();this.features=d||this.features,this.session.assign({projectID:u}),this.session.setUserInfo({userBrowser:s,userCity:o,userCountry:i,userDevice:a,userOS:c,userState:l});const p={sessionToken:r,userUUID:"",sessionID:""};var h;this.startCallbacks.forEach(e=>e(p)),await(null===(t=this.conditionsManager)||void 0===t?void 0:t.fetchConditions(u,r)),this.features["feature-flags"]&&(await this.featureFlags.reloadFlags(r),null===(h=this.conditionsManager)||void 0===h||h.processFlags(this.featureFlags.flags)),await this.tagWatcher.fetchTags(this.options.ingestPoint,r)},this.onSessionSent=()=>{},this.offlineRecording=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;a.onSessionSent=t,a.singleBuffer=!0;const n=a.checkSessionToken(e.forceNew);t_(),a.coldStartTs=r_();const r=a.localStorage.getItem(dw);if(r){const e=JSON.parse(r);a.bufferedMessages1=Array.isArray(e)?e:a.bufferedMessages1,a.localStorage.removeItem(dw)}a.bufferedMessages1.push(w_(a.timestamp())),a.bufferedMessages1.push(z_(a.session.getTabId())),a.activityState=fw.ColdStart,e.sessionHash&&a.session.applySessionHash(e.sessionHash),e.forceNew&&a.session.reset(),a.session.assign({userID:e.userID,metadata:e.metadata});const s={sessionToken:"",userUUID:"",sessionID:""};return a.startCallbacks.forEach(e=>e(s)),n||a.send(H_(a.session.getTabId())),a.observer.observe(),a.ticker.start(),{saveBuffer:a.saveBuffer,getBuffer:a.getBuffer,setBuffer:a.setBuffer}},this.saveBuffer=()=>{this.localStorage.setItem(dw,JSON.stringify(this.bufferedMessages1))},this.getBuffer=()=>this.bufferedMessages1,this.setBuffer=e=>{this.bufferedMessages1=e},this.prevOpts={},this.restartCanvasTracking=()=>{var e;null===(e=this.canvasRecorder)||void 0===e||e.restartTracking()},this.flushBuffer=async e=>new Promise((t,n)=>{if(0===e.length)return void t(null);let r=1;for(;r<e.length&&0!==e[r][0];)r++;__(()=>{try{const n=e.splice(0,r);this.postToWorker(n.map(e=>[...e])),t(null)}catch(e){this._debug("flushBuffer",e),n(new Error("flushBuffer failed"))}})}),this.onUxtCb=[],this.contextId=Math.random().toString(36).slice(2),this.projectKey=e,this.networkOptions=n.network;const c={revID:"",node_id:"__openreplay_id",session_token_key:"__openreplay_token",session_pageno_key:"__openreplay_pageno",session_reset_key:"__openreplay_reset",session_tabid_key:"__openreplay_tabid",local_uuid_key:"__openreplay_uuid",ingestPoint:"https://api.openreplay.com/ingest",resourceBaseHref:null,__is_snippet:!1,__debug_report_edp:null,__debug__:0,localStorage:null,sessionStorage:null,forceSingleTab:!1,assistSocketHost:"",captureIFrames:!0,obscureTextEmails:!1,obscureTextNumbers:!1,disableStringDict:!1,crossdomain:{parentDomain:"*"},canvas:{disableCanvas:!1,fixedCanvasScaling:!1,__save_canvas_locally:!1,useAnimationFrame:!1},forceNgOff:!1,inlineCss:0,disableSprites:!1};if(this.options=S_(c,n),!this.insideIframe&&!this.options.forceSingleTab&&globalThis&&"BroadcastChannel"in globalThis){const e=location.hostname.split(".").slice(-2).join("_");this.bc=new BroadcastChannel(`rick_${e}`)}else this.options.forceSingleTab&&this.allowAppStart();this.revID=this.options.revID,this.localStorage=this.options.localStorage??window.localStorage,this.sessionStorage=this.options.sessionStorage??window.sessionStorage,this.sanitizer=new iw({app:this,options:n}),this.nodes=new $S({node_id:this.options.node_id,forceNgOff:Boolean(n.forceNgOff),maintainer:null===(o=this.options.nodes)||void 0===o?void 0:o.maintainer}),this.observer=new rw({app:this,options:n}),this.ticker=new cw(this),this.ticker.attach(()=>this.commit()),this.debug=new PS(this.options.__debug__),this.session=new aw({app:this,options:this.options}),this.attributeSender=new Vb({app:this,isDictDisabled:Boolean(this.options.disableStringDict||(null===(i=this.options.crossdomain)||void 0===i?void 0:i.enabled))}),this.featureFlags=new Xb(this),this.tagWatcher=new K_({sessionStorage:this.sessionStorage,errLog:this.debug.error,onTag:e=>this.send([120,e])}),this.session.attachUpdateCallback(e=>{let{userID:t,metadata:n}=e;null!=t&&this.send([28,t]),null!=n&&Object.entries(n).forEach(e=>{let[t,n]=e;return this.send(E_(t,n))})}),null!=t&&this.session.applySessionHash(t);const l=this.session.getTabId();this.insideIframe?(window.addEventListener("message",this.parentCrossDomainFrameListener),window.addEventListener("message",this.crossDomainIframeListener),setInterval(()=>{var e;document.hidden||window.parent.postMessage({line:Ew,context:this.contextId},(null===(e=n.crossdomain)||void 0===e?void 0:e.parentDomain)??"*")},250)):(this.initWorker(),window.addEventListener("message",this.crossDomainIframeListener)),null!==this.bc&&(this.bc.postMessage({line:yw,source:l,context:this.contextId,projectKey:this.projectKey}),this.startTimeout=setTimeout(()=>{this.allowAppStart()},250),this.bc.onmessage=e=>{if(e.data.context!==this.contextId&&this.projectKey===e.data.projectKey){if(this.debug.log(e),e.data.line===vw){const t=e.data.token;this.session.setSessionToken(t,this.projectKey),this.allowAppStart()}if(e.data.line===bw){const t=e.data.token;this.session.regenerateTabId(),this.session.setSessionToken(t,this.projectKey),this.allowAppStart()}if(e.data.line===yw){const t=this.session.getSessionToken(this.projectKey);t&&this.bc&&this.bc.postMessage({line:e.data.source===l?bw:vw,token:t,source:l,context:this.contextId,projectKey:this.projectKey})}}else this.debug.log("same ctx event",e)})}allowAppStart(){this.canStart=!0,this.startTimeout&&(clearTimeout(this.startTimeout),this.startTimeout=null)}async checkNodeId(e){let t;if(this.pageFrames.length>0&&(t=this.pageFrames.find(t=>t.contentWindow===e)),!t||!this.pageFrames.length){const n=Array.from(document.querySelectorAll("iframe"));this.pageFrames=n,t=n.find(t=>t.contentWindow===e)}if(!t)return null;let n=0;for(;n<100;){const e=t[this.options.node_id];if(void 0!==e)return n=100,e;n++,await gw(100)}return null}initWorker(){try{this.worker=new Worker(URL.createObjectURL(new Blob(['!function(){"use strict";class t{constructor(t,s,i,e=10,n=250,h,r){this.onUnauthorised=s,this.onFailure=i,this.MAX_ATTEMPTS_COUNT=e,this.ATTEMPT_TIMEOUT=n,this.onCompress=h,this.pageNo=r,this.attemptsCount=0,this.busy=!1,this.queue=[],this.token=null,this.lastBatchNum=0,this.ingestURL=t+"/v1/web/i",this.isCompressing=void 0!==h}getQueueStatus(){return 0===this.queue.length&&!this.busy}authorise(t){this.token=t,this.busy||this.sendNext()}push(t){if(this.busy||!this.token)this.queue.push(t);else if(this.busy=!0,this.isCompressing&&this.onCompress)this.onCompress(t);else{const s=++this.lastBatchNum;this.sendBatch(t,!1,s)}}sendNext(){const t=this.queue.shift();if(t)if(this.busy=!0,this.isCompressing&&this.onCompress)this.onCompress(t);else{const s=++this.lastBatchNum;this.sendBatch(t,!1,s)}else this.busy=!1}retry(t,s,i){this.attemptsCount>=this.MAX_ATTEMPTS_COUNT?this.onFailure(`Failed to send batch after ${this.attemptsCount} attempts.`):(this.attemptsCount++,setTimeout((()=>this.sendBatch(t,s,i)),this.ATTEMPT_TIMEOUT*this.attemptsCount))}sendBatch(t,s,i){var e;const n=null==i?void 0:i.toString().replace(/^([^_]+)_([^_]+).*/,"$1_$2_$3");this.busy=!0;const h={Authorization:`Bearer ${this.token}`};s&&(h["Content-Encoding"]="gzip"),null!==this.token?fetch(`${this.ingestURL}?batch=${null!==(e=this.pageNo)&&void 0!==e?e:"noPageNum"}_${null!=n?n:"noBatchNum"}`,{body:t,method:"POST",headers:h,keepalive:t.length<65536}).then((e=>{if(401===e.status)return this.busy=!1,void this.onUnauthorised();e.status>=400?this.retry(t,s,`${null!=i?i:"noBatchNum"}_network:${e.status}`):(this.attemptsCount=0,this.sendNext())})).catch((e=>{console.warn("OpenReplay:",e),this.retry(t,s,`${null!=i?i:"noBatchNum"}_reject:${e.message}`)})):setTimeout((()=>{this.sendBatch(t,s,`${null!=i?i:"noBatchNum"}_newToken`)}),500)}sendCompressed(t){const s=++this.lastBatchNum;this.sendBatch(t,!0,s)}sendUncompressed(t){const s=++this.lastBatchNum;this.sendBatch(t,!1,s)}clean(){this.sendNext(),setTimeout((()=>{this.token=null,this.queue.length=0}),10)}}const s="function"==typeof TextEncoder?new TextEncoder:{encode(t){const s=t.length,i=new Uint8Array(3*s);let e=-1;for(let n=0,h=0,r=0;r!==s;){if(n=t.charCodeAt(r),r+=1,n>=55296&&n<=56319){if(r===s){i[e+=1]=239,i[e+=1]=191,i[e+=1]=189;break}if(h=t.charCodeAt(r),!(h>=56320&&h<=57343)){i[e+=1]=239,i[e+=1]=191,i[e+=1]=189;continue}if(n=1024*(n-55296)+h-56320+65536,r+=1,n>65535){i[e+=1]=240|n>>>18,i[e+=1]=128|n>>>12&63,i[e+=1]=128|n>>>6&63,i[e+=1]=128|63&n;continue}}n<=127?i[e+=1]=0|n:n<=2047?(i[e+=1]=192|n>>>6,i[e+=1]=128|63&n):(i[e+=1]=224|n>>>12,i[e+=1]=128|n>>>6&63,i[e+=1]=128|63&n)}return i.subarray(0,e+1)}};class i{constructor(t){this.size=t,this.offset=0,this.checkpointOffset=0,this.data=new Uint8Array(t)}getCurrentOffset(){return this.offset}checkpoint(){this.checkpointOffset=this.offset}get isEmpty(){return 0===this.offset}skip(t){return this.offset+=t,this.offset<=this.size}set(t,s){this.data.set(t,s)}boolean(t){return this.data[this.offset++]=+t,this.offset<=this.size}uint(t){for((t<0||t>Number.MAX_SAFE_INTEGER)&&(t=0);t>=128;)this.data[this.offset++]=t%256|128,t=Math.floor(t/128);return this.data[this.offset++]=t,this.offset<=this.size}int(t){return t=Math.round(t),this.uint(t>=0?2*t:-2*t-1)}string(t){const i=s.encode(t),e=i.byteLength;return!(!this.uint(e)||this.offset+e>this.size)&&(this.data.set(i,this.offset),this.offset+=e,!0)}reset(){this.offset=0,this.checkpointOffset=0}flush(){const t=this.data.slice(0,this.checkpointOffset);return this.reset(),t}}class e extends i{encode(t){switch(t[0]){case 0:case 11:case 114:case 115:return this.uint(t[1]);case 4:case 44:case 47:return this.string(t[1])&&this.string(t[2])&&this.uint(t[3]);case 5:case 20:case 38:case 70:case 75:case 76:case 77:case 82:return this.uint(t[1])&&this.uint(t[2]);case 6:return this.int(t[1])&&this.int(t[2]);case 7:return!0;case 8:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3])&&this.string(t[4])&&this.boolean(t[5]);case 9:case 10:case 24:case 35:case 51:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3]);case 12:case 52:case 61:case 71:return this.uint(t[1])&&this.string(t[2])&&this.string(t[3]);case 13:case 14:case 17:case 34:case 50:case 54:return this.uint(t[1])&&this.string(t[2]);case 16:return this.uint(t[1])&&this.int(t[2])&&this.int(t[3]);case 18:return this.uint(t[1])&&this.string(t[2])&&this.int(t[3]);case 19:return this.uint(t[1])&&this.boolean(t[2]);case 21:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4])&&this.string(t[5])&&this.uint(t[6])&&this.uint(t[7])&&this.uint(t[8]);case 22:case 27:case 30:case 41:case 45:case 46:case 43:case 63:case 64:case 79:case 124:return this.string(t[1])&&this.string(t[2]);case 23:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3])&&this.uint(t[4])&&this.uint(t[5])&&this.uint(t[6])&&this.uint(t[7])&&this.uint(t[8])&&this.uint(t[9]);case 28:case 29:case 42:case 117:case 118:return this.string(t[1]);case 37:return this.uint(t[1])&&this.string(t[2])&&this.uint(t[3]);case 39:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4])&&this.uint(t[5])&&this.uint(t[6])&&this.uint(t[7]);case 40:return this.string(t[1])&&this.uint(t[2])&&this.string(t[3])&&this.string(t[4]);case 48:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4])&&this.int(t[5]);case 49:return this.int(t[1])&&this.int(t[2])&&this.uint(t[3])&&this.uint(t[4]);case 53:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3])&&this.uint(t[4])&&this.uint(t[5])&&this.uint(t[6])&&this.string(t[7])&&this.string(t[8]);case 55:return this.boolean(t[1]);case 57:case 60:return this.uint(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4]);case 58:case 120:return this.int(t[1]);case 59:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3])&&this.uint(t[4])&&this.string(t[5])&&this.string(t[6])&&this.string(t[7]);case 67:case 73:return this.uint(t[1])&&this.string(t[2])&&this.uint(t[3])&&this.string(t[4]);case 68:return this.uint(t[1])&&this.uint(t[2])&&this.string(t[3])&&this.string(t[4])&&this.uint(t[5])&&this.uint(t[6]);case 69:return this.uint(t[1])&&this.uint(t[2])&&this.string(t[3])&&this.string(t[4]);case 78:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4]);case 81:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3])&&this.int(t[4])&&this.string(t[5]);case 83:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4])&&this.string(t[5])&&this.uint(t[6])&&this.uint(t[7])&&this.uint(t[8])&&this.uint(t[9]);case 84:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.uint(t[4])&&this.string(t[5])&&this.string(t[6]);case 112:return this.uint(t[1])&&this.string(t[2])&&this.boolean(t[3])&&this.string(t[4])&&this.int(t[5])&&this.int(t[6]);case 113:return this.uint(t[1])&&this.uint(t[2])&&this.string(t[3]);case 116:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3])&&this.uint(t[4])&&this.uint(t[5])&&this.uint(t[6])&&this.string(t[7])&&this.string(t[8])&&this.uint(t[9])&&this.boolean(t[10]);case 119:return this.string(t[1])&&this.uint(t[2]);case 121:return this.string(t[1])&&this.string(t[2])&&this.uint(t[3])&&this.uint(t[4]);case 122:return this.string(t[1])&&this.string(t[2])&&this.uint(t[3])&&this.string(t[4]);case 123:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4])&&this.uint(t[5])}}}class n{constructor(t,s,i,n,h,r){this.pageNo=t,this.timestamp=s,this.url=i,this.onBatch=n,this.tabId=h,this.onOfflineEnd=r,this.nextIndex=0,this.beaconSize=2e5,this.encoder=new e(this.beaconSize),this.sizeBuffer=new Uint8Array(3),this.isEmpty=!0,this.checkpoints=[],this.beaconSizeLimit=1e6,this.prepare()}writeType(t){return this.encoder.uint(t[0])}writeFields(t){return this.encoder.encode(t)}writeSizeAt(t,s){for(let s=0;s<3;s++)this.sizeBuffer[s]=t>>8*s;this.encoder.set(this.sizeBuffer,s)}prepare(){if(!this.encoder.isEmpty)return;this.checkpoints.length=0;const t=[81,1,this.pageNo,this.nextIndex,this.timestamp,this.url],s=[0,this.timestamp],i=[118,this.tabId];this.writeType(t),this.writeFields(t),this.writeWithSize(s),this.writeWithSize(i),this.isEmpty=!0}writeWithSize(t){const s=this.encoder;if(!this.writeType(t)||!s.skip(3))return!1;const i=s.getCurrentOffset(),e=this.writeFields(t);if(e){const e=s.getCurrentOffset()-i;if(e>16777215)return console.warn("OpenReplay: max message size overflow."),!1;this.writeSizeAt(e,i-3),s.checkpoint(),this.checkpoints.push(s.getCurrentOffset()),this.isEmpty=this.isEmpty&&0===t[0],this.nextIndex++}return e}setBeaconSizeLimit(t){this.beaconSizeLimit=t}writeMessage(t){if("q_end"===t[0])return this.finaliseBatch(),this.onOfflineEnd();0===t[0]&&(this.timestamp=t[1]),122===t[0]&&(this.url=t[1]),this.writeWithSize(t)||(this.finaliseBatch(),this.writeWithSize(t)||(this.encoder=new e(this.beaconSizeLimit),this.prepare(),this.writeWithSize(t)?this.finaliseBatch():console.warn("OpenReplay: beacon size overflow. Skipping large message.",t,this),this.encoder=new e(this.beaconSize),this.prepare()))}finaliseBatch(t=!1){if(this.isEmpty)return;const s=this.encoder.flush();this.onBatch(s,t),this.prepare()}clean(){this.encoder.reset(),this.checkpoints.length=0}}var h;!function(t){t[t.NotActive=0]="NotActive",t[t.Starting=1]="Starting",t[t.Stopping=2]="Stopping",t[t.Active=3]="Active",t[t.Stopped=4]="Stopped"}(h||(h={}));let r=null,a=null,u=h.NotActive;function o(t){a&&a.finaliseBatch(t)}function c(){return new Promise((t=>{u=h.Stopping,null!==p&&(clearInterval(p),p=null),a&&(a.clean(),a=null),r&&(r.clean(),setTimeout((()=>{r=null}),20)),setTimeout((()=>{u=h.NotActive,t(null)}),100)}))}function g(){[h.Stopped,h.Stopping].includes(u)||(postMessage("a_stop"),c().then((()=>{postMessage("a_start")})))}let l,p=null;self.onmessage=({data:s})=>{if("stop"===s)return o(),void c().then((()=>{u=h.Stopped}));if("forceFlushBatch"!==s)if("closing"!==s){if(!Array.isArray(s)){if("compressed"===s.type){if(!r)return console.debug("OR WebWorker: sender not initialised. Compressed batch."),void g();s.batch&&r.sendCompressed(s.batch)}if("uncompressed"===s.type){if(!r)return console.debug("OR WebWorker: sender not initialised. Uncompressed batch."),void g();s.batch&&r.sendUncompressed(s.batch)}return"start"===s.type?(u=h.Starting,r=new t(s.ingestPoint,(()=>{g()}),(t=>{!function(t){postMessage({type:"failure",reason:t}),c()}(t)}),s.connAttemptCount,s.connAttemptGap,(t=>{postMessage({type:"compress",batch:t},[t.buffer])}),s.pageNo),a=new n(s.pageNo,s.timestamp,s.url,((t,s)=>{r&&(s?r.sendUncompressed(t):r.push(t))}),s.tabId,(()=>postMessage({type:"queue_empty"}))),null===p&&(p=setInterval(o,3e4)),u=h.Active):"auth"===s.type?r?a?(r.authorise(s.token),void(s.beaconSizeLimit&&a.setBeaconSizeLimit(s.beaconSizeLimit))):(console.debug("OR WebWorker: writer not initialised. Received auth."),void g()):(console.debug("OR WebWorker: sender not initialised. Received auth."),void g()):void 0}if(a){const t=a;s.forEach((s=>{55===s[0]&&(s[1]?l=setTimeout((()=>g()),18e5):clearTimeout(l)),t.writeMessage(s)}))}else postMessage("not_init"),g()}else o(!0);else o()}}();\n'],{type:"text/javascript"}))),this.worker.onerror=e=>{this._debug("webworker_error",e)},this.worker.onmessage=e=>{let{data:t}=e;this.handleWorkerMsg(t)};let e=!1;const t=()=>{e||(e=!0,setTimeout(()=>{e=!1},500),this.worker&&this.worker.postMessage("closing"))};this.attachEventListener(document.body,"mouseleave",t,!1,!1),this.attachEventListener(window,"pagehide",t,!1,!1),this.attachEventListener(document,"visibilitychange",e=>"hidden"===document.visibilityState&&t(),!1)}catch(e){this._debug("worker_start",e)}}handleWorkerMsg(e){if("a_stop"===e)this.stop(!1);else if("a_start"===e)this.waitStatus(fw.NotActive).then(()=>{this.allowAppStart(),this.start(this.prevOpts,!0).then(e=>{this.debug.info("Worker restart, session too long",e)}).catch(e=>{this.debug.error("Worker restart failed",e)})});else if("not_init"===e)this.debug.warn("OR WebWorker: writer not initialised. Restarting tracker");else if("failure"===e.type)this.stop(!1),this.debug.error("worker_failed",e.reason),this._debug("worker_failed",e.reason);else if("compress"===e.type){const n=e.batch;var t;n.byteLength>this.compressionThreshold?Hb(e.batch,{mtime:0},(e,t)=>{var r,s;e?(this.debug.error("Openreplay compression error:",e),null===(r=this.worker)||void 0===r||r.postMessage({type:"uncompressed",batch:n})):null===(s=this.worker)||void 0===s||s.postMessage({type:"compressed",batch:t})}):null===(t=this.worker)||void 0===t||t.postMessage({type:"uncompressed",batch:n})}else"queue_empty"===e.type&&this.onSessionSent()}_debug(e,t){null!==this.options.__debug_report_edp&&fetch(this.options.__debug_report_edp,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({context:e,error:`${t}`})}),this.debug.error("OpenReplay error: ",e,t)}_nCommit(){if(this.socketMode)return this.messages.unshift(w_(this.timestamp()),z_(this.session.getTabId())),this.commitCallbacks.forEach(e=>e(this.messages)),void(this.messages.length=0);var e;if(this.insideIframe)return window.parent.postMessage({line:ww,messages:this.messages},(null===(e=this.options.crossdomain)||void 0===e?void 0:e.parentDomain)??"*"),this.commitCallbacks.forEach(e=>e(this.messages)),void(this.messages.length=0);if(void 0!==this.worker&&this.messages.length)if(!this.messages.length&&this.emptyBatchCounter<1e3)this.emptyBatchCounter++;else{this.emptyBatchCounter=0;try{__(()=>{var e;this.messages.unshift(w_(this.timestamp()),z_(this.session.getTabId())),null===(e=this.worker)||void 0===e||e.postMessage(this.messages),this.commitCallbacks.forEach(e=>e(this.messages)),this.messages.length=0})}catch(e){this._debug("worker_commit",e),this.stop(!0),setTimeout(()=>{this.start()},500)}}}_cStartCommit(){if(this.coldStartCommitN+=1,2===this.coldStartCommitN){const e=[w_(this.timestamp()),z_(this.session.getTabId())];this.bufferedMessages1.push(...e),this.bufferedMessages2.push(...e),this.coldStartCommitN=0}}commit(){this.activityState===fw.ColdStart?this._cStartCommit():this._nCommit()}postToWorker(e){var t;null===(t=this.worker)||void 0===t||t.postMessage(e),this.commitCallbacks.forEach(t=>t(e))}timestamp(){return r_()+this.delay}safe(e){const t=this;return function(){try{for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];e.apply(this,r)}catch(e){t._debug("safe_fn_call",e)}}}attachCommitCallback(e){this.commitCallbacks.push(e)}checkRequiredVersion(e){const t=e.split(/[.-]/),n=this.version.split(/[.-]/);for(let e=0;e<3;e++){if(isNaN(Number(n[e]))||isNaN(Number(t[e])))return!1;if(Number(n[e])>Number(t[e]))return!0;if(Number(n[e])<Number(t[e]))return!1}return!0}getTrackerInfo(){return{userUUID:this.localStorage.getItem(this.options.local_uuid_key),projectKey:this.projectKey,revID:this.revID,trackerVersion:this.version,isSnippet:this.options.__is_snippet}}getSessionInfo(){return{...this.session.getInfo(),...this.getTrackerInfo()}}getSessionToken(){return this.session.getSessionToken(this.projectKey)}getSessionID(){return this.session.getInfo().sessionID||void 0}getSessionURL(e){const{projectID:t,sessionID:n,timestamp:r}=this.session.getInfo();if(!t||!n)return void this.debug.error("OpenReplay error: Unable to build session URL");const s=this.options.ingestPoint,o=(/api\.openreplay\.com/.test(s)?"https://app.openreplay.com/ingest":s).replace(/ingest$/,`${t}/session/${n}`);return null!=e&&e.withCurrentTime?`${o}?jumpto=${r_()-r}`:o}getHost(){return new URL(this.options.ingestPoint).host}getProjectKey(){return this.projectKey}getBaseHref(){var e;return"string"==typeof this.options.resourceBaseHref?this.options.resourceBaseHref:(this.options.resourceBaseHref,document.baseURI?document.baseURI:(null===(e=document.head)||void 0===e||null===(e=e.getElementsByTagName("base")[0])||void 0===e?void 0:e.getAttribute("href"))||location.origin+location.pathname)}resolveResourceURL(e){const t=new URL(this.getBaseHref());return t.pathname+="/"+new URL(e).pathname,t.pathname.replace(/\/+/g,"/"),t.toString()}isServiceURL(e){return e.startsWith(this.options.ingestPoint)}active(){return this.activityState===fw.Active}resetNextPageSession(e){e?this.sessionStorage.setItem(this.options.session_reset_key,"t"):this.sessionStorage.removeItem(this.options.session_reset_key)}checkSessionToken(e){const t=null!==this.sessionStorage.getItem(this.options.session_reset_key),n=e||t,r=this.session.getSessionToken(this.projectKey);return n||!r}async uploadOfflineRecording(){var e,t;this.stop(!1);const n=r_();null===(e=this.worker)||void 0===e||e.postMessage({type:"start",pageNo:this.session.incPageNo(),ingestPoint:this.options.ingestPoint,timestamp:this.coldStartTs,url:document.URL,connAttemptCount:this.options.connAttemptCount,connAttemptGap:this.options.connAttemptGap,tabId:this.session.getTabId()});const r=await fetch(this.options.ingestPoint+"/v1/web/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...this.getTrackerInfo(),timestamp:n,doNotRecord:!1,bufferDiff:n-this.coldStartTs,userID:this.session.getInfo().userID,token:void 0,deviceMemory:W_,jsHeapSizeLimit:V_,timezone:mw()})}),{token:s,userBrowser:o,userCity:i,userCountry:a,userDevice:c,userOS:l,userState:u,beaconSizeLimit:d,projectID:p}=await r.json();for(null===(t=this.worker)||void 0===t||t.postMessage({type:"auth",token:s,beaconSizeLimit:d}),this.session.assign({projectID:p}),this.session.setUserInfo({userBrowser:o,userCity:i,userCountry:a,userDevice:c,userOS:l,userState:u});this.bufferedMessages1.length>0;)await this.flushBuffer(this.bufferedMessages1);this.postToWorker([["q_end"]]),this.clearBuffers()}async _start(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>2?arguments[2]:void 0;0!==Object.keys(t).length&&(this.prevOpts=t);const r=this.activityState===fw.ColdStart;if(r&&this.coldInterval&&clearInterval(this.coldInterval),!this.worker&&!this.insideIframe){const e="No worker found: perhaps, CSP is not set.";return this.signalError(e,[]),Promise.resolve(pw(e))}if(this.activityState===fw.Active||this.activityState===fw.Starting){const e="OpenReplay: trying to call `start()` on the instance that has been started already.";return Promise.resolve(pw(e))}this.activityState=fw.Starting,r||t_(),t.sessionHash&&this.session.applySessionHash(t.sessionHash),t.forceNew&&this.session.reset(),this.session.assign({userID:t.userID,metadata:t.metadata});const s=r_();null===(e=this.worker)||void 0===e||e.postMessage({type:"start",pageNo:this.session.incPageNo(),ingestPoint:this.options.ingestPoint,timestamp:r?this.coldStartTs:s,url:document.URL,connAttemptCount:this.options.connAttemptCount,connAttemptGap:this.options.connAttemptGap,tabId:this.session.getTabId()});const o=this.session.getSessionToken(this.projectKey),i=this.checkSessionToken(t.forceNew);this.sessionStorage.removeItem(this.options.session_reset_key),this.debug.log("OpenReplay: starting session; need new session id?",i,"session token: ",o);try{var a,c;const e=await window.fetch(this.options.ingestPoint+"/v1/web/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...this.getTrackerInfo(),timestamp:s,doNotRecord:!1,bufferDiff:s-this.coldStartTs,userID:this.session.getInfo().userID,token:i?void 0:o,deviceMemory:W_,jsHeapSizeLimit:V_,timezone:mw(),condition:n,assistOnly:t.assistOnly??this.socketMode,width:window.screen.width,height:window.screen.height})});if(200!==e.status){const t=await e.text(),n=t===lw?lw:`Server error: ${e.status}. ${t}`;return pw(n)}if(!this.worker&&!this.insideIframe){const e="no worker found after start request (this should not happen in real world)";return this.signalError(e,[]),pw(e)}const{token:p,userUUID:h,projectID:f,beaconSizeLimit:m,compressionThreshold:g,delay:y,sessionID:v,startTimestamp:b,userBrowser:_,userCity:S,userCountry:w,userDevice:k,userOS:x,userState:T,canvasEnabled:E,canvasQuality:I,canvasFPS:C,assistOnly:M,features:R}=await e.json();if(this.features=R||this.features,"string"!=typeof p||"string"!=typeof h||"number"!=typeof b&&void 0!==b||"string"!=typeof v||"number"!=typeof y||"number"!=typeof m&&void 0!==m){const t=`Incorrect server response: ${JSON.stringify(e)}`;return this.signalError(t,[]),pw(t)}var l,u;this.delay=y,this.session.setSessionToken(p,this.projectKey),this.session.setUserInfo({userBrowser:_,userCity:S,userCountry:w,userDevice:k,userOS:x,userState:T}),this.session.assign({sessionID:v,timestamp:b||s,projectID:f}),M?(this.socketMode=!0,null===(l=this.worker)||void 0===l||l.postMessage("stop")):null===(u=this.worker)||void 0===u||u.postMessage({type:"auth",token:p,beaconSizeLimit:m}),i||p!==o||(this.debug.log("continuing session on new tab",this.session.getTabId()),this.send(H_(this.session.getTabId()))),Object.entries(this.session.getInfo().metadata).forEach(e=>{let[t,n]=e;return this.send(E_(t,n))}),this.localStorage.setItem(this.options.local_uuid_key,h),this.compressionThreshold=g;const O={sessionToken:p,userUUID:h,sessionID:v};if(this.startCallbacks.forEach(e=>e(O)),t.startCallback&&t.startCallback(hw(O)),this.features["feature-flags"])try{this.featureFlags.reloadFlags()}catch(e){this.debug.log("Error getting feature flags",e)}if(await this.tagWatcher.fetchTags(this.options.ingestPoint,p),this.activityState=fw.Active,null!==(a=this.options.crossdomain)&&void 0!==a&&a.enabled&&this.bootChildrenFrames(),E&&!this.options.canvas.disableCanvas&&(this.canvasRecorder=this.canvasRecorder??new DS(this,{fps:C,quality:I,isDebug:this.options.canvas.__save_canvas_locally,fixedScaling:this.options.canvas.fixedCanvasScaling,useAnimationFrame:this.options.canvas.useAnimationFrame})),r){const e=this.bufferedMessages1.length>this.bufferedMessages2.length?this.bufferedMessages1:this.bufferedMessages2;for(;e.length>0;)await this.flushBuffer(e);this.clearBuffers(),this.commit()}else this.insideIframe&&this.rootId?this.observer.crossdomainObserve(this.rootId,this.frameOderNumber,this.frameLevel):this.observer.observe(),this.ticker.start();if(null===(c=this.canvasRecorder)||void 0===c||c.startTracking(),this.features["usability-test"]&&!this.insideIframe){var d;let e;this.uxtManager=this.uxtManager?this.uxtManager:new ES(this,uw);const t=this.localStorage.getItem(uw);if(t&&(e=parseInt(t,10)),null!==(d=location)&&void 0!==d&&d.search){const t=new URLSearchParams(location.search);if(t.has("oruxt")){const n=t.get("oruxt");e=n?parseInt(n,10):void 0}}e&&(this.uxtManager.isActive?this.onUxtCb.forEach(t=>t(e)):this.uxtManager.getTest(e,p,Boolean(t)).then(e=>{e&&this.onUxtCb.forEach(t=>t(e))}))}return hw(O)}catch(e){if(this.stop(),this.session.reset(),!e)return console.error("Unknown error during start"),this.signalError("Unknown error",[]),pw("Unknown error");if(e===lw)return this.signalError(lw,[]),pw(lw);this._debug("session_start",e);const t=e instanceof Error?e.message:e.toString();return this.signalError(t,[]),pw(t)}}addOnUxtCb(e){this.onUxtCb.push(e)}getUxtId(){var e;return null===(e=this.uxtManager)||void 0===e?void 0:e.getTestId()}async waitStart(){return new Promise(e=>{const t=setInterval(()=>{this.canStart&&(clearInterval(t),e(!0))},100)})}async waitStarted(){return this.waitStatus(fw.Active)}async waitStatus(e){return new Promise(t=>{const n=()=>{this.activityState===e?t(!0):setTimeout(n,25)};n()})}async start(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this.activityState===fw.Active||this.activityState===fw.Starting){const e="OpenReplay: trying to call `start()` on the instance that has been started already.";return Promise.resolve(pw(e))}return this.insideIframe&&this.signalIframeTracker(),document.hidden?new Promise(e=>{const n=async()=>{document.hidden||(await this.waitStart(),document.removeEventListener("visibilitychange",n),e(this._start(...t)))};document.addEventListener("visibilitychange",n)}):(await this.waitStart(),this._start(...t))}forceFlushBatch(){var e;null===(e=this.worker)||void 0===e||e.postMessage("forceFlushBatch")}getTabId(){return this.session.getTabId()}clearBuffers(){this.bufferedMessages1.length=0,this.bufferedMessages2.length=0}trackWs(e){var t=this;const n=e;return function(e,r){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"down";"string"!=typeof e||"string"!=typeof r||r.length>5242880||e.length>255||t.send(function(e,t,n,r,s,o){return[84,e,t,n,r,s,o]}("websocket",n,r,t.timestamp(),s,e))}}stop(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.activityState!==fw.NotActive)try{var t,n;null!==(t=this.options.crossdomain)&&void 0!==t&&t.enabled&&this.killChildrenFrames(),this.attributeSender.clear(),this.sanitizer.clear(),this.observer.disconnect(),this.nodes.clear(),this.ticker.stop(),this.stopCallbacks.forEach(e=>e()),this.tagWatcher.clear(),this.worker&&e&&this.worker.postMessage("stop"),null===(n=this.canvasRecorder)||void 0===n||n.clear(),this.messages.length=0,this.parentActive=!1}finally{this.activityState=fw.NotActive,this.debug.log("OpenReplay tracking stopped.")}}}const Cw=Qb&&"InstallTrigger"in window?e=>e.message+"\n"+e.stack:e=>e.stack||e.message;function Mw(e){return void 0===e?"undefined":null===e?"null":e instanceof Error?Cw(e):Array.isArray(e)?`Array(${e.length})`:String(e)}function Rw(e){if(void 0===e)return"undefined";if(null===e)return"null";if(e instanceof Error)return Cw(e);if(Array.isArray(e))return`Array(${e.length})[${e.slice(0,10).map(Mw).join(", ")}]`;if("object"==typeof e){const t=[];let n=0;for(const r in e){if(10===++n)break;const s=e[r];t.push(r+": "+Mw(s))}return"{"+t.join(", ")+"}"}return e.toString()}const Ow=["log","info","warn","error","debug","assert"];function Aw(e,t){const n=Object.assign({consoleMethods:Ow,consoleThrottling:30},t);if(!Array.isArray(n.consoleMethods)||0===n.consoleMethods.length)return;const r=e.safe((t,n)=>{let r=function(e){return"string"==typeof e[0]&&e.unshift(e.shift().replace(/%(o|s|f|d|i)/g,(t,n)=>{const r=e.shift();if(void 0===r)return t;switch(n){case"o":return Rw(r);case"s":return Mw(r);case"f":return function(e){return"number"!=typeof e?"NaN":e.toString()}(r);case"d":case"i":return function(e){return"number"!=typeof e?"NaN":Math.floor(e).toString()}(r);default:return t}})),e.map(Rw).join(" ")}(n);e.sanitizer.privateMode&&(r=r.replaceAll(/./g,"*")),e.send(function(e,t){return[22,e,t]}(t,r))});let s=0;const o=()=>{s=0};e.attachStartCallback(o),e.ticker.attach(o,33,!1);const i=e.safe(t=>((t,o)=>{const i={apply:function(e,t,i){Reflect.apply(e,o,i),s+=1,s>n.consoleThrottling||r(e.name,i)}};n.consoleMethods.forEach(n=>{if(-1===Ow.indexOf(n))return void e.debug.error(`OpenReplay: unsupported console method "${n}"`);const r=o.console[n];t[n]=new Proxy(r,i)})})(t.console,t));i(window),e.observer.attachContextCallback(i)}const Nw=/(^|@)\S+:\d+/,Dw=/^\s*at .*(\S+:\d+|\(native\))/m,Lw=/^(eval@)?(\[native code\])?$/;function Pw(e){if(!e.includes(":"))return[e,void 0,void 0];const t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]}function Fw(e,t){return e}function jw(e){return[{columnNumber:e.colno,lineNumber:e.lineno,fileName:e.filename,functionName:"",source:""}]}function $w(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t;try{r=function(e){return function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return!(t=e).stacktrace||t.message.includes("\n")&&t.message.split("\n").length>t.stacktrace.split("\n").length?function(e){const t=/Line (\d+).*script (?:in )?(\S+)/i,n=e.message.split("\n"),r=[];for(let e=2,s=n.length;e<s;e+=2){const s=t.exec(n[e]);s&&r.push({file:s[2],line:+s[1],raw:n[e]})}return Fw(r)}(t):t.stack?function(e){return Fw(e.stack.split("\n").filter(e=>!!e.match(Nw)&&!e.match(/^Error created at/))).map(e=>{const t=e.split("@"),n=Pw(t.pop()),r=t.shift()||"",s=r.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;let o;return r.match(/\(([^)]*)\)/)&&(o=r.replace(/^[^(]+\(([^)]*)\)$/,"$1")),{function:s,args:void 0===o||"[arguments not available]"===o?void 0:o.split(","),file:n[0],line:n[1]?+n[1]:void 0,col:n[2]?+n[2]:void 0,raw:e}})}(t):function(e){const t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=e.stacktrace.split("\n"),r=[];for(let e=0,s=n.length;e<s;e+=2){const s=t.exec(n[e]);s&&r.push({function:s[3]||void 0,file:s[2],line:s[1]?+s[1]:void 0,raw:n[e]})}return Fw(r)}(t);var t;if(e.stack&&e.stack.match(Dw))return function(e){return Fw(e.stack.split("\n").filter(e=>!!e.match(Dw))).map(e=>{e.includes("(eval ")&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));let t=e.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,"");const n=t.match(/ (\(.+\)$)/);t=n?t.replace(n[0],""):t;const r=Pw(n?n[1]:t);return{function:n&&t||void 0,file:["eval","<anonymous>"].includes(r[0])?void 0:r[0],line:r[1]?+r[1]:void 0,col:r[2]?+r[2]:void 0,raw:e}})}(e);if(e.stack)return function(e){return Fw(e.stack.split("\n").filter(e=>!e.match(Lw))).map(e=>{if(e.includes(" > eval")&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),e.includes("@")||e.includes(":")){const t=/(([^\n\r"\u2028\u2029]*".[^\n\r"\u2028\u2029]*"[^\n\r@\u2028\u2029]*(?:@[^\n\r"\u2028\u2029]*"[^\n\r@\u2028\u2029]*)*(?:[\n\r\u2028\u2029][^@]*)?)?[^@]*)@/,n=e.match(t),r=n&&n[1]?n[1]:void 0,s=Pw(e.replace(t,""));return{function:r,file:s[0],line:s[1]?+s[1]:void 0,col:s[2]?+s[2]:void 0,raw:e}}return{function:e}})}(e);throw new Error("Cannot parse given Error object")}(e).map(e=>({functionName:e.function,args:e.args,fileName:e.file,lineNumber:e.line,columnNumber:e.col,source:e.raw}))}(e)}catch(e){}return F_(e.name,e.message,JSON.stringify(r),JSON.stringify(n))}function Bw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e instanceof ErrorEvent){if(e.error instanceof Error)return $w(e.error,jw(e),n);{let[t,r]=e.message.split(":");return r||(t="Error",r=e.message),F_(t,r,JSON.stringify(jw(e)),JSON.stringify(n))}}if("PromiseRejectionEvent"in t&&e instanceof t.PromiseRejectionEvent){if(e.reason instanceof Error)return $w(e.reason,[],n);{let t;try{t=JSON.stringify(e.reason)}catch(n){t=String(e.reason)}return F_("Unhandled Promise Rejection",t,"[]",JSON.stringify(n))}}return null}function Uw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.location;return(e=e.trim()).startsWith("//")||e.startsWith("http://")||e.startsWith("https://")||e.startsWith("data:")?e:e.startsWith("/")?t.origin+e:t.origin+t.pathname+e}const Hw=["text","password","email","search","number","range","date","tel","time"],zw=Qb&&"labels"in HTMLInputElement.prototype?e=>{let t=e;for(;null!==(t=t.parentNode);)if(NS(t,"label"))return t;const n=e.labels;if(null!==n&&1===n.length)return n[0]}:e=>{let t=e;for(;null!==(t=t.parentNode);)if(NS(t,"label"))return t;const n=e.id;if(n){const t=e.ownerDocument.querySelectorAll('label[for="'+n+'"]');if(null!==t&&1===t.length)return t[0]}};function qw(e){let t=u_(e);if(null===t){const n=zw(e);t=n&&n.innerText||e.placeholder||e.name||e.id||e.className||e.type}return o_(t).slice(0,100)}const Ww="undefined"!=typeof CSS&&CSS.escape||(e=>e),Vw=new WeakMap;function Jw(e){const t=e.tagName.toUpperCase();return"BUTTON"===t||"A"===t||"LI"===t||"SELECT"===t||"TR"===t||"TH"===t||null!=e.onclick||"button"===e.getAttribute("role")}function Kw(e,t){return e instanceof Element?function(e,t){let n=e;for(;null!==n&&n!==t.documentElement;){if(d_(n,"masked"))return null;n=n.parentElement}if(CS(e)){let t=e.ownerSVGElement;for(;null!==t;)e=t,t=t.ownerSVGElement}for(n=e;null!==n&&n!==t.documentElement;){const e=n.tagName.toUpperCase();if("LABEL"===e)return null;if("INPUT"===e)return n;if(Jw(n)||null!==u_(n))return n;n=n.parentElement}return e===t.documentElement?null:e}(e,t):null}function Gw(e,t){const{disableClickmaps:n=!1}=t||{};let r,s=-1,o=-1,i=!1,a=null,c=0,l={},u=0,d=0,p=0,h=0;e.attachStartCallback(()=>{r=setInterval(()=>function(){const t=h/225;u?(p>4&&(t-u)/225>.008&&e.send([114,r_()]),h=0,p=0,u=t):u=t}(),225)}),e.attachStopCallback(()=>{s=-1,o=-1,i=!1,a=null,l={},r&&clearInterval(r)});const f=()=>{i&&(e.send(function(e,t){return[20,e,t]}(s,o)),i=!1)},m=function(t){const r=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.attachEventListener.bind(e):e.nodes.attachNodeListener.bind(e.nodes);r(t.documentElement,"mouseover",e=>{const n=Kw(e.target,t);n!==a&&(a=n,c=performance.now())}),r(t,"mousemove",n=>{const[r,a]=e.observer.getDocumentOffset(t);s=n.clientX+r,o=n.clientY+a,i=!0;const c=Math.sign(n.movementX);h+=Math.abs(n.movementX)+Math.abs(n.movementY),c!==d&&(d=c,p++)},!1),r(t,"click",r=>{const s=Kw(r.target,t);if(!r.clientX&&!r.clientY||null===s)return;const o=e.nodes.getID(s);if(void 0!==o){const i=r.pageX,u=r.pageY,d=t.documentElement.scrollWidth,p=t.documentElement.scrollHeight,h=Xw(i/d),m=Xw(u/p);f();const g=function(t){const n=u_(t);if(null!==n)return n;if(NS(t,"input"))return qw(t);if(Jw(t)){let n="";return t instanceof HTMLElement&&(n=e.sanitizer.getInnerTextSecure(t)),n=n||t.id||t.className,o_(n).slice(0,100)}return""}(s);e.send(function(e,t,n,r,s,o){return[68,e,t,n,r,s,o]}(o,a===s?Math.round(performance.now()-c):0,e.sanitizer.privateMode?g.replaceAll(/./g,"*"):g,Jw(s)&&!n?function(e,t){return l[e]=l[e]||function(e){return function(e){if(!e||1!==e.nodeType)return!1;if(e.id)return`#${Ww(e.id)}`;const t=[];for(;e&&1===e.nodeType&&e!==e.ownerDocument;){var n;if(e.id){t.unshift(`#${Ww(e.id)}`);break}const r=e.tagName.toLowerCase();if(null!==(n=e.classList)&&void 0!==n&&n.length)for(const n of e.classList)if(Qw(n)&&Yw(n,e.ownerDocument))return t.unshift(`${r}.${Ww(n)}`),t.join(" > ");const s=Zw(e);if(s)t.unshift(`${r}.${Ww(s)}`);else if(e===e.ownerDocument.body||e===e.ownerDocument.documentElement)t.unshift(r);else{let n=1;for(let t=e.previousElementSibling;t;t=t.previousElementSibling)t.tagName.toLowerCase()===r&&n++;t.unshift(`${r}:nth-of-type(${n})`)}e=e.parentNode}return t.join(" > ")}(e)||""}(t)}(o,s):"",h,m),!0)}a=null})};e.nodes.attachNodeCallback(e=>{OS(e)&&m(e)}),m(document,!0),e.ticker.attach(f,(null==t?void 0:t.trackingOffset)||7)}function Xw(e){return Math.round(1e4*e)}function Yw(e,t){let n=Vw.get(t);if(n||(n=Object.create(null),Vw.set(t,n)),e in n)return n[e];const r=1===t.querySelectorAll(`.${Ww(e)}`).length;return n[e]=r,r}function Qw(e){if(/^[a-z\-]{3,}$/i.test(e)){const t=e.split(/-|[A-Z]/);for(const e of t){if(e.length<=2)return!1;if(/[^aeiou]{4,}/i.test(e))return!1}return!0}return!1}function Zw(e){var t;if(null===(t=e.classList)||void 0===t||!t.length||!e.parentNode)return null;const n=e.parentNode.children;e:for(const t of e.classList)if(Qw(t)&&Yw(t,e.ownerDocument)){for(const s of n){var r;if(s!==e&&null!==(r=s.classList)&&void 0!==r&&r.contains(t))continue e}return t}return null}let ek=-1;const tk=e=>{addEventListener("pageshow",t=>{t.persisted&&(ek=t.timeStamp,e(t))},!0)},nk=(e,t,n,r)=>{let s,o;return i=>{t.value>=0&&(i||r)&&(o=t.value-(s??0),(o||void 0===s)&&(s=t.value,t.delta=o,t.rating=((e,t)=>e>t[1]?"poor":e>t[0]?"needs-improvement":"good")(t.value,n),e(t)))}},rk=e=>{requestAnimationFrame(()=>requestAnimationFrame(()=>e()))},sk=()=>{const e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},ok=()=>{const e=sk();return(null==e?void 0:e.activationStart)??0},ik=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=sk();let r="navigate";return ek>=0?r="back-forward-cache":n&&(document.prerendering||ok()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},ak=new WeakMap;function ck(e,t){return ak.get(e)||ak.set(e,new t),ak.get(e)}class lk{constructor(){Kv(this,"t",void 0),Kv(this,"i",0),Kv(this,"o",[])}h(e){var t;if(e.hadRecentInput)return;const n=this.o[0],r=this.o.at(-1);this.i&&n&&r&&e.startTime-r.startTime<1e3&&e.startTime-n.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),null===(t=this.t)||void 0===t||t.call(this,e)}}const uk=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const r=new PerformanceObserver(e=>{Promise.resolve().then(()=>{t(e.getEntries())})});return r.observe({type:e,buffered:!0,...n}),r}}catch{}},dk=e=>{let t=!1;return()=>{t||(e(),t=!0)}};let pk=-1;const hk=new Set,fk=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,mk=e=>{if("hidden"===document.visibilityState){if("visibilitychange"===e.type)for(const e of hk)e();isFinite(pk)||(pk="visibilitychange"===e.type?e.timeStamp:0,removeEventListener("prerenderingchange",mk,!0))}},gk=()=>{if(pk<0){var e;const t=ok(),n=document.prerendering||null===(e=globalThis.performance.getEntriesByType("visibility-state").filter(e=>"hidden"===e.name&&e.startTime>t)[0])||void 0===e?void 0:e.startTime;pk=n??fk(),addEventListener("visibilitychange",mk,!0),addEventListener("prerenderingchange",mk,!0),tk(()=>{setTimeout(()=>{pk=fk()})})}return{get firstHiddenTime(){return pk},onHidden(e){hk.add(e)}}},yk=e=>{document.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},vk=[1800,3e3],bk=[.1,.25];let _k=0,Sk=1/0,wk=0;const kk=e=>{for(const t of e)t.interactionId&&(Sk=Math.min(Sk,t.interactionId),wk=Math.max(wk,t.interactionId),_k=wk?(wk-Sk)/7+1:0)};let xk;const Tk=()=>xk?_k:performance.interactionCount??0;let Ek=0;class Ik{constructor(){Kv(this,"u",[]),Kv(this,"l",new Map),Kv(this,"m",void 0),Kv(this,"p",void 0)}v(){Ek=Tk(),this.u.length=0,this.l.clear()}L(){const e=Math.min(this.u.length-1,Math.floor((Tk()-Ek)/50));return this.u[e]}h(e){var t;if(null!==(t=this.m)&&void 0!==t&&t.call(this,e),!e.interactionId&&"first-input"!==e.entryType)return;const n=this.u.at(-1);let r=this.l.get(e.interactionId);if(r||this.u.length<10||e.duration>n.P){var s;if(r?e.duration>r.P?(r.entries=[e],r.P=e.duration):e.duration===r.P&&e.startTime===r.entries[0].startTime&&r.entries.push(e):(r={id:e.interactionId,entries:[e],P:e.duration},this.l.set(r.id,r),this.u.push(r)),this.u.sort((e,t)=>t.P-e.P),this.u.length>10){const e=this.u.splice(10);for(const t of e)this.l.delete(t.id)}null===(s=this.p)||void 0===s||s.call(this,r)}}}const Ck=e=>{const t=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?e():(e=dk(e),addEventListener("visibilitychange",e,{once:!0,capture:!0}),t(()=>{e(),removeEventListener("visibilitychange",e,{capture:!0})}))},Mk=[200,500];class Rk{constructor(){Kv(this,"m",void 0)}h(e){var t;null===(t=this.m)||void 0===t||t.call(this,e)}}const Ok=[2500,4e3],Ak=[800,1800],Nk=e=>{document.prerendering?yk(()=>Nk(e)):"complete"!==document.readyState?addEventListener("load",()=>Nk(e),!0):setTimeout(e)};function Dk(e,t){const n=Object.assign({captureResourceTimings:!0,capturePageLoadTimings:!0,capturePageRenderTimings:!0,excludedResourceUrls:[]},t);if("PerformanceObserver"in window||(n.captureResourceTimings=!1),!n.captureResourceTimings)return;let r={};function s(t){var s;if(t.duration<0||!i_(t.name)||e.isServiceURL(t.name))return;null!==r&&(r[t.name]=t.startTime+t.duration);let o=!1;if(null===(s=n.excludedResourceUrls)||void 0===s||s.forEach(e=>{t.name.startsWith(e)&&(o=!0)}),o)return;const i=n.resourceNameSanitizer?n.resourceNameSanitizer(t.name):t.name,a=t.responseStatus&&304===t.responseStatus||t.deliveryType&&"cache"===t.deliveryType||0===t.transferSize&&t.decodedBodySize>0,c=t.responseStatus&&t.responseStatus>=400?-111:t.decodedBodySize||0;e.send(U_(t.startTime+n_(),t.duration,t.responseStart&&t.startTime?t.responseStart-t.startTime:0,t.transferSize>t.encodedBodySize?t.transferSize-t.encodedBodySize:0,t.encodedBodySize||0,c,e.sanitizer.privateMode?t.name.replaceAll(/./g,"*"):i,t.initiatorType,t.transferSize,a))}const o=new PerformanceObserver(e=>e.getEntries().forEach(s));function i(t){if(e.active())return e.send((n=t.name,r=String(t.value),[124,n,r]));var n,r}e.attachStartCallback(function(e){let{sessionID:t}=e;o.observe({type:"resource",buffered:!0}),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=gk();!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};yk(()=>{const n=gk();let r,s=ik("FCP");const o=uk("paint",e=>{for(const t of e)"first-contentful-paint"===t.name&&(o.disconnect(),t.startTime<n.firstHiddenTime&&(s.value=Math.max(t.startTime-ok(),0),s.entries.push(t),r(!0)))});o&&(r=nk(e,s,vk,t.reportAllChanges),tk(n=>{s=ik("FCP"),r=nk(e,s,vk,t.reportAllChanges),rk(()=>{s.value=performance.now()-n.timeStamp,r(!0)})}))})}(dk(()=>{let r,s=ik("CLS",0);const o=ck(t,lk),i=e=>{for(const t of e)o.h(t);o.i>s.value&&(s.value=o.i,s.entries=o.o,r())},a=uk("layout-shift",i);a&&(r=nk(e,s,bk,t.reportAllChanges),n.onHidden(()=>{i(a.takeRecords()),r(!0)}),tk(()=>{o.i=0,s=ik("CLS",0),r=nk(e,s,bk,t.reportAllChanges),rk(()=>r())}),setTimeout(r))}))}(i),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const n=gk();yk(()=>{"interactionCount"in performance||xk||(xk=uk("event",kk,{type:"event",buffered:!0,durationThreshold:0}));let r,s=ik("INP");const o=ck(t,Ik),i=e=>{Ck(()=>{for(const t of e)o.h(t);const t=o.L();t&&t.P!==s.value&&(s.value=t.P,s.entries=t.entries,r())})},a=uk("event",i,{durationThreshold:t.durationThreshold??40});r=nk(e,s,Mk,t.reportAllChanges),a&&(a.observe({type:"first-input",buffered:!0}),n.onHidden(()=>{i(a.takeRecords()),r(!0)}),tk(()=>{o.v(),s=ik("INP"),r=nk(e,s,Mk,t.reportAllChanges)}))})}(i),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};yk(()=>{const n=gk();let r,s=ik("LCP");const o=ck(t,Rk),i=e=>{t.reportAllChanges||(e=e.slice(-1));for(const t of e)o.h(t),t.startTime<n.firstHiddenTime&&(s.value=Math.max(t.startTime-ok(),0),s.entries=[t],r())},a=uk("largest-contentful-paint",i);if(a){r=nk(e,s,Ok,t.reportAllChanges);const n=dk(()=>{i(a.takeRecords()),a.disconnect(),r(!0)}),o=e=>{e.isTrusted&&(Ck(n),removeEventListener(e.type,o,{capture:!0}))};for(const e of["keydown","click","visibilitychange"])addEventListener(e,o,{capture:!0});tk(n=>{s=ik("LCP"),r=nk(e,s,Ok,t.reportAllChanges),rk(()=>{s.value=performance.now()-n.timeStamp,r(!0)})})}})}(i),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=ik("TTFB"),r=nk(e,n,Ak,t.reportAllChanges);Nk(()=>{const s=sk();s&&(n.value=Math.max(s.responseStart-ok(),0),n.entries=[s],r(!0),tk(()=>{n=ik("TTFB",0),r=nk(e,n,Ak,t.reportAllChanges),r(!0)}))})}(i)}),e.attachStopCallback(function(){o.disconnect()});let a=0,c=0;if(n.capturePageLoadTimings){let t=!1;e.ticker.attach(()=>{if(!t&&(0!==a&&0!==c||performance.getEntriesByType("paint").forEach(e=>{const{name:t,startTime:n}=e;switch(t){case"first-paint":a=n;break;case"first-contentful-paint":c=n}}),performance.timing.loadEventEnd||performance.now()>3e4)){t=!0;const{navigationStart:n,requestStart:r,responseStart:s,responseEnd:o,domContentLoadedEventStart:i,domContentLoadedEventEnd:l,loadEventStart:u,loadEventEnd:d}=performance.timing;e.send(function(e,t,n,r,s,o,i,a,c){return[23,e,t,n,r,s,o,i,a,c]}(r-n||0,s-n||0,o-n||0,i-n||0,l-n||0,u-n||0,d-n||0,a,c))}},30)}if(n.capturePageRenderTimings){let t=0,n=0,s=0,o=null,i=!1;e.ticker.attach(()=>{if(i)return;const l=performance.now();if(null!==r&&(t=Math.max.apply(null,Object.keys(r).map(e=>r[e])),l-t>1e3&&(o=function(e){const t=[],n=document.getElementsByTagName("*"),r=/url\(("[^"]*"|'[^']*'|[^)]*)\)/i;for(let s=0;s<n.length;s++){const o=n[s];let i="";if(NS(o,"img")&&(i=o.currentSrc||o.src),!i){const e=getComputedStyle(o).getPropertyValue("background-image");if(e){const t=r.exec(e);null!==t&&(i=t[1],(i.startsWith('"')||i.startsWith("'"))&&(i=i.substr(1,i.length-2)))}}if(!i)continue;const a="data:image"===i.substr(0,10)?0:e[i];if(void 0===a)continue;const c=o.getBoundingClientRect(),l=Math.max(c.top,0),u=Math.max(c.left,0),d=Math.min(c.bottom,window.innerHeight||document.documentElement&&document.documentElement.clientHeight||0),p=Math.min(c.right,window.innerWidth||document.documentElement&&document.documentElement.clientWidth||0);if(d<=l||p<=u)continue;const h=(d-l)*(p-u);t.push({time:a,area:h})}return t}(r),r=null)),null!==s&&(l-s>50&&(n=l),s=l-n>5e3?null:l),null!==o&&null===s||l>3e4){i=!0,r=null;const l=null===o?0:function(e,t){let n=Math.max(document.documentElement&&document.documentElement.clientWidth||0,window.innerWidth||0)*Math.max(document.documentElement&&document.documentElement.clientHeight||0,window.innerHeight||0)/10,r=n*e;for(let s=0;s<t.length;s++){const{time:o,area:i}=t[s];n+=i,r+=i*(o>e?o:e)}return 0===n?0:r/n}(c||a,o),{domContentLoadedEventEnd:u,navigationStart:d}=performance.timing,p=null===s?Math.max(n,c,u-d||0):0;e.send(function(e,t,n){return[24,e,t,n]}(l,c>t?c:t,p))}})}}function Lk(e){const t=e.defaultView;return[t&&t.scrollX||e.documentElement&&e.documentElement.scrollLeft||e.body&&e.body.scrollLeft||0,t&&t.scrollY||e.documentElement&&e.documentElement.scrollTop||e.body&&e.body.scrollTop||0]}const Pk={checkCssInterval:200,scanInMemoryCSS:!1,checkLimit:void 0};const Fk=new Set(["password","pass","pwd","mdp","token","bearer","jwt","api_key","api-key","apiKey","secret","ssn","zip","zipcode","x-api-key","www-authenticate","x-csrf-token","x-requested-with","x-forwarded-for","x-real-ip","cookie","authorization","auth","proxy-authorization","set-cookie","account_key"]);function jk(e){if("number"==typeof e){const t=function(e){return 1+(0|Math.log10((e^e>>31)-(e>>31)))}(e);return"9".repeat(t)}return"string"==typeof e?e.replace(/[^\f\n\r\t\v\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff\s]/g,"*"):e}function $k(e){const t={};if(Array.isArray(e))e.forEach(e=>{let{name:n,value:r}=e;Fk.has(n.toLowerCase())?t[n]=jk(r):t[n]=r});else for(const[n,r]of Object.entries(e))Fk.has(n.toLowerCase())?t[n]=jk(r):t[n]=r;return t}function Bk(e){if(!e)return e;let t,n=!1;try{t=JSON.parse(e),n=!0}catch(e){}if(n)return Uk(t),JSON.stringify(t);if("string"!=typeof e||!e.includes("?")||!e.includes("="))return e;try{const t=new URLSearchParams(e);for(const e of t.keys())if(Fk.has(e.toLowerCase())){const n=jk(t.get(e));t.set(e,n)}return t.toString()}catch(t){return e}}function Uk(e){if(Array.isArray(e))e.forEach(Uk);else if(e&&"object"==typeof e)for(const t in e)Object.hasOwn(e,t)&&(Fk.has(t.toLowerCase())?e[t]=jk(e[t]):null!==e[t]&&"object"==typeof e[t]&&Uk(e[t]))}function Hk(e){if(!e)return"";try{const t=new URL(e);if(t.searchParams)for(const e of t.searchParams.keys())Fk.has(e.toLowerCase())&&t.searchParams.set(e,"******");return t.toString()}catch(t){return e}}class zk{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;this.ignoredHeaders=e,this.setSessionTokenHeader=t,this.sanitize=n,this.id="",this.name="",this.method="",this.url="",this.status=0,this.statusText="",this.cancelState=0,this.readyState=0,this.header={},this.responseType="",this.requestType="xhr",this.requestHeader={},this.responseSize=0,this.responseSizeText="",this.startTime=0,this.endTime=0,this.duration=0,this.getData={},this.requestData=null}getMessage(){const{reqHs:e,resHs:t}=this.writeHeaders(),n="GET"===this.method?JSON.stringify((Uk(r=this.getData),r)):Bk(this.requestData);var r;const s={headers:$k(e),body:n},o={headers:$k(t),body:Bk(this.response)},i=this.sanitize({url:Hk(this.url),method:this.method,status:this.status,request:s,response:o});if(!i)return null;const a=i.url.includes("/graphql")||Object.values(i.request.headers).some(e=>e.includes("application/graphql-response"));if(a&&i.response.body&&"string"==typeof i.response.body){const e=i.response.body.includes("errors");i.status=e?400:200,this.requestType="graphql"}return{requestType:this.requestType,method:i.method,url:i.url,request:JSON.stringify(i.request),response:JSON.stringify(i.response),status:i.status,startTime:this.startTime,duration:this.duration,responseSize:this.responseSize}}writeHeaders(){const e={};Object.entries(this.requestHeader).forEach(t=>{let[n,r]=t;this.isHeaderIgnored(n)||(e[n]=r)}),this.setSessionTokenHeader((t,n)=>{e[t]=n});const t={};return Object.entries(this.header).forEach(e=>{let[n,r]=e;this.isHeaderIgnored(n)||(t[n]=r)}),{reqHs:e,resHs:t}}isHeaderIgnored(e){return Array.isArray(this.ignoredHeaders)?this.ignoredHeaders.map(e=>e.toLowerCase()).includes(e.toLowerCase()):this.ignoredHeaders}}const qk=(e,t)=>{let n="";switch(e){case"":case"text":case"json":"string"==typeof t?n=t:Vk(t)||Array.isArray(t)?n=JSON.stringify(t):void 0!==t&&(n=Object.prototype.toString.call(t));break;default:void 0!==t&&(n=Object.prototype.toString.call(t))}return n},Wk=e=>{if(!e)return null;let t;try{if("string"==typeof e){"{"!==e[0]&&"["!==e[0]||(t=e);const n=e.split("&");t=1===n.length?e:n.join(",")}else if(null==(n=e)||ArrayBuffer.isView(n)||"undefined"==typeof Symbol||"function"!=typeof n[Symbol.iterator])t=e instanceof Blob||e instanceof ReadableStream||e instanceof ArrayBuffer?"byte data":Vk(e)?e:"can't parse body "+typeof e;else{const n=[];for(const[t,r]of e)n.push(`${t}=${"string"==typeof r?r:"[object Object]"}`);t=n.join(",")}return t}catch(e){return"can't parse body"}var n};function Vk(e){return null!==e&&"object"==typeof e}function Jk(e){return e<=0?"":e>=1e6?(e/1e3/1e3).toFixed(1)+" MB":e>=1e3?(e/1e3).toFixed(1)+" KB":`${e}B`}const Kk=e=>(e.startsWith("//")&&(e=`${new URL(window.location.href).protocol}${e}`),e.startsWith("http")?new URL(e):new URL(e,window.location.href)),Gk=e=>e instanceof Blob?e.type:e instanceof FormData?"multipart/form-data":e instanceof URLSearchParams?"application/x-www-form-urlencoded;charset=UTF-8":"text/plain;charset=UTF-8";class Xk{constructor(e,t,n,r,s){this.ignoredHeaders=e,this.setSessionTokenHeader=t,this.sanitize=n,this.sendMessage=r,this.isServiceUrl=s}apply(e,t,n){const r=n[0],s=n[1],o=new zk(this.ignoredHeaders,this.setSessionTokenHeader,this.sanitize);if(this.isServiceUrl(r))return e.apply(t,n);const i=Kk(r);if(o.method="POST",o.url=r,o.name=(i.pathname.split("/").pop()||"")+i.search,o.requestType="beacon",o.requestHeader={"Content-Type":Gk(s)},o.status=0,o.statusText="Pending",i.search&&i.searchParams){o.getData={};for(const[e,t]of i.searchParams)o.getData[e]=t}o.requestData=Wk(s),o.startTime||(o.startTime=performance.now());const a=e.apply(t,n);a?(o.endTime=performance.now(),o.duration=o.endTime-(o.startTime||o.endTime),o.status=0,o.statusText="Sent",o.readyState=4):(o.status=500,o.statusText="Unknown");const c=o.getMessage();return c&&this.sendMessage(c),a}}class Yk{static create(e,t,n,r,s,o){if(e)return new Proxy(e,new Xk(t,n,r,s,o))}}class Qk{constructor(e,t){this.resp=e,this.item=t}set(e,t,n){return Reflect.set(e,t,n)}get(e,t){const n=Reflect.get(e,t);if("arrayBuffer"===t||"blob"===t)return"function"==typeof n?n.bind(e):n;switch(t){case"formData":case"json":case"text":return()=>(this.item.responseType=t.toLowerCase(),n.apply(e).then(e=>(this.item.response=qk(this.item.responseType,e),e)))}return"function"==typeof n?n.bind(e):n}}class Zk{constructor(e,t,n,r,s,o){this.ignoredHeaders=e,this.setSessionTokenHeader=t,this.sanitize=n,this.sendMessage=r,this.isServiceUrl=s,this.tokenUrlMatcher=o}apply(e,t,n){var r;const s=n[0],o=n[1];if(!s||"string"!=typeof s&&!(null==s?void 0:s.url))return e.apply(window,n);if(s instanceof URL||"string"==typeof s?this.isServiceUrl(String(s)):this.isServiceUrl(String(s.url)))return e.apply(window,n);const i=new zk(this.ignoredHeaders,this.setSessionTokenHeader,this.sanitize);this.beforeFetch(i,s,o);const a=(n[0]instanceof Request?n[0].signal:void 0)||(null===(r=n[1])||void 0===r?void 0:r.signal);let c=!1;const l=()=>{if(c)return;c=!0,i.endTime=performance.now(),i.duration=i.endTime-(i.startTime||i.endTime),i.status=0,i.statusText="Aborted",i.readyState=0;const e=i.getMessage();e&&this.sendMessage(e)};return a&&(a.aborted?l():a.addEventListener("abort",l,{once:!0})),this.setSessionTokenHeader((e,t)=>{if(void 0===this.tokenUrlMatcher||this.tokenUrlMatcher(i.url))return void 0===n[1]&&n[0]instanceof Request?n[0].headers.append(e,t):(n[1]||(n[1]={}),void 0===n[1].headers&&(n[1]=Object.assign(Object.assign({},n[1]),{headers:{}})),void(n[1].headers instanceof Headers?n[1].headers.append(e,t):Array.isArray(n[1].headers)?n[1].headers.push([e,t]):n[1].headers[e]=t))}),e.apply(window,n).then(this.afterFetch(i,()=>{c=!0})).catch(e=>{if(i.endTime=performance.now(),i.duration=i.endTime-(i.startTime||i.endTime),e&&"AbortError"===e.name&&(i.status=0,i.statusText="Aborted",i.readyState=0,!c)){const e=i.getMessage();e&&this.sendMessage(e)}throw e})}beforeFetch(e,t,n){let r,s="GET",o={};if("string"==typeof t?(s=(null==n?void 0:n.method)||"GET",r=Kk(t),o=(null==n?void 0:n.headers)||{}):(s=t.method||"GET",r=Kk(t.url),o=t.headers),e.method=s,e.requestType="fetch",e.requestHeader=o,e.url=r.toString(),e.name=(r.pathname.split("/").pop()||"")+r.search,e.status=0,e.statusText="Pending",e.readyState=1,e.startTime||(e.startTime=performance.now()),"[object Headers]"===Object.prototype.toString.call(o)){e.requestHeader={};for(const[t,n]of o)e.requestHeader[t]=n}else e.requestHeader=o;if(r.search&&r.searchParams){e.getData={};for(const[t,n]of r.searchParams)e.getData[t]=n}(null==n?void 0:n.body)&&(e.requestData=Wk(n.body))}afterFetch(e,t){return n=>{t&&(null==t||t()),e.endTime=performance.now(),e.duration=e.endTime-(e.startTime||e.endTime),e.status=n.status,e.statusText=String(n.status);let r=!1;e.header={};for(const[t,s]of n.headers)e.header[t]=s,r=s.toLowerCase().indexOf("chunked")>-1||r;r?e.readyState=3:(e.readyState=4,this.handleResponseBody(n.clone(),e).then(t=>{e.responseSize="string"==typeof t?t.length:t.byteLength,e.responseSizeText=Jk(e.responseSize),e.response=qk(e.responseType,t);const n=e.getMessage();n&&this.sendMessage(n)}).catch(t=>{if("AbortError"!==t.name)throw t;{e.status=0,e.statusText="Aborted",e.readyState=0;const t=e.getMessage();t&&this.sendMessage(t)}}));const s=(n.headers.get("content-type")||"").toLowerCase();return s.includes("application/json")||s.startsWith("text/")?new Proxy(n,new Qk(n,e)):n}}handleResponseBody(e,t){const n=e.headers.get("content-type");return n&&n.includes("application/json")?(t.responseType="json",e.text()):n&&(n.includes("text/html")||n.includes("text/plain"))?(t.responseType="text",e.text()):(t.responseType="arraybuffer",e.arrayBuffer())}}class ex{static create(e,t,n,r,s,o){return new Proxy(fetch,new Zk(e,t,n,r,s,o))}}var tx;!function(e){e[e.UNSENT=0]="UNSENT",e[e.OPENED=1]="OPENED",e[e.HEADERS_RECEIVED=2]="HEADERS_RECEIVED",e[e.LOADING=3]="LOADING",e[e.DONE=4]="DONE"}(tx||(tx={}));class nx{constructor(e,t,n,r,s,o,i){this.ignoredHeaders=t,this.setSessionTokenHeader=n,this.sanitize=r,this.sendMessage=s,this.isServiceUrl=o,this.tokenUrlMatcher=i,this.XMLReq=e,this.XMLReq.onreadystatechange=()=>{this.onReadyStateChange()},this.XMLReq.onabort=()=>{this.onAbort()},this.XMLReq.ontimeout=()=>{this.onTimeout()},this.item=new zk(t,n,r),this.item.requestType="xhr"}get(e,t){switch(t){case"open":return this.getOpen(e);case"send":return this.setSessionTokenHeader((t,n)=>{(void 0===this.tokenUrlMatcher||this.tokenUrlMatcher(this.item.url))&&1===e.readyState&&e.setRequestHeader(t,n)}),this.getSend(e);case"setRequestHeader":return this.getSetRequestHeader(e);default:const n=Reflect.get(e,t);return"function"==typeof n?n.bind(e):n}}set(e,t,n){switch(t){case"onreadystatechange":return this.setOnReadyStateChange(e,t,n);case"onabort":return this.setOnAbort(e,t,n);case"ontimeout":return this.setOnTimeout(e,t,n)}return Reflect.set(e,t,n)}onReadyStateChange(){if(this.item.url&&this.isServiceUrl(this.item.url))return;this.item.readyState=this.XMLReq.readyState,this.item.responseType=this.XMLReq.responseType,this.item.endTime=performance.now(),this.item.duration=this.item.endTime-this.item.startTime,this.updateItemByReadyState();const e=this.item.responseType||"";if(""!==e&&"text"!==e&&"json"!==e||setTimeout(()=>{this.item.response=qk(e,this.XMLReq.response)},0),this.XMLReq.readyState===tx.DONE){const e=this.item.getMessage();e&&this.sendMessage(e)}}onAbort(){this.item.cancelState=1,this.item.statusText="Abort";const e=this.item.getMessage();e&&this.sendMessage(e)}onTimeout(){this.item.cancelState=3,this.item.statusText="Timeout";const e=this.item.getMessage();e&&this.sendMessage(e)}getOpen(e){var t=this;const n=Reflect.get(e,"open");return function(){for(var r,s,o,i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];const l=a[0],u=a[1];return t.item.method=l?l.toUpperCase():"GET",t.item.url=(null===(r=u.toString)||void 0===r?void 0:r.call(u))||"",t.item.name=null!==(o=null===(s=t.item.url)||void 0===s?void 0:s.replace(new RegExp("/*$"),"").split("/").pop())&&void 0!==o?o:"",t.item.getData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Vk(t)||(t={});let n=e?e.split("?"):[];if(n.shift(),n.length>0){n=n.join("?").split("&");for(const e of n){const n=e.split("=");try{t[n[0]]=decodeURIComponent(n[1])}catch(e){t[n[0]]=n[1]}}}return t}(t.item.url,{}),n.apply(e,a)}}getSend(e){var t=this;const n=Reflect.get(e,"send");return function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];const i=s[0];return t.item.requestData=Wk(i),n.apply(e,s)}}getSetRequestHeader(e){var t=this;const n=Reflect.get(e,"setRequestHeader");return function(){t.item.requestHeader||(t.item.requestHeader={});for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return t.item.requestHeader[s[0]]=s[1],n.apply(e,s)}}setOnReadyStateChange(e,t,n){var r=this;return Reflect.set(e,t,function(){r.onReadyStateChange();for(var t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];null==n||n.apply(e,s)})}setOnAbort(e,t,n){var r=this;return Reflect.set(e,t,function(){r.onAbort();for(var t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];n.apply(e,s)})}setOnTimeout(e,t,n){var r=this;return Reflect.set(e,t,function(){r.onTimeout();for(var t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];n.apply(e,s)})}updateItemByReadyState(){switch(this.XMLReq.readyState){case tx.UNSENT:case tx.OPENED:this.item.status=tx.UNSENT,this.item.statusText="Pending",this.item.startTime||(this.item.startTime=performance.now());break;case tx.HEADERS_RECEIVED:this.item.status=this.XMLReq.status,this.item.statusText="Loading",this.item.header={};const e=(this.XMLReq.getAllResponseHeaders()||"").split("\n");for(let t=0;t<e.length;t++){const n=e[t];if(!n)continue;const r=n.split(": "),s=r[0];this.item.header[s]=r.slice(1).join(": ")}break;case tx.LOADING:this.item.status=this.XMLReq.status,this.item.statusText="Loading";const t=this.XMLReq.response;if(t){const e="string"==typeof t?t.length:t instanceof ArrayBuffer?t.byteLength:"undefined"!=typeof Blob&&t instanceof Blob?t.size:0;e&&(this.item.responseSize=e,this.item.responseSizeText=Jk(this.item.responseSize))}break;case tx.DONE:this.item.status=this.XMLReq.status||this.item.status||0,this.item.statusText=String(this.item.status),this.item.endTime=performance.now(),this.item.duration=this.item.endTime-(this.item.startTime||this.item.endTime);const n=this.XMLReq.response,r=this.XMLReq.responseType||"";if(""!==r&&"text"!==r&&"json"!==r||(this.item.response=n),n){const e="string"==typeof n?n.length:n instanceof ArrayBuffer?n.byteLength:"undefined"!=typeof Blob&&n instanceof Blob?n.size:0;e&&(this.item.responseSize=e,this.item.responseSizeText=Jk(e))}break;default:this.item.status=this.XMLReq.status,this.item.statusText="Unknown"}}}class rx{static create(e,t,n,r,s,o){return new Proxy(XMLHttpRequest,{construct(i){const a=new i;return new Proxy(a,new nx(a,e,t,n,r,s,o))}})}}const sx=e=>{const t=`Openreplay: Can't find ${e} in global context.`;console.warn(t)},ox=Symbol("OpenReplayProxyOriginal"),ix=e=>(e=>!!e&&void 0!==e[ox])(e)?e[ox]:e,ax=(e,t)=>(e[ox]=t,e);function cx(e){return e.__or_req_data__||(e.__or_req_data__={body:void 0,headers:{}}),e.__or_req_data__}function lx(e){return"string"==typeof e?e.toUpperCase():"GET"}function ux(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.disabled)return;const n=Object.assign({failuresOnly:!1,ignoreHeaders:["cookie","set-cookie","authorization"],capturePayload:!1,sessionTokenHeader:!1,captureInIframes:!0,axiosInstances:void 0,useProxy:!0},t);!1===n.useProxy&&e.debug.warn("Network module is migrating to proxy api, to gradually migrate and test it set useProxy to true");const r=n.ignoreHeaders,s=Array.isArray(r)?e=>r.includes(e):()=>r,o=!0===n.sessionTokenHeader?"X-OpenReplay-SessionToken":n.sessionTokenHeader;function i(t){if(o){const n=e.getSessionToken();n&&e.safe(t)(o,n)}}function a(t){if(n.capturePayload&&!e.sanitizer.privateMode||(delete t.request.body,delete t.response.body),n.sanitizer){const e=t.response.body;if("string"==typeof e)try{t.response.body=JSON.parse(e)}catch{}return n.sanitizer(t)}return t}function c(t){if(t&&"string"!=typeof t.body)try{t.body=JSON.stringify(t.body)}catch{t.body="<unable to stringify>",e.notify.warn("Openreplay fetch couldn't stringify body:",t.body)}return JSON.stringify(t)}const l=t=>{if(n.useProxy)return function(e,t,n,r,s,o){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{xhr:!0,fetch:!0,beacon:!0},a=arguments.length>7?arguments[7]:void 0;var c;if(e){if(i.xhr){const i=ix(e.XMLHttpRequest);i?e.XMLHttpRequest=ax(rx.create(t,n,r,s,o,a),i):sx("XMLHttpRequest")}if(i.fetch){const i=ix(e.fetch);i?e.fetch=ax(ex.create(t,n,r,s,o,a),i):sx("fetch")}if(i.beacon&&(null===(c=e.navigator)||void 0===c?void 0:c.sendBeacon)){const i=ix(e.navigator.sendBeacon);e.navigator.sendBeacon=ax(Yk.create(i,t,n,r,s,o),i)}}}(t,!!e.sanitizer.privateMode||n.ignoreHeaders,i,a,t=>{if(n.failuresOnly&&t.status<400)return;const r=e.sanitizer.privateMode?"************":t.url;e.send(j_(t.requestType,t.method,r,t.request,t.response,t.status,t.startTime+n_(),t.duration,t.responseSize))},t=>e.isServiceURL(t),{xhr:!0,fetch:!0,beacon:!0},n.tokenUrlMatcher);const o=t.fetch.bind(t);t.fetch=function(t){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!("string"==typeof t||t instanceof URL)||e.isServiceURL(String(t)))return o(t,l);i(function(e,t){void 0===l.headers&&(l.headers={}),l.headers instanceof Headers?l.headers.append(e,t):Array.isArray(l.headers)?l.headers.push([e,t]):l.headers[e]=t});const u=performance.now();return o(t,l).then(o=>{const i=performance.now()-u;if(n.failuresOnly&&o.status<400)return o;const d=o.clone();return d.text().then(n=>{const o={},p={};if(!0!==r){const e=e=>{let[t,n]=e;s(t)||(o[t]=n)};l.headers instanceof Headers?l.headers.forEach((t,n)=>e([n,t])):Array.isArray(l.headers)?l.headers.forEach(e):"object"==typeof l.headers&&Object.entries(l.headers).forEach(e),d.headers.forEach((e,t)=>{s(t)||(p[t]=e)})}const h=lx(l.method),f=a({url:String(t),method:h,status:d.status,request:{headers:o,body:l.body||null},response:{headers:p,body:n}});f&&e.send(j_("fetch",h,String(f.url),c(f.request),c(f.response),d.status,u+n_(),i,0))}).catch(t=>e.debug.error("Could not process Fetch response:",t)),o})};const l=t.XMLHttpRequest.prototype.open,u=t.XMLHttpRequest.prototype.setRequestHeader,d=t.XMLHttpRequest.prototype.send;n.axiosInstances||(t.XMLHttpRequest.prototype.open=function(t,n){const r=this;i((e,t)=>r.setRequestHeader(e,t));let o=0;return r.addEventListener("loadstart",e=>{o=e.timeStamp}),r.addEventListener("load",e.safe(i=>{const{headers:l,body:u}=cx(r),d=o>0?i.timeStamp-o:0,p=(r.getAllResponseHeaders()||"").trim().split(/[\r\n]+/),h={};p.forEach(function(e){const t=e.split(": "),n=t.shift();s(n)||(h[n]=t.join(": "))});const f=lx(t),m=a({url:String(n),method:f,status:r.status,request:{headers:l,body:u||null},response:{headers:h,body:r.response}});m&&e.send(j_("xhr",f,String(m.url),c(m.request),c(m.response),r.status,o+n_(),d,0))})),l.apply(this,arguments)},t.XMLHttpRequest.prototype.send=function(e){return cx(this).body=e,d.apply(this,arguments)},t.XMLHttpRequest.prototype.setRequestHeader=function(e,t){return s(e)||(cx(this).headers[e]=t),u.apply(this,arguments)})};l(window),n.axiosInstances&&n.axiosInstances.forEach(t=>{!function(e,t,n,r,s){function o(t){e.debug.log("Openreplay: capturing axios response data",t);const{headers:o,data:i,method:a,url:c,baseURL:l}=t.config,{data:u,headers:d,status:p,response:h}=t,{data:f,headers:m,status:g}=h||{},y=n.ignoreHeaders,v=Array.isArray(y)?e=>y.includes(e):()=>y;function b(e,t){v(t[0])||(e[t[0]]=t[1])}let _={},S={};o.toJSON?_=o.toJSON():o instanceof Headers?o.forEach((e,t)=>b(_,[t,e])):Array.isArray(o)?o.forEach(e=>b(_,e)):"object"==typeof o&&Object.entries(o).forEach(e=>b(_,e));const w=m||d;w.toJSON?S=w.toJSON():w instanceof Headers?w.forEach((e,t)=>b(S,[t,e])):Array.isArray(w)?w.forEach(e=>b(S,e)):"object"==typeof w&&Object.entries(w).forEach(e=>{let[t,n]=e;v(t)||(S[t]=n)});const k=r({url:c,method:a||"",status:p||g||0,request:{headers:_,body:i},response:{headers:S,body:f||u}});if(!k)return void e.debug.log("Openreplay: empty request/response info, skipping");const x=t.config.__openreplay_timing,T=performance.now()-x;e.debug.log("Openreplay: final req object",k),e.send(j_("xhr",String(a),String(k.url),s(k.request),s(k.response),k.status,x+n_(),T,0))}e.debug.log("Openreplay: attaching axios spy to instance",t);const i=t.interceptors.request.use(function(t){if(e.debug.log("Openreplay: capturing API request",t),t.__openreplay_timing=performance.now(),n.sessionTokenHeader){const r="string"==typeof n.sessionTokenHeader?n.sessionTokenHeader:"X-OpenReplay-Session-Token",s=e.getSessionToken();s&&t.headers.set(r,s)}return t},function(t){e.debug.log("Openreplay: failed API request, skipping",t)},{synchronous:!0}),a=t.interceptors.response.use(function(e){return n.failuresOnly||o(e),e},function(t){var n,r;return e.debug.log("Openreplay: capturing API request error",t),null!==(r=n=t)&&"object"==typeof r&&!0===n.isAxiosError&&Boolean(t.response)?o(t.response):t instanceof Error&&e.send($w(t,[])),Promise.reject(t)},{synchronous:!0});e.attachStopCallback(()=>{var e,n,r,s;null===(e=(n=t.interceptors.request).eject)||void 0===e||e.call(n,i),null===(r=(s=t.interceptors.response).eject)||void 0===r||r.call(s,a)})}(e,t,n,a,c)}),n.captureInIframes&&e.observer.attachContextCallback(e.safe(l))}const dx="/en/sdk/constructor";class px{constructor(e){var t,n,r=this;if(this.options=e,this.app=null,this.crossdomainMode=!1,this.checkDoNotTrack=()=>this.options.respectDoNotTrack&&("1"==navigator.doNotTrack||"1"==window.doNotTrack),this.signalStartIssue=(e,t)=>{const n=this.checkDoNotTrack();console.log("Tracker couldn't start due to:",JSON.stringify({trackerVersion:"16.4.10",projectKey:this.options.projectKey,doNotTrack:n,reason:t.length?`missing api: ${t.join(",")}`:e}))},this.restartCanvasTracking=()=>{null!==this.app&&this.app.restartCanvasTracking()},this.handleError=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!==r.app)if(e instanceof Error){const n=$w(e,[],t);r.app.send(n)}else if(e instanceof ErrorEvent||"PromiseRejectionEvent"in window&&e instanceof PromiseRejectionEvent){const n=Bw(e,void 0,t);null!=n&&r.app.send(n)}},this.crossdomainMode=Boolean(f_()&&(null===(t=e.crossdomain)||void 0===t?void 0:t.enabled)),!Qb||!function(e){if(null==e)return console.error(`OpenReplay: invalid options argument type. Please, check documentation on ${a_}${dx}`),!1;if("string"!=typeof e.projectKey)if("number"!=typeof e.projectKey){if("number"!=typeof e.projectID)return console.error(`OpenReplay: projectKey is missing or wrong type (string is expected). Please, check ${a_}${dx} for more information.`),!1;e.projectKey=e.projectID.toString(),l_("`projectID` option","`projectKey` option",dx)}else console.warn("OpenReplay: projectKey is expected to have a string type."),e.projectKey=e.projectKey.toString();return null!=e.sessionToken&&l_("`sessionToken` option","`sessionHash` start() option","/"),!0}(e))return;if(window.__OPENREPLAY__||!this.crossdomainMode&&f_()&&(()=>{try{var e;return Boolean(null===(e=window.top)||void 0===e?void 0:e.document)}catch{return!1}})()&&window.top.__OPENREPLAY__)return void console.error("OpenReplay: one tracker instance has been initialised already");if(!e.__DISABLE_SECURE_MODE&&"https:"!==location.protocol)return void console.error("OpenReplay: Your website must be publicly accessible and running on SSL in order for OpenReplay to properly capture and replay the user session. You can disable this check by setting `__DISABLE_SECURE_MODE` option to `true` if you are testing in localhost. Keep in mind, that asset files on a local machine are not available to the outside world. This might affect tracking if you use css files.");const s=[],o=["Map","Set","MutationObserver","performance","timing","startsWith","Blob","Worker"];if(this.checkDoNotTrack())s.push("doNotTrack");else for(const e of o)if("timing"===e){if("performance"in window&&!(e in performance)){s.push(e);break}}else if("startsWith"===e){if(!(e in String.prototype)){s.push(e);break}}else if(!(e in window)){s.push(e);break}if(s.length>0){const e=s.join(",");return console.error(`OpenReplay: browser doesn't support API required for tracking or doNotTrack is set to 1. Reason: ${e}`),void this.signalStartIssue("missing_api",s)}const i=new Iw(e.projectKey,e.sessionToken,e,this.signalStartIssue,this.crossdomainMode);this.app=i,this.crossdomainMode||(function(e,t){let n,r,s,o,i=document.referrer;const a=(null==t?void 0:t.urlSanitizer)||(e=>e),c=(null==t?void 0:t.titleSanitizer)||(e=>e),l=e.safe(()=>{const{URL:t}=document;if(t!==n){n=t;const r=a(n),s=e.sanitizer.privateMode?ow(document.title):c(document.title),l=e.sanitizer.privateMode?ow(r):r,u=e.sanitizer.privateMode?ow(i):i;e.send(function(e,t,n,r){return[122,e,t,n,r]}(l,u,o,s)),o=0,i=n}}),u=e.safe(()=>{const{innerWidth:t,innerHeight:n}=window;t===r&&n===s||(r=t,s=n,e.send(function(e,t){return[5,e,t]}(r,s)))}),d=void 0===document.hidden?Function.prototype:e.safe(()=>e.send([55,document.hidden]));e.attachStartCallback(()=>{n=null,o=n_(),r=s=-1,l(),u(),d()}),void 0!==document.hidden&&e.attachEventListener(document,"visibilitychange",d,!1,!1),e.ticker.attach(l,1,!1),e.ticker.attach(u,5,!1)}(i,e.urls),function(e){const t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(void 0===t)return;const n=()=>{return e.send((n=Math.round(1e3*t.downlink),r=t.type||"unknown",[54,n,r]));var n,r};n(),t.addEventListener("change",n)}(i),function(e,t){if(!Object.assign({capturePerformance:!0},t).capturePerformance)return;let n,r;const s=()=>{void 0!==n&&-1!==n&&(n++,requestAnimationFrame(s))};e.ticker.attach(()=>{void 0!==r&&-1!==r&&r++},0,!1);const o=()=>{void 0!==n&&void 0!==r&&(e.send(function(e,t,n,r){return[49,e,t,n,r]}(n,r,q_.memory.totalJSHeapSize||0,q_.memory.usedJSHeapSize||0)),r=n=document.hidden?-1:0)};e.attachStartCallback(()=>{r=n=-1,o(),s()}),e.attachStopCallback(()=>{r=n=void 0}),e.ticker.attach(o,165,!1),void 0!==document.hidden&&e.attachEventListener(document,"visibilitychange",o,!1,!1)}(i,e),function(e){e.attachEventListener(window,"focus",function(){document.hidden||(e.debug.log("Openreplay: tab change to"+e.session.getTabId()),e.send(H_(e.session.getTabId())))},!1,!1)}(i)),Gw(i,e.mouse),function(e,t){let n=!1;const r=new Map;function s(e){IS(e)&&(MS(e)&&r.set(e,[e.scrollLeft,e.scrollTop]),OS(e)&&r.set(e,Lk(e)))}const o=e.safe(()=>{t||e.send(function(e,t){return[6,e,t]}(...Lk(document)))}),i=e.safe((t,n)=>{const r=e.nodes.getID(n);void 0!==r&&e.send(function(e,t,n){return[16,e,t,n]}(r,t[0],t[1]))});e.attachStartCallback(o),e.attachStopCallback(()=>{n=!1,r.clear()}),e.nodes.attachNodeCallback((t,n)=>{n&&(MS(t)&&t.scrollLeft+t.scrollTop>0?r.set(t,[t.scrollLeft,t.scrollTop]):OS(t)&&r.set(t,Lk(t))),AS(t)&&e.nodes.attachNodeListener(t,"scroll",e=>{s(e.target)})}),e.attachEventListener(document,"scroll",e=>{const t=e.target;t!==document?s(t):n=!0}),e.ticker.attach(()=>{n&&(o(),n=!1),r.forEach(i),r.clear()},5,!1)}(i,this.crossdomainMode),function(e,t){if(null===e)return;if(!window.CSSStyleSheet)return void e.send((n="no_stylesheet_prototype_in_window",r="",[63,n,r]));var n,r;const s={...Pk,...t},o=new Map;let i=null;const a=new Set,c=s.checkCssInterval||200;let l={};function u(){if(!s.scanInMemoryCSS)return;const t=a.values();for(const n of t)try{const t=qS.get(n);if(!t)continue;if(s.checkLimit&&(l[t]?l[t]++:l[t]=0,l[t]>s.checkLimit))return void a.delete(n);for(let r=0;r<n.cssRules.length;r++)try{const s=n.cssRules[r],i=`${t}:${r}`,a=o.get(i),c=s.cssText;a!==c&&(void 0!==a?(e.send(D_(t,r)),e.send(N_(t,c,r,e.getBaseHref()))):e.send(N_(t,c,r,e.getBaseHref())),o.set(i,c))}catch(e){}const r=Array.from(o.keys()).filter(e=>e.startsWith(`${t}:`));for(const e of r)parseInt(e.split(":")[1],10)>=n.cssRules.length&&o.delete(e)}catch(e){a.delete(n)}}const d=/{\s*}/;function p(e){return d.test(e)}const h=e.safe((t,n,r)=>{const s=qS.get(t);s&&("string"==typeof r?(e.send(N_(s,r,n,e.getBaseHref())),p(r)&&(o.set(`${s}:${n}`,r),a.add(t))):(e.send(D_(s,n)),o.has(`${s}:${n}`)&&o.delete(`${s}:${n}`)))}),f=e.safe(t=>{let n=t;for(;n.parentRule;)n=n.parentRule;const r=n.parentStyleSheet;if(!r)return;const s=qS.get(r);if(!s)return;const i=n.cssText,c=Array.from(r.cssRules).indexOf(n);c>=0&&(e.send(N_(s,i,c,e.getBaseHref())),e.send(D_(s,c+1)),p(i)&&(o.set(`${s}:${c}`,i),a.add(r)))}),m=e.safe(e=>{if(e.__css_tracking_patched__)return;e.__css_tracking_patched__=!0;const{insertRule:t,deleteRule:n}=e.CSSStyleSheet.prototype,{insertRule:r,deleteRule:s}=e.CSSGroupingRule.prototype;e.CSSStyleSheet.prototype.insertRule=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=t.call(this,e,n);return h(this,r,e),r},e.CSSStyleSheet.prototype.deleteRule=function(e){return h(this,e),n.call(this,e)},e.CSSGroupingRule.prototype.insertRule=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=r.call(this,e,t);return f(this),n},e.CSSGroupingRule.prototype.deleteRule=function(e){const t=s.call(this,e);return f(this),t}});m(window),e.observer.attachContextCallback(m),e.nodes.attachNodeCallback(t=>{if(!NS(t,"style")||!t.sheet)return;if(null!==t.textContent&&t.textContent.trim().length>0)return;const n=e.nodes.getID(t);if(!n)return;const r=t.sheet,s=zS();qS.set(r,s),e.send(L_(s,n));for(let e=0;e<r.cssRules.length;e++)try{h(r,e,r.cssRules[e].cssText)}catch(e){}}),setTimeout(function(){!i&&s.scanInMemoryCSS&&(i=window.setInterval(u,c))},50),e.attachStopCallback(()=>{i&&(clearInterval(i),i=null),o.clear()})}(i,e.css),function(e){if(null===e)return;if(!US(document))return;const t=new Map,n=new Map,r=r=>setTimeout(()=>{let s=e.nodes.getID(r);if(r===document&&(s=0),void 0===s)return;let o=n.get(s);o||(o=[]);const i=[],a=r.adoptedStyleSheets;if(a&&Symbol.iterator in a)for(const n of a){let r=t.get(n);const a=!r;if(r||(r=zS(),t.set(n,r)),o.includes(r)||e.send(L_(r,s)),a){const t=n.cssRules;for(let n=0;n<t.length;n++)e.send(N_(r,t[n].cssText,n,e.getBaseHref()))}i.push(r)}if(Symbol.iterator in o)for(const t of o)i.includes(t)||e.send(P_(t,s));n.set(s,i)},20);function s(e){const t=Object.getOwnPropertyDescriptor(e,"adoptedStyleSheets");t&&Object.defineProperty(e,"adoptedStyleSheets",{...t,set:function(e){const n=t.set.call(this,e);return r(this),n}})}const o=n=>{if(n.__openreplay_adpss_patched__)return;n.__openreplay_adpss_patched__=!0,s(n.Document.prototype),s(n.ShadowRoot.prototype);const{replace:r,replaceSync:o}=n.CSSStyleSheet.prototype;n.CSSStyleSheet.prototype.replace=function(n){return r.call(this,n).then(r=>{const s=t.get(this);return s&&e.send(A_(s,n,e.getBaseHref())),r})},n.CSSStyleSheet.prototype.replaceSync=function(n){const r=t.get(this);return r&&e.send(A_(r,n,e.getBaseHref())),o.call(this,n)}};o(window),e.observer.attachContextCallback(e.safe(o)),e.attachStopCallback(()=>{t.clear(),n.clear()}),e.attachStartCallback(()=>{r(document)}),e.nodes.attachNodeCallback(e=>{US(e)&&r(e)})}(i),Aw(i,e),function(e,t){function n(t){function n(n){const r=Bw(n,t);null!=r&&e.send(r)}try{e.attachEventListener(t,"unhandledrejection",n),e.attachEventListener(t,"error",n)}catch(e){console.error("Error while attaching to error proto contexts",e)}}Object.assign({captureExceptions:!0},t).captureExceptions&&(e.observer.attachContextCallback(n),n(window))}(i,e),function(e){function t(t,n){e.attributeSender.sendSetAttribute(t,"src","https://static.openreplay.com/tracker/placeholder.jpeg");const{width:r,height:s}=n.getBoundingClientRect();n.hasAttribute("width")||e.attributeSender.sendSetAttribute(t,"width",String(r)),n.hasAttribute("height")||e.attributeSender.sendSetAttribute(t,"height",String(s))}const n=function(t,n){const{srcset:r}=n;if(!r)return;const s=r.split(r.match(/,\s+/)?/,\s+/:",").map(e=>Uw(e)).join(", ");e.attributeSender.sendSetAttribute(t,"srcset",s)},r=function(n,r){r.src.length>1e5&&t(n,r),e.send(M_(n,"src",r.src,e.getBaseHref()))},s=e.safe(function(t){const n=Uw(t.src||"");i_(n)&&e.send(U_(e.timestamp(),0,0,0,0,0,n,"img",0,!1))}),o=e.safe(function(o){const i=e.nodes.getID(o);var a;void 0!==i&&o.complete&&(0!==o.naturalHeight||0!==o.naturalWidth||(a=o.src,Zb&&(a.startsWith("data:image/svg+xml")||a.match(/.svg$|/i)))?e.sanitizer.isHidden(i)||e.sanitizer.isObscured(i)?t(i,o):(r(i,o),n(i,o)):s(o))}),i=g_(e.safe(t=>{for(const s of t)if("attributes"===s.type){const t=s.target,o=e.nodes.getID(t);if(void 0===o)return;"src"===s.attributeName&&r(o,t),"srcset"===s.attributeName&&n(o,t)}}),e.options.forceNgOff);e.attachStopCallback(()=>{i.disconnect()}),e.nodes.attachNodeCallback(t=>{NS(t,"img")&&(e.nodes.attachNodeListener(t,"error",()=>s(t)),e.nodes.attachNodeListener(t,"load",()=>o(t)),o(t),i.observe(t,{attributes:!0,attributeFilter:["src","srcset"]}))})}(i),function(e,t){const n=Object.assign({obscureInputNumbers:!0,obscureInputEmails:!0,defaultInputMode:1,obscureInputDates:!1},t);function r(t,r){let s=r.value,o=n.defaultInputMode;"password"===r.type||e.sanitizer.isHidden(t)?o=2:(e.sanitizer.isObscured(t)||0===o&&(n.obscureInputNumbers&&"date"!==r.type&&/\d\d\d\d/.test(s)||n.obscureInputDates&&"date"===r.type||n.obscureInputEmails&&("email"===r.type||~s.indexOf("@"))))&&(o=1);let i=0;switch(o){case 2:i=-1,s="";break;case 1:i=s.length,s=""}return{value:s,mask:i}}function s(t,n){const{value:s,mask:o}=r(t,n);e.send(function(e,t,n){return[18,e,t,n]}(t,s,o))}const o=new Map,i=new Map;function a(e,t){o.get(e)!==t.value&&(o.set(e,t.value),s(e,t))}function c(t,n){i.get(t)!==n&&(i.set(t,n),e.send(function(e,t){return[19,e,t]}(t,n)))}e.attachStopCallback(()=>{o.clear(),i.clear()}),e.ticker.attach(()=>{o.forEach((t,n)=>{const r=e.nodes.getNode(n);if(!r)return o.delete(n);a(n,r)}),i.forEach((t,n)=>{const r=e.nodes.getNode(n);if(!r)return i.delete(n);c(n,r.checked)})},3),e.nodes.attachNodeCallback(e.safe(t=>{const n=e.nodes.getID(t);if(void 0!==n){if(NS(t,"select")&&(s(n,t),e.nodes.attachNodeListener(t,"change",()=>s(n,t))),function(e){return!!NS(e,"textarea")||!!NS(e,"input")&&Hw.includes(e.type)}(t)){a(n,t);let s=0,o=0,i=0;const c=()=>{s=r_()},l=()=>{0===o&&0!==s&&(o=r_()-s)},u=()=>{0!==s&&(i=r_()-s),function(t,n,s,o){const{value:i,mask:a}=r(t,n);let c=qw(n);e.sanitizer.privateMode&&(c=c.replaceAll(/./g,"*")),e.send(function(e,t,n,r,s,o){return[112,e,t,n,r,s,o]}(t,i,0!==a,c,s,o))}(n,t,o,i),o=0,i=0,s=0};return e.nodes.attachNodeListener(t,"focus",c),e.nodes.attachNodeListener(t,"input",l),void e.nodes.attachNodeListener(t,"change",u)}return function(e){if(!NS(e,"input"))return!1;const t=e.type;return"checkbox"===t||"radio"===t}(t)?(c(n,t.checked),void e.nodes.attachNodeListener(t,"change",()=>c(n,t.checked))):void 0}}))}(i,e),Dk(i,e),function(e){function t(t){const n=e.nodes.getID(t);void 0!==n&&e.send(C_(n))}let n=!1;e.nodes.attachNodeCallback(r=>{NS(r,"body")&&(e.nodes.attachNodeListener(r,"focus",e=>{IS(e.target)&&(t(e.target),n=!1)}),e.nodes.attachNodeListener(r,"blur",t=>{null===t.relatedTarget&&(n=!0,setTimeout(()=>{n&&e.send(C_(-1))},0))}))}),e.attachStartCallback(()=>{let e=document.activeElement;for(;e&&NS(e,"iframe")&&e.contentDocument;)e=e.contentDocument.activeElement;e&&e!==e.ownerDocument.body&&t(e)},!0)}(i),function(e){if(!window.FontFace)return;const t=new Map,n=n=>{class r extends n.FontFace{constructor(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];if("string"==typeof s[1]){let r="";s[2]&&e.safe(()=>{r=JSON.stringify(s[2])});const o=[s[0],s[1],r],i=t.get(n.document)||[];i.push(o),t.set(n.document,i);const a=n===window?0:e.nodes.getID(n.document);if(void 0===a)return;e.active()&&e.send(I_(a,...o))}super(...s)}}n.FontFace=r};e.observer.attachContextCallback(n),n(window),e.nodes.attachNodeCallback(e.safe(n=>{if(!OS(n))return;const r=t.get(n);if(!r)return;const s=n.defaultView===window?0:e.nodes.getID(n);void 0!==s&&r.forEach(t=>{e.send(I_(s,...t))})}))}(i),(null===(n=e.network)||void 0===n?void 0:n.disabled)||ux(i,e.network),function(e){e.attachEventListener(document,"selectionchange",()=>{const t=document.getSelection();if(null===t||t.isCollapsed)e.send($_(-1,-1,""));else{const n=e.nodes.getID(t.anchorNode),r=e.nodes.getID(t.focusNode),s=t.toString().replace(/\s+/g," ");n&&r&&e.send($_(n,r,s))}})}(i),window.__OPENREPLAY__=this,e.flags&&e.flags.onFlagsLoad&&this.onFlagsLoad(e.flags.onFlagsLoad);const a=window.open;(e.autoResetOnWindowOpen||e.resetTabOnWindowOpen)&&(i.attachStartCallback(()=>{const t=i.getTabId(),n=i.sessionStorage??window.sessionStorage;window.open=function(){e.autoResetOnWindowOpen&&i.resetNextPageSession(!0),e.resetTabOnWindowOpen&&n.removeItem(e.session_tabid_key||"__openreplay_tabid"),i.resetNextPageSession(!1),n.setItem(e.session_tabid_key||"__openreplay_tabid",t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return a.call(window,...s)}}),i.attachStopCallback(()=>{window.open=a}))}isFlagEnabled(e){return this.featureFlags.isFlagEnabled(e)}onFlagsLoad(e){var t;null===(t=this.app)||void 0===t||t.featureFlags.onFlagsLoad(e)}clearPersistFlags(){var e;null===(e=this.app)||void 0===e||e.featureFlags.clearPersistFlags()}reloadFlags(){var e;return null===(e=this.app)||void 0===e?void 0:e.featureFlags.reloadFlags()}getFeatureFlag(e){var t;return null===(t=this.app)||void 0===t?void 0:t.featureFlags.getFeatureFlag(e)}getAllFeatureFlags(){var e;return null===(e=this.app)||void 0===e?void 0:e.featureFlags.flags}use(e){return e(this.app,this.options)}isActive(){return null!==this.app&&this.app.active()}trackWs(e){if(null!==this.app)return this.app.trackWs(e)}start(e){return this.browserEnvCheck()?null===this.app?Promise.reject("Browser doesn't support required api, or doNotTrack is active."):this.app.start(e):Promise.reject("Trying to start not in browser.")}browserEnvCheck(){return!!Qb||(console.error(`OpenReplay: you are trying to start Tracker on a node.js environment. If you want to use OpenReplay with SSR, please, use componentDidMount or useEffect API for placing the \`tracker.start()\` line. Check documentation on ${a_}${dx}`),!1)}coldStart(e,t){return this.browserEnvCheck()?null===this.app?Promise.reject("Tracker not initialized"):void this.app.coldStart(e,t):Promise.reject("Trying to start not in browser.")}startOfflineRecording(e,t){return this.browserEnvCheck()?null===this.app?Promise.reject("Tracker not initialized"):this.app.offlineRecording(e,t):Promise.reject("Trying to start not in browser.")}uploadOfflineRecording(){if(null!==this.app)return this.app.uploadOfflineRecording()}stop(){if(null!==this.app)return this.app.stop(),this.app.session.getSessionHash()}forceFlushBatch(){null!==this.app&&this.app.forceFlushBatch()}getSessionToken(){return null===this.app?null:this.app.getSessionToken()}getSessionInfo(){return null===this.app?null:this.app.session.getInfo()}getSessionID(){return null===this.app?null:this.app.getSessionID()}getTabId(){return null===this.app?null:this.app.getTabId()}getUxId(){return null===this.app?null:this.app.getUxtId()}sessionID(){return l_("'sessionID' method","'getSessionID' method","/"),this.getSessionID()}getSessionURL(e){if(null!==this.app)return this.app.getSessionURL(e)}setUserID(e){"string"==typeof e&&null!==this.app&&this.app.session.setUserID(e)}userID(e){l_("'userID' method","'setUserID' method","/"),this.setUserID(e)}setUserAnonymousID(e){"string"==typeof e&&null!==this.app&&this.app.send(function(e){return[29,e]}(e))}userAnonymousID(e){l_("'userAnonymousID' method","'setUserAnonymousID' method","/"),this.setUserAnonymousID(e)}setMetadata(e,t){"string"==typeof e&&"string"==typeof t&&null!==this.app&&this.app.session.setMetadata(e,t)}metadata(e,t){l_("'metadata' method","'setMetadata' method","/"),this.setMetadata(e,t)}event(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof e&&null!==this.app){if(n)return this.issue(e,t);try{t=JSON.stringify(t)}catch(e){return}this.app.send(function(e,t){return[27,e,t]}(e,t))}}issue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e&&null!==this.app){try{t=JSON.stringify(t)}catch(e){return}this.app.send(function(e,t){return[64,e,t]}(e,t))}}}new class{constructor(){this.instance=null,this.isConfigured=!1}configure(e){Qb&&(this.isConfigured?console.warn("OpenReplay: Tracker is already configured. You should only call configure once."):e.projectKey?(this.instance=new px(e),this.isConfigured=!0):console.error("OpenReplay: Missing required projectKey option"))}get options(){var e;return(null===(e=this.instance)||void 0===e?void 0:e.options)||null}start(e){var t;return Qb?this.ensureConfigured()?(null===(t=this.instance)||void 0===t?void 0:t.start(e))||Promise.resolve({success:!1,reason:"Tracker not initialized"}):Promise.resolve({success:!1,reason:"Tracker not configured"}):Promise.resolve({success:!1,reason:"Not in browser environment"})}stop(){if(Qb&&this.ensureConfigured()&&this.instance)return this.instance.stop()}setUserID(e){Qb&&this.ensureConfigured()&&this.instance&&this.instance.setUserID(e)}setMetadata(e,t){Qb&&this.ensureConfigured()&&this.instance&&this.instance.setMetadata(e,t)}getSessionURL(e){if(Qb&&this.ensureConfigured()&&this.instance)return this.instance.getSessionURL(e)}getSessionID(){return Qb&&this.ensureConfigured()&&this.instance?this.instance.getSessionID():null}getSessionToken(){return Qb&&this.ensureConfigured()&&this.instance?this.instance.getSessionToken():null}event(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Qb&&this.ensureConfigured()&&this.instance&&this.instance.event(e,t,n)}issue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Qb&&this.ensureConfigured()&&this.instance&&this.instance.issue(e,t)}handleError(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Qb&&this.ensureConfigured()&&this.instance&&this.instance.handleError(e,t)}isFlagEnabled(e){return!!(Qb&&this.ensureConfigured()&&this.instance)&&this.instance.isFlagEnabled(e)}onFlagsLoad(){Qb&&this.ensureConfigured()&&this.instance&&this.instance.onFlagsLoad(...arguments)}clearPersistFlags(){Qb&&this.ensureConfigured()&&this.instance&&this.instance.clearPersistFlags()}reloadFlags(){if(Qb&&this.ensureConfigured()&&this.instance)return this.instance.reloadFlags()}getFeatureFlag(e){if(Qb&&this.ensureConfigured()&&this.instance)return this.instance.getFeatureFlag(e)}getAllFeatureFlags(){if(Qb&&this.ensureConfigured()&&this.instance)return this.instance.getAllFeatureFlags()}restartCanvasTracking(){Qb&&this.ensureConfigured()&&this.instance&&this.instance.restartCanvasTracking()}setUserAnonymousID(e){Qb&&this.ensureConfigured()&&this.instance&&this.instance.setUserAnonymousID(e)}isActive(){return!!(Qb&&this.ensureConfigured()&&this.instance)&&this.instance.isActive()}getInstance(){return this.ensureConfigured()&&Qb?this.instance:null}coldStart(e,t){if(Qb&&this.ensureConfigured()&&this.instance)return this.instance.coldStart(e,t)}trackWs(e){return Qb&&this.ensureConfigured()&&this.instance?this.instance.trackWs(e):()=>{}}ensureConfigured(){return!(!this.isConfigured&&Qb&&(console.warn('OpenReplay: Tracker must be configured before use. Call tracker.configure({projectKey: "your-project-key"}) first.'),1))}use(e){return Qb&&this.ensureConfigured()&&this.instance?this.instance.use(e):e(null)}startOfflineRecording(){if(Qb&&this.ensureConfigured()&&this.instance)return this.instance.startOfflineRecording(...arguments)}uploadOfflineRecording(){if(Qb&&this.ensureConfigured()&&this.instance)return this.instance.uploadOfflineRecording()}forceFlushBatch(){if(Qb&&this.ensureConfigured()&&this.instance)return this.instance.forceFlushBatch()}getSessionInfo(){return Qb&&this.ensureConfigured()&&this.instance?this.instance.getSessionInfo():null}getTabId(){return Qb&&this.ensureConfigured()&&this.instance?this.instance.getTabId():null}getUxId(){return Qb&&this.ensureConfigured()&&this.instance?this.instance.getUxId():null}};const hx="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):null,fx=1e4;function mx(e){if(null==e)return e;try{if(e.length>fx)return e.slice(0,fx)+`...[truncated ${e.length-fx} chars]`}catch(e){}return e}function gx(e){if(null==e)return e;try{if(hx&&e instanceof ArrayBuffer)return mx(hx.decode(new Uint8Array(e)))}catch(e){}try{if(hx&&ArrayBuffer.isView(e))return mx(hx.decode(e))}catch(e){}if("undefined"!=typeof Blob&&e instanceof Blob)return`[Blob: ${e.size||"unknown"} bytes, type: ${e.type||"unknown"}]`;if("string"==typeof e)return mx(e);if("object"==typeof e)try{return mx(JSON.stringify(e))}catch(t){return`[object: ${e&&e.constructor?e.constructor.name:"unknown"}]`}try{return String(e)}catch(e){return"[unserializable]"}}window.NapkinOR={isReady:!1,init:function(){try{let e=window.location.hostname;if(e.includes("local"))return void console.debug("Skipping OpenReplay on local environment.",e);this.tracker=new px({projectKey:Vv()?"ST6CHB3GxKaUNbCNSHjO":"qEGEoiTtThbyhGAnnMX2",ingestPoint:"https://openreplay.napkin.ai/ingest",disableSprites:!0,capturePerformance:!0,consoleThrottling:500,defaultInputMode:0,obscureTextNumbers:!1,obscureTextEmails:!1,obscureInputEmails:!1,defaultInputMode:0,__DISABLE_SECURE_MODE:!0!==Vv(),network:{captureHeaders:!0,captureContent:!0,capturePayload:!0,sanitizer:e=>{try{if(e.status<300)e.request.body=null,e.response.body=null;else{try{e.request.body=gx(e.request.body)}catch(e){console.warn("[OpenReplay] Failed to decode request body",e)}try{e.response.body=gx(e.response.body)}catch(e){console.warn("[OpenReplay] Failed to decode response body",e)}}}catch(e){console.error("[OpenReplay] Error in network sanitizer: ",e)}return e}}}),this.tracker.start().then(()=>{if(this.isReady=!0,console.debug("[OpenReplay] Started",this.tracker.getSessionURL()),window.NapkinSentry){var e=window.NapkinSentry.getClient();e&&(e.setTag("openReplaySessionID",this.tracker.getSessionID()),e.setTag("openReplaySessionToken",this.tracker.getSessionToken()))}}),console.debug("[OpenReplay] Loaded")}catch(e){console.error("[OpenReplay] Error in init: ",e)}},getClient:function(){return this.tracker}},window.NapkinOR.init(),Vv()?window.NapkinSentry.init():console.log("[Sentry] Sentry is not loaded in development mode")})();
//# sourceMappingURL=m.js.map?t=eebad9b69